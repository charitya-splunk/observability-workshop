<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.125.5"><meta name=generator content="Relearn 6.0.0+tip"><meta name=description content="Up until this point, there have been no code changes, yet tracing, profiling and Database Query Performance data is being sent to Splunk Observability Cloud.
Next we will add the Splunk Log Observer to the mix to obtain log data from the Spring PetClinic application.
This change will update the configuration of logback in the Spring PetClinic application. This will allow the automatic discovery and configuration to add OpenTelemetry relevant information into the logs."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Log Observer :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="Up until this point, there have been no code changes, yet tracing, profiling and Database Query Performance data is being sent to Splunk Observability Cloud.
Next we will add the Splunk Log Observer to the mix to obtain log data from the Spring PetClinic application.
This change will update the configuration of logback in the Spring PetClinic application. This will allow the automatic discovery and configuration to add OpenTelemetry relevant information into the logs."><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Log Observer :: Splunk Observability Cloud Workshops"><meta property="og:description" content="Up until this point, there have been no code changes, yet tracing, profiling and Database Query Performance data is being sent to Splunk Observability Cloud.
Next we will add the Splunk Log Observer to the mix to obtain log data from the Spring PetClinic application.
This change will update the configuration of logback in the Spring PetClinic application. This will allow the automatic discovery and configuration to add OpenTelemetry relevant information into the logs."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Log Observer :: Splunk Observability Cloud Workshops"><meta itemprop=description content="Up until this point, there have been no code changes, yet tracing, profiling and Database Query Performance data is being sent to Splunk Observability Cloud.
Next we will add the Splunk Log Observer to the mix to obtain log data from the Spring PetClinic application.
This change will update the configuration of logback in the Spring PetClinic application. This will allow the automatic discovery and configuration to add OpenTelemetry relevant information into the logs."><meta itemprop=dateModified content="2024-06-14T14:20:44+01:00"><meta itemprop=wordCount content="110"><title>Log Observer :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/index.html rel=canonical type=text/html title="Log Observer :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/v5.62/images/favicon.ico?1718371975 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/v5.62/css/fontawesome-all.min.css?1718371989 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.62/css/fontawesome-all.min.css?1718371989 rel=stylesheet></noscript><link href=/observability-workshop/v5.62/css/nucleus.css?1718371989 rel=stylesheet><link href=/observability-workshop/v5.62/css/auto-complete.css?1718371989 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.62/css/auto-complete.css?1718371989 rel=stylesheet></noscript><link href=/observability-workshop/v5.62/css/perfect-scrollbar.min.css?1718371989 rel=stylesheet><link href=/observability-workshop/v5.62/css/fonts.css?1718371989 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.62/css/fonts.css?1718371989 rel=stylesheet></noscript><link href=/observability-workshop/v5.62/css/theme.css?1718371989 rel=stylesheet><link href=/observability-workshop/v5.62/css/theme-splunk-light.css?1718371989 rel=stylesheet id=R-variant-style><link href=/observability-workshop/v5.62/css/chroma-relearn-light.css?1718371989 rel=stylesheet id=R-variant-chroma-style><link href=/observability-workshop/v5.62/css/variant.css?1718371989 rel=stylesheet><link href=/observability-workshop/v5.62/css/print.css?1718371989 rel=stylesheet media=print><link href=/observability-workshop/v5.62/css/format-print.css?1718371989 rel=stylesheet><script src=/observability-workshop/v5.62/js/variant.js?1718371989></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../../../..",window.relearn.relBaseUri="../../../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.62",window.index_js_url="/observability-workshop/v5.62/en/index.search.js",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA"})</script></script><style>:root{--MAIN-WIDTH-MAX:1000rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.62/en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.62/en/other/index.html><span itemprop=name>Ninja Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.62/en/other/3-auto-instrumentation/index.html><span itemprop=name>Auto-Instrumentation Workshops</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/index.html><span itemprop=name>PetClinic Kubernetes Workshop</span></a><meta itemprop=position content="4">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>7. Log Observer</span><meta itemprop=position content="5"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/6-profiling-db-query/4-section-break/index.html title="4. Section Break (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/1-configure-logback/index.html title="Configuring Logback (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable chapter narrow" tabindex=-1><div class=flex-block-wrapper><article class=chapter><header class=headline></header><h1 id=log-observer>Log Observer</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>Up until this point, there have been no code changes, yet tracing, profiling and Database Query Performance data is being sent to Splunk Observability Cloud.</p><p>Next we will add the <strong>Splunk Log Observer</strong> to the mix to obtain log data from the Spring PetClinic application.</p><p>This change will update the configuration of <a href=https://logback.qos.ch/ rel=external target=_blank><strong>logback</strong></a> in the Spring PetClinic application. This will allow the automatic discovery and configuration to add OpenTelemetry relevant information into the logs.</p><p>The <strong>Splunk Log Observer</strong> is then used to view the logs and with the changes to the log format the platform can automatically correlate log information with services and traces.</p><p>This feature is called <a href=https://docs.splunk.com/observability/en/metrics-and-metadata/relatedcontent.html rel=external target=_blank><strong>Related Content</strong></a>.</p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>rcastley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Jun 14, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Log Observer</h1><article class=default><header class=headline></header><h1 id=configuring-logback>Configuring Logback</h1><p>First, clone the PetClinic GitHub repository, as we will need this later in the workshop to compile, build, package and containerize the application:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~ <span class=o>&amp;&amp;</span> git clone https://github.com/hagen-p/spring-petclinic-microservices.git</span></span></code></pre></div><p>Then change into the <code>spring-petclinic-microservices</code> directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/spring-petclinic-microservices</span></span></code></pre></div><p>The Spring PetClinic application can be configured to use several different Java logging libraries. In this scenario, the application is using <code>logback</code>. To make sure we get the OpenTelemetry information in the logs we need to update a file named <code>logback.xml</code> with the log structure and add an OpenTelemetry dependency to the <code>pom.xml</code> of each of the services in the PetClinic microservices folders.</p><p>First, let&rsquo;s set the Log Structure/Format. SpringBoot will allow you to set a global template, but for ease of use, we will replace the existing content of the <code>logback-spring.xml</code> files of each service with the following XML content using a prepared script.</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>The following entries will be added:</p><ul><li><strong>trace_id</strong></li><li><strong>span_id</strong></li><li><strong>trace_flags</strong></li><li><strong>service.name</strong></li><li><strong>deployment.environment</strong></li></ul></div></div><p>These fields allow the <strong>Splunk Observability Cloud</strong> to display <strong>Related Content</strong> when using the log pattern shown below:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;pattern&gt;</span>
</span></span><span class=line><span class=cl>  logback: %d{HH:mm:ss.SSS} [%thread] severity=%-5level %logger{36} - trace_id=%X{trace_id} span_id=%X{span_id} service.name=%property{otel.resource.service.name} trace_flags=%X{trace_flags} - %msg %kvp{DOUBLE}%n
</span></span><span class=line><span class=cl><span class=nt>&lt;/pattern&gt;</span></span></span></code></pre></div><p>The following script will update the <code>logback-spring.xml</code> for all of the services with the log structure in the format above:</p><div class=tab-panel data-tab-group=288e65ae9b1fbfd2f09c15bd00aabd8a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=update-logback-files class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("288e65ae9b1fbfd2f09c15bd00aabd8a","update-logback-files")'>
<span class=tab-nav-text>Update Logback files</span>
</button>
<button data-tab-item=replace-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("288e65ae9b1fbfd2f09c15bd00aabd8a","replace-output")'>
<span class=tab-nav-text>Replace Output</span></button></div><div class=tab-content-container><div data-tab-item=update-logback-files class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/petclinic/scripts/update_logback.sh</span></span></code></pre></div></div></div><div data-tab-item=replace-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Overwritten /home/splunk/spring-petclinic-microservices/spring-petclinic-admin-server/src/main/resources/logback-spring.xml with new XML content.
</span></span><span class=line><span class=cl>Overwritten /home/splunk/spring-petclinic-microservices/spring-petclinic-api-gateway/src/main/resources/logback-spring.xml with new XML content.
</span></span><span class=line><span class=cl>Overwritten /home/splunk/spring-petclinic-microservices/spring-petclinic-config-server/src/main/resources/logback-spring.xml with new XML content.
</span></span><span class=line><span class=cl>Overwritten /home/splunk/spring-petclinic-microservices/spring-petclinic-customers-service/src/main/resources/logback-spring.xml with new XML content.
</span></span><span class=line><span class=cl>Overwritten /home/splunk/spring-petclinic-microservices/spring-petclinic-discovery-server/src/main/resources/logback-spring.xml with new XML content.
</span></span><span class=line><span class=cl>Overwritten /home/splunk/spring-petclinic-microservices/spring-petclinic-vets-service/src/main/resources/logback-spring.xml with new XML content.
</span></span><span class=line><span class=cl>Overwritten /home/splunk/spring-petclinic-microservices/spring-petclinic-visits-service/src/main/resources/logback-spring.xml with new XML content.
</span></span><span class=line><span class=cl>Script execution completed.</span></span></code></pre></div></div></div></div></div><p>We can verify if the replacement has been successful by examining the <code>logback-spring.xml</code> file from one of the services:</p><div class=tab-panel data-tab-group=5b0de34e0ac40eb5e7563bf610e18854><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=cat-logback-springxml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("5b0de34e0ac40eb5e7563bf610e18854","cat-logback-springxml")'>
<span class=tab-nav-text>cat logback-spring.xml</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("5b0de34e0ac40eb5e7563bf610e18854","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=cat-logback-springxml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /home/splunk/spring-petclinic-microservices/spring-petclinic-customers-service/src/main/resources/logback-spring.xml</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span></span><span class=line><span class=cl>&lt;configuration&gt;
</span></span><span class=line><span class=cl>    &lt;appender name=&#34;console&#34; class=&#34;ch.qos.logback.core.ConsoleAppender&#34;&gt;
</span></span><span class=line><span class=cl>        &lt;encoder&gt;
</span></span><span class=line><span class=cl>            &lt;pattern&gt;
</span></span><span class=line><span class=cl>                logback: %d{HH:mm:ss.SSS} [%thread] severity=%-5level %logger{36} - trace_id=%X{trace_id} span_id=%X{span_id} service.name=%property{otel.resource.service.name} trace_flags=%X{trace_flags} - %msg %kvp{DOUBLE}%n
</span></span><span class=line><span class=cl>            &lt;/pattern&gt;
</span></span><span class=line><span class=cl>        &lt;/encoder&gt;
</span></span><span class=line><span class=cl>    &lt;/appender&gt;
</span></span><span class=line><span class=cl>    &lt;appender name=&#34;OpenTelemetry&#34;
</span></span><span class=line><span class=cl>              class=&#34;io.opentelemetry.instrumentation.logback.appender.v1_0.OpenTelemetryAppender&#34;&gt;
</span></span><span class=line><span class=cl>        &lt;captureExperimentalAttributes&gt;true&lt;/captureExperimentalAttributes&gt;
</span></span><span class=line><span class=cl>        &lt;captureKeyValuePairAttributes&gt;true&lt;/captureKeyValuePairAttributes&gt;
</span></span><span class=line><span class=cl>    &lt;/appender&gt;
</span></span><span class=line><span class=cl>    &lt;root level=&#34;INFO&#34;&gt;
</span></span><span class=line><span class=cl>        &lt;appender-ref ref=&#34;console&#34;/&gt;
</span></span><span class=line><span class=cl>        &lt;appender-ref ref=&#34;OpenTelemetry&#34;/&gt;
</span></span><span class=line><span class=cl>    &lt;/root&gt;
</span></span><span class=line><span class=cl>&lt;/configuration&gt;</span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>rcastley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Jun 14, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=rebuild-petclinic>Rebuild PetClinic</h1><p>Before we can build the new services with the updated log format we need to add the OpenTelemetry dependency that handles field injection to the <code>pom.xml</code> of our services:<div class=tab-panel data-tab-group=1f643d380efe59a0d5dbb03fb30dd06b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=adding-otel-dependencies class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("1f643d380efe59a0d5dbb03fb30dd06b","adding-otel-dependencies")'>
<span class=tab-nav-text>Adding OTel dependencies</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("1f643d380efe59a0d5dbb03fb30dd06b","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=adding-otel-dependencies class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/petclinic/scripts/add_otel.sh</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-admin-server
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-api-gateway
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-config-server
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-discovery-server
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-customers-service
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-vets-service
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-visits-service
</span></span><span class=line><span class=cl>Dependency addition complete!</span></span></code></pre></div></div></div></div></div></p><p>The Services are now ready to be built, so run the script that will use the <code>maven</code> command to compile/build/package the PetClinic microservices:</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>Note the <code>-P buildDocker</code>, this will build the new containers and take 3-5 minutes to complete.</p></div></div><div class=tab-panel data-tab-group=7fac5a1a488939c8377e0c7b3691d2b6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=running-maven class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("7fac5a1a488939c8377e0c7b3691d2b6","running-maven")'>
<span class=tab-nav-text>Running maven</span>
</button>
<button data-tab-item=maven-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7fac5a1a488939c8377e0c7b3691d2b6","maven-output")'>
<span class=tab-nav-text>Maven Output</span></button></div><div class=tab-content-container><div data-tab-item=running-maven class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw clean install -D skipTests -P buildDocker</span></span></code></pre></div></div></div><div data-tab-item=maven-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Successfully tagged quay.io/phagen/spring-petclinic-api-gateway:latest
</span></span><span class=line><span class=cl>[INFO] Built quay.io/phagen/spring-petclinic-api-gateway
</span></span><span class=line><span class=cl>[INFO] ------------------------------------------------------------------------
</span></span><span class=line><span class=cl>[INFO] Reactor Summary:
</span></span><span class=line><span class=cl>[INFO] 
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-microservices 0.0.1 ............... SUCCESS [  0.770 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-admin-server ...................... SUCCESS [01:03 min]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-customers-service ................. SUCCESS [ 29.031 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-vets-service ...................... SUCCESS [ 22.145 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-visits-service .................... SUCCESS [ 20.451 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-config-server ..................... SUCCESS [ 12.260 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-discovery-server .................. SUCCESS [ 14.174 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-api-gateway 0.0.1 ................. SUCCESS [ 29.832 s]
</span></span><span class=line><span class=cl>[INFO] ------------------------------------------------------------------------
</span></span><span class=line><span class=cl>[INFO] BUILD SUCCESS
</span></span><span class=line><span class=cl>[INFO] ------------------------------------------------------------------------
</span></span><span class=line><span class=cl>[INFO] Total time: 03:14 min
</span></span><span class=line><span class=cl>[INFO] Finished at: 2024-01-02T12:43:20Z
</span></span><span class=line><span class=cl>[INFO] ------------------------------------------------------------------------</span></span></code></pre></div></div></div></div></div><p>Given that Kubernetes needs to pull these freshly built images from somewhere, we are going to store them in the repository we tested earlier. To do this, run the script that will push the newly built containers into our local repository:</p><div class=tab-panel data-tab-group=1777aba8cbd602c8c46f6492d5d2bc32><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=pushing-containers class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("1777aba8cbd602c8c46f6492d5d2bc32","pushing-containers")'>
<span class=tab-nav-text>pushing Containers</span>
</button>
<button data-tab-item=docker-push-output-partial class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("1777aba8cbd602c8c46f6492d5d2bc32","docker-push-output-partial")'>
<span class=tab-nav-text>Docker Push Output (partial)</span></button></div><div class=tab-content-container><div data-tab-item=pushing-containers class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/petclinic/scripts/push_docker.sh </span></span></code></pre></div></div></div><div data-tab-item=docker-push-output-partial class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>The push refers to repository [localhost:5000/spring-petclinic-vets-service]
</span></span><span class=line><span class=cl>0391386bcb2a: Preparing
</span></span><span class=line><span class=cl>bbb67f51a186: Preparing
</span></span><span class=line><span class=cl>105351d0ada3: Preparing
</span></span><span class=line><span class=cl>49cfeae6cb9f: Preparing
</span></span><span class=line><span class=cl>b4da5101fcde: Preparing
</span></span><span class=line><span class=cl>49cfeae6cb9f: Pushed
</span></span><span class=line><span class=cl>e742c14be110: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>540aa741fede: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>a1dfe59d4939: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>1e99e92c46bf: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>f5aa38537736: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>d2210512edb4: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>8e87ff28f1b5: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>local: digest: sha256:42337b2a4ff7d0ac9b7c2cf3c70aa20b7b52d092f1e05d351e031dd7fad956fc size: 3040
</span></span><span class=line><span class=cl>The push refers to repository [localhost:5000/spring-petclinic-customers-service]
</span></span><span class=line><span class=cl>15d54d9adca8: Preparing
</span></span><span class=line><span class=cl>886f6def5b35: Preparing
</span></span><span class=line><span class=cl>1575ae90e858: Preparing
</span></span><span class=line><span class=cl>ccc884d92d18: Preparing
</span></span><span class=line><span class=cl>b4da5101fcde: Preparing
</span></span><span class=line><span class=cl>ccc884d92d18: Pushed
</span></span><span class=line><span class=cl>e742c14be110: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>540aa741fede: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>a1dfe59d4939: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>1e99e92c46bf: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>f5aa38537736: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>d2210512edb4: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>8e87ff28f1b5: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>local: digest: sha256:3601c6e7f58224001946058fb0400483fbb8f1b0ea8a6dbaf403c62b4c1908be size: 3042</span></span></code></pre></div></div></div></div></div><p>The containers should now be stored in the local repository, let&rsquo;s confirm by checking the catalog:</p><div class=tab-panel data-tab-group=92ff51414358bf8db99bd2ad864448c0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=check-catalog class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("92ff51414358bf8db99bd2ad864448c0","check-catalog")'>
<span class=tab-nav-text>Check Catalog</span>
</button>
<button data-tab-item=catalog-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("92ff51414358bf8db99bd2ad864448c0","catalog-output")'>
<span class=tab-nav-text>Catalog Output</span></button></div><div class=tab-content-container><div data-tab-item=check-catalog class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -X GET http://localhost:9999/v2/_catalog</span></span></code></pre></div></div></div><div data-tab-item=catalog-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;repositories&#34;</span><span class=p>:[</span><span class=s2>&#34;spring-petclinic-admin-server&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-api-gateway&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-config-server&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-customers-service&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-discovery-server&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-vets-service&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-visits-service&#34;</span><span class=p>]}</span></span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>rcastley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Jun 14, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-to-kubernetes>Deploy to Kubernetes</h1><p>To see the changes in effect, we need to redeploy the services, First, let&rsquo;s change the location of the images from the external repo to the local one by running the following script:</p><div class=tab-panel data-tab-group=327c362c15bcc4ec075b356ac83d315a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=change-deployment-to-local-containers class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("327c362c15bcc4ec075b356ac83d315a","change-deployment-to-local-containers")'>
<span class=tab-nav-text>Change deployment to local containers</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("327c362c15bcc4ec075b356ac83d315a","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=change-deployment-to-local-containers class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/petclinic/scripts/set_local.sh</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Script execution completed. Modified content saved to /home/splunk/workshop/petclinic/petclinic-local.yaml</span></span></code></pre></div></div></div></div></div><p>The result is a new file on disk called <code>petclinic-local.yaml</code>. Switch to the local versions by using the new version of the deployment YAML. First delete the old containers from the original deployment with:</p><div class=tab-panel data-tab-group=8c17b949b5a2385be48fb494770f5bac><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=deleting-remote-petclinic-services class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8c17b949b5a2385be48fb494770f5bac","deleting-remote-petclinic-services")'>
<span class=tab-nav-text>Deleting remote Petclinic services</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("8c17b949b5a2385be48fb494770f5bac","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=deleting-remote-petclinic-services class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete -f ~/workshop/petclinic/petclinic-deploy.yaml</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>deployment.apps &#34;config-server&#34; deleted
</span></span><span class=line><span class=cl>service &#34;config-server&#34; deleted
</span></span><span class=line><span class=cl>deployment.apps &#34;discovery-server&#34; deleted
</span></span><span class=line><span class=cl>service &#34;discovery-server&#34; deleted
</span></span><span class=line><span class=cl>deployment.apps &#34;api-gateway&#34; deleted
</span></span><span class=line><span class=cl>service &#34;api-gateway&#34; deleted
</span></span><span class=line><span class=cl>service &#34;api-gateway-external&#34; deleted
</span></span><span class=line><span class=cl>deployment.apps &#34;customers-service&#34; deleted
</span></span><span class=line><span class=cl>service &#34;customers-service&#34; deleted
</span></span><span class=line><span class=cl>deployment.apps &#34;vets-service&#34; deleted
</span></span><span class=line><span class=cl>service &#34;vets-service&#34; deleted
</span></span><span class=line><span class=cl>deployment.apps &#34;visits-service&#34; deleted
</span></span><span class=line><span class=cl>service &#34;visits-service&#34; deleted
</span></span><span class=line><span class=cl>deployment.apps &#34;admin-server&#34; deleted
</span></span><span class=line><span class=cl>service &#34;admin-server&#34; deleted
</span></span><span class=line><span class=cl>service &#34;petclinic-db&#34; deleted
</span></span><span class=line><span class=cl>deployment.apps &#34;petclinic-db&#34; deleted
</span></span><span class=line><span class=cl>configmap &#34;petclinic-db-initdb-config&#34; deleted
</span></span><span class=line><span class=cl>deployment.apps &#34;petclinic-loadgen-deployment&#34; deleted
</span></span><span class=line><span class=cl>configmap &#34;scriptfile&#34; deleted</span></span></code></pre></div></div></div></div></div><p>followed by:</p><div class=tab-panel data-tab-group=ff1932de5cb127984a2ad69b295951e4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=starting-local-petclinic--services class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("ff1932de5cb127984a2ad69b295951e4","starting-local-petclinic--services")'>
<span class=tab-nav-text>Starting local Petclinic services</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("ff1932de5cb127984a2ad69b295951e4","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=starting-local-petclinic--services class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f ~/workshop/petclinic/petclinic-local.yaml</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>deployment.apps/config-server created
</span></span><span class=line><span class=cl>service/config-server created
</span></span><span class=line><span class=cl>deployment.apps/discovery-server created
</span></span><span class=line><span class=cl>service/discovery-server created
</span></span><span class=line><span class=cl>deployment.apps/api-gateway created
</span></span><span class=line><span class=cl>service/api-gateway created
</span></span><span class=line><span class=cl>service/api-gateway-external created
</span></span><span class=line><span class=cl>deployment.apps/customers-service created
</span></span><span class=line><span class=cl>service/customers-service created
</span></span><span class=line><span class=cl>deployment.apps/vets-service created
</span></span><span class=line><span class=cl>service/vets-service created
</span></span><span class=line><span class=cl>deployment.apps/visits-service created
</span></span><span class=line><span class=cl>service/visits-service created
</span></span><span class=line><span class=cl>deployment.apps/admin-server created
</span></span><span class=line><span class=cl>service/admin-server created
</span></span><span class=line><span class=cl>service/petclinic-db created
</span></span><span class=line><span class=cl>deployment.apps/petclinic-db created
</span></span><span class=line><span class=cl>configmap/petclinic-db-initdb-config created
</span></span><span class=line><span class=cl>deployment.apps/petclinic-loadgen-deployment created
</span></span><span class=line><span class=cl>configmap/scriptfile created</span></span></code></pre></div></div></div></div></div><p>This will cause the containers to be replaced with the local version, you can verify this by checking the containers:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe pods api-gateway <span class=p>|</span> grep Image:</span></span></code></pre></div><p>The resulting output will show <code>localhost:9999</code>:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>  Image:         localhost:9999/spring-petclinic-api-gateway:local</span></span></code></pre></div><p>However, as we only patched the deployment before, the new deployment does not have the right annotations for the <strong>automatic discovery and configuration</strong>, so let&rsquo;s fix that now by running the patch command again:</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>There will be no change for the <strong>admin-server</strong>, <strong>config-server</strong> and <strong>discovery-server</strong> as they are already annotated.</p></div></div><div class=tab-panel data-tab-group=189532b1bccb34dadf6e8c265d60cd2b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=patch-all-petclinic-services class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("189532b1bccb34dadf6e8c265d60cd2b","patch-all-petclinic-services")'>
<span class=tab-nav-text>Patch all Petclinic services</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("189532b1bccb34dadf6e8c265d60cd2b","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=patch-all-petclinic-services class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get deployments -l app.kubernetes.io/part-of<span class=o>=</span>spring-petclinic -o name <span class=p>|</span> xargs -I % kubectl patch % -p <span class=s2>&#34;{\&#34;spec\&#34;: {\&#34;template\&#34;:{\&#34;metadata\&#34;:{\&#34;annotations\&#34;:{\&#34;instrumentation.opentelemetry.io/inject-java\&#34;:\&#34;default/splunk-otel-collector\&#34;}}}}}&#34;</span></span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>deployment.apps/config-server patched (no change)
</span></span><span class=line><span class=cl>deployment.apps/admin-server patched (no change)
</span></span><span class=line><span class=cl>deployment.apps/customers-service patched
</span></span><span class=line><span class=cl>deployment.apps/visits-service patched
</span></span><span class=line><span class=cl>deployment.apps/discovery-server patched (no change)
</span></span><span class=line><span class=cl>deployment.apps/vets-service patched
</span></span><span class=line><span class=cl>deployment.apps/api-gateway patched</span></span></code></pre></div></div></div></div></div><p>Check the <code>api-gateway</code> container (again if you see two <code>api-gateway</code> containers, it&rsquo;s the old container being terminated so give it a few seconds):</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe pods api-gateway <span class=p>|</span> grep Image:</span></span></code></pre></div><p>The resulting output will show the local api gateway version <code>localhost:9999</code> and the auto-instrumentation container:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>  Image:         ghcr.io/signalfx/splunk-otel-java/splunk-otel-java:v1.32.1
</span></span><span class=line><span class=cl>  Image:         localhost:9999/spring-petclinic-api-gateway:local</span></span></code></pre></div><p>Now that the Pods have been patched validate they are all running by executing the following command:</p><div class=tab-panel data-tab-group=a129fe4695af0ee7736bf108d8d64b02><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=checking-if-all-pods-are-running class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("a129fe4695af0ee7736bf108d8d64b02","checking-if-all-pods-are-running")'>
<span class=tab-nav-text>Checking if all Pods are running</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a129fe4695af0ee7736bf108d8d64b02","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=checking-if-all-pods-are-running class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                           READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-certmanager-cainjector-cd8459647-d42ls   1/1     Running   0          22h
</span></span><span class=line><span class=cl>splunk-otel-collector-certmanager-85cbb786b6-xgjgb             1/1     Running   0          22h
</span></span><span class=line><span class=cl>splunk-otel-collector-certmanager-webhook-75d888f9f7-477x4     1/1     Running   0          22h
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-nmmkm                              1/1     Running   0          22h
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-7f96c94fd9-fv4p8    1/1     Running   0          22h
</span></span><span class=line><span class=cl>splunk-otel-collector-operator-6b56bc9d79-r8p7w                2/2     Running   0          22h
</span></span><span class=line><span class=cl>petclinic-loadgen-deployment-765b96d4b9-gm8fp                  1/1     Running   0          21h
</span></span><span class=line><span class=cl>petclinic-db-774dbbf969-2q6md                                  1/1     Running   0          21h
</span></span><span class=line><span class=cl>config-server-5784c9fbb4-9pdc8                                 1/1     Running   0          21h
</span></span><span class=line><span class=cl>admin-server-849d877b6-pncr2                                   1/1     Running   0          21h
</span></span><span class=line><span class=cl>discovery-server-6d856d978b-7x69f                              1/1     Running   0          21h
</span></span><span class=line><span class=cl>visits-service-c7cd56876-grfn7                                 1/1     Running   0          21h
</span></span><span class=line><span class=cl>customers-service-6c57cb68fd-hx68n                             1/1     Running   0          21h
</span></span><span class=line><span class=cl>vets-service-688fd4cb47-z42t5                                  1/1     Running   0          21h
</span></span><span class=line><span class=cl>api-gateway-59f4c7fbd6-prx5f                                   1/1     Running   0          20h</span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>rcastley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Jun 14, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=viewing-the-logs>Viewing the Logs</h1><p>In order to see logs click on the <strong>Log Observer</strong> <a href=#R-image-619b7a63feda1c699736e4a6b4ec6538 class=lightbox-link><img alt=Logo class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/4-view-logs/../../images/logo-icon.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-619b7a63feda1c699736e4a6b4ec6538><img alt=Logo class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/4-view-logs/../../images/logo-icon.png?classes=inline&height=25px"></a> in the left-hand menu. Once in Log Observer please ensure <strong>Index</strong> on the filter bar is set to <strong>splunk4rookies-workshop</strong>.</p><p>Next, click <strong>Add Filter</strong> and search for the field <code>deployment.environment</code>, select your workshop instance and click <code>=</code> (to include). You will now see only the log messages from your PetClinic application.</p><p>Next search for the field <code>service_name</code>, select the value <code>customers-service</code> and click <code>=</code> (to include). Now the log entries will be reduced to show the entries from your <code>customers-service</code> only.</p><p>In the log entry you will see the message is formatted as per the pattern we configured for logback eariler <strong>(1)</strong>:</p><p><a href=#R-image-9e34bfdb11c54439746108f98978dd1f class=lightbox-link><img alt="Log Observer" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/4-view-logs/../../images/log-observer-trace-info.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9e34bfdb11c54439746108f98978dd1f><img alt="Log Observer" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/4-view-logs/../../images/log-observer-trace-info.png></a></p><p>Click on an entry with an injected trace_id <strong>(1)</strong>. A side pane will open where you can see the detailed information, including the relevant trace and span IDs <strong>(2)</strong>.</p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>rcastley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Jun 14, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=related-content>Related Content</h1><p>In the bottom pane is where any related content will be reported. In the screenshot below you can see that APM has found a trace that is related to this log line <strong>(1)</strong>:</p><p><a href=#R-image-e88b2a990b4c5d24cba3a22aa745cf33 class=lightbox-link><img alt=RC class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/5-related-content/../../images/log-apm-rc.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e88b2a990b4c5d24cba3a22aa745cf33><img alt=RC class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/5-related-content/../../images/log-apm-rc.png></a></p><p>By clicking on <strong>Trace for 0c5b37a751e1fc3e7a7191140ex714a0</strong> <strong>(2)</strong> will take us to the waterfall in APM for this specific trace that this log line was generated from:</p><p><a href=#R-image-4cb9813844692c8a59a673f80b375544 class=lightbox-link><img alt="waterfall logs" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/5-related-content/../../images/waterfall-with-logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4cb9813844692c8a59a673f80b375544><img alt="waterfall logs" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.62/en/other/3-auto-instrumentation/1-zero-config-k8s/7-log-observer-connect/5-related-content/../../images/waterfall-with-logs.png></a></p><p>Note that you now have Related Content pane for Logs appear <strong>(1)</strong>. Clicking on this will take you back to Log Observer and will display all the log lines that are part of this trace.</p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>rcastley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Jun 14, 2024</span></span></footer></article><article class=chapter><header class=headline></header><h1 id=6-section-break>6. Section Break</h1><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>rcastley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Jun 14, 2024</span></span></footer></article></section></div></main></div><script src=/observability-workshop/v5.62/js/clipboard.min.js?1718371989 defer></script><script src=/observability-workshop/v5.62/js/perfect-scrollbar.min.js?1718371989 defer></script><script src=/observability-workshop/v5.62/js/theme.js?1718371989 defer></script></body></html>