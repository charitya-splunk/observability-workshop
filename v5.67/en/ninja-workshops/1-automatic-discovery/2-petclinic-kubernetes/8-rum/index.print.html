<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.125.5"><meta name=generator content="Relearn 6.4.0+tip"><meta name=description content="To enable Real User Monitoring (RUM) instrumentation for your application, you need to add the Open Telemetry Javascript https://github.com/signalfx/splunk-otel-js-web snippet to your code.
The Spring PetClinic application uses a single HTML page as the “index” page, that is reused across all pages of the application. This is the perfect location to insert the Splunk RUM Instrumentation Library as it will be loaded for all pages automatically.
The following snippet is inserted into the section of the index."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Real User Monitoring :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="To enable Real User Monitoring (RUM) instrumentation for your application, you need to add the Open Telemetry Javascript https://github.com/signalfx/splunk-otel-js-web snippet to your code.
The Spring PetClinic application uses a single HTML page as the “index” page, that is reused across all pages of the application. This is the perfect location to insert the Splunk RUM Instrumentation Library as it will be loaded for all pages automatically.
The following snippet is inserted into the section of the index."><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Real User Monitoring :: Splunk Observability Cloud Workshops"><meta property="og:description" content="To enable Real User Monitoring (RUM) instrumentation for your application, you need to add the Open Telemetry Javascript https://github.com/signalfx/splunk-otel-js-web snippet to your code.
The Spring PetClinic application uses a single HTML page as the “index” page, that is reused across all pages of the application. This is the perfect location to insert the Splunk RUM Instrumentation Library as it will be loaded for all pages automatically.
The following snippet is inserted into the section of the index."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Real User Monitoring :: Splunk Observability Cloud Workshops"><meta itemprop=description content="To enable Real User Monitoring (RUM) instrumentation for your application, you need to add the Open Telemetry Javascript https://github.com/signalfx/splunk-otel-js-web snippet to your code.
The Spring PetClinic application uses a single HTML page as the “index” page, that is reused across all pages of the application. This is the perfect location to insert the Splunk RUM Instrumentation Library as it will be loaded for all pages automatically.
The following snippet is inserted into the section of the index."><meta itemprop=dateModified content="2024-09-19T16:47:03+01:00"><meta itemprop=wordCount content="382"><title>Real User Monitoring :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/index.html rel=canonical type=text/html title="Real User Monitoring :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/v5.67/images/favicon.ico?1726779098 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/v5.67/css/fontawesome-all.min.css?1726779098 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.67/css/fontawesome-all.min.css?1726779098 rel=stylesheet></noscript><link href=/observability-workshop/v5.67/css/nucleus.css?1726779098 rel=stylesheet><link href=/observability-workshop/v5.67/css/auto-complete.css?1726779098 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.67/css/auto-complete.css?1726779098 rel=stylesheet></noscript><link href=/observability-workshop/v5.67/css/perfect-scrollbar.min.css?1726779098 rel=stylesheet><link href=/observability-workshop/v5.67/css/fonts.css?1726779098 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.67/css/fonts.css?1726779098 rel=stylesheet></noscript><link href=/observability-workshop/v5.67/css/theme.css?1726779098 rel=stylesheet><link href=/observability-workshop/v5.67/css/theme-splunk-light.css?1726779098 rel=stylesheet id=R-variant-style><link href=/observability-workshop/v5.67/css/chroma-relearn-light.css?1726779098 rel=stylesheet id=R-variant-chroma-style><link href=/observability-workshop/v5.67/css/variant.css?1726779098 rel=stylesheet><link href=/observability-workshop/v5.67/css/print.css?1726779098 rel=stylesheet media=print><link href=/observability-workshop/v5.67/css/format-print.css?1726779098 rel=stylesheet><script src=/observability-workshop/v5.67/js/variant.js?1726779098></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../../../..",window.relearn.relBaseUri="../../../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.67",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.index_js_url="/observability-workshop/v5.67/en/index.search.js?1726779098",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA"})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.67/en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.67/en/ninja-workshops/index.html><span itemprop=name>Ninja Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/index.html><span itemprop=name>Automatic Discovery Workshops</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/index.html><span itemprop=name>PetClinic Kubernetes Workshop</span></a><meta itemprop=position content="4">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>8. Real User Monitoring</span><meta itemprop=position content="5"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/7-log-observer-connect/2-related-content/index.html title="Related Content (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/1-rebuild-app/index.html title="Rebuild PetClinic with RUM enabled (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=real-user-monitoring>Real User Monitoring</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>To enable Real User Monitoring (RUM) instrumentation for your application, you need to add the Open Telemetry Javascript <a href=https://github.com/signalfx/splunk-otel-js-web rel=external target=_blank><strong>https://github.com/signalfx/splunk-otel-js-web</strong></a> snippet to your code.</p><p>The Spring PetClinic application uses a single HTML page as the &ldquo;index&rdquo; page, that is reused across all pages of the application. This is the perfect location to insert the Splunk RUM Instrumentation Library as it will be loaded for all pages automatically.</p><p>The following snippet is inserted into the <strong><head></strong>section of the <code>index.html</code> page:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/static/env.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>realm</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_REALM</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Realm:&#39;</span><span class=p>,</span> <span class=nx>realm</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>auth</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_AUTH</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>appName</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_APP_NAME</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>environmentName</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_ENVIRONMENT</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>realm</span> <span class=o>&amp;&amp;</span> <span class=nx>auth</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>realm</span><span class=o>:</span> <span class=nx>realm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>rumAccessToken</span><span class=o>:</span> <span class=nx>auth</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>applicationName</span><span class=o>:</span> <span class=nx>appName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>deploymentEnvironment</span><span class=o>:</span> <span class=nx>environmentName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>version</span><span class=o>:</span> <span class=s1>&#39;1.0.0&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>SplunkSessionRecorder</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>app</span><span class=o>:</span> <span class=nx>appName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>realm</span><span class=o>:</span> <span class=nx>realm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>rumAccessToken</span><span class=o>:</span> <span class=nx>auth</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>Provider</span> <span class=o>=</span> <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>provider</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>tracer</span><span class=o>=</span><span class=nx>Provider</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=s1>&#39;appModuleLoader&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Realm or auth is empty, provide default values or skip initialization
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Realm or auth is empty. Skipping Splunk Rum initialization.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span></span></span></code></pre></div><p>The above snippet of code has already been added to <code>index.html</code> in the repository you cloned earlier, but it is not yet activated, we will do that in the next section.</p><p>If you want you can verify the snippet, we added to the index.html by viewing the file:</p><div class=tab-panel data-tab-group=e75c5147e96ffc273c04711855a2c6f2><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=view-indexhtml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("e75c5147e96ffc273c04711855a2c6f2","view-indexhtml")'>
<span class=tab-nav-text>View index.html</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("e75c5147e96ffc273c04711855a2c6f2","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=view-indexhtml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> more ~/spring-petclinic-microservices/spring-petclinic-api-gateway/src/main/resources/static/index.html</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;html ng-app=&#34;petClinicApp&#34; lang=&#34;en&#34;&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;head&gt;
</span></span><span class=line><span class=cl>    &lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=UTF-8&#34;/&gt;
</span></span><span class=line><span class=cl>    &lt;meta charset=&#34;utf-8&#34;/&gt;
</span></span><span class=line><span class=cl>    &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;IE=edge&#34;/&gt;
</span></span><span class=line><span class=cl>    &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1, user-scalable=0, minimal-ui&#34;/&gt;
</span></span><span class=line><span class=cl>    &lt;!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags --&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;link rel=&#34;shortcut icon&#34; type=&#34;image/x-icon&#34; href=&#34;/images/favicon.png&#34;/&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;title&gt;PetClinic :: a Spring Framework demonstration&lt;/title&gt;
</span></span><span class=line><span class=cl>    &lt;link rel=&#34;stylesheet&#34; href=&#34;/webjars/bootstrap/css/bootstrap.min.css&#34;/&gt;
</span></span><span class=line><span class=cl>    &lt;link rel=&#34;stylesheet&#34; href=&#34;/css/petclinic.css&#34;/&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;script src=&#34;/webjars/jquery/jquery.min.js&#34;&gt;&lt;/script&gt;
</span></span><span class=line><span class=cl>    &lt;script src=&#34;/webjars/bootstrap/js/bootstrap.min.js&#34;&gt;&lt;/script&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;script src=&#34;/webjars/angularjs/angular.min.js&#34;&gt;&lt;/script&gt;
</span></span><span class=line><span class=cl>    &lt;script src=&#34;/webjars/angular-ui-router/angular-ui-router.min.js&#34;&gt;&lt;/script&gt;
</span></span><span class=line><span class=cl>    &lt;!-- Section added for  RUM --&gt;
</span></span><span class=line><span class=cl>    &lt;script src=&#34;/scripts/env.js&#34;&gt;&lt;/script&gt;
</span></span><span class=line><span class=cl>    &lt;script src=&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js&#34; crossorigin=&#34;anonymous&#34;&gt;&lt;/script&gt;
</span></span><span class=line><span class=cl>    &lt;script src=&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js&#34; crossorigin=&#34;anonymous&#34;&gt;&lt;/script&gt;
</span></span><span class=line><span class=cl>    &lt;script&gt;
</span></span><span class=line><span class=cl>        var realm = env.RUM_REALM;
</span></span><span class=line><span class=cl>        console.log(&#39;Realm:&#39;, realm);
</span></span><span class=line><span class=cl>        var auth = env.RUM_AUTH;
</span></span><span class=line><span class=cl>        var appName = env.RUM_APP_NAME;
</span></span><span class=line><span class=cl>        var environmentName = env.RUM_ENVIRONMENT
</span></span><span class=line><span class=cl>        if (realm &amp;&amp; auth) {
</span></span><span class=line><span class=cl>            SplunkRum.init({
</span></span><span class=line><span class=cl>                realm: realm,
</span></span><span class=line><span class=cl>                rumAccessToken: auth,
</span></span><span class=line><span class=cl>                applicationName: appName,
</span></span><span class=line><span class=cl>                deploymentEnvironment: environmentName,
</span></span><span class=line><span class=cl>                version: &#39;1.0.0&#39;,
</span></span><span class=line><span class=cl>            });
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            SplunkSessionRecorder.init({
</span></span><span class=line><span class=cl>                app: appName,
</span></span><span class=line><span class=cl>                realm: realm,
</span></span><span class=line><span class=cl>                rumAccessToken: auth
</span></span><span class=line><span class=cl>            });
</span></span><span class=line><span class=cl>            const Provider = SplunkRum.provider;
</span></span><span class=line><span class=cl>            var tracer=Provider.getTracer(&#39;appModuleLoader&#39;);
</span></span><span class=line><span class=cl>        } else {
</span></span><span class=line><span class=cl>        // Realm or auth is empty, provide default values or skip initialization
</span></span><span class=line><span class=cl>        console.log(&#34;Realm or auth is empty. Skipping Splunk Rum initialization.&#34;);
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    &lt;/script&gt;
</span></span><span class=line><span class=cl>     &lt;!-- Section added for  RUM --&gt;
</span></span><span class=line><span class=cl>    &lt;script src=&#34;/scripts/app.js&#34;&gt;&lt;/script&gt;</span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Real User Monitoring</h1><article class=default><header class=headline></header><h1 id=rebuild-petclinic-with-rum-enabled>Rebuild PetClinic with RUM enabled</h1><p>At the top of the previous code snippet, there is a reference to the file <code>/static/env.js</code>, which contains/sets the variables used by RUM, currently these are not configured and therefore no RUM traces are currently being sent.</p><p>Run the script that will update variables to enable RUM traces so they are viewable in <strong>Splunk Observability Cloud</strong>. Note, that the <code>env.js</code> script contains a deliberate JavaScript error, that will be picked up in RUM:</p><div class=tab-panel data-tab-group=5ff58dab01accca3be6fefbe1fe156a4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=update-envjs-for-rum class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("5ff58dab01accca3be6fefbe1fe156a4","update-envjs-for-rum")'>
<span class=tab-nav-text>Update env.js for RUM</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("5ff58dab01accca3be6fefbe1fe156a4","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=update-envjs-for-rum class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/petclinic/scripts/push_env.sh</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Repository directory exists.
</span></span><span class=line><span class=cl>JavaScript file generated at: /home/splunk/spring-petclinic-microservices/spring-petclinic-api-gateway/src/main/resources/static/env.js</span></span></code></pre></div></div></div></div></div><p>Verify if the <code>env.js</code> has been created correctly:</p><div class=tab-panel data-tab-group=311dfb37f24b446698ee63ef1c0b78ae><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=cat-envjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("311dfb37f24b446698ee63ef1c0b78ae","cat-envjs")'>
<span class=tab-nav-text>cat env.js</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("311dfb37f24b446698ee63ef1c0b78ae","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=cat-envjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/spring-petclinic-microservices/spring-petclinic-api-gateway/src/main/resources/static/scripts/env.js</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl> <span class=nx>env</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>RUM_REALM</span><span class=o>:</span> <span class=s1>&#39;eu0&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>RUM_AUTH</span><span class=o>:</span> <span class=s1>&#39;[redacted]&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>RUM_APP_NAME</span><span class=o>:</span> <span class=s1>&#39;k8s-petclinic-workshop-store&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>RUM_ENVIRONMENT</span><span class=o>:</span> <span class=s1>&#39;k8s-petclinic-workshop-workshop&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>Change into the <code>api-gateway</code> directory and force a new build for just the <code>api-gateway</code> service:</p><div class=tab-panel data-tab-group=d333aac1e232d3173e8ffc76af6345dc><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=building-api-gateway class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("d333aac1e232d3173e8ffc76af6345dc","building-api-gateway")'>
<span class=tab-nav-text>Building api-gateway</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("d333aac1e232d3173e8ffc76af6345dc","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=building-api-gateway class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span>  ~/spring-petclinic-microservices/spring-petclinic-api-gateway
</span></span><span class=line><span class=cl>../mvnw clean install -D skipTests -P buildDocker</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Successfully built 2d409c1eeccc
</span></span><span class=line><span class=cl>Successfully tagged localhost:9999/spring-petclinic-api-gateway:local
</span></span><span class=line><span class=cl>[INFO] Built localhost:9999/spring-petclinic-api-gateway:local
</span></span><span class=line><span class=cl>[INFO] ------------------------------------------------------------------------
</span></span><span class=line><span class=cl>[INFO] BUILD SUCCESS
</span></span><span class=line><span class=cl>[INFO] ------------------------------------------------------------------------
</span></span><span class=line><span class=cl>[INFO] Total time: 26.250 s
</span></span><span class=line><span class=cl>[INFO] Finished at: 2024-05-31T15:51:20Z
</span></span><span class=line><span class=cl>[INFO] ------------------------------------------------------------------------</span></span></code></pre></div></div></div></div></div><p>and now push the new container to the local registry, the others get skipped:</p><div class=tab-panel data-tab-group=a8b48b473adc71700489fd078922295d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=updating-docker-repo-with-rum-api-gateway class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("a8b48b473adc71700489fd078922295d","updating-docker-repo-with-rum-api-gateway")'>
<span class=tab-nav-text>Updating docker repo with RUM api-gateway</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a8b48b473adc71700489fd078922295d","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=updating-docker-repo-with-rum-api-gateway class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/petclinic/scripts/push_docker.sh</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>The push refers to repository [localhost:9999/spring-petclinic-api-gateway]
</span></span><span class=line><span class=cl>9a7b16677cf9: Pushed
</span></span><span class=line><span class=cl>f2e09ed98998: Layer already exists
</span></span><span class=line><span class=cl>291752eeb66b: Layer already exists
</span></span><span class=line><span class=cl>ac28fe526c24: Layer already exists
</span></span><span class=line><span class=cl>0a37fe4a02de: Layer already exists
</span></span><span class=line><span class=cl>4b1e7b998de9: Layer already exists
</span></span><span class=line><span class=cl>a2a8ef39e636: Layer already exists
</span></span><span class=line><span class=cl>86cb6a9eb3cd: Layer already exists
</span></span><span class=line><span class=cl>985fdc63de98: Layer already exists
</span></span><span class=line><span class=cl>4ab2850febd7: Layer already exists
</span></span><span class=line><span class=cl>2db7720a8970: Layer already exists
</span></span><span class=line><span class=cl>629ca62fb7c7: Layer already exists</span></span></code></pre></div></div></div></div></div><p>As soon as the container is pushed into the repository, just restart the <code>api-gateway</code> to apply the changes:</p><div class=tab-panel data-tab-group=b137388bed617a45fc993dafcd5f2dd6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=rollout-restart-api-gateway class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("b137388bed617a45fc993dafcd5f2dd6","rollout-restart-api-gateway")'>
<span class=tab-nav-text>Rollout restart api-gateway</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("b137388bed617a45fc993dafcd5f2dd6","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=rollout-restart-api-gateway class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl rollout restart deployment api-gateway</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>deployment.apps/api-gateway restarted</span></span></code></pre></div></div></div></div></div><p>Validate that the application is running by visiting <strong>http://&lt;IP_ADDRESS>:81</strong> (replace <strong>&lt;IP_ADDRESS></strong> with the IP address you obtained above). Make sure the application is working correctly by visiting the <strong>All Owners</strong> <strong>(1)</strong> and select an owner, then add a <strong>visit</strong> <strong>(2)</strong>. We will use this action when checking RUM</p><p><a href=#R-image-e7ad7fe60e86d80abb66c2b9a907a87a class=lightbox-link><img alt=pet class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/1-rebuild-app/../../images/petclinic-pet.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e7ad7fe60e86d80abb66c2b9a907a87a><img alt=pet class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/1-rebuild-app/../../images/petclinic-pet.png></a></p><p>If you want, you can access this website on your phone/tablet as well as this data will also show up in RUM.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=select-the-rum-view-for-the-petclinic-app>Select the RUM view for the Petclinic App</h1><p>Once RUM has been configured and you have added a visit for a pet, you can log in to <strong>Splunk Observability Cloud</strong> and verify that RUM traces are flowing in.</p><p>Lets start a quick high level tour into RUM by clicking <strong>RUM</strong> <a href=#R-image-11660bd909b0f3cd35c1d5cf8e09e4be class=lightbox-link><img alt=RUM class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/2-rum-tour-1/../../images/rum-icon.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-11660bd909b0f3cd35c1d5cf8e09e4be><img alt=RUM class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/2-rum-tour-1/../../images/rum-icon.png?classes=inline&height=25px"></a> in the left-hand menu. Then change the <strong>Environment</strong> filter <strong>(1)</strong> to the name of your workshop instance from the dropdown box, it will be <strong><code>&lt;INSTANCE>-workshop</code></strong> <strong>(1)</strong> (where <strong><code>INSTANCE</code></strong> is the value from the shell script you ran earlier). Make sure it is the only one selected.</p><p>Then change the <strong>App</strong> <strong>(2)</strong> dropdown box to the name of your app, it will be <strong><code>&lt;INSTANCE>-store</code></strong></p><p><a href=#R-image-d2cc3d1e48ec68d638b11ebfaa50d49b class=lightbox-link><img alt="rum select" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/2-rum-tour-1/../../images/rum-env-select.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d2cc3d1e48ec68d638b11ebfaa50d49b><img alt="rum select" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/2-rum-tour-1/../../images/rum-env-select.png></a></p><p>Once you have selected your <strong>Environment</strong> and <strong>App</strong>, you will see an overview page showing the RUM status of your App (if your Summary Dashboard is just a single row of numbers, you are looking at the condensed view. You can expand it by clicking on the <strong>></strong> in front of the Application name). If any JavaScript error occurred they will show up as shown below:</p><p><a href=#R-image-7a6fde79b88c879566b6cdfa373aa882 class=lightbox-link><img alt="rum overview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/2-rum-tour-1/../../images/rum-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7a6fde79b88c879566b6cdfa373aa882><img alt="rum overview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/2-rum-tour-1/../../images/rum-overview.png></a></p><p>To continue, click on the blue link (with your workshop name) to get to the details page, this will bring up a new dashboard view breaking down the interactions by UX Metrics, Front-end Health, Back-end Health and Custom Events and comparing them to historic metrics (1 hour by default).</p><p><a href=#R-image-fcb25ff1c9347ea500f64d72e207bdec class=lightbox-link><img alt="rum  main" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/2-rum-tour-1/../../images/rum-main.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fcb25ff1c9347ea500f64d72e207bdec><img alt="rum  main" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/2-rum-tour-1/../../images/rum-main.png></a>
Normally you have only one line inside the first chart, Click on the link that relates to your Petclinic shop,
http://198.19.249.62 in our example:</p><p>This will bring us to the Tag Spotlight page:</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=rum-trace-waterfall-view--linking-to-apm>RUM trace Waterfall view & linking to APM</h1><p>In the TAG Spotlight view, you are presented with all the tags associated with the RUM data. Tags are key-value pairs that are used to identify the data. In this case, the tags are automatically generated by the OpenTelemetry instrumentation. The tags are used to filter the data and to create the charts and tables. The Tag Spotlight view allows you detect trends in behavior and to drill down into a user session.</p><p><a href=#R-image-f176a1c4072a3e2cca8fbba658fbc277 class=lightbox-link><img alt="RUM TAG" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/3-rum-tour-2/../../images/rum-tag-spotlight.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f176a1c4072a3e2cca8fbba658fbc277><img alt="RUM TAG" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/3-rum-tour-2/../../images/rum-tag-spotlight.png></a></p><p>Click on User Sessions <strong>(1)</strong>, this will show you the list of user session that occurred during the time window.
We want to look at one of the session , so click on <em>Duration</em> <strong>(2)</strong> to sort on duration, and make sure you click on the link of one of the longer ones <strong>(3)</strong>:</p><p><a href=#R-image-e0fbc2685f9ac7a14596bd236b000f6d class=lightbox-link><img alt="User sessions" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/3-rum-tour-2/../../images/rum-user-sessions.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e0fbc2685f9ac7a14596bd236b000f6d><img alt="User sessions" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/3-rum-tour-2/../../images/rum-user-sessions.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=rum-trace-waterfall-view--linking-to-apm>RUM trace Waterfall view & linking to APM</h1><p>We are now looking at the RUM Trace waterfall, this will tell you what happened during the session on the user device as they visited the page of our petclinic application.</p><p>If you scroll down the waterfall find click on the <strong>Vets</strong> segment on the right <strong>(1)</strong>, you see a list of action that occurred during the handling of the Vets request. Note, that the HTTP request have a blue <strong>APM</strong> link before the return code. Pick one, and click on the APM link. This will show you the APM info for this Ser vice call to our Microservices in Kubernetes.</p><p><a href=#R-image-3cc37e4116437313d316237472d1f9f6 class=lightbox-link><img alt="rum apm link" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/4-rum-tour-3/../../images/rum-trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3cc37e4116437313d316237472d1f9f6><img alt="rum apm link" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/4-rum-tour-3/../../images/rum-trace.png></a></p><p>Note , that there give you the information what happened during action in the Microservices, and if you want to drill down to verify what happened with the request, click on the Trace ID url.</p><p>This will show you the trace related to your request from RUM:</p><p><a href=#R-image-30f1fc9fe18ce84df32c0f415f4b4c98 class=lightbox-link><img alt="RUm-apm linked" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/4-rum-tour-3/../../images/rum-apm-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-30f1fc9fe18ce84df32c0f415f4b4c98><img alt="RUm-apm linked" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/8-rum/4-rum-tour-3/../../images/rum-apm-waterfall.png></a></p><p>You can see that the entry point into your service now has a <strong>RUM (1)</strong> related content link added, allowing you to return back to your RUM session after you validated what happened in your Microservices.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section></div></main></div><script src=/observability-workshop/v5.67/js/clipboard.min.js?1726779098 defer></script><script src=/observability-workshop/v5.67/js/perfect-scrollbar.min.js?1726779098 defer></script><script src=/observability-workshop/v5.67/js/theme.js?1726779098 defer></script></body></html>