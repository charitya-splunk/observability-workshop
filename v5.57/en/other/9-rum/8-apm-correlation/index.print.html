<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.125.5"><meta name=generator content="Relearn 6.0.0+tip"><meta name=description content="Continue with the RUM Session information in the RUM UI See correlated APM traces and logs in the APM & Log Observer UI 1. Finding backend service issues Click on the to close the Span view. Now continue to scroll down and find the POST /cart/checkout line.
Click on the blue link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="Continue with the RUM Session information in the RUM UI See correlated APM traces and logs in the APM & Log Observer UI 1. Finding backend service issues Click on the to close the Span view. Now continue to scroll down and find the POST /cart/checkout line.
Click on the blue link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user."><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.57/en/other/9-rum/8-apm-correlation/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><meta property="og:description" content="Continue with the RUM Session information in the RUM UI See correlated APM traces and logs in the APM & Log Observer UI 1. Finding backend service issues Click on the to close the Span view. Now continue to scroll down and find the POST /cart/checkout line.
Click on the blue link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="Ninja Workshops"><meta property="article:modified_time" content="2023-12-21T14:15:53+00:00"><meta itemprop=name content="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><meta itemprop=description content="Continue with the RUM Session information in the RUM UI See correlated APM traces and logs in the APM & Log Observer UI 1. Finding backend service issues Click on the to close the Span view. Now continue to scroll down and find the POST /cart/checkout line.
Click on the blue link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user."><meta itemprop=dateModified content="2023-12-21T14:15:53+00:00"><meta itemprop=wordCount content="561"><title>8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.57/en/other/9-rum/8-apm-correlation/index.html rel=canonical type=text/html title="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><link href=../../../../images/favicon.ico?1715860346 rel=icon type=image/x-icon sizes=any><link href=../../../../css/fontawesome-all.min.css?1715860360 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../css/fontawesome-all.min.css?1715860360 rel=stylesheet></noscript><link href=../../../../css/nucleus.css?1715860360 rel=stylesheet><link href=../../../../css/auto-complete.css?1715860360 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../css/auto-complete.css?1715860360 rel=stylesheet></noscript><link href=../../../../css/perfect-scrollbar.min.css?1715860360 rel=stylesheet><link href=../../../../css/fonts.css?1715860360 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../css/fonts.css?1715860360 rel=stylesheet></noscript><link href=../../../../css/theme.css?1715860360 rel=stylesheet><link href=../../../../css/theme-splunk-light.css?1715860360 rel=stylesheet id=R-variant-style><link href=../../../../css/chroma-relearn-light.css?1715860360 rel=stylesheet id=R-variant-chroma-style><link href=../../../../css/variant.css?1715860360 rel=stylesheet><link href=../../../../css/print.css?1715860360 rel=stylesheet media=print><link href=../../../../css/format-print.css?1715860360 rel=stylesheet><script src=../../../../js/variant.js?1715860360></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../../..",window.relearn.relBaseUri="../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.57",window.index_js_url="../../../../en/index.search.js",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA"})</script></script><style>:root{--MAIN-WIDTH-MAX:1000rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=../../../../en/other/9-rum/8-apm-correlation/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../en/other/index.html><span itemprop=name>Ninja Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../en/other/9-rum/index.html><span itemprop=name>Splunk RUM</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>8. APM & RUM Correlation</span><meta itemprop=position content="4"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=../../../../en/other/9-rum/7-rum-sessions/index.html title="7. Analyzing RUM Sessions (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=../../../../en/other/9-rum/9-alerting/index.html title="9. Custom alerts and charts based on RUM Metrics (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=8-correlate-between-splunk-rum-and-apm-backend-services>8. Correlate between Splunk RUM and APM backend services</h1><ul><li>Continue with the RUM Session information in the RUM UI</li><li>See correlated APM traces and logs in the APM & Log Observer UI</li></ul><hr><h2 id=1-finding-backend-service-issues>1. Finding backend service issues</h2><p>Click on the <a href=#R-image-2467b76bc19a5fa15a0ba24cc9f43202 class=lightbox-link><img alt=RUM-JS class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../../../en/other/9-rum/8-apm-correlation/../images/RUM-JS-Error.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2467b76bc19a5fa15a0ba24cc9f43202><img alt=RUM-JS class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../../../en/other/9-rum/8-apm-correlation/../images/RUM-JS-Error.png?classes=inline&height=25px"></a> to close the Span view.
Now continue to scroll down and find the <strong>POST /cart/checkout</strong> line.</p><p><a href=#R-image-5af7f436eb6dfea2b8f2ee066729655b class=lightbox-link><img alt=RUM-APM-Click class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-APM-Click.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5af7f436eb6dfea2b8f2ee066729655b><img alt=RUM-APM-Click class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-APM-Click.png></a></p><p>Click on the blue <a href=#R-image-450a74b244aa4edf05e6f9eea1cc3b3a class=lightbox-link><img alt=RUM-APM-BLUE class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../../../en/other/9-rum/8-apm-correlation/../images/RUM-APM.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-450a74b244aa4edf05e6f9eea1cc3b3a><img alt=RUM-APM-BLUE class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../../../en/other/9-rum/8-apm-correlation/../images/RUM-APM.png?classes=inline&height=25px"></a> link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user.</p><p><a href=#R-image-b8760cd961e3a39810f3a8f03a97f8b3 class=lightbox-link><img alt=RUM-APM-Trace class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-Trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b8760cd961e3a39810f3a8f03a97f8b3><img alt=RUM-APM-Trace class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-Trace.png></a></p><p>In this popup, there are multiple sections available, providing you with a quick insight in the behavior of your backend services. For example the Performance Summary section will tell you where the time was spent during the backend call.</p><p><a href=#R-image-5e5461232daa3cbffeedbea504200bab class=lightbox-link><img alt=RUM-APM-Trace-perf class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-Trace-Performance.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5e5461232daa3cbffeedbea504200bab><img alt=RUM-APM-Trace-perf class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-Trace-Performance.png></a></p><p>In the above example you can see that more than 77,9% was spent in external services.</p><p>If you scroll down to the bottom of the dialog, you can see the complete Trace and Services section like shown below:</p><p><a href=#R-image-a1f56df091727c5ff0bb7a76ee717917 class=lightbox-link><img alt=RUM-APM-Trace-services class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-Trace-Services.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a1f56df091727c5ff0bb7a76ee717917><img alt=RUM-APM-Trace-services class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-Trace-Services.png></a></p><p>in the Services map, you can see two services flagged red, the <strong>Checkout</strong> Service and the <strong>Payment</strong> Service in both in dark red. Light red means it received an error and dark red means an error originated from that service.</p><p><a href=#R-image-998e5560de9583e26c50387f3977387d class=lightbox-link><img alt=RUM-APM-Trace-services-detail class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-Trace-Services-Detail.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-998e5560de9583e26c50387f3977387d><img alt=RUM-APM-Trace-services-detail class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-Trace-Services-Detail.png></a>
So already it is obvious there is a problem in the back end services.</p><p>Let&rsquo;s investigate!</p><h2 id=2--follow-the-trace-to-the-backend-service>2. Follow the Trace to the Backend service</h2><p>You can now click on the Trace Id link:</p><p><a href=#R-image-0f60604a4cfa05a6058a5be4d67223f1 class=lightbox-link><img alt=RUM-APM-Trace-link class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-Trace-url.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0f60604a4cfa05a6058a5be4d67223f1><img alt=RUM-APM-Trace-link class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-Trace-url.png></a></p><p>This will bring you to the Waterfall APM view that will show you what occurred in detail in a call to the backend services.
On the right you see the Trace Id: and again the Performance Summary, as we saw before.
In the waterfall, you can identify the various backend services that were part of this call from the frontend.</p><p>As you can see there are red error indicators <a href=#R-image-1869b86730d9fa16107ee22e0367ef6e class=lightbox-link><img alt=RUM-APM-error-flag class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../../../en/other/9-rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1869b86730d9fa16107ee22e0367ef6e><img alt=RUM-APM-error-flag class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../../../en/other/9-rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&height=25px"></a> before the <strong>Checkout</strong> Service and the <strong>Payment</strong> Service.</p><p><a href=#R-image-90562a5de830b96c525133e19e1dc08d class=lightbox-link><img alt=RUM-APM-waterfall class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-APM-Waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-90562a5de830b96c525133e19e1dc08d><img alt=RUM-APM-waterfall class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-APM-Waterfall.png></a></p><p>Click on the <a href=#R-image-cb49f831151cd162f9b8d0575ba73db6 class=lightbox-link><img alt=RUM-APM-error-flag class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../../../en/other/9-rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cb49f831151cd162f9b8d0575ba73db6><img alt=RUM-APM-error-flag class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../../../en/other/9-rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&height=25px"></a> after the <strong>paymentservice: grpc.hipstershop.PaymentService/Charge</strong> line.</p><p><a href=#R-image-3fc2e5b1cecaa6bbee7715f60591bbe1 class=lightbox-link><img alt=RUM-payment-click class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/payment-click.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3fc2e5b1cecaa6bbee7715f60591bbe1><img alt=RUM-payment-click class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/payment-click.png></a></p><p>This will open the span detail page to show you the detailed information about this service call.
You wil see that the call returned a <strong>401</strong> error code or <em>Invalid Request</em>.</p><h2 id=3--use-the-related-content---logs>3. Use the Related Content - Logs</h2><p>As the Splunk Observability cloud suite correlates trace metrics and logs automatically, the system will show you in the related content bar at the bottom of the page, the corresponding logs for this trace.</p><p><a href=#R-image-2b3f04a3c5aaea16de09b168d24cdc43 class=lightbox-link><img alt=RUM-payment-related-content class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/log-corelation.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2b3f04a3c5aaea16de09b168d24cdc43><img alt=RUM-payment-related-content class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/log-corelation.png></a></p><p>Click on the Log link to see the logs.</p><p>When the logs are shown, notice that the filter at the top of the page contains the logs for the trace.
Next select one of the lines indicating an error for the payment service.
This should open the log message on the right.</p><p>It clearly shows the reason why the payment service fails: we are using an invalid token towards the service:<br>*<strong>Failed payment processing through ButtercupPayments: Invalid API Token (test-20e26e90-356b-432e-a2c6-956fc03f5609)</strong></p><p><a href=#R-image-a40203cab8bf5c3da0b718e4fd28f6c9 class=lightbox-link><img alt=RUM-logs class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-LogObserver.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a40203cab8bf5c3da0b718e4fd28f6c9><img alt=RUM-logs class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../en/other/9-rum/8-apm-correlation/../images/RUM-LogObserver.png></a></p><h2 id=4--conclusion>4. Conclusion</h2><p>In the workshop, you have seen how to add RUM functionality to you website.
We investigate the performance of your Website using RUM Metrics.
Using the Tag profile, you have searched for your own session, and with the session waterfall, you identified two problems:</p><ul><li>A Java script error that caused your price calculation to be zero.</li><li>An issue in the payment backend service that caused payments to fail.</li></ul><p>Using the ability to correlate RUM traces with the Backend APM trace and Logs, you have found the reason for the payment failure.</p><p>This concludes the RUM workshop.</p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>Robert Castley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Dec 21, 2023</span></span></footer></article></div></main></div><script src=../../../../js/clipboard.min.js?1715860360 defer></script><script src=../../../../js/perfect-scrollbar.min.js?1715860360 defer></script><script src=../../../../js/theme.js?1715860360 defer></script></body></html>