<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Build a Distributed Trace in Lambda and Kinesis on Splunk Observability Cloud Workshops</title><link>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/index.html</link><description>Recent content in Build a Distributed Trace in Lambda and Kinesis on Splunk Observability Cloud Workshops</description><generator>Hugo -- gohugo.io</generator><language>en</language><atom:link href="https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/index.xml" rel="self" type="application/rss+xml"/><item><title>Setup</title><link>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/1-setup/index.html</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/1-setup/index.html</guid><description>This lab will make a tracing superhero out of you!
In this lab you will learn how a distributed trace is constructed for a small serverless application that runs on AWS Lambda, producing and consuming your message via AWS Kinesis.
Pre-requisites You should already have the lab content available on your EC2 lab host.
Ensure that this lab&amp;rsquo;s required folder o11y-lambda-lab is on your home directory:
&amp;#8203; Command Output cd ~ &amp;amp;&amp;amp; ls o11y-lambda-lab Note If you don&amp;rsquo;t see it, fetch the lab contents by running the following command:</description></item><item><title>Auto-Instrumentation</title><link>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/2-auto-instrumentation/index.html</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/2-auto-instrumentation/index.html</guid><description>Auto-Instrumentation Navigate to the auto directory that contains auto-instrumentation code.
&amp;#8203; Command cd ~/o11y-lambda-lab/auto Inspect the contents of the files in this directory. Take a look at the serverless.yml template.
&amp;#8203; Command cat serverless.yml Workshop Question Can you identify which AWS entities are being created by this template? Can you identify where OpenTelemetry instrumentation is being set up? Can you determine which instrumentation information is being provided by the Environment Variables?</description></item><item><title>Lambdas in Splunk APM</title><link>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/3-lambdas-in-splunk/index.html</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/3-lambdas-in-splunk/index.html</guid><description>Lambdas in Splunk APM Now it&amp;rsquo;s time to check how your Lambda traffic has been captured in Splunk APM.
Navigate to your Splunk Observability Cloud Select APM from the Main Menu and then select your APM Environment. Your APM environment should be in the format $INSTANCE-apm-lambda where the hostname value is a four letter name of your lab host. (Check it by looking at your command prompt, or by running echo $INSTANCE).</description></item><item><title>Manual Instrumentation</title><link>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/4-manual-instrumentation/index.html</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/4-manual-instrumentation/index.html</guid><description>Manual Instrumentation Navigate to the manual directory that contains manually instrumentated code.
&amp;#8203; Command cd ~/o11y-lambda-lab/manual Inspect the contents of the files in this directory. Take a look at the serverless.yml template.
&amp;#8203; Command cat serverless.yml Workshop Question Do you see any difference from the same file in your auto directory?
You can try to compare them with a diff command:
&amp;#8203; Diff Command Expected Output diff ~/o11y-lambda-lab/auto/serverless.yml ~/o11y-lambda-lab/manual/serverless.yml 19c19 &amp;lt; #====================================== --- &amp;gt; #====================================== There is no difference!</description></item><item><title>Redeploy Lambdas</title><link>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/5-redeploy-lambdas/index.html</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/5-redeploy-lambdas/index.html</guid><description>Re-deploy your Lambdas While remaining in your manual directory, run the following commandd to re-deploy your Lambda Functions:
&amp;#8203; Deploy Producer Code Expected Output sls deploy -f producer Deploying function producer to stage dev (us-east-1) ✔ Function code deployed (6s) Configuration did not change. Configuration update skipped. (6s) &amp;#8203; Deploy Consumer Code Expected Output sls deploy -f consumer Deploying function consumer to stage dev (us-east-1) ✔ Function code deployed (6s) Configuration did not change.</description></item><item><title>Updated Lambdas in Splunk APM</title><link>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/6-updated-in-splunk/index.html</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/6-updated-in-splunk/index.html</guid><description>Navigate back to APM in Splunk Observabilty Cloud
Go back to your Service Dependency map.
Workshop Question Notice the difference?
You should be able to see the consumer-lambda now clearly connected to the producer-lambda.
Remember the value you copied from your producer logs? You can run sls logs -f consumer command again on your EC2 lab host to fetch one.
Take that value, and paste it into trace search:
Click on Go and you should be able to find the logged Trace:</description></item><item><title>Summary</title><link>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/7-summary/index.html</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://splunk.github.io/observability-workshop/v5.37/en/other/6-lambda-kinesis/7-summary/index.html</guid><description>Before you Go Please kindly clean up your lab using the following command:
&amp;#8203; Remove Functions sls remove Conclusion Congratuations on finishing the lab. You have seen how we complement auto-instrumentation with manual steps to force Producer function&amp;rsquo;s context to be sent to Consumer function via a Record put on a Kinesis stream. This allowed us to build the expected Distributed Trace.
You can now build out a Trace manually by linking two different functions together.</description></item></channel></rss>