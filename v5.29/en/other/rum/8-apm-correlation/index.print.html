<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta name=generator content="Relearn 5.23.2+tip"><meta name=description content="Splunk Observability Workshops"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="Continue with the RUM Session information in the RUM UI See correlated APM traces and logs in the APM & Log Observer UI 1. Finding backend service issues Click on the to close the Span view. Now continue to scroll down and find the POST /cart/checkout line.
Click on the blue link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user."><meta property="og:title" content="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><meta property="og:description" content="Continue with the RUM Session information in the RUM UI See correlated APM traces and logs in the APM & Log Observer UI 1. Finding backend service issues Click on the to close the Span view. Now continue to scroll down and find the POST /cart/checkout line.
Click on the blue link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user."><meta property="og:type" content="article"><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.29/en/other/rum/8-apm-correlation/index.html"><meta property="article:section" content="Splunk RUM :: Splunk Observability Cloud Workshops"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><title>8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops</title><link href=https://splunk.github.io/observability-workshop/v5.29/en/other/rum/8-apm-correlation/index.html rel=canonical type=text/html title="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><link href=../../../../en/other/rum/8-apm-correlation/index.xml rel=alternate type=application/rss+xml title="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><link href=../../../../images/favicon.ico?1701716243 rel=icon type=image/x-icon sizes=any><link href=../../../../css/fontawesome-all.min.css?1701716247 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../css/fontawesome-all.min.css?1701716247 rel=stylesheet></noscript><link href=../../../../css/nucleus.css?1701716247 rel=stylesheet><link href=../../../../css/auto-complete.css?1701716247 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../css/auto-complete.css?1701716247 rel=stylesheet></noscript><link href=../../../../css/perfect-scrollbar.min.css?1701716247 rel=stylesheet><link href=../../../../css/fonts.css?1701716247 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../css/fonts.css?1701716247 rel=stylesheet></noscript><link href=../../../../css/theme.css?1701716247 rel=stylesheet><link href=../../../../css/theme-splunk-light.css?1701716247 rel=stylesheet id=R-variant-style><link href=../../../../css/variant.css?1701716247 rel=stylesheet><link href=../../../../css/print.css?1701716247 rel=stylesheet media=print><link href=../../../../css/format-print.css?1701716247 rel=stylesheet><link href=../../../../css/ie.css?1701716247 rel=stylesheet><script src=../../../../js/url.js?1701716247></script>
<script src=../../../../js/variant.js?1701716247></script>
<script>window.index_js_url="../../../../en/index.search.js";var root_url="../../../../",baseUri=root_url.replace(/\/$/,"");window.relearn=window.relearn||{},window.relearn.baseUriFull="https://splunk.github.io/observability-workshop/v5.29/",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script>
<script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script>
<script>SplunkRum.init({beaconUrl:"https://rum-ingest.eu0.signalfx.com/v1/rum",rumAuth:"EDIbCJR4LlxWdXMLjkYX1g",app:"observability-workshop",version:"1",environment:"observability-workshop-env"}),SplunkSessionRecorder.init({beaconUrl:"https://rum-ingest.eu0.signalfx.com/v1/rumreplay",rumAuth:"EDIbCJR4LlxWdXMLjkYX1g"})</script><style>@media screen and (min-width:1000px){#R-body .flex-block-wrapper{margin-left:auto;margin-right:auto;max-width:1000px;width:100%}}:root{--MENU-WIDTH-L:19.75rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=../../../../en/other/rum/8-apm-correlation/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)">
<i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../en/other/index.html><span itemprop=name>Ninja Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../en/other/rum/index.html><span itemprop=name>Splunk RUM</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>8. Correlate between Splunk RUM and APM backend services</span><meta itemprop=position content="4"></li></ol><div class="topbar-area topbar-area-end" data-area=end></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=8-correlate-between-splunk-rum-and-apm-backend-services>8. Correlate between Splunk RUM and APM backend services</h1><ul><li>Continue with the RUM Session information in the RUM UI</li><li>See correlated APM traces and logs in the APM & Log Observer UI</li></ul><hr><h2 id=1-finding-backend-service-issues>1. Finding backend service issues</h2><p>Click on the <a href=#R-image-8b2b09db03fbabcbe0b7c47501f77c82 class=lightbox-link><img src="../../../../en/other/rum/8-apm-correlation/../images/RUM-JS-Error.png?classes=inline&amp;height=25px" alt=RUM-JS class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8b2b09db03fbabcbe0b7c47501f77c82><img src="../../../../en/other/rum/8-apm-correlation/../images/RUM-JS-Error.png?classes=inline&amp;height=25px" alt=RUM-JS class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> to close the Span view.
Now continue to scroll down and find the <strong>POST /cart/checkout</strong> line.</p><p><a href=#R-image-fbb7661981004942ee7728e359ddc180 class=lightbox-link><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-APM-Click.png alt=RUM-APM-Click class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fbb7661981004942ee7728e359ddc180><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-APM-Click.png alt=RUM-APM-Click class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on the blue <a href=#R-image-53e604b86610c40501b36ec0ae0c2f83 class=lightbox-link><img src="../../../../en/other/rum/8-apm-correlation/../images/RUM-APM.png?classes=inline&amp;height=25px" alt=RUM-APM-BLUE class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-53e604b86610c40501b36ec0ae0c2f83><img src="../../../../en/other/rum/8-apm-correlation/../images/RUM-APM.png?classes=inline&amp;height=25px" alt=RUM-APM-BLUE class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user.</p><p><a href=#R-image-efbfc465780bff67a680d5c9c71428e5 class=lightbox-link><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-Trace.png alt=RUM-APM-Trace class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-efbfc465780bff67a680d5c9c71428e5><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-Trace.png alt=RUM-APM-Trace class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In this popup, there are multiple sections available, providing you with a quick insight in the behavior of your backend services. For example the Performance Summary section will tell you where the time was spent during the backend call.</p><p><a href=#R-image-58a916c73b5dd93a75a8604ffc168d55 class=lightbox-link><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-Trace-Performance.png alt=RUM-APM-Trace-perf class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-58a916c73b5dd93a75a8604ffc168d55><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-Trace-Performance.png alt=RUM-APM-Trace-perf class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the above example you can see that more than 77,9% was spent in external services.</p><p>If you scroll down to the bottom of the dialog, you can see the complete Trace and Services section like shown below:</p><p><a href=#R-image-475b195616f33d5d4438a124aaed7c1f class=lightbox-link><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-Trace-Services.png alt=RUM-APM-Trace-services class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-475b195616f33d5d4438a124aaed7c1f><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-Trace-Services.png alt=RUM-APM-Trace-services class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>in the Services map, you can see two services flagged red, the <strong>Checkout</strong> Service and the <strong>Payment</strong> Service in both in dark red. Light red means it received an error and dark red means an error originated from that service.</p><p><a href=#R-image-8b40d91e81a5222cf453fea691b9ca58 class=lightbox-link><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-Trace-Services-Detail.png alt=RUM-APM-Trace-services-detail class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8b40d91e81a5222cf453fea691b9ca58><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-Trace-Services-Detail.png alt=RUM-APM-Trace-services-detail class="lightbox-image noborder lightbox noshadow" loading=lazy></a>
So already it is obvious there is a problem in the back end services.</p><p>Let&rsquo;s investigate!</p><h2 id=2--follow-the-trace-to-the-backend-service>2. Follow the Trace to the Backend service</h2><p>You can now click on the Trace Id link:</p><p><a href=#R-image-2894fb407846b32828b1ea36a7eb0b5e class=lightbox-link><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-Trace-url.png alt=RUM-APM-Trace-link class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2894fb407846b32828b1ea36a7eb0b5e><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-Trace-url.png alt=RUM-APM-Trace-link class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will bring you to the Waterfall APM view that will show you what occurred in detail in a call to the backend services.
On the right you see the Trace Id: and again the Performance Summary, as we saw before.
In the waterfall, you can identify the various backend services that were part of this call from the frontend.</p><p>As you can see there are red error indicators <a href=#R-image-95abf4372a87339f6c5bd84c333fa314 class=lightbox-link><img src="../../../../en/other/rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&amp;height=25px" alt=RUM-APM-error-flag class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-95abf4372a87339f6c5bd84c333fa314><img src="../../../../en/other/rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&amp;height=25px" alt=RUM-APM-error-flag class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> before the <strong>Checkout</strong> Service and the <strong>Payment</strong> Service.</p><p><a href=#R-image-9ee7e71c9ab334989dd4d39b38c2182e class=lightbox-link><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-APM-Waterfall.png alt=RUM-APM-waterfall class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9ee7e71c9ab334989dd4d39b38c2182e><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-APM-Waterfall.png alt=RUM-APM-waterfall class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on the <a href=#R-image-14b56638520ff9ce3edb9909c99d8342 class=lightbox-link><img src="../../../../en/other/rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&amp;height=25px" alt=RUM-APM-error-flag class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-14b56638520ff9ce3edb9909c99d8342><img src="../../../../en/other/rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&amp;height=25px" alt=RUM-APM-error-flag class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> after the <strong>paymentservice: grpc.hipstershop.PaymentService/Charge</strong> line.</p><p><a href=#R-image-98d79fc359d75ea16f902d859b5cd0e1 class=lightbox-link><img src=../../../../en/other/rum/8-apm-correlation/../images/payment-click.png alt=RUM-payment-click class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-98d79fc359d75ea16f902d859b5cd0e1><img src=../../../../en/other/rum/8-apm-correlation/../images/payment-click.png alt=RUM-payment-click class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will open the span detail page to show you the detailed information about this service call.
You wil see that the call returned a <strong>401</strong> error code or <em>Invalid Request</em>.</p><h2 id=3--use-the-related-content---logs>3. Use the Related Content - Logs</h2><p>As the Splunk Observability cloud suite correlates trace metrics and logs automatically, the system will show you in the related content bar at the bottom of the page, the corresponding logs for this trace.</p><p><a href=#R-image-2bef0cc05593539befa02d9539482f16 class=lightbox-link><img src=../../../../en/other/rum/8-apm-correlation/../images/log-corelation.png alt=RUM-payment-related-content class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2bef0cc05593539befa02d9539482f16><img src=../../../../en/other/rum/8-apm-correlation/../images/log-corelation.png alt=RUM-payment-related-content class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on the Log link to see the logs.</p><p>When the logs are shown, notice that the filter at the top of the page contains the logs for the trace.
Next select one of the lines indicating an error for the payment service.
This should open the log message on the right.</p><p>It clearly shows the reason why the payment service fails: we are using an invalid token towards the service:<br>*<strong>Failed payment processing through ButtercupPayments: Invalid API Token (test-20e26e90-356b-432e-a2c6-956fc03f5609)</strong></p><p><a href=#R-image-e2c3dea9ed5a6d0b3a755ece0a51c4e0 class=lightbox-link><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-LogObserver.png alt=RUM-logs class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e2c3dea9ed5a6d0b3a755ece0a51c4e0><img src=../../../../en/other/rum/8-apm-correlation/../images/RUM-LogObserver.png alt=RUM-logs class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=4--conclusion>4. Conclusion</h2><p>In the workshop, you have seen how to add RUM functionality to you website.
We investigate the performance of your Website using RUM Metrics.
Using the Tag profile, you have searched for your own session, and with the session waterfall, you identified two problems:</p><ul><li>A Java script error that caused your price calculation to be zero.</li><li>An issue in the payment backend service that caused payments to fail.</li></ul><p>Using the ability to correlate RUM traces with the Backend APM trace and Logs, you have found the reason for the payment failure.</p><p>This concludes the RUM workshop.</p><footer class=footline></footer></article></div></main></div><script src=../../../../js/clipboard.min.js?1701716247 defer></script>
<script src=../../../../js/perfect-scrollbar.min.js?1701716247 defer></script>
<script src=../../../../js/theme.js?1701716247 defer></script></body></html>