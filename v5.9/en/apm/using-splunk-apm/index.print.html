<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.110.0"><meta name=generator content="Relearn 5.22.1+tip"><meta name=description content="An overview of how to use Splunk APM"><meta property="og:title" content="2. Using Splunk APM"><meta property="og:description" content="An overview of how to use Splunk APM"><meta property="og:type" content="website"><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.9/en/apm/using-splunk-apm/"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta name=twitter:card content="summary"><meta name=twitter:title content="2. Using Splunk APM"><meta name=twitter:description content="An overview of how to use Splunk APM"><title>2. Using Splunk APM :: Splunk Observability Cloud Workshops</title><link href=https://splunk.github.io/observability-workshop/v5.9/en/apm/using-splunk-apm/index.html rel=alternate hreflang=x-default><link href=https://splunk.github.io/observability-workshop/v5.9/en/apm/using-splunk-apm/index.html rel=alternate hreflang=en><link href=https://splunk.github.io/observability-workshop/v5.9/ja/apm/using-splunk-apm/index.html rel=alternate hreflang=ja><link href=https://splunk.github.io/observability-workshop/v5.9/en/apm/using-splunk-apm/index.html rel=canonical type=text/html title="2. Using Splunk APM :: Splunk Observability Cloud Workshops"><link href=../../../en/apm/using-splunk-apm/index.xml rel=alternate type=application/rss+xml title="2. Using Splunk APM :: Splunk Observability Cloud Workshops"><link href=../../../images/favicon.ico?1697478580 rel=icon type=image/x-icon sizes=any><link href=../../../css/fontawesome-all.min.css?1697478584 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../css/fontawesome-all.min.css?1697478584 rel=stylesheet></noscript><link href=../../../css/nucleus.css?1697478584 rel=stylesheet><link href=../../../css/auto-complete.css?1697478584 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../css/auto-complete.css?1697478584 rel=stylesheet></noscript><link href=../../../css/perfect-scrollbar.min.css?1697478584 rel=stylesheet><link href=../../../css/fonts.css?1697478584 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../css/fonts.css?1697478584 rel=stylesheet></noscript><link href=../../../css/theme.css?1697478584 rel=stylesheet><link href=../../../css/theme-auto.css?1697478584 rel=stylesheet id=R-variant-style><link href=../../../css/variant.css?1697478584 rel=stylesheet><link href=../../../css/print.css?1697478584 rel=stylesheet media=print><link href=../../../css/format-print.css?1697478584 rel=stylesheet><link href=../../../css/ie.css?1697478584 rel=stylesheet><script src=../../../js/url.js?1697478584></script>
<script src=../../../js/variant.js?1697478584></script>
<script>window.index_js_url="../../../en/index.search.js";var root_url="../../../",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",window.T_Reset_view="Reset view",window.T_View_reset="View reset!",window.T_No_results_found="No results found for \u0022{0}\u0022",window.T_N_results_found="{1} results found for \u0022{0}\u0022",baseUriFull="https://splunk.github.io/observability-workshop/v5.9/",window.variants&&variants.init(["auto","splunk-light","splunk-dark"])</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script>
<script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script>
<script>SplunkRum.init({beaconUrl:"https://rum-ingest.eu0.signalfx.com/v1/rum",rumAuth:"EDIbCJR4LlxWdXMLjkYX1g",app:"observability-workshop",version:"1",environment:"observability-workshop-env"}),SplunkSessionRecorder.init({beaconUrl:"https://rum-ingest.eu0.signalfx.com/v1/rumreplay",rumAuth:"EDIbCJR4LlxWdXMLjkYX1g"})</script><style>@media screen and (min-width:1500px){#R-body .flex-block-wrapper{margin-left:auto;margin-right:auto;max-width:1500px;width:100%}}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=../../../en/apm/using-splunk-apm/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)">
<i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../en/apm/index.html><span itemprop=name>Splunk APM</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>2. Using Splunk APM</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=2-using-splunk-apm>2. Using Splunk APM</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
15 minutes</button></span><ul><li>APM Overview - RED metrics</li><li>Using the Service Map</li><li>Introduction to Tag Spotlight</li><li>Example Traces</li><li>Contextual Links to Infra</li></ul><h2 id=1-traces-and-spans-explained>1. Traces and Spans explained</h2><p>A trace is a collection of spans that share the same trace ID, representing a unique transaction handled by your application and its constituent services.</p><p><a href=#R-image-4f806d42d6abbe6bec3a8ee819af2772 class=lightbox-link><img src=../../../en/apm/using-splunk-apm/../images/trace-spans.png alt="Traces and Spans" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4f806d42d6abbe6bec3a8ee819af2772><img src=../../../en/apm/using-splunk-apm/../images/trace-spans.png alt="Traces and Spans" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Each span has a name, representing the operation captured by this span, and a service name, representing within which service the operation took place.</p><p>Additionally, spans may reference another span as their parent, defining the relationships between the operations captured in the trace that were performed to process that transaction.</p><p>Each span contains a lot of information about the method, operation, or block of code that it captures, including:</p><ul><li>the operation name</li><li>the start time of the operation with microsecond precision</li><li>how long the operation took to execute, also with microsecond precision</li><li>the logical name of the service on which the operation took place</li><li>the IP address of the service instance on which the operation took place</li></ul><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of 2. Using Splunk APM</h1><article class=default><header class=headline></header><h1 id=21-service-map>2.1 Service Map</h1><h2 id=service-map>Service Map</h2><p>Click on <strong>paymentservice</strong> in the service map and select <strong>version</strong> from the <code>breakdown</code> drop down filter underneath <strong>paymentservice</strong>. This will filter our service map by the custom span tag <strong>version</strong>.</p><p>You will now see the service map has been updated like the below screenshot to show the different versions of the <strong>paymentservice</strong>.</p><p>Splunk Observability shows that not only is paymentservice experiencing errors (you can see request rate vs error rate) but that this service is the root cause.</p><p>This happens automatically with our AI-directed triage capabilities once distributed tracing is enabled in your services. You donâ€™t have to set a threshold or anything for it to populate just like this.</p><p>This is one example of how customers can detect issues faster and know where to look for errors and hence helps reduce the MTTD and MTTR.</p><p><a href=#R-image-233a69808a74b876002af9707bc26969 class=lightbox-link><img src=../../../en/apm/using-splunk-apm/service_map/../../images/paymentservice.png alt="Payment Service" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-233a69808a74b876002af9707bc26969><img src=../../../en/apm/using-splunk-apm/service_map/../../images/paymentservice.png alt="Payment Service" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=22-tag-spotlight>2.2 Tag Spotlight</h1><h2 id=tag-spotlight>Tag Spotlight</h2><p>On the right hand side of the screen scroll down on <strong>Tag Spotlight</strong>, ensure <strong>Top Across All Indexed Tags</strong> is selected in the dropdown click the full screen button as indicated in the screenshot below.</p><p><a href=#R-image-0d5dcbe32fcdd532e46a8b8191a02a40 class=lightbox-link><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight.png alt="Tag Spotlight" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0d5dcbe32fcdd532e46a8b8191a02a40><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight.png alt="Tag Spotlight" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>The Tag Spotlight Page will be displayed. From this page you can view the top tags in your application and their corresponding error rates and request rates.</p><p>Note that for the <strong>version</strong> span tag it appears that version <code>350.10</code> has a 100% error rate and for our <strong>tenant.level</strong> span tag it shows that all three tenants (Gold, Silver & Bronze) have errors present.</p><p><a href=#R-image-f358d4f8786ab22c063bbaa9569d934a class=lightbox-link><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight-dashboard.png alt="Tag Spotlight Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f358d4f8786ab22c063bbaa9569d934a><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight-dashboard.png alt="Tag Spotlight Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>The Tag Spotlight page is interactive and allows you to add a tag as a filter by simply clicking on your desired tag. Click on <strong>gold</strong> under <strong>tenant.level</strong> to add it as a filter. Once this is done the page will now only display data with <strong>gold</strong> as itâ€™s <strong>tenant.level</strong>.</p><p><a href=#R-image-2acd35b2827f642d261dc01573df9d10 class=lightbox-link><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/gold-tenant.png alt="Gold Tenant" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2acd35b2827f642d261dc01573df9d10><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/gold-tenant.png alt="Gold Tenant" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Tag Spotlight is very useful for analysing your data and spotting trends. We can see that for the Gold Tenant that out of the total number of requests, 55 of them are in error (this number will vary in your workshop).</p><p>If we correlate this to the version tag, we can see that version <code>350.10</code> served 55 requests and version <code>350.9</code> served 17 requests. This means that all of the requests that went through version <code>350.10</code> ended up in an error state.</p><p>In order to test this theory further that all of the requests from <strong>paymentservice</strong> version <code>350.10</code> result in an error, we can change our filter to another tenant by using the tag selector. Change your filter from <strong>gold</strong> tenant to <strong>silver</strong> tenant.</p><p><a href=#R-image-2c4466aafce84c4420e2235a37f30cd6 class=lightbox-link><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/silver-tag-filter.png alt="Silver Tag Filter" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2c4466aafce84c4420e2235a37f30cd6><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/silver-tag-filter.png alt="Silver Tag Filter" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now we can perform a similar analysis by looking at the number of requests in error for the <strong>silver</strong> tenant and correlating that with the version number. Note the amount of errors for the <strong>silver</strong> tenant match the amount of requests for version <code>350.10</code>.</p><p><a href=#R-image-1b58e70dc88f8373b08d5a24866e1f4b class=lightbox-link><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/silver-tenant.png alt="Silver Tenant" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1b58e70dc88f8373b08d5a24866e1f4b><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/silver-tenant.png alt="Silver Tenant" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Tag Spotlight not only allows you to look at request and error rates but also at the latency per service. In order to do this just select the latency button and remove your Silver Tenant Tag so that you can see the latency for all of the Payment Service.</p><p><a href=#R-image-d4329ed70a26fb6d68b5ee73e3402491 class=lightbox-link><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/latency.png alt=Latency class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d4329ed70a26fb6d68b5ee73e3402491><img src=../../../en/apm/using-splunk-apm/tag_spotlight/../../images/latency.png alt=Latency class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Go back to your service map by pressing the <strong>X</strong> button on the far right underneath <strong>Clear All</strong>.</p><p>Click anywhere on the pink line in the <strong>Services by Error Rate</strong> graph in the top right hand corner. Once selected you should see a list of example traces. Click on one of the example traces with an initiating operation of <strong>frontend: POST /cart/checkout</strong>.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=23-example-trace>2.3 Example trace</h1><h2 id=example-trace>Example Trace</h2><p><a href=#R-image-307a36c4031c0dc652940fa2d0aad032 class=lightbox-link><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/example-trace.png alt="Example Trace" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-307a36c4031c0dc652940fa2d0aad032><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/example-trace.png alt="Example Trace" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should now see the entire trace along with the spans for the example trace that was selected. Spans which have errors are indicated by a red exclamation mark beside it. If you have a number such as <strong>x6</strong> in a grey box, click it to expand the compacted <code>paymentservice</code> spans.</p><p><a href=#R-image-938be6e3e08f77cb13354a8dc070868b class=lightbox-link><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/trace-span.png alt="Example Trace" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-938be6e3e08f77cb13354a8dc070868b><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/trace-span.png alt="Example Trace" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now click one of the <code>paymentservice</code> spans with the red exclamation mark to expand it and see the associated metadata and some error details. Note that we are able to see that this error is caused by a 401 error and other useful information such as â€˜tenantâ€™ and â€˜versionâ€™ is also displayed.</p><p><a href=#R-image-d01d9e2b418405b132b154963342d0fc class=lightbox-link><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/trace-metadata.png alt="Traces and Spans" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d01d9e2b418405b132b154963342d0fc><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/trace-metadata.png alt="Traces and Spans" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>So we now know that the error is caused by an <strong>Invalid Request</strong> but we don&rsquo;t know what exact request. At the bottom of the page you should see a contextual link to Logs, clink on this link to view the logs associated with this span.</p><p><a href=#R-image-3edcab1131c6d8be038a1285ab3be09d class=lightbox-link><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/logs_link.png alt="Logs Link" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3edcab1131c6d8be038a1285ab3be09d><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/logs_link.png alt="Logs Link" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should now be looking at a <strong>Log Observer</strong> dashboard simialar to the image below.</p><p><a href=#R-image-39cf1499fe0b645f64568abe462a9733 class=lightbox-link><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/log_observer.png alt="Log Observer" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-39cf1499fe0b645f64568abe462a9733><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/log_observer.png alt="Log Observer" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We can use the filter to display only the error logs. Click on <code>ERROR</code> in the top right hand corner, then <code>Add to filter</code></p><p><a href=#R-image-c0b41c058a706797f803096d905260ef class=lightbox-link><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/error_filter.png alt="Error Filter" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c0b41c058a706797f803096d905260ef><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/error_filter.png alt="Error Filter" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should now have a shorter list of log entries which have a <code>severity</code> of <code>ERROR</code></p><p><a href=#R-image-f2ad14c5ce5c7017641eee604a2792d6 class=lightbox-link><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/filtered_results.png alt="Filtered Results" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f2ad14c5ce5c7017641eee604a2792d6><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/filtered_results.png alt="Filtered Results" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Select any of the entries to view the details. We can now see how the error was caused by the use of an <strong>Invalid API Token</strong> that our developers have accidentally pushed to production!</p><p><a href=#R-image-cf68c810907d46db4b487c0483f7c1f7 class=lightbox-link><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/error_details.png alt="Error Details" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cf68c810907d46db4b487c0483f7c1f7><img src=../../../en/apm/using-splunk-apm/example_trace/../../images/error_details.png alt="Error Details" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Congratulations</strong>, you have now completed the APM Workshop.</p><footer class=footline></footer></article></section></div></main></div><script src=../../../js/clipboard.min.js?1697478584 defer></script>
<script src=../../../js/perfect-scrollbar.min.js?1697478584 defer></script>
<script src=../../../js/theme.js?1697478584 defer></script></body></html>