<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.125.5"><meta name=generator content="Relearn 6.0.0+tip"><meta name=description content="In this section, we will use APM to drill down and identify where the problem is."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Splunk APM :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="In this section, we will use APM to drill down and identify where the problem is."><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.64/en/s4r/6-apm/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Splunk APM :: Splunk Observability Cloud Workshops"><meta property="og:description" content="In this section, we will use APM to drill down and identify where the problem is."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Splunk APM :: Splunk Observability Cloud Workshops"><meta itemprop=description content="In this section, we will use APM to drill down and identify where the problem is."><meta itemprop=dateModified content="2024-04-03T09:27:43+01:00"><meta itemprop=wordCount content="119"><title>Splunk APM :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.64/en/s4r/6-apm/index.html rel=alternate hreflang=x-default><link href=https://splunk.github.io/observability-workshop/v5.64/en/s4r/6-apm/index.html rel=alternate hreflang=en><link href=https://splunk.github.io/observability-workshop/v5.64/ja/s4r/6-apm/index.html rel=alternate hreflang=ja><link href=https://splunk.github.io/observability-workshop/v5.64/en/s4r/6-apm/index.html rel=canonical type=text/html title="Splunk APM :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/v5.64/images/favicon.ico?1721291801 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/v5.64/css/fontawesome-all.min.css?1721291801 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.64/css/fontawesome-all.min.css?1721291801 rel=stylesheet></noscript><link href=/observability-workshop/v5.64/css/nucleus.css?1721291801 rel=stylesheet><link href=/observability-workshop/v5.64/css/auto-complete.css?1721291801 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.64/css/auto-complete.css?1721291801 rel=stylesheet></noscript><link href=/observability-workshop/v5.64/css/perfect-scrollbar.min.css?1721291801 rel=stylesheet><link href=/observability-workshop/v5.64/css/fonts.css?1721291801 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.64/css/fonts.css?1721291801 rel=stylesheet></noscript><link href=/observability-workshop/v5.64/css/theme.css?1721291801 rel=stylesheet><link href=/observability-workshop/v5.64/css/theme-splunk-light.css?1721291801 rel=stylesheet id=R-variant-style><link href=/observability-workshop/v5.64/css/chroma-relearn-light.css?1721291801 rel=stylesheet id=R-variant-chroma-style><link href=/observability-workshop/v5.64/css/variant.css?1721291801 rel=stylesheet><link href=/observability-workshop/v5.64/css/print.css?1721291801 rel=stylesheet media=print><link href=/observability-workshop/v5.64/css/format-print.css?1721291801 rel=stylesheet><script src=/observability-workshop/v5.64/js/variant.js?1721291801></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.64",window.index_js_url="/observability-workshop/v5.64/en/index.search.js?1721291801",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA"})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/observability-workshop/v5.64/en/s4r/6-apm/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.64/en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.64/en/s4r/index.html><span itemprop=name>Splunk4Rookies - Observability Cloud</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>6. Splunk APM</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.64/en/s4r/5-rum/4-user-sessions/index.html title="4. User Sessions (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.64/en/s4r/6-apm/1-apm-explore/index.html title="1. APM Explore (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable chapter narrow" tabindex=-1><div class=flex-block-wrapper><article class=chapter><header class=headline></header><h1 id=splunk-apm>Splunk APM</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> Persona</div><div class=box-content><p>You are a <strong>back-end developer</strong> and you have been called in to help investigate an issue found by the SRE. The SRE has identified a poor user experience and has asked you to investigate the issue.</p></div></div><p>Discover the power of full end-to-end visibility by jumping from a RUM trace (front-end) to an APM trace (back-end). All the services are sending telemetry (traces and spans) that Splunk Observability Cloud can visualize, analyze and use to detect anomalies and errors.</p><p>RUM and APM are two sides of the same coin. RUM is the client-side view of the application and APM is the server-side view. In this section, we will use APM to drill down and identify where the problem is.</p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>rcastley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Apr 3, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Splunk APM</h1><article class=default><header class=headline></header><h1 id=1-apm-explore>1. APM Explore</h1><p>The APM Service Map displays the dependencies and connections among your instrumented and inferred services in APM. The map is dynamically generated based on your selections in the time range, environment, workflow, service, and tag filters.</p><p>When we clicked on the APM link in the RUM waterfall, filters were automatically added to the service map view to show the services that were involved in that <strong>WorkFlow Name</strong> (<code>frontend:/cart/checkout</code>).</p><p>You can see the services involved in the workflow in the <strong>Service Map</strong>. In the side pane, under <strong>Business Workflow</strong>, charts for the selected workflow are displayed. The <strong>Service Map</strong> and <strong>Business Workflow</strong> charts are synchronized. When you select a service in the <strong>Service Map</strong>, the charts in the <strong>Business Workflow</strong> pane are updated to show metrics for the selected service.</p><p><a href=#R-image-256cb862203c9b747f6e800e4c2fe1cb class=lightbox-link><img alt="APM Business Workflow" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/1-apm-explore/../images/apm-business-workflow.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-256cb862203c9b747f6e800e4c2fe1cb><img alt="APM Business Workflow" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/1-apm-explore/../images/apm-business-workflow.png></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on the <strong>paymentservice</strong> in the Service Map.</li></ul></div></div><p><a href=#R-image-f985bba8f1154076f55633ac3890a734 class=lightbox-link><img alt="APM Explore" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/1-apm-explore/../images/apm-explore.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f985bba8f1154076f55633ac3890a734><img alt="APM Explore" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/1-apm-explore/../images/apm-explore.png></a></p><p>Splunk APM also provides a set of built-in dashboards that present charts and visualized metrics to help you see problems occurring in real time and quickly determine whether the problem is associated with a service, a specific endpoint, or the underlying infrastructure. Let&rsquo;s have a closer look.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on the three dots next to <strong>paymentservice</strong> and select <strong>APM Service</strong></li></ul></div></div><p><a href=#R-image-214e5baa30dcff643620ca6d94ad694c class=lightbox-link><img alt="APM Service" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/1-apm-explore/../images/apm-service.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-214e5baa30dcff643620ca6d94ad694c><img alt="APM Service" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/1-apm-explore/../images/apm-service.png></a></p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>rcastley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Jun 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=2-apm-service-dashboard>2. APM Service Dashboard</h1><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Service Dashboard</div><div class=box-content><p>APM Service Dashboards provide request, error, and duration (<strong>RED</strong>) metrics based on Monitoring MetricSets created from endpoint spans for your services, endpoints, and Business Workflows. If you scroll down the dashboard you will also see the host and Kubernetes-related metrics which help you determine whether there are problems with the underlying infrastructure.</p></div></div><p><a href=#R-image-0ba2af4c0296c32f64256eed2ec782fd class=lightbox-link><img alt="Service Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0ba2af4c0296c32f64256eed2ec782fd><img alt="Service Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-dashboard.png></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Check the <strong>Time</strong> box <strong>(1)</strong>, you can see that the dashboards only show data relevant to the time it took for the APM trace we selected to complete (note that the charts are static).</li><li>In the <strong>time</strong> box change enter <strong>-1h</strong> and hit enter.</li><li>The Single Value charts, <strong>Request rate</strong>, <strong>Request latency (p90)</strong> and <strong>Error rate</strong> will start updating every 10 seconds showing that we still have a large number of errors occurring.</li><li>These charts are very useful to quickly identify performance issues. You can use this dashboard to keep an eye on the health of your service or use it as a base for a custom one.</li><li>We want to use some of these charts in a later exercise:<ul><li>In the <strong>Request rate</strong> Single Value chart (<strong>2</strong>), click the <strong>&mldr;</strong> and select <strong>Copy</strong>. Note that you now have a <strong>1</strong> before the <strong>+</strong> at the top right of the page (<strong>3</strong>), indicating you have a copied chart to the clipboard.</li><li>In the <strong>Request rate</strong> line chart (<strong>4</strong>), either click on the <strong>Add to clipboard</strong> indicator that appeared (just at the <strong>(4)</strong> in the screenshot) to add it to the clipboard or use the <strong>&mldr;</strong> and select <strong>Add to clipboard</strong>.</li></ul></li><li>Note that you now have <strong>2</strong> before the <strong>+</strong> on the top right of the page. (<strong>3</strong>)</li><li>Now let&rsquo;s go back to the explore view, you can hit the back button in your Browser</li></ul></div></div><p><a href=#R-image-291eaeb2221bd4e2439b246bf73ef376 class=lightbox-link><img alt="APM Explore" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/2-apm-service-dashboard/../images/apm-explore.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-291eaeb2221bd4e2439b246bf73ef376><img alt="APM Explore" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/2-apm-service-dashboard/../images/apm-explore.png></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><div class=tab-panel data-tab-group=b066812fdb190d4bc531dc4c46638248><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("b066812fdb190d4bc531dc4c46638248","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("b066812fdb190d4bc531dc4c46638248","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>In the Service Map hover over the <strong>paymentservice</strong>. What can you conclude from the popup service chart?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The error percentage is very high.</strong></p></div></div></div></div></div></div><p><a href=#R-image-543d697ae36c6c6512123d64515e978e class=lightbox-link><img alt="APM Service Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-popup-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-543d697ae36c6c6512123d64515e978e><img alt="APM Service Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-popup-chart.png></a></p><p>We need to understand if there is a pattern to this error rate. We have a handy tool for that, <strong>Tag Spotlight</strong>.</p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>Robert Castley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Dec 21, 2023</span></span></footer></article><article class=default><header class=headline></header><h1 id=3-apm-tag-spotlight>3. APM Tag Spotlight</h1><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>To view the tags for the <strong>paymentservice</strong> click on the <strong>paymentservice</strong> and then click on <strong>Tag Spotlight</strong> in the right-hand side functions pane (you may need to scroll down depending upon your screen resolution).</li><li>Once in <strong>Tag Spotlight</strong> ensure the toggle <strong>Show tags with no values</strong> is off.</li></ul></div></div><p><a href=#R-image-756220dc18c28b89d1e3857ee4dacc79 class=lightbox-link><img alt="APM Tag Spotlight" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/3-apm-tag-spotlight/../images/apm-tag-spotlight.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-756220dc18c28b89d1e3857ee4dacc79><img alt="APM Tag Spotlight" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/3-apm-tag-spotlight/../images/apm-tag-spotlight.png></a></p><p>There are two views available in <strong>Tag Spotlight</strong>. The default is <strong>Request/Errors</strong> and the other is <strong>Latency</strong>.</p><p>Request/Error charts display the total number of requests, errors, and root cause errors. The Latency charts display p50, p90, and p99 latency. These values are based on Troubleshooting MetricSets (TMS), which Splunk APM generates for every indexed span tag. These are known as RED metrics (request, error, and duration).</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><div class=tab-panel data-tab-group=b2a1ab1162d1b461c1b0e140e032cdbf><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("b2a1ab1162d1b461c1b0e140e032cdbf","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("b2a1ab1162d1b461c1b0e140e032cdbf","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>Which chart exposes the tag that identifies what the problem is?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The <em>version</em> chart. The number of requests against <code>v350.10</code> matches the number of errors.</strong></p></div></div></div></div><ul><li>Now that we have identified the version of the <strong>paymentservice</strong> that is causing the issue, let&rsquo;s see if we can find out more information about the error. Click on <strong>← Tag Spotlight</strong> at the top of the page to get back to the Service Map.</li></ul></div></div><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>Robert Castley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Dec 1, 2023</span></span></footer></article><article class=default><header class=headline></header><h1 id=4-apm-service-breakdown>4. APM Service Breakdown</h1><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>In the right-hand pane click on the <span class="btn cstyle grey"><span><span class=title>Breakdown</span></span></span>.</li><li>Select <code>tenant.level</code> in the list. This is a tag that exposes the customers&rsquo; status and can be useful to see trends related to customer status.</li><li>Back in the Service Map Click on <strong>gold</strong> to select it.</li><li>Click on <span class="btn cstyle grey"><span><span class=title>Breakdown</span></span></span> and select <code>version</code>, this is the tag that exposes the service version.</li><li>Repeat this for <strong>silver</strong> and <strong>bronze</strong>.</li></ul><div class=tab-panel data-tab-group=e725bb2ae22314f1b2e8a1bcbf494b24><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("e725bb2ae22314f1b2e8a1bcbf494b24","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("e725bb2ae22314f1b2e8a1bcbf494b24","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>What can you conclude from what you are seeing?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>Every tenant is being impacted by <code>v350.10</code></strong></p></div></div></div></div></div></div><p>You will now see the <strong>paymentservice</strong> broken down into three services, <strong>gold</strong>, <strong>silver</strong> and <strong>bronze</strong>. Each tenant is broken down into two services, one for each version (<code>v350.10</code> and <code>v350.9</code>).</p><p><a href=#R-image-4ad475e066467792d25b3e1240d123d7 class=lightbox-link><img alt="APM Service Breakdown" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/4-apm-service-breakdown/../images/apm-service-breakdown.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4ad475e066467792d25b3e1240d123d7><img alt="APM Service Breakdown" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/4-apm-service-breakdown/../images/apm-service-breakdown.png></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on the outer main box that surrounds the 3 red circles, the box will become highlighted.</li></ul></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Span Tags</div><div class=box-content><p>Using span tags to break down services is a very powerful feature. It allows you to see how your services are performing for different customers, different versions, different regions, etc. In this exercise, we have determined that <code>v350.10</code> of the <strong>paymentservice</strong> is causing problems for all our customers.</p></div></div><p>Next, we need to drill down into a trace to see what is going on.</p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>Robert Castley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Dec 4, 2023</span></span></footer></article><article class=default><header class=headline></header><h1 id=5-apm-trace-analyzer>5. APM Trace Analyzer</h1><p>As Splunk APM provides a <strong>NoSample™</strong> end-to-end visibility of every service Splunk APM captures every trace. For this workshop, the <strong>Order Confirmation ID</strong> is available as a tag. This means that we can use this to search for the exact trace of the poor user experience you encountered earlier in the workshop.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Trace Analyzer</div><div class=box-content><p>Splunk Observability Cloud provides several tools for exploring application monitoring data. <strong>Trace Analyzer</strong> is suited to scenarios where you have high-cardinality, high-granularity searches and explorations to research unknown or new issues.</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>With the outer box of the <strong>paymentservice</strong> selected, in the right-hand pane, click on <strong>Traces</strong>.</li><li>To ensure we are using <strong>Trace Analyzer</strong> make sure the button <span class="btn cstyle transparent"><span><span class=title>Switch to Classic View</span></span></span> is showing. If it is not, click on <span class="btn cstyle blue"><span><span class=title>Switch to Trace Analyzer</span></span></span>.</li></ul></div></div><p><a href=#R-image-bd43fba1d81c03ab8502cd110f83e67e class=lightbox-link><img alt="APM Trace Analyzer" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/5-apm-trace-analyzer/../images/apm-trace-analyzer.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bd43fba1d81c03ab8502cd110f83e67e><img alt="APM Trace Analyzer" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/5-apm-trace-analyzer/../images/apm-trace-analyzer.png></a></p><p>The <strong>Trace & error count</strong> view shows the total traces and traces with errors in a stacked bar chart. You can use your mouse to select a specific period within the available time frame.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on the dropdown menu that says <strong>Trace & error count</strong>, and change it to <strong>Trace duration</strong></li></ul></div></div><p><a href=#R-image-6ee73df3500bba1dbc0502e0b01e17fb class=lightbox-link><img alt="APM Trace Analyzer Heat Map" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/5-apm-trace-analyzer/../images/apm-trace-analyzer-heat-map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6ee73df3500bba1dbc0502e0b01e17fb><img alt="APM Trace Analyzer Heat Map" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/5-apm-trace-analyzer/../images/apm-trace-analyzer-heat-map.png></a></p><p>The <strong>Trace Duration</strong> view shows a heatmap of traces by duration. The heatmap represents 3 dimensions of data:</p><ol><li>Time on the x-axis</li><li>Trace duration on the y-axis</li><li>The traces (or requests) per second are represented by the heatmap shades</li></ol><p>You can use your mouse to select an area on the heatmap, to focus on a specific time period and trace duration range.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Switch from <strong>Trace duration</strong> back to <strong>Trace & Error count</strong>.</li><li>In the time picker select <strong>Last 1 hour</strong>.</li><li>Note, that most of our traces have errors (red) and there are only a limited amount of traces that are error-free (blue).</li><li>Make sure the <strong>Sample Ratio</strong> is set to <code>1:1</code> and <strong>not</strong> <code>1:10</code>.</li><li>Click on <strong>Add filters</strong>, type in <code>orderId</code> and select <strong>orderId</strong> from the list.</li><li>Paste in your <strong>Order Confirmation ID</strong> from when you went shopping earlier in the workshop and hit enter. If you didn&rsquo;t capture one, please ask your instructor for one.
<a href=#R-image-b028c13b2d7abec9ef3c2e7285836f0e class=lightbox-link><img alt="Traces by Duration" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/5-apm-trace-analyzer/../images/apm-trace-by-duration.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b028c13b2d7abec9ef3c2e7285836f0e><img alt="Traces by Duration" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/5-apm-trace-analyzer/../images/apm-trace-by-duration.png></a></li></ul></div></div><p>We have now filtered down to the exact trace where you encountered a poor user experience with a very long checkout wait. A secondary benefit to viewing this trace is that the trace will be accessible for up to 13 months. This will allow developers to come back to this issue at a later stage and still view this trace for example.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on the trace in the list.</li></ul></div></div><p>Next, we will walk through the trace waterfall.</p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>dmitchsplunk</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Jul 12, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=6-apm-waterfall>6. APM Waterfall</h1><p>We have arrived at the <strong>Trace Waterfall</strong> from the <strong>Trace Analyzer</strong>. A trace is a collection of spans that share the same trace ID, representing a unique transaction handled by your application and its constituent services.</p><p>Each span in Splunk APM captures a single operation. Splunk APM considers a span to be an error span if the operation that the span captures results in an error.</p><p><a href=#R-image-47e38a12e294c4b688af325eac393d1e class=lightbox-link><img alt="Trace Waterfall" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/6-apm-waterfall/../images/apm-trace-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-47e38a12e294c4b688af325eac393d1e><img alt="Trace Waterfall" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/6-apm-waterfall/../images/apm-trace-waterfall.png></a></p><p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on the <span class="btn cstyle red"><span><span class=title>!</span></span></span> next to any of the <code>paymentservice:grpc.hipstershop.PaymentService/Charge</code> spans in the waterfall.</li></ul><div class=tab-panel data-tab-group=008fcf849cc3345204e8db945a65d828><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("008fcf849cc3345204e8db945a65d828","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("008fcf849cc3345204e8db945a65d828","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>What is the error message and version being reported in the span metadata?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>Invalid request and <code>v350.10</code></strong>.</p></div></div></div></div></div></div>Now that we have identified the version of the <strong>paymentservice</strong> that is causing the issue, let&rsquo;s see if we can find out more information about the error. This is where <strong>Related Logs</strong> come in.</p><p><a href=#R-image-c46b7879986e63d23c0eede507a86033 class=lightbox-link><img alt="Related Logs" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/6-apm-waterfall/../images/apm-related-logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c46b7879986e63d23c0eede507a86033><img alt="Related Logs" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.64/en/s4r/6-apm/6-apm-waterfall/../images/apm-related-logs.png></a></p><p>Related Content relies on specific metadata that allow APM, Infrastructure Monitoring, and Log Observer to pass filters around Observability Cloud. For related logs to work, you need to have the following metadata in your logs:</p><ul><li><code>service.name</code></li><li><code>deployment.environment</code></li><li><code>host.name</code></li><li><code>trace_id</code></li><li><code>span_id</code></li></ul><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>At the very bottom of the <strong>Trace Waterfall</strong> click on the word <strong>Logs (1)</strong>. This highlights that there are <strong>Related Logs</strong> for this trace.</li><li>Click on the <strong>Logs for trace XXX</strong> entry in the pop-up, this will open the logs for the complete trace in <strong>Log Observer</strong>.</li></ul></div></div><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>Robert Castley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Dec 1, 2023</span></span></footer></article></section></div></main></div><script src=/observability-workshop/v5.64/js/clipboard.min.js?1721291801 defer></script><script src=/observability-workshop/v5.64/js/perfect-scrollbar.min.js?1721291801 defer></script><script src=/observability-workshop/v5.64/js/theme.js?1721291801 defer></script></body></html>