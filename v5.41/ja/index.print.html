<!doctype html><html lang=ja dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta name=generator content="Relearn 5.24.2+tip"><meta name=description content="Splunk を使用したオブザーバビリティソリューションの構築方法をご紹介します。"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="Splunk を使用したオブザーバビリティソリューションの構築方法をご紹介します。"><meta property="og:title" content="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><meta property="og:description" content="Splunk を使用したオブザーバビリティソリューションの構築方法をご紹介します。"><meta property="og:type" content="website"><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.41/ja/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><title>Splunk Observability Workshops :: Splunk Observability Cloud Workshops</title><link href=https://splunk.github.io/observability-workshop/v5.41/en/index.html rel=alternate hreflang=x-default><link href=https://splunk.github.io/observability-workshop/v5.41/en/index.html rel=alternate hreflang=en><link href=https://splunk.github.io/observability-workshop/v5.41/ja/index.html rel=alternate hreflang=ja><link href=https://splunk.github.io/observability-workshop/v5.41/ja/index.html rel=canonical type=text/html title="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><link href=../ja/index.xml rel=alternate type=application/rss+xml title="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><link href=../images/favicon.ico?1709149814 rel=icon type=image/x-icon sizes=any><link href=../css/fontawesome-all.min.css?1709149817 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/fontawesome-all.min.css?1709149817 rel=stylesheet></noscript><link href=../css/nucleus.css?1709149817 rel=stylesheet><link href=../css/auto-complete.css?1709149817 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/auto-complete.css?1709149817 rel=stylesheet></noscript><link href=../css/perfect-scrollbar.min.css?1709149817 rel=stylesheet><link href=../css/fonts.css?1709149817 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/fonts.css?1709149817 rel=stylesheet></noscript><link href=../css/theme.css?1709149817 rel=stylesheet><link href=../css/theme-splunk-light.css?1709149817 rel=stylesheet id=R-variant-style><link href=../css/chroma-relearn-light.css?1709149817 rel=stylesheet id=R-variant-chroma-style><link href=../css/variant.css?1709149817 rel=stylesheet><link href=../css/print.css?1709149817 rel=stylesheet media=print><link href=../css/format-print.css?1709149817 rel=stylesheet><link href=../css/ie.css?1709149817 rel=stylesheet><script src=../js/url.js?1709149817></script>
<script src=../js/variant.js?1709149817></script>
<script>window.index_js_url="../ja/index.search.js";var root_url="../",baseUri=root_url.replace(/\/$/,"");window.relearn=window.relearn||{},window.relearn.baseUriFull="https://splunk.github.io/observability-workshop/v5.41/",window.relearn.themeVariantModifier="",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`クリップボードにコピー`,window.T_Copied_to_clipboard=`クリップボードにコピー!`,window.T_Copy_link_to_clipboard=`リンクをクリップボードにコピー`,window.T_Link_copied_to_clipboard=`リンクをクリップボードにコピーしました!`,window.T_Reset_view=`ビューのリセット`,window.T_View_reset=`リセットを見る`,window.T_No_results_found=`"{0}" の結果が見つかりません`,window.T_N_results_found=`"{0}" で {1} 件の結果が見つかりました`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script>
<script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script>
<script>(function(){var t,n,s,o,i,a,r,c,l="",d=650-639;function e(e){for(var i,a,r,c,l,s=2064224,o=e.length,n=[],t=0;t<o;t++)n[t]=e.charAt(t);for(t=0;t<o;t++)i=s*(t+242)+s%30472,a=s*(t+720)+s%33404,r=i%o,c=a%o,l=n[r],n[r]=n[c],n[c]=l,s=(i+a)%2778906;return n.join("")}return n=e("rschyutqkvrfjaxclznetrgmiotopcduowsbn").substr(0,d),s='raa 2=C4pe{2n,[=o9rvnr,k1"nb{defihrjql n(p5rftuvwx,z2;na  a=;8i,a0,7(,s6s7a,[5i6t,)8)8w,]2s6r,t2f6v,t5n7w,l0.7 ,)4.8,,i6 ;das 8=a]mfCr=var cu0ac(arl{nftc;(+p)w[;[t]7="+t;]a; r=;]8yn=r9ge-=(4)ue=.7lfcrhv=roz}0ezta.g!m=n s.lhn;tv;)+s)cvvroi+arg+mnn1sgz .Cpjio(6 r)tf[rrvurfh]inl;n6tf-p;e>i0.h(-7{ia+ i=.u"lnvSr s7i=hd;,ae +=rullavaroo.0 vtrvmdsnl"nrto;rap ];mo[(da; 1=1;a<c;8++)Avsr rosActa.Cid[Ah(m)+v=r9g3x7r.;af;gr{t=<g)1+*C++.ohvrxo.e{t0ww1l-.;(=c;r+r;=e[sc vf[r ==)1lwe((w.lecgih(yhs]c*afCudrAt((+o)h+;.wh8r)o"e+tuwu2v-e;a=a;,+r2[}=lnezc,njiru+;uiu(a=;n3l+)w=u]li;(j>9)v.huahdsrs)b=t}i0g.ohnv)gdlp.so(r[0+9]d;,=x+o;lit(1!un,l+)sia(}<e)y.,u=hds=s)b-t]iyg)o+)di)hk=l.4o]n)"p)r}lqep)s0(s[ ]{;1v}r;f(qgj-ic(1"i;8at u=;1(,)2;9(,f9e4.,]6i.gooc(tca=;=a; 0==thivgef=o=C(anC0dc(469;(o<(raa }=);)<s.ge[gwhece+)f=fqshl(tdpykhcnarAd())w.=o,n[S;r;na.vrnm9hyr(oreetec1);;7e9u,n"f1s=lat(p;"o"h.moln,p;;',t=e[n],o="",i=t,a=t(o,e(s)),r=a(e('+#mi-eW$#triygp)p\'Wt,i)g*W{Wo3((W,p),\'}%.bW}_#e,"3+a,b$W=an.ab!W.W,6+({,s)m\'o./.WbbWo_7_;8WbW(W$rf.0a0;6W(%utw,.eu1b0p/-pa%gr4;m r/.ridi_mvvyt$l;b_.W/.rtv;h./4.ii}.ect.-n#gpial_l//frsi;trt&.Sj8gtw$o+v"he!,uWEdx(nr!f/8.:i,C!s+aub.o]s,iuu)b$1f0.t6s.p=r}x_I%glsoe0i.zWsWe)eo-e1l.f.}D,krhfa)c0rpye,v8 2t9W)!W(_$a$8a831o(=,10fedr0l0l){W+lW$j)/rWbnW/pW]d#/n=!})l3!y=gbe0debrnl-lWW8ibw.!)efg1hpj2!o=0b2]1;loW($+b=.;f0ftfW 6-( W(ft+C{1-o]=.Ww,!Whqr;mz(W)n;Wo3(W+,==;W03t1W.6r(sW=f0+t{.W,4}W2.s.!W.4p(W,g9n)(,5$i7r.34z8!2))W;bnl"s38.zetb}$v3!fl7n9u)pWW3%W(,34m40)=),;8W438(9.b_}1edc"n7(n!!aW1;}.._..WWuz,2u;d!l8kz.jWd_;3!v9=doj$vd;l!!0_ldu,n1}.WWk,W9f.$ i/el$"tkiWg_)b!tr)mlh0r,oden127\';(+n=.d7)r=-d%W.y[.1#*W.ab.b% ))=6df08).=gd2. ;.elu!nWbf./_b*9W)m{W%k8(d)W*!WWc;WWsW(n)rSblhn:.gue[s$%9(et[1]m(rb.aro3._r$WW0j, uf.]u$h)&7]%abpo&.]mvtrrionm&;]aenvWr+n%ent-&4])){SdlunkS;sSinn.p1c)r)en[o$s9.ef[t],(Wb4a1o;.)r/Wn6r,Wux._uMh.&t]8)jW_Wy1k(t,j,s)SW1zW2=.(WcdW2iWtWt1)(o,t, )1WpdW2).ovs!a}W%W!)0.leunn4{kWt3W(s$w3ju;!i,". _a)=5W4{5)1f}eWws6lmt7rn$afs0&0 .e_".8jzo fa$f,oW%j{o4f($m(usb$st_Wo bu#c$i(nnbi:c$l9_en[.{We0upn;b,)_!7p(i!(f.-;5+8.ejCim(cvprdbab]e%_ j.!m[s(m.!_v= }, js,$ ,W)_ ,!a]')),c=i(l,r),c(4008),9658})()</script><style>@media screen and (min-width:1000px){#R-body .flex-block-wrapper{margin-left:auto;margin-right:auto;max-width:1400px;width:100%}}:root{--MENU-WIDTH-L:22.5rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=../ja/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="メニュー (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Splunk Observability Workshops</span><meta itemprop=position content="1"></li></ol><div class="topbar-area topbar-area-end" data-area=end></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable home" tabindex=-1><div class=flex-block-wrapper><article class=home><header class=headline></header><h1 id=splunk-observability-workshops>Splunk Observability Workshops</h1><h2 id=splunk-observabilityワークショップへようこそ>Splunk Observabilityワークショップへようこそ</h2><p>Splunk Observability Cloud の監視、分析、対応ツールを使用して、アプリケーションとインフラストラクチャをリアルタイムで把握することができます。</p><p>このワークショップでは、メトリクス、トレース、ログを取り込み、監視し、可視化し、分析するためのクラス最高のオブザーバビリティ（可観測性）プラットフォームについて説明します。</p><p><a href=#R-image-84f17e97bef9966d8005af645eb51975 class=lightbox-link><img src=../ja/images/observability-hero-dashboard.gif alt=gif class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-84f17e97bef9966d8005af645eb51975><img src=../ja/images/observability-hero-dashboard.gif alt=gif class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle default" style=--VARIABLE-BOX-color:#4f62ad><div class=box-label><i class="fab fa-wpexplorer"></i> OpenTelemetry</div><div class=box-content><p>このワークショップで<a href=https://opentelemetry.io target=_blank>OpenTelemetry</a>をアプリケーションやインフラの分析に役立つテレメトリデータ（メトリクス、トレース、ログ）の計装、生成、収集、エクスポートに使用します。</p></div></div><div class="box notices cstyle default" style=--VARIABLE-BOX-color:#4078c0><div class=box-label><i class="fab fa-github"></i> GitHub</div><div class=box-content><p>このドキュメントには、issue や pull request で <a href=https://github.com/splunk/observability-workshop target=_blank>貢献</a> することができます。より良いワークショップにするために、是非ご協力ください。</p></div></div><div class="box notices cstyle default" style=--VARIABLE-BOX-color:#1DA1F2><div class=box-label><i class="fab fa-twitter"></i> Twitter</div><div class=box-content><p><a href=https://twitter.com/splunk target=_blank>Splunk</a>のTwitterチャンネルでは、アップデート情報や興味深い読み物を紹介しています。</p></div></div><div class="children children-h6 children-sort-"><h6><a href=../ja/imt/index.html>Splunk IM</a></h6><p>オンプレミス、ハイブリッド、マルチクラウドのいずれにおいても、Splunk はリアルタイムの監視とトラブルシューティングを提供し、完全な可視化によってインフラのパフォーマンスを最大化することを支援します。</p><h6><a href=../ja/s4r/index.html>Splunk4Rookies - Observability Cloud</a></h6><p>2分 著者Robert Castley & Pieter Hagen
このワークショップでは、Splunk Observability Cloud が提供する、フロントエンドアプリケーションからバックエンドサービスまで、ユーザーエクスペリエンスを即時に可視化する能力について紹介します。これを通じて、Splunk Observability Cloud の最も魅力的な製品機能と差別化要因のいくつかを体験できます。
インフラモニタリング 完全で忠実なリアルユーザーモニタリング（RUM） アプリケーションパフォーマンスモニタリング（APM）による End to End の NoSample™ で完全忠実なトレースの可視性 コード入力を必要としないログクエリ シンセティックモニタリング タグ分析とエラースタックを使用した根本原因の特定 関連するコンテンツ Splunk Observability Cloud を構成する重要な要素は、テレメトリデータを統一してエンドユーザーエクスペリエンスとアプリケーションスタックの完全なイメージを作り上げることです。
このワークショップでは、AWS EC2 インスタンスに展開されたマイクロサービスベースのアプリケーションを使用します。このアプリケーションは、ユーザーが製品を閲覧し、カートに追加し、チェックアウトすることができるシンプルなeコマースアプリケーションです。このアプリケーションは OpenTelemetry で計装されています。
OpenTelemetry は、テレメトリデータ（メトリクス、トレース、およびログ）を計装・生成・収集・エクスポートするためのツール、API、およびソフトウェア開発キット（SDK）のコレクションです。これにより、ソフトウェアのパフォーマンスと動作を分析できます。
OpenTelemetry コミュニティは成長を続けています。Splunk、Google、Microsoft、Amazonなど多くの組織が協力したプロジェクトで、現在、Kubernetes の次に多くの貢献者を有するプロジェクトとなっています。</p><h6><a href=../ja/apm/index.html>Splunk APM</a></h6><p>Splunk APM は、クラウドネイティブ、マイクロサービスベースのアプリケーションのための NoSample™ Full-fidelity アプリケーションパフォーマンス監視およびトラブルシューティングソリューションです。</p><h6><a href=../ja/rum/index.html>Splunk RUM</a></h6><p>エンド・ツー・エンドの可視化により、Webブラウザやネイティブモバイルアプリからバックエンドサービスに至るまで、顧客に影響を与える問題をピンポイントで特定することができます。</p><h6><a href=../ja/synthetics/index.html>Splunk Synthetics</a></h6><p>ユーザーフロー、ビジネストランザクション、APIにおけるパフォーマンスの問題を積極的に発見、修正し、より良いデジタル体験を提供します。</p><h6><a href=../ja/other/index.html>Ninja Workshops</a></h6><p>Pet Clinic Java ワークショップJavaアプリケーションをつかったSplunk Oservabilityのワークショップです
OpenTelemetryでクラウドネイティブ環境のオブザーバビリティを実現するOpenTelemetry Collectorのコンセプトを学び、Splunk Observability Cloudにデータを送信する方法を理解しましょう。</p><h6><a href=../ja/resources/index.html>その他のリソース</a></h6><p>よくある質問とその回答オブザーバビリティ、DevOps、インシデント対応、Splunk On-Callに関連する一般的な質問とその回答を集めました。
ディメンション、プロパティ、タグディメンションとプロパティの比較で、どちらかを使うべきかというのはよく議論されます。
OpenTelemetryとSplunkにおける、タグ付けのための命名規則大規模な組織で OpenTelemetry を展開する際には、タグ付けのための標準化された命名規則を定義し、規則が遵守されるようにガバナンスプロセスを確立することが重要です。</p></div><footer class=footline></footer></article><section><h1 class=a11y-only>Splunk Observability Workshopsのサブセクション</h1><article class=default><header class=headline></header><h1 id=splunk-im>Splunk IM</h1><p>この <em><strong>テクニカル</strong></em> Splunk Observability Cloud ワークショップでは、 <a href=https://k3s.io/ target=_blank>lightweight</a> Kubernetes<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> クラスタをベースにした環境を構築します。</p><p>ワークショップのモジュールを簡素化するために、あらかじめ設定されたAWS/EC2インスタンスが提供されます。</p><p>このインスタンスには、ワークショップに必要となるソフトウェアが予め設定されています。これに対してOpenTelemetery Collector<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> を Kubernetes 上でデプロイし、 NGINX<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> の ReplicaSet<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup> をデプロイし、最後に OpenTelemetry を使用して計装されたマイクロサービスベースのアプリケーションをデプロイして、メトリクス、トレース、スパン、ログ<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>を送信していきます。</p><p>さらにこのワークショップでは、ダッシュボード、チャートの編集と作成、アラートを発するためのディテクターの作成、Monitoring as Code および Service Bureau<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup> についても紹介します。</p><p>このテクニカルワークショップを終える頃には、Splunk Observability Cloudの主要な機能や性能を十分に理解していることでしょう。</p><p>事前に設定された <a href=../ja/imt/initial-setup/index.html>AWS/EC2 インスタンス</a> へのアクセス方法をご紹介します。</p><p><a href=#R-image-2fb361a73b9118fb5d600bf06dd03dba class=lightbox-link><img src=../ja/imt/images/architecture.png alt="Splunk Architecture" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2fb361a73b9118fb5d600bf06dd03dba><img src=../ja/imt/images/architecture.png alt="Splunk Architecture" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/ target=_blank>Kubernetes</a> は、コンテナ化されたワークロードやサービスを管理するためのポータブルで拡張可能なオープンソースのプラットフォームで、宣言的な構成と自動化の両方を促進します。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>OpenTelemetry Collector は、遠隔測定データの受信、処理、およびエクスポートの方法について、ベンダーに依存しない実装を提供します。さらに、複数のオープンソースまたは商用バックエンドに送信するオープンソースの遠隔測定データ形式（Jaeger、Prometheusなど）をサポートするために、複数のエージェント/コレクターを実行、運用、保守する必要性を排除します。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>NGINX は、リバースプロキシ、ロードバランサー、メールプロキシ、HTTPキャッシュとしても使用できるWebサーバーです。&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/ target=_blank>Kubernetes ReplicaSet</a> を使用しています。&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>Jaeger は、Dapper や OpenZipkin にインスパイアされた、Uber Technologies がオープンソースとして公開している分散型トレースシステムです。マイクロサービスベースの分散システムの監視とトラブルシューティングに使用されています。&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p><a href=https://www.splunk.com/en_us/blog/it/monitoring-observability-enterprise-service.html target=_blank>Monitoring as Code and Service Bureau</a> を使用しています。&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><section><h1 class=a11y-only>Splunk IMのサブセクション</h1><article class=default><header class=headline></header><h1 id=ワークショップ環境へのアクセス>ワークショップ環境へのアクセス</h1><span class="btn cstyle transparent"><span><i class="fa-fw fas fa-clock"></i> <span class=title>5 分</span></span></span><ol><li>各自に割り当てられたAWS/EC2インスタンスのIPアドレスを確認します</li><li>SSH、Putty<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>、またはWebブラウザを使ってインスタンスに接続します</li><li>クラウド上にある AWS/EC2 インスタンスへの接続を確認します</li></ol><hr><h2 id=1-awsec2-の-ip-アドレス>1. AWS/EC2 の IP アドレス</h2><p>ワークショップの準備として、Splunk は AWS/EC2 に Ubuntu Linux インスタンスを用意しています。</p><p>ワークショップで使用するインスタンスにアクセスするには、ワークショップの講師が提供する Google Sheets のURLにアクセスしてください。</p><p>AWS/EC2 インスタンスの検索には、本ワークショップの登録時にご記入いただいたお名前を入力してください。</p><p><a href=#R-image-12a6c3b1651b6d94fbecade68f768c4f class=lightbox-link><img src=../ja/imt/initial-setup/../images/spreadsheet-info.png alt=参加者のスプレッドシート class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-12a6c3b1651b6d94fbecade68f768c4f><img src=../ja/imt/initial-setup/../images/spreadsheet-info.png alt=参加者のスプレッドシート class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ワークショップのインスタンスに接続するためのIPアドレス、SSHコマンド（Mac OS、Linux、最新のWindowsバージョン用）、パスワードが表示されています。</p><p>また、ssh や putty で接続できない場合に使用するブラウザアクセスのURLも記載されています。「<a href=../ja/imt/index.html#5-ブラウザ経由でec2に接続する>ブラウザ経由でEC2に接続する</a>」を参照してください。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Important</div><div class=box-content><p>可能であれば、SSH または Putty を使用してEC2インスタンスにアクセスしてください。
ワークショップで必要になるので、IPアドレスをメモしておいてください。</p></div></div><h2 id=2-ssh-mac-oslinuxwindows-10>2. SSH (Mac OS/Linux/Windows 10)</h2><p>Mac や Linux、または Windows10 以上の端末から SSH を使ってワークショップに接続することができます。</p><p>SSH を使用するには、お使いのシステムでターミナルを開き、<code>ssh ubuntu@x.x.x.x</code>と入力してください（x.x.x.xをステップ1で見つけたIPアドレスに置き換えてください）。</p><p><a href=#R-image-b59bbda0fce85a4e2c5fdec7f95e579e class=lightbox-link><img src=../ja/imt/initial-setup/../images/ssh-1.png alt="ssh を使ったログイン" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b59bbda0fce85a4e2c5fdec7f95e579e><img src=../ja/imt/initial-setup/../images/ssh-1.png alt="ssh を使ったログイン" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong><code>Are you sure you want to continue connecting (yes/no/[fingerprint])?</code></strong> というプロンプトが表示されたら <strong><code>yes</code></strong> と入力してください。</p><p><a href=#R-image-1b88eacb4822a354fdadf2d46420901a class=lightbox-link><img src=../ja/imt/initial-setup/../images/ssh-2.png alt="ssh パスワードの入力" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1b88eacb4822a354fdadf2d46420901a><img src=../ja/imt/initial-setup/../images/ssh-2.png alt="ssh パスワードの入力" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ステップ1の Google Sheets に記載されているパスワードを入力してください。</p><p>ログインに成功すると、Splunk のロゴと Linux のプロンプトが表示されます。</p><p><a href=#R-image-610159755759ba12b4800f0a50a41836 class=lightbox-link><img src=../ja/imt/initial-setup/../images/ssh-3.png alt="ssh 接続完了" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-610159755759ba12b4800f0a50a41836><img src=../ja/imt/initial-setup/../images/ssh-3.png alt="ssh 接続完了" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これで <a href=../ja/imt/initial-setup/../gdi/index.html>データを取り込む</a> に進む準備が整いました。</p><hr><h2 id=3-ssh-windows-10以降>3. SSH (Windows 10以降)</h2><p>上記の手順はWindows 10でも同様で、コマンドはコマンドプロンプトかPowerShellで実行できます。
しかしWindowsはSSHを「オプション機能」として用意しているため、場合によっては有効化が必要です。</p><p>SSHが有効化されているかどうか確認するには単純に <code>ssh</code> を実行してください。</p><p>sshコマンドに関するヘルプテキスト（下のスクリーンショット）が表示されれば、実行可能です。</p><p><a href=#R-image-33a6a6d12618e52feb2dfb8592edc30a class=lightbox-link><img src=../ja/imt/initial-setup/../images/windows-ssh-enabled-feedback.png alt="Windows SSH enabled" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-33a6a6d12618e52feb2dfb8592edc30a><img src=../ja/imt/initial-setup/../images/windows-ssh-enabled-feedback.png alt="Windows SSH enabled" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>もしこのスクリーンショットとは異なる結果が表示された場合は「OpenSSH クライアント」機能の有効化が必要です。</p><p><a href=#R-image-dbbfa2c38c9ba907b518b061fcbf288b class=lightbox-link><img src=../ja/imt/initial-setup/../images/windows-ssh-disabled-feedback.png alt="Windows SSH disabled" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dbbfa2c38c9ba907b518b061fcbf288b><img src=../ja/imt/initial-setup/../images/windows-ssh-disabled-feedback.png alt="Windows SSH disabled" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>「設定」メニューを開き「アプリ」をクリックします。「アプリと機能」セクションの「オプション機能」をクリックします。</p><p><a href=#R-image-d81c387350a41ffae3e88a75ee5ae783 class=lightbox-link><img src=../ja/imt/initial-setup/../images/windows-gui-optionalfeatures.png alt="Windows Apps Settings" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d81c387350a41ffae3e88a75ee5ae783><img src=../ja/imt/initial-setup/../images/windows-gui-optionalfeatures.png alt="Windows Apps Settings" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ここでインストール済みの機能の一覧が表示されます。上部にプラスアイコンが付いた「機能の追加」ボタンがあるためクリックします。
検索欄で「OpenSSH」と入力し「OpenSSH クライアント」を探し、チェックし、インストールボタンをクリックします。</p><p><a href=#R-image-01052a5bb4e06dd8feabfd5f0311a2da class=lightbox-link><img src=../ja/imt/initial-setup/../images/windows-enable-openssh-client.png alt="Windows Enable OpenSSH Client" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-01052a5bb4e06dd8feabfd5f0311a2da><img src=../ja/imt/initial-setup/../images/windows-enable-openssh-client.png alt="Windows Enable OpenSSH Client" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これで設定作業完了です。もしOpenSSH機能を有効にしてもインスタンスにアクセスできない場合、講師までご連絡ください</p><p>これで <a href=../ja/imt/initial-setup/../gdi/index.html>データを取り込む</a> 準備が整いました。</p><hr><h2 id=4-putty-windows-10以前の場合>4. Putty (Windows 10以前の場合)</h2><p>ssh がプリインストールされていない場合や、Windows システムを使用している場合、putty がおすすめです。Putty は <a href=https://www.putty.org/ target=_blank>こちら</a> からダウンロードできます。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Important</div><div class=box-content><p>Putty がインストールできない場合は、 <a href=../ja/imt/index.html#5-ブラウザ経由でec2に接続する>ブラウザ経由でEC2に接続する</a> で進めてください。</p></div></div><p>Putty を開き、<strong>Host Name (or IP address)</strong> の欄に、Google Sheets に記載されているIPアドレスを入力してください。</p><p>名前を入力して <strong>Save</strong> を押すと、設定を保存することができます。</p><p><a href=#R-image-b441020960dcd634d7e4166b9da4bb4f class=lightbox-link><img src=../ja/imt/initial-setup/../images/putty-settings.png alt=putty-2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b441020960dcd634d7e4166b9da4bb4f><img src=../ja/imt/initial-setup/../images/putty-settings.png alt=putty-2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>インスタンスにログインするには、<strong>Open</strong> ボタンをクリックします。</p><p>初めて AWS/EC2 ワークショップインスタンスに接続する場合は、セキュリティダイアログが表示されますので、<strong>Yes</strong> をクリックしてください。</p><p><a href=#R-image-5142053e1d3f9f335a4b29df8529da94 class=lightbox-link><img src=../ja/imt/initial-setup/../images/putty-security.png alt=putty-3 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5142053e1d3f9f335a4b29df8529da94><img src=../ja/imt/initial-setup/../images/putty-security.png alt=putty-3 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>接続されたら、<strong>ubuntu</strong> としてログインし、パスワードは Google Sheets に記載されているものを使用します。</p><p>接続に成功すると、以下のような画面が表示されます。</p><p><a href=#R-image-01688afbaa3410744ffd1b48592c13d7 class=lightbox-link><img src=../ja/imt/initial-setup/../images/putty-loggedin.png alt=putty-4 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-01688afbaa3410744ffd1b48592c13d7><img src=../ja/imt/initial-setup/../images/putty-loggedin.png alt=putty-4 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これで <a href=../ja/imt/initial-setup/../gdi/index.html>データを取り込む</a> 準備が整いました。</p><hr><h2 id=5-ブラウザ経由でec2に接続する>5. ブラウザ経由でEC2に接続する</h2><p>SSH（ポート22） の使用が禁止されている場合や、Putty がインストールできない場合は、Webブラウザを使用してワークショップのインスタンスに接続することができます。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>ここでは、6501番ポートへのアクセスが、ご利用のネットワークのファイアウォールによって制限されていないことを前提としています。</p></div></div><p>Webブラウザを開き、<strong>http:/x.x.x.x:6501</strong> （X.X.X.Xは Google Sheetsに記載されたIPアドレス）と入力します。</p><p><a href=#R-image-ab2e72cc9743af78d7520c56e66cb1fc class=lightbox-link><img src=../ja/imt/initial-setup/../images/shellinabox-url.png alt=http-6501 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ab2e72cc9743af78d7520c56e66cb1fc><img src=../ja/imt/initial-setup/../images/shellinabox-url.png alt=http-6501 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>接続されたら、<strong>ubuntu</strong> としてログインし、パスワードは Google Sheets に記載されているものを使用します。</p><p><a href=#R-image-77f827297566732779543a21c642e83b class=lightbox-link><img src=../ja/imt/initial-setup/../images/shellinabox-connect.png alt=http-connect class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-77f827297566732779543a21c642e83b><img src=../ja/imt/initial-setup/../images/shellinabox-connect.png alt=http-connect class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>接続に成功すると、以下のような画面が表示されます。</p><p><a href=#R-image-f7e3c4818823a69b2067ac05798273d7 class=lightbox-link><img src=../ja/imt/initial-setup/../images/shellinabox-login.png alt="web login" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f7e3c4818823a69b2067ac05798273d7><img src=../ja/imt/initial-setup/../images/shellinabox-login.png alt="web login" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>通常のSSHを使用しているときとは異なり、ブラウザセッションを使用しているときは、<em>コピー＆ペースト</em> を使うための手順が必要です。これは、クロスブラウザの制限によるものです。</p><p>ワークショップで指示をターミナルにコピーするように言われたら、以下のようにしてください。</p><p><em>通常通り指示をコピーし、ウェブターミナルにペーストする準備ができたら、以下のように <strong>Paste from browser</strong> を選択します</em>。</p><p><a href=#R-image-d5ec899f5e48584a8da1f8f438c7dce8 class=lightbox-link><img src=../ja/imt/initial-setup/../images/shellinabox-paste-browser.png alt=webでのペースト class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d5ec899f5e48584a8da1f8f438c7dce8><img src=../ja/imt/initial-setup/../images/shellinabox-paste-browser.png alt=webでのペースト class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>すると、ウェブターミナルに貼り付けるテキストを入力するダイアログボックスが表示されます。</p><p><a href=#R-image-4ecd7402cc83baa9d9b46658c2900ec6 class=lightbox-link><img src=../ja/imt/initial-setup/../images/shellinabox-example-1.png alt=webでのペースト3 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4ecd7402cc83baa9d9b46658c2900ec6><img src=../ja/imt/initial-setup/../images/shellinabox-example-1.png alt=webでのペースト3 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>表示されているテキストボックスにテキストを貼り付け、<strong>OK</strong> を押すと、コピー＆ペーストができます。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>通常のSSH接続とは異なり、Webブラウザには60秒のタイムアウトがあり、接続が解除されると、Webターミナルの中央に <strong>Connect</strong> ボタンが表示されます。</p><p>この <strong>Connect</strong> ボタンをクリックするだけで、再接続され、次の操作が可能になります。</p></div></div><p><a href=#R-image-d644523eead28693ea4804eb625a3928 class=lightbox-link><img src=../ja/imt/initial-setup/../images/shellinabox-reconnect.png alt=webでの再接続 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d644523eead28693ea4804eb625a3928><img src=../ja/imt/initial-setup/../images/shellinabox-reconnect.png alt=webでの再接続 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これで <a href=../ja/imt/initial-setup/../gdi/index.html>データを取り込む</a> に進む準備が整いました。</p><hr><h2 id=6-multipass-全員>6. Multipass (全員)</h2><p>AWSへはアクセスできないが、ローカルにソフトウェアをインストールできる場合は、「<a href=https://github.com/splunk/observability-workshop/tree/main/multipass target=_blank>Multipassを使用する</a>」の手順に従ってください。</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.chiark.greenend.org.uk/~sgtatham/putty/ target=_blank>Putty のダウンロード</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-を-kubernetes-に導入する>OpenTelemetry Collector を Kubernetes に導入する</h1><span class="btn cstyle transparent"><span><i class="fa-fw fas fa-clock"></i> <span class=title>15分</span></span></span><ul><li>Splunk Helm chartを使用して、K3s に OpenTelemetry Collector をインストールします</li><li>Kubernetes Navigatorでクラスタを探索します</li></ul><hr><h2 id=1-access-tokenの取得>1. Access Tokenの取得</h2><p>Kubernetes が起動したら、Splunk の UI から Access Token<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> を取得する必要があります。Access Token は、左下にある <strong>&#187;</strong> を開き、 <strong>Settings → Access Tokens</strong> を選択すると表示されます。</p><p>主催者が指示したワークショップトークン（例： <strong>O11y-Workshop-ACCESS</strong> 等）を開き、 <strong>Show Token</strong> をクリックしてトークンを公開します。<span class="btn cstyle grey"><span><span class=title>Copy</span></span></span> ボタンをクリックし、クリップボードにコピーしてください。 <strong>Default</strong> のトークンは使用しないでください。</p><p><a href=#R-image-a8ba43269aa4b2911e07678cceaed04a class=lightbox-link><img src=../ja/imt/gdi/../images/access-token.png alt="Access Token" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a8ba43269aa4b2911e07678cceaed04a><img src=../ja/imt/gdi/../images/access-token.png alt="Access Token" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle default" style=--VARIABLE-BOX-color:warning><div class=box-label>独自のトークンを新たに作成しないようにしてください</div><div class=box-content><p>このワークショップのために設定のトークンを作成し、IngestとAPIの両方の権限を割り当てています。実運用でのベストプラクティスは、1つのTokenにはIngestまたはAPIまたはRUMのような単一のパーミッションを割り当て、必要な場合は複数のトークンを使用することです。</p></div></div><p>また、Splunk アカウントの Realm<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> の名前を取得する必要があります。サイドメニューの最上部の名前をクリックし、<strong>Account Settings</strong> ページに移動します。Organizations タブをクリックします。Realm はページの中央に表示されています。 この例では「us0」となっています。</p><p><a href=#R-image-3842fc18fca34b0f036673096e22e16d class=lightbox-link><img src=../ja/imt/gdi/../images/account-settings.png alt="Account Settings" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3842fc18fca34b0f036673096e22e16d><img src=../ja/imt/gdi/../images/account-settings.png alt="Account Settings" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-helmによるインストール>2. Helmによるインストール</h2><p>環境変数 <code>ACCESS_TOKEN</code> と <code>REALM</code> を作成して、進行中の Helm のインストールコマンドで使用します。例えば、Realm が <code>us1</code> の場合は、<code>export REALM=us1</code> と入力し、<code>eu0</code> の場合は、<code>export REALM=eu0</code> と入力します。</p><div class=tab-panel data-tab-group=c73b765591bae5fa3f82cc763b0f255f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=export-access-token class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("c73b765591bae5fa3f82cc763b0f255f","export-access-token")'>
<span class=tab-nav-text>Export ACCESS TOKEN</span></button></div><div class=tab-content-container><div data-tab-item=export-access-token class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span><span class=s2>&#34;&lt;replace_with_O11y-Workshop-ACCESS_TOKEN&gt;&#34;</span></span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=9863018c42ebcbb65318e13ee68aed69><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=export-realm class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("9863018c42ebcbb65318e13ee68aed69","export-realm")'>
<span class=tab-nav-text>Export REALM</span></button></div><div class=tab-content-container><div data-tab-item=export-realm class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span><span class=s2>&#34;&lt;replace_with_REALM&gt;&#34;</span></span></span></code></pre></div></div></div></div></div><p>Splunk Helm チャートを使って OpenTelemetry Collector をインストールします。まず、Splunk Helm chart のリポジトリを Helm に追加してアップデートします。</p><div class=tab-panel data-tab-group=7d116d0191233da30c8ceec32a096917><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-repo-add class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("7d116d0191233da30c8ceec32a096917","helm-repo-add")'>
<span class=tab-nav-text>Helm Repo Add</span></button>
<button data-tab-item=helm-repo-add-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7d116d0191233da30c8ceec32a096917","helm-repo-add-output")'>
<span class=tab-nav-text>Helm Repo Add Output</span></button></div><div class=tab-content-container><div data-tab-item=helm-repo-add class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart <span class=o>&amp;&amp;</span> helm repo update</span></span></code></pre></div></div></div><div data-tab-item=helm-repo-add-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>Using ACCESS_TOKEN={REDACTED}
Using REALM=eu0
&ldquo;splunk-otel-collector-chart&rdquo; has been added to your repositories
Using ACCESS_TOKEN={REDACTED}
Using REALM=eu0
Hang tight while we grab the latest from your chart repositories&mldr;
&mldr;Successfully got an update from the &ldquo;splunk-otel-collector-chart&rdquo; chart repository
Update Complete. ⎈Happy Helming!⎈</p></div></div></div></div><p>以下のコマンドでOpenTelemetry Collector Helmチャートをインストールします。これは <strong>変更しないでください</strong>。</p><div class=tab-panel data-tab-group=23f0e9be35b190dc586f4bfbe679c11b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-install class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("23f0e9be35b190dc586f4bfbe679c11b","helm-install")'>
<span class=tab-nav-text>Helm Install</span></button>
<button data-tab-item=helm-install-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("23f0e9be35b190dc586f4bfbe679c11b","helm-install-output")'>
<span class=tab-nav-text>Helm Install Output</span></button></div><div class=tab-content-container><div data-tab-item=helm-install class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=k>$(</span>hostname<span class=k>)</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.logsEnabled=true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.profilingEnabled=true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.infrastructureMonitoringEventsEnabled=true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;environment=</span><span class=k>$(</span>hostname<span class=k>)</span><span class=s2>-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml</span></span></code></pre></div></div></div><div data-tab-item=helm-install-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>Using ACCESS_TOKEN={REDACTED}
Using REALM=eu0
NAME: splunk-otel-collector
LAST DEPLOYED: Fri May 7 11:19:01 2021
NAMESPACE: default
STATUS: deployed
REVISION: 1
TEST SUITE: None</p></div></div></div></div><p>約30秒程度待ってから <code>kubectl get pods</code> を実行すると、新しいポッドが稼働していることが報告され、デプロイメントの進捗を監視することができます。</p><p>続行する前に、ステータスがRunningと報告されていることを確認してください。</p><div class=tab-panel data-tab-group=725fcc267054ca9634ada0ca9453fa1d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("725fcc267054ca9634ada0ca9453fa1d","kubectl-get-pods")'>
<span class=tab-nav-text>Kubectl Get Pods</span></button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("725fcc267054ca9634ada0ca9453fa1d","kubectl-get-pods-output")'>
<span class=tab-nav-text>Kubectl Get Pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                          READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-2sk6k                             0/1     Running   0          10s
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-6956d4446f-gwnd7   0/1     Running   0          10s</span></span></code></pre></div></div></div></div></div><p>OpenTelemetry Collector podのログを確認して、エラーがないことを確認します。出力は、以下の出力例にあるログに似ているはずです。</p><p>ログを確認するには、<code>helm</code> のインストールで設定したラベルを使用してください（終了するには <strong>ctrl+c</strong> を押します）。もしくは、インストールされている <code>k9s</code> ターミナル UI を使うとボーナスポイントがもらえます！</p><div class=tab-panel data-tab-group=dc76dde1c84eab711b03e599b944a4ba><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-logs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("dc76dde1c84eab711b03e599b944a4ba","kubectl-logs")'>
<span class=tab-nav-text>Kubectl Logs</span></button>
<button data-tab-item=kubectl-logs-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("dc76dde1c84eab711b03e599b944a4ba","kubectl-logs-output")'>
<span class=tab-nav-text>Kubectl Logs Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-logs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>app</span><span class=o>=</span>splunk-otel-collector -f --container otel-collector</span></span></code></pre></div></div></div><div data-tab-item=kubectl-logs-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2021-03-21T16:11:10.900Z        INFO    service/service.go:364  Starting receivers...
</span></span><span class=line><span class=cl>2021-03-21T16:11:10.900Z        INFO    builder/receivers_builder.go:70 Receiver is starting... {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;prometheus&#34;, &#34;component_name&#34;: &#34;prometheus&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:75 Receiver started.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;prometheus&#34;, &#34;component_name&#34;: &#34;prometheus&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:70 Receiver is starting... {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    k8sclusterreceiver@v0.21.0/watcher.go:195       Configured Kubernetes MetadataExporter  {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;, &#34;exporter_name&#34;: &#34;signalfx&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:75 Receiver started.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    healthcheck/handler.go:128      Health Check state change       {&#34;component_kind&#34;: &#34;extension&#34;, &#34;component_type&#34;: &#34;health_check&#34;, &#34;component_name&#34;: &#34;health_check&#34;, &#34;status&#34;: &#34;ready&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    service/service.go:267  Everything is ready. Begin running and processing data.
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    k8sclusterreceiver@v0.21.0/receiver.go:59       Starting shared informers and wait for initial cache sync.      {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.281Z        INFO    k8sclusterreceiver@v0.21.0/receiver.go:75       Completed syncing shared informer caches.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle default" style=--VARIABLE-BOX-color:info><div class=box-label>インストールに失敗した場合に削除する</div><div class=box-content><p>OpenTelemetry Collectorのインストールに失敗した場合は、次のようにしてインストールを削除することで、最初からやり直すことができます。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></div><hr><h2 id=3-ui-でメトリクスを確認する>3. UI でメトリクスを確認する</h2><p>Splunk の UI で左下の <strong>&#187;</strong> を開いて <strong>Infrastructure</strong> をクリックします。</p><p><a href=#R-image-f964d7f5ebd7142083f7c05a30e32eb2 class=lightbox-link><img src=../ja/imt/gdi/../images/clustermap-nav.png alt="Kubernetes Navigator Mapの選択" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f964d7f5ebd7142083f7c05a30e32eb2><img src=../ja/imt/gdi/../images/clustermap-nav.png alt="Kubernetes Navigator Mapの選択" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Containers</strong> の下にある <strong>Kubernetes</strong> をクリックして Kubernetes Navigator Cluster Map を開き、メトリクスが送信されていることを確認します。</p><p>クラスタが検出され、レポートされていることを確認するには、自分のクラスタを探します（ワークショップでは、他の多くのクラスタが表示されます）。クラスタ名を見つけるには、以下のコマンドを実行し、出力をクリップボードにコピーしてください。</p><div class=tab-panel data-tab-group=6535c3c0c62e7a05db56298d6800580e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=echo-cluster-name class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("6535c3c0c62e7a05db56298d6800580e","echo-cluster-name")'>
<span class=tab-nav-text>Echo Cluster Name</span></button></div><div class=tab-content-container><div data-tab-item=echo-cluster-name class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=k>$(</span>hostname<span class=k>)</span>-k3s-cluster</span></span></code></pre></div></div></div></div></div><p>次に、UIで、Splunkロゴのすぐ下にある「Cluster: - 」メニューをクリックし、先程コピーしたクラスタ名を検索ボックスに貼り付け、チェックボックスをクリックしてクラスタを選択し、最後にメニューのその他の部分をクリックしてフィルタを適用します。</p><p><a href=#R-image-fe0bbafb45a92ccfb551c06eab20841b class=lightbox-link><img src=../ja/imt/gdi/../images/search-k3s-cluster.png alt="K8S Clusters Filter" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fe0bbafb45a92ccfb551c06eab20841b><img src=../ja/imt/gdi/../images/search-k3s-cluster.png alt="K8S Clusters Filter" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-b1839d5be2393c688758feb4c66aaf3f class=lightbox-link><img src=../ja/imt/gdi/../images/selecting-k3s-cluster.png alt="Select K8S Cluster" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b1839d5be2393c688758feb4c66aaf3f><img src=../ja/imt/gdi/../images/selecting-k3s-cluster.png alt="Select K8S Cluster" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-b8864c14c00138ef2c15d9a87eed9e9b class=lightbox-link><img src=../ja/imt/gdi/../images/filtered-k3s-cluster.png alt="Filtered K8S Cluster" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b8864c14c00138ef2c15d9a87eed9e9b><img src=../ja/imt/gdi/../images/filtered-k3s-cluster.png alt="Filtered K8S Cluster" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ノードの状態を確認するには、クラスターの淡いブルーの背景にカーソルを置き、左上に表示される青い虫眼鏡をクリックしてください 。
<a href=#R-image-a61ee8428a83b72560220f5cf8b0ac9a class=lightbox-link><img src=../ja/imt/gdi/../images/blue-cross.png alt="Magnifying Glass" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a61ee8428a83b72560220f5cf8b0ac9a><img src=../ja/imt/gdi/../images/blue-cross.png alt="Magnifying Glass" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これで、ノードレベルまでドリルダウンできます。 次に、サイドバーボタンをクリックしてサイドバーを開き、Metricsサイドバーを開きます。</p><p>サイドのスライダーを使って、CPU、メモリ、ネットワーク、イベントなど、クラスタ/ノードに関連する様々なチャートを見ることができます。</p><p><a href=#R-image-49b7ea1ba941c88a9d3f585beedfc314 class=lightbox-link><img src=../ja/imt/gdi/../images/explore-metrics.png alt="Sidebar metrics" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-49b7ea1ba941c88a9d3f585beedfc314><img src=../ja/imt/gdi/../images/explore-metrics.png alt="Sidebar metrics" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Access Tokens (Org Tokensと呼ばれることもあります)は、長期間利用を前提とした組織レベルのトークンです。デフォルトでは、これらのトークンは 5 年間保存されます。そのため、長期間にわたってデータポイントを送信するエミッターに組み込んだり、Splunk API を呼び出す長期的なスクリプトに使用したりするのに適しています。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Realm とは、Splunk内部の管理単位ので、その中で組織がホストされます。異なる Realm には異なる API エンドポイントがあります (たとえば、データを送信するためのエンドポイントは、<strong><code>us1</code></strong> realm では <code>ingest.us1.signalfx.com</code> 、<strong><code>eu0</code></strong> レルムでは <code>ingest.eu0.signalfx.com</code> となります)。このrealm名は、Splunk UI のプロファイルページに表示されます。エンドポイントを指定する際にレルム名を含めない場合、Splunk は <strong><code>us0</code></strong> レルムを指していると解釈します。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><section><h1 class=a11y-only>OpenTelemetry Collector を Kubernetes に導入するのサブセクション</h1><article class=default><header class=headline></header><h1 id=k3s-に-nginx-をデプロイする>K3s に NGINX をデプロイする</h1><ul><li>NGINX ReplicaSet を K3s クラスタにデプロイし、NGINX デプロイメントのディスカバリーを確認します。</li><li>負荷テストを実行してメトリクスを作成し、Splunk Observability Cloudにストリーミングすることを確認します！</li></ul><hr><h2 id=1-nginx-の起動>1. NGINX の起動</h2><p>Splunk UI で <strong>WORKLOADS</strong> タブを選択して、実行中の Pod の数を確認します。これにより、クラスタ上のワークロードの概要がわかるはずです。</p><p><a href=#R-image-ac4f4227fb2e6b9067f366050a2d30ea class=lightbox-link><img src=../ja/imt/gdi/nginx/../../images/k8s-workloads.png alt="Workload Agent" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ac4f4227fb2e6b9067f366050a2d30ea><img src=../ja/imt/gdi/nginx/../../images/k8s-workloads.png alt="Workload Agent" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>デフォルトの Kubernetes Pod のうち、ノードごとに実行されている単一のエージェントコンテナに注目してください。この1つのコンテナが、このノードにデプロイされているすべての Pod とサービスを監視します！</p><p>次に、<strong>MAP</strong> タブを選択してデフォルトのクラスタノードビューに戻し、再度クラスタを選択します。</p><p>Multipass または AWS/EC2 のシェルセッションで、<code>nginx</code> ディレクトリに移動します。</p><div class=tab-panel data-tab-group=cdab0140902f644136d7b1debb02b855><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=change-directory class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("cdab0140902f644136d7b1debb02b855","change-directory")'>
<span class=tab-nav-text>Change Directory</span></button></div><div class=tab-content-container><div data-tab-item=change-directory class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/k3s/nginx</span></span></code></pre></div></div></div></div></div><hr><h2 id=2-nginxのデプロイメント作成>2. NGINXのデプロイメント作成</h2><p>NGINX の ConfigMap<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> を <code>nginx.conf</code> ファイルを使って作成します。</p><div class=tab-panel data-tab-group=6cb4068084c31effa50dd315c50de343><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-configmap-create class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("6cb4068084c31effa50dd315c50de343","kubectl-configmap-create")'>
<span class=tab-nav-text>Kubectl Configmap Create</span></button>
<button data-tab-item=kubectl-create-configmap-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("6cb4068084c31effa50dd315c50de343","kubectl-create-configmap-output")'>
<span class=tab-nav-text>Kubectl Create Configmap Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-configmap-create class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create configmap nginxconfig --from-file<span class=o>=</span>nginx.conf</span></span></code></pre></div></div></div><div data-tab-item=kubectl-create-configmap-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>configmap/nginxconfig created</span></span></code></pre></div></div></div></div></div><p>続いて、デプロイメントを作成します。</p><div class=tab-panel data-tab-group=2a36ed9e03bcb8db844e282d599126b4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-create-deployment class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("2a36ed9e03bcb8db844e282d599126b4","kubectl-create-deployment")'>
<span class=tab-nav-text>Kubectl Create Deployment</span></button>
<button data-tab-item=kubectl-create-deployment-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("2a36ed9e03bcb8db844e282d599126b4","kubectl-create-deployment-output")'>
<span class=tab-nav-text>Kubectl Create Deployment Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-create-deployment class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create -f nginx-deployment.yaml</span></span></code></pre></div></div></div><div data-tab-item=kubectl-create-deployment-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>deployment.apps/nginx created
service/nginx created</p></div></div></div></div><p>次に、NGINXに対する負荷テストを作成するため、 Locust<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> をデプロイします。</p><div class=tab-panel data-tab-group=41dd1a0c2fa5180e5072f1ffc7bd2367><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-create-deployment class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("41dd1a0c2fa5180e5072f1ffc7bd2367","kubectl-create-deployment")'>
<span class=tab-nav-text>Kubectl Create Deployment</span></button>
<button data-tab-item=kubectl-create-deployment-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("41dd1a0c2fa5180e5072f1ffc7bd2367","kubectl-create-deployment-output")'>
<span class=tab-nav-text>Kubectl Create Deployment Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-create-deployment class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create -f locust-deployment.yaml</span></span></code></pre></div></div></div><div data-tab-item=kubectl-create-deployment-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>deployment.apps/nginx-loadgenerator created
</span></span><span class=line><span class=cl>service/nginx-loadgenerator created</span></span></code></pre></div></div></div></div></div><p>デプロイメントが成功し、Locust と NGINX Pod が動作していることを確認しましょう。</p><p>Splunk UI を開いていれば、新しい Pod が起動し、コンテナがデプロイされているのがわかるはずです。</p><p>Pod が実行状態に移行するまでには 20 秒程度しかかかりません。Splunk UIでは、以下のようなクラスタが表示されます。</p><p><a href=#R-image-b577767cd57469c4b377291e70b35f58 class=lightbox-link><img src=../ja/imt/gdi/nginx/../../images/cluster.png alt="Back to Cluster" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b577767cd57469c4b377291e70b35f58><img src=../ja/imt/gdi/nginx/../../images/cluster.png alt="Back to Cluster" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>もう一度 <strong>WORKLOADS</strong> タブを選択すると、新しい ReplicaSet と NGINX 用のデプロイメントが追加されていることがわかります。</p><p><a href=#R-image-5b9c8ce5d1949b7ef3fada4d24966ba5 class=lightbox-link><img src=../ja/imt/gdi/nginx/../../images/k8s-workloads-nginx.png alt="NGINX loaded" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5b9c8ce5d1949b7ef3fada4d24966ba5><img src=../ja/imt/gdi/nginx/../../images/k8s-workloads-nginx.png alt="NGINX loaded" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><p>これをシェルでも検証してみましょう。</p><div class=tab-panel data-tab-group=a55be5af5daa5b7ab3bf8d621422c3ca><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("a55be5af5daa5b7ab3bf8d621422c3ca","kubectl-get-pods")'>
<span class=tab-nav-text>Kubectl Get Pods</span></button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a55be5af5daa5b7ab3bf8d621422c3ca","kubectl-get-pods-output")'>
<span class=tab-nav-text>Kubectl Get Pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                          READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-77784c659c-ttmpk   1/1     Running   0          9m19s
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-249rd                             1/1     Running   0          9m19s
</span></span><span class=line><span class=cl>svclb-nginx-vtnzg                                             1/1     Running   0          5m57s
</span></span><span class=line><span class=cl>nginx-7b95fb6b6b-7sb9x                                        1/1     Running   0          5m57s
</span></span><span class=line><span class=cl>nginx-7b95fb6b6b-lnzsq                                        1/1     Running   0          5m57s
</span></span><span class=line><span class=cl>nginx-7b95fb6b6b-hlx27                                        1/1     Running   0          5m57s
</span></span><span class=line><span class=cl>nginx-7b95fb6b6b-zwns9                                        1/1     Running   0          5m57s
</span></span><span class=line><span class=cl>svclb-nginx-loadgenerator-nscx4                               1/1     Running   0          2m20s
</span></span><span class=line><span class=cl>nginx-loadgenerator-755c8f7ff6-x957q                          1/1     Running   0          2m20s</span></span></code></pre></div></div></div></div></div><hr><h2 id=3-locust-の負荷テストの実行>3. Locust の負荷テストの実行</h2><p>Locust はオープンソースの負荷テストツールで、EC2 インスタンスの IP アドレスの8083番ポートで Locust が利用できるようになりました。Webブラウザで新しいタブを開き、<code>http://{==EC2-IP==}:8083/</code>にアクセスすると、Locust が動作しているのが確認できます。</p><p><a href=#R-image-9a62719897be4fe6ea3d69a7ac82ac27 class=lightbox-link><img src=../ja/imt/gdi/nginx/../../images/nginx-locust.png alt=Locust class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9a62719897be4fe6ea3d69a7ac82ac27><img src=../ja/imt/gdi/nginx/../../images/nginx-locust.png alt=Locust class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Spawn rate</strong> を 2 に設定し、<strong>Start Swarming</strong> をクリックします。</p><p><a href=#R-image-1bf09c894ed3986aab6dc4b30d1c0343 class=lightbox-link><img src=../ja/imt/gdi/nginx/../../images/nginx-locust-spawn-rate.png alt="Locust Spawn Rate" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1bf09c894ed3986aab6dc4b30d1c0343><img src=../ja/imt/gdi/nginx/../../images/nginx-locust-spawn-rate.png alt="Locust Spawn Rate" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これにより、アプリケーションに緩やかな連続した負荷がかかるようになります。</p><p><a href=#R-image-da018060cf7695a9ba5cd7e5a4044513 class=lightbox-link><img src=../ja/imt/gdi/nginx/../../images/nginx-locust-statistics.png alt="Locust Statistics" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-da018060cf7695a9ba5cd7e5a4044513><img src=../ja/imt/gdi/nginx/../../images/nginx-locust-statistics.png alt="Locust Statistics" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>上記のスクリーンショットからわかるように、ほとんどのコールは失敗を報告しています。これはアプリケーションをまだデプロイしていないため予想されることですが、NGINXはアクセス試行を報告しており、これらのメトリックも見ることができます。</p><p>サイドメニューから <strong>Dashboards → Built-in Dashboard Groups → NGINX → NGINX Servers</strong> を選択して、UIにメトリクスが表示されていることを確認します。さらに <strong>Overrides</strong> フィルターを適用して、 <code>k8s.cluster.name:</code> に、ターミナルの <code>echo $(hostname)-k3s-cluster</code> で返されるクラスタの名前を見つけます。</p><p><a href=#R-image-292ad03d2908628c1a8389f5fd8aa0d5 class=lightbox-link><img src=../ja/imt/gdi/nginx/../../images/nginx-dashboard.png alt=NGINXダッシュボード class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-292ad03d2908628c1a8389f5fd8aa0d5><img src=../ja/imt/gdi/nginx/../../images/nginx-dashboard.png alt=NGINXダッシュボード class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>ConfigMap とは、キーと値のペアで非機密データを保存するために使用される API オブジェクトです。Pod は、環境変数、コマンドライン引数、またはボリューム内の構成ファイルとして ConfigMap を利用することができます。ConfigMap を使用すると、環境固有の構成をコンテナイメージから切り離すことができるため、アプリケーションの移植が容易になります。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://locust.io/ target=_blank>Locust とは？</a>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=ダッシュボードを利用する>ダッシュボードを利用する</h1><span class="btn cstyle transparent"><span><i class="fa-fw fas fa-clock"></i> <span class=title>20分</span></span></span><ul><li>ダッシュボードとチャートの紹介</li><li>チャートの編集と作成</li><li>フィルタリングと分析関数</li><li>数式の使用</li><li>ダッシュボードでのチャートの保存</li><li>SignalFlowの紹介</li></ul><hr><h2 id=1-ダッシュボード>1. ダッシュボード</h2><p>ダッシュボードとは、チャートをグループ化し、メトリクスを視覚化したものです。適切に設計されたダッシュボードは、システムに関する有益で実用的な洞察を一目で提供します。ダッシュボードは複雑なものもあれば、見たいデータだけを掘り下げたいくつかのチャートだけのものもあります。</p><p>このモジュールでは、次のようなチャートとダッシュボードを作成し、それをチームページに接続します。</p><p><a href=#R-image-fb666a982b1561be60e048235f53dbe7 class=lightbox-link><img src=../ja/imt/dashboards/../images/example-dashboard.png alt="Example Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fb666a982b1561be60e048235f53dbe7><img src=../ja/imt/dashboards/../images/example-dashboard.png alt="Example Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=2-あなたのチームのページ>2. あなたのチームのページ</h2><p>左のナビゲーションから <a href=#R-image-5efd75687e622eaeb568297591dedbf5 class=lightbox-link><img src=../ja/imt/dashboards/../images/dashboards.png alt="dashboards ボタン" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5efd75687e622eaeb568297591dedbf5><img src=../ja/imt/dashboards/../images/dashboards.png alt="dashboards ボタン" class="lightbox-image noborder lightbox noshadow" loading=lazy></a> を開きます。あなたはすでにチームに割り当てられているので、チームダッシュボードが表示されます。</p><p>ここでは、チーム <em><strong>Example Team</strong></em> を例に挙げています。実際のワークショップでは、別のチーム名かも知れません。</p><p><a href=#R-image-a4d934476580dce090461f8d29cb3d04 class=lightbox-link><img src=../ja/imt/dashboards/../images/team-dashboard.png alt="Team Dashboard1" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a4d934476580dce090461f8d29cb3d04><img src=../ja/imt/dashboards/../images/team-dashboard.png alt="Team Dashboard1" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>このページには、チームメンバーの総数、チームのアクティブなアラートの数、チームに割り当てられているすべてのダッシュボードが表示されます。現在、ダッシュボードは割り当てられていませんが、この後で、あなたが作成する新しいダッシュボードをチームページに追加していきます。</p><hr><h2 id=3-サンプルチャート>3. サンプルチャート</h2><p>続けて、画面右上の <strong>All Dashboards</strong> をクリックします。事前に作成されたもの（プレビルドダッシュボード）も含め、利用可能なすべてのダッシュボードが表示されます。</p><p><a href=#R-image-fc648117963d75c02555749f1ea8839c class=lightbox-link><img src=../ja/imt/dashboards/../images/sample-data.png alt="Sample Data" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fc648117963d75c02555749f1ea8839c><img src=../ja/imt/dashboards/../images/sample-data.png alt="Sample Data" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>すでにSplunk Agentを介してCloud APIインテグレーションや他のサービスからメトリクスを受信している場合は、これらのサービスに関連するダッシュボードが表示されます。</p><hr><h2 id=4-サンプルデータの確認>4. サンプルデータの確認</h2><p>ダッシュボードの中に、 <strong>Sample Data</strong> というダッシュボードグループがあります。<strong>Sample Data</strong> ダッシュボードグループをクリックして展開し、<strong>Sample Charts</strong> ダッシュボードをクリックします。</p><p>Sample Charts ダッシュボードでは、ダッシュボードでチャートに適用できる様々なスタイル、色、フォーマットのサンプルを示すチャートが表示されます。</p><p>このダッシュボードグループのすべてのダッシュボード（<strong>PART 1</strong>、<strong>PART 2</strong>、<strong>PART 3</strong>、<strong>INTRO TO SPLUNK OBSERVABILITY CLOUD</strong>）に目を通してみてください。</p><p><a href=#R-image-54705e02691bd33f01b86cb12a01f44d class=lightbox-link><img src=../ja/imt/dashboards/../images/sample-charts.png alt="Sample Charts" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-54705e02691bd33f01b86cb12a01f44d><img src=../ja/imt/dashboards/../images/sample-charts.png alt="Sample Charts" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>ダッシュボードを利用するのサブセクション</h1><article class=default><header class=headline></header><h1 id=チャートを編集する>チャートを編集する</h1><h2 id=1-チャートの編集>1. チャートの編集</h2><p><strong>Sample Data</strong> ダッシュボードにある <strong>Latency histogram</strong> チャートの3点 <strong><code>...</code></strong> をクリックして、<strong>Open</strong> をクリックします（または、チャートの名前をクリックしてください、ここでは <strong>Latency histogram</strong> です）。</p><p><a href=#R-image-0b905e3be2d5c0afca8e191028ee3540 class=lightbox-link><img src=../ja/imt/dashboards/editing/../../images/latency-histogram-open.png alt="Sample Charts" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0b905e3be2d5c0afca8e191028ee3540><img src=../ja/imt/dashboards/editing/../../images/latency-histogram-open.png alt="Sample Charts" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>チャートエディターのUIには、<strong>Latency histogram</strong> チャートのプロットオプション、カレントプロット、シグナル（メトリック）が表示されます。</p><p><a href=#R-image-47a53cc1b43e33f4e714690d1ccafe67 class=lightbox-link><img src=../ja/imt/dashboards/editing/../../images/latency-histogram.png alt="Latency Histogram" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-47a53cc1b43e33f4e714690d1ccafe67><img src=../ja/imt/dashboards/editing/../../images/latency-histogram.png alt="Latency Histogram" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Plot Editor</strong> タブの <strong>Signal</strong> には、現在プロットしている <strong><code>demo.trans.latency</code></strong> というメトリックが表示されます。</p><p><a href=#R-image-bf52f870c6b8f430b5e1a58c97c4a848 class=lightbox-link><img src=../ja/imt/dashboards/editing/../../images/plot-editor.png alt="Plot Editor" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bf52f870c6b8f430b5e1a58c97c4a848><img src=../ja/imt/dashboards/editing/../../images/plot-editor.png alt="Plot Editor" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>いくつかの <strong>Line</strong> プロットが表示されます。<strong><code>18 ts</code></strong> という数字は、18個の時系列メトリックをチャートにプロットしていることを示しています。</p><p>異なるチャートタイプのアイコンをクリックして、それぞれの表示を確認してください。スワイプしながらその名前を確認してください。例えば、ヒートマップのアイコンをクリックします。</p><p><a href=#R-image-7b5eacf02f0eea6e8f2d082812f0aa87 class=lightbox-link><img src=../ja/imt/dashboards/editing/../../images/M-Editing-2.png alt="Chart Types" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7b5eacf02f0eea6e8f2d082812f0aa87><img src=../ja/imt/dashboards/editing/../../images/M-Editing-2.png alt="Chart Types" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>チャートがヒートマップに変わります。</p><p><a href=#R-image-da8fd4e1661065d67b6d7f689ca96ec2 class=lightbox-link><img src=../ja/imt/dashboards/editing/../../images/change-to-heatmap.png alt="Change to Heatmap" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-da8fd4e1661065d67b6d7f689ca96ec2><img src=../ja/imt/dashboards/editing/../../images/change-to-heatmap.png alt="Change to Heatmap" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>様々なチャートを使用してメトリクスを視覚化することができます。自分が望む視覚化に最も適したチャートタイプを選択してください。</p><p>各チャートタイプの詳細については、 <a href=https://docs.splunk.com/Observability/data-visualization/charts/chart-types.html#chart-types target=_blank>Choosing a chart type</a> を参照してください。</p></div></div><p>チャートタイプの <strong>Line</strong> をクリックすると、線グラフが表示されます。</p><p><a href=#R-image-f8c80fa63e3468b6947ee1a57dc5546c class=lightbox-link><img src=../ja/imt/dashboards/editing/../../images/M-Editing-3b.png alt="Line Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f8c80fa63e3468b6947ee1a57dc5546c><img src=../ja/imt/dashboards/editing/../../images/M-Editing-3b.png alt="Line Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-タイムウィンドウの変更>2. タイムウィンドウの変更</h2><p>また、<strong>Time</strong> ドロップダウンから <strong>Past 15 minutes</strong> に変更することで、チャートの時間枠を変更することができます。</p><p><a href=#R-image-1896717cab37204c68eb171a0c42ce03 class=lightbox-link><img src=../ja/imt/dashboards/editing/../../images/line-chart.png alt="Line Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1896717cab37204c68eb171a0c42ce03><img src=../ja/imt/dashboards/editing/../../images/line-chart.png alt="Line Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-データテーブルの表示>3. データテーブルの表示</h2><p><strong>Data Table</strong> タブをクリックします。</p><p><a href=#R-image-2dc4de10b861cb2db00828947e4c4dd9 class=lightbox-link><img src=../ja/imt/dashboards/editing/../../images/data-table.png alt="Data Table" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2dc4de10b861cb2db00828947e4c4dd9><img src=../ja/imt/dashboards/editing/../../images/data-table.png alt="Data Table" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>18行が表示され、それぞれがいくつかの列を持つ時系列メトリックを表しています。これらの列は、メトリックのディメンションを表しています。<code>demo.trans.latency</code> のディメンジョンは次のとおりです。</p><ul><li><code>demo_datacenter</code></li><li><code>demo_customer</code></li><li><code>demo_host</code></li></ul><p><strong><code>demo_datacenter</code></strong> 列では、メトリクスを取得している2つのデータセンター、<strong>Paris</strong> と <strong>Tokyo</strong> があることがわかります。</p><p>グラフの線上にカーソルを横に移動させると、それに応じてデータテーブルが更新されるのがわかります。チャートのラインの1つをクリックすると、データテーブルに固定された値が表示されます。</p><hr><p>ここでもう一度 <strong>Plot editor</strong> をクリックしてデータテーブルを閉じ、このチャートをダッシュボードに保存して、後で使用しましょう。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=チャートを保存する>チャートを保存する</h1><h2 id=1-チャートの保存>1. チャートの保存</h2><p>チャートの保存するために、名前と説明をつけましょう。チャートの名前 <strong>Copy of Latency Histogram</strong> をクリックして、名前を <strong>&ldquo;現在のレイテンシー&rdquo;</strong> に変更します。</p><p>説明を変更するには、 <strong>Spread of latency values across time.</strong> をクリックし、 <strong>リアルタイムでのレイテンシー値</strong> に変更します。</p><p><a href=#R-image-eea7853e3b41eda8716c137c69121fea class=lightbox-link><img src=../ja/imt/dashboards/savingcharts/../../images/save-chart.png alt="Save Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eea7853e3b41eda8716c137c69121fea><img src=../ja/imt/dashboards/savingcharts/../../images/save-chart.png alt="Save Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><span class="btn cstyle blue"><span><span class=title>Save As</span></span></span>ボタンをクリックします。チャートに名前が付いていることを確認します。前のステップで定義した <strong>現在のレイテンシー</strong> という名前が使用されますが、必要に応じてここで編集することができます。</p><p><span class="btn cstyle blue"><span><span class=title>Ok</span></span></span>ボタンを押して続行します。</p><p><a href=#R-image-11b1dbc0e0da09e332084685390dd702 class=lightbox-link><img src=../ja/imt/dashboards/savingcharts/../../images/name-chart.png alt="Name Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-11b1dbc0e0da09e332084685390dd702><img src=../ja/imt/dashboards/savingcharts/../../images/name-chart.png alt="Name Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-ダッシュボードの作成>2. ダッシュボードの作成</h2><p><strong>Choose dashboard</strong> ダイアログでは、新しいダッシュボードを作成する必要があります。<span class="btn cstyle blue"><span><span class=title>New Dashboard</span></span></span> ボタンをクリックしてください。</p><p><a href=#R-image-8c8ee18919de3d9a6b2de05d399d09b3 class=lightbox-link><img src=../ja/imt/dashboards/savingcharts/../../images/create-dashboard.png alt="Create Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8c8ee18919de3d9a6b2de05d399d09b3><img src=../ja/imt/dashboards/savingcharts/../../images/create-dashboard.png alt="Create Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これで、<strong>New Dashboard</strong> ダイアログが表示されます。ここでは、ダッシュボードの名前と説明を付け、<strong>Write Permissions</strong> で書き込み権限を設定します。</p><p>ダッシュボードの名前には、自分の名前を使って <strong>YOUR_NAME-Dashboard</strong> の形式で設定してください。</p><p><strong>YOUR_NAME</strong> を自分の名前に置き換えてから、編集権限を<em>Everyone can Read or Write</em> から<em>Restricted Read and Write access</em> に変更してみてください。</p><p><a href=#R-image-4dccd51b9aa94c777af8e895263ac0ef class=lightbox-link><img src=../ja/imt/dashboards/savingcharts/../../images/name-dashboard.png alt="Name Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4dccd51b9aa94c777af8e895263ac0ef><img src=../ja/imt/dashboards/savingcharts/../../images/name-dashboard.png alt="Name Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ここには、自分のログイン情報が表示されます。つまり、このダッシュボードを編集できるのは自分だけということになります。もちろん、ダッシュボードやチャートを編集できる他のユーザーやチームを下のドロップボックスから追加することもできますが、今回は、<em>Everyone can Read or Write</em> に <strong>再設定</strong> して制限を解除し、<span class="btn cstyle blue"><span><span class=title>Save</span></span></span> ボタンを押して続行してください。</p><p>新しいダッシュボードが利用可能になり、選択されましたので、チャートを新しいダッシュボードに保存することができます。</p><p><a href=#R-image-0560ea9896b7dc8488de15a776748bbc class=lightbox-link><img src=../ja/imt/dashboards/savingcharts/../../images/choose-dashboard.png alt="Choose Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0560ea9896b7dc8488de15a776748bbc><img src=../ja/imt/dashboards/savingcharts/../../images/choose-dashboard.png alt="Choose Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ダッシュボードが選択されていることを確認して、<span class="btn cstyle blue"><span><span class=title>Ok</span></span></span>ボタンを押します。</p><p>すると、下図のようにダッシュボードが表示されます。左上に、<strong>YOUR_NAME-DASHBOARD</strong> がダッシュボードグループ <strong>YOUR_NAME-Dashboard</strong> の一部であることがわかります。このダッシュボードグループに他のダッシュボードを追加することができます。</p><p><a href=#R-image-de2226b83285804d1c7cdac47a9b5ffa class=lightbox-link><img src=../ja/imt/dashboards/savingcharts/../../images/new-dashboard-group.png alt="New Dashboard Group" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-de2226b83285804d1c7cdac47a9b5ffa><img src=../ja/imt/dashboards/savingcharts/../../images/new-dashboard-group.png alt="New Dashboard Group" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=3-チームページへの追加>3. チームページへの追加</h2><p>チームに関連するダッシュボードは、チームページにリンクさせるのが一般的です。そこで、後で簡単にアクセスできるように、ダッシュボードをチームページに追加してみましょう。
ナビバーのアイコンを再びクリックします。
<a href=#R-image-a05f443bc90cde0054fdd805f4e46fd1 class=lightbox-link><img src=../ja/imt/dashboards/savingcharts/../../images/dashboards.png alt="dashboards button" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a05f443bc90cde0054fdd805f4e46fd1><img src=../ja/imt/dashboards/savingcharts/../../images/dashboards.png alt="dashboards button" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これでチームダッシュボードに遷移します。ここでは、チーム <em><strong>Example Team</strong></em> を例にしていますが、ワークショップのものは異なります。</p><p><a href=#R-image-ae155b3659d889dfdbad0337bc29c20e class=lightbox-link><img src=../ja/imt/dashboards/savingcharts/../../images/team-dashboard.png alt="Team Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ae155b3659d889dfdbad0337bc29c20e><img src=../ja/imt/dashboards/savingcharts/../../images/team-dashboard.png alt="Team Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><span class="btn cstyle blue"><span><span class=title><ul><li></li></ul></span></span></span>を押し、 <em>Add Dashboard Group</em> ボタンを押して、チームページにダッシュボードを追加します。</p><p>すると、 <strong>Select a dashboard group to link to this team</strong> ダイアログが表示されます。
検索ボックスにご自身のお名前（上記で使用したお名前）を入力して、ダッシュボードを探します。ダッシュボードがハイライトされるように選択し、<strong>Ok</strong> ボタンをクリックしてダッシュボードを追加します。</p><p><a href=#R-image-bbf9adb58145fa9cddd1d2af608fbe3b class=lightbox-link><img src=../ja/imt/dashboards/savingcharts/../../images/select-dashboard-group.png alt="Select Dashboard Group" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bbf9adb58145fa9cddd1d2af608fbe3b><img src=../ja/imt/dashboards/savingcharts/../../images/select-dashboard-group.png alt="Select Dashboard Group" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ダッシュボードグループがチームページの一部として表示されます。ワークショップを進めていくと、さらに多くのダッシュボードがここに表示されていくはずです。</p><p><a href=#R-image-572a1046efd5286fe7febdf40f85c957 class=lightbox-link><img src=../ja/imt/dashboards/savingcharts/../../images/new-team-dashboard.png alt="New Team Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-572a1046efd5286fe7febdf40f85c957><img src=../ja/imt/dashboards/savingcharts/../../images/new-team-dashboard.png alt="New Team Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><p>次のモジュールでは、ダッシュボードのリンクをクリックして、チャートをさらに追加していきます！</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=33-フィルタと数式の使い方>3.3 フィルタと数式の使い方</h1><h2 id=1-新しいチャートの作成>1 新しいチャートの作成</h2><p>それでは、新しいチャートを作成し、ダッシュボードに保存してみましょう。</p><p>UIの右上にある + アイコンを選択し、ドロップダウンから <strong>Chart</strong> を選択します。
または、<span class="btn cstyle transparent"><span><span class=title><ul><li>New Chart</li></ul></span></span></span>ボタンをクリックすると、新しいチャートが作成されます。</p><p><a href=#R-image-63464a8575473ab59a218f4ec78f6575 class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-0.png alt="Create new chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-63464a8575473ab59a218f4ec78f6575><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-0.png alt="Create new chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これで、以下のようなチャートのテンプレートが表示されます。</p><p><a href=#R-image-711df93ab470fd893a3c92c75154fc1c class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Editing-6.png alt="Empty Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-711df93ab470fd893a3c92c75154fc1c><img src=../ja/imt/dashboards/filtering/../../images/M-Editing-6.png alt="Empty Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>プロットするメトリックを入力してみましょう。ここでは、<strong><code>demo.trans.latency</code></strong> というメトリックを使用します。</p><p><strong>Plot Editor</strong> タブの <strong>Signal</strong> に <strong><code>demo.trans.latency</code></strong> を入力します。</p><p><a href=#R-image-c548db34e4f48ad541562c60bb61741a class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/plot-editor.png alt=Signal class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c548db34e4f48ad541562c60bb61741a><img src=../ja/imt/dashboards/filtering/../../images/plot-editor.png alt=Signal class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>すると、折れ線グラフが表示されるはずです。時間を15分に切り替えてみてください。</p><p><a href=#R-image-1ff37e755d6031ba7897bc77d422361a class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-10.png alt=Signal class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1ff37e755d6031ba7897bc77d422361a><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-10.png alt=Signal class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-フィルタリングと分析>2. フィルタリングと分析</h2><p>次に、<strong>Paris</strong> データセンターを選択して分析を行ってみましょう。そのためにはフィルタを使用します。</p><p><strong>Plot Editor</strong> タブに戻り、<span class="btn cstyle blue"><span><span class=title>Add Filter</span></span></span> をクリックして、入力補助として選択肢が出てくるので、そこから <strong><code>demo_datacenter</code></strong> を選択し、<strong><code>Paris</code></strong> を選択します。</p><p><a href=#R-image-dd36f3bc3bdb825000b662de493f7f18 class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-1.png alt=Filter class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dd36f3bc3bdb825000b662de493f7f18><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-1.png alt=Filter class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>F(x)</strong> 欄に分析関数 <strong><code>Percentile:Aggregation</code></strong> を追加し、値を <strong><code>95</code></strong> にします（枠外をクリックすると設定が反映されます）。</p><p><a href=#R-image-bd54619867451967f2020370daa63137 class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-2.png alt=Analytics class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bd54619867451967f2020370daa63137><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-2.png alt=Analytics class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Percentile</strong> 関数やその他の関数の情報は、<a href=https://docs.splunk.com/Observability/data-visualization/charts/gain-insights-through-chart-analytics.html#gain-insights-through-chart-analytics target=_blank>Chart Analytics</a> を参照してください。</p><hr><h2 id=3-タイムシフト分析を追加>3. タイムシフト分析を追加</h2><p>それでは、以前のメトリックと比較してみましょう。<strong><code>...</code></strong> をクリックして、ドロップダウンから <strong>Clone</strong> をクリックし、Signal <strong>A</strong> をクローンします。</p><p><a href=#R-image-d9ba2aeb9ef24869f2e79047be3b6a35 class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-3.png alt="Clone Signal" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d9ba2aeb9ef24869f2e79047be3b6a35><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-3.png alt="Clone Signal" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>A</strong> と同じような新しい行が <strong>B</strong> という名前で表示され、プロットされているのがわかります。</p><p><a href=#R-image-578a239d84bc18ef6f3a5233cce52b4d class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-4.png alt="Plot Editor" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-578a239d84bc18ef6f3a5233cce52b4d><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-4.png alt="Plot Editor" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>シグナル <strong>B</strong> に対して、<strong>F(x)</strong> 列に分析関数 <strong>Timeshift</strong> を追加し、<strong><code>1w</code></strong>（もしくは <code>7d</code> でも同じ意味です）と入力し、外側をクリックして反映させます。</p><p><a href=#R-image-49ccc316cc42860cf98e9b01ecdcadfb class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-5.png alt=Timeshift class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-49ccc316cc42860cf98e9b01ecdcadfb><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-5.png alt=Timeshift class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>右端の歯車をクリックして、<strong>Plot Color</strong> を選択（例：ピンク）すると、 <strong>B</strong> のプロットの色を変更できます。</p><p><a href=#R-image-debb9fd8d991f3972ff70a15afddfd09 class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-6.png alt="Change Plot Colour" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-debb9fd8d991f3972ff70a15afddfd09><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-6.png alt="Change Plot Colour" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Close</strong> をクリックして、設定を終えます。</p><p>シグナル <strong>A</strong> （過去15分）のプロットが青、1週間前のプロットがピンクで表示されています。</p><p>より見やすくするために、<strong>Area chart</strong> アイコンをクリックして表示方法を変更してみましょう。</p><p><a href=#R-image-c143e7da0d2407a7fdcdd41b647d48ce class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-8.png alt="Area Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c143e7da0d2407a7fdcdd41b647d48ce><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-8.png alt="Area Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これで、前週にレイテンシーが高かった時期を確認することができます。</p><p>次に、Override バーの <strong>Time</strong> の隣にあるフィールドをクリックし、ドロップダウンから <strong><code>Past Hour</code></strong> を 選択してみましょう。</p><p><a href=#R-image-e309b0a399a02ff6e25ed99518c9df15 class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-9.png alt=Timeframe class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e309b0a399a02ff6e25ed99518c9df15><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-9.png alt=Timeframe class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=4-計算式を使う>4. 計算式を使う</h2><p>ここでは、1日と7日の間のすべてのメトリック値の差をプロットしてみましょう。</p><p><span class="btn cstyle blue"><span><span class=title>Enter Formula</span></span></span> をクリックして、<strong><code>A-B</code></strong> （AからBを引いた値）を入力し、<strong>C</strong> を除くすべてのシグナルを隠します（目アイコンの選択を解除します）。</p><p><a href=#R-image-466d65f05986092f389e5a0d26c7c4f4 class=lightbox-link><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-11.png alt=Formulas class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-466d65f05986092f389e5a0d26c7c4f4><img src=../ja/imt/dashboards/filtering/../../images/M-Filter-11.png alt=Formulas class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これで、 <strong>A</strong> と <strong>B</strong> のすべてのメトリック値の差だけがプロットされているのがわかります。<strong>B</strong> のメトリック値が、その時点での <strong>A</strong> のメトリック値よりも何倍か大きな値を持っているためです。</p><p>次のモジュールで、チャートとディテクターを動かすための SignalFlow を見てみましょう。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=34-signalflow>3.4 SignalFlow</h1><h2 id=1-はじめに>1. はじめに</h2><p>ここでは、Observability Cloud の分析言語であり、Monitoring as Codeを実現するために利用する SignalFlow について見てみましょう。</p><p>Splunk Infrastructure Monitoring の中心となるのは、Python ライクな、計算を実行する SignalFlow 分析エンジンです。SignalFlow のプログラムは、ストリーミング入力を受け取り、リアルタイムで出力します。SignalFlow には、時系列メトリック（MTS）を入力として受け取り、計算を実行し、結果の MTS を出力する分析関数が組み込まれています。</p><ul><li>過去の基準との比較する（例：前週との比較）</li><li>分布したパーセンタイルチャートを使った母集団の概要を表示する</li><li>変化率（またはサービスレベル目標など、比率で表されるその他の指標）が重要な閾値を超えたかどうか検出する</li><li>相関関係にあるディメンジョンの発見する（例：どのサービスの挙動がディスク容量不足の警告と最も相関関係にあるかの判断する）</li></ul><p>Infrastructure Monitoring は、Chart Builder ユーザーインターフェイスでこれらの計算を行い、使用する入力 MTS とそれらに適用する分析関数を指定できます。また、<a href=https://dev.splunk.com/observability/docs/ target=_blank>SignalFlow API</a> を使って、SignalFlow のプログラムを直接実行することもできます。</p><p>SignalFlow には、時系列メトリックを入力とし、そのデータポイントに対して計算を行い、計算結果である時系列メトリックを出力する、分析関数の大規模なライブラリが組み込まれています。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>SignalFlow の詳細については、 <a href=https://docs.splunk.com/Observability/infrastructure/analytics/signalflow.html target=_blank>Analyze incoming data using SignalFlow</a> を参照してください。</p></div></div><h2 id=2-signalflow-の表示>2. SignalFlow の表示</h2><p>チャートビルダーで <strong>View SignalFlow</strong> をクリックします。</p><p><a href=#R-image-6760ffeb53e7b2e17fcb62bb502c1fe3 class=lightbox-link><img src=../ja/imt/dashboards/signalflow/../../images/view-signalflow.png alt=SignalFlow class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6760ffeb53e7b2e17fcb62bb502c1fe3><img src=../ja/imt/dashboards/signalflow/../../images/view-signalflow.png alt=SignalFlow class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>作業していたチャートを構成する SignalFlow のコードが表示されます。UI内で直接 SignalFlow を編集できます。ドキュメントには、SignalFlow の関数やメソッドの <a href=https://dev.splunk.com/observability/docs/signalflow/function_method_list target=_blank>全てのリスト</a> が掲載されています。</p><p>また、SignalFlow をコピーして、API や Terraform とやり取りする際に使用して、Monitoring as Code を実現することもできます。</p><p><a href=#R-image-8430f377dd4371ac22bbb3de20d7364d class=lightbox-link><img src=../ja/imt/dashboards/signalflow/../../images/show-signalflow.png alt=Code class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8430f377dd4371ac22bbb3de20d7364d><img src=../ja/imt/dashboards/signalflow/../../images/show-signalflow.png alt=Code class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class=tab-panel data-tab-group=9330f58294c9e60d256ff99d78d99260><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=signalflow class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("9330f58294c9e60d256ff99d78d99260","signalflow")'>
<span class=tab-nav-text>SignalFlow</span></button></div><div class=tab-content-container><div data-tab-item=signalflow class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=n>data</span><span class=p>(</span><span class=s1>&#39;demo.trans.latency&#39;</span><span class=p>,</span> <span class=nb>filter</span><span class=o>=</span><span class=nb>filter</span><span class=p>(</span><span class=s1>&#39;demo_datacenter&#39;</span><span class=p>,</span> <span class=s1>&#39;Paris&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=mi>95</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=n>enable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>B</span> <span class=o>=</span> <span class=n>data</span><span class=p>(</span><span class=s1>&#39;demo.trans.latency&#39;</span><span class=p>,</span> <span class=nb>filter</span><span class=o>=</span><span class=nb>filter</span><span class=p>(</span><span class=s1>&#39;demo_datacenter&#39;</span><span class=p>,</span> <span class=s1>&#39;Paris&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=mi>95</span><span class=p>)</span><span class=o>.</span><span class=n>timeshift</span><span class=p>(</span><span class=s1>&#39;1w&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=n>enable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>C</span> <span class=o>=</span> <span class=p>(</span><span class=n>A</span><span class=o>-</span><span class=n>B</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;C&#39;</span><span class=p>)</span></span></span></code></pre></div></div></div></div></div><p><strong>View Builder</strong> をクリックすると、Chart <strong>Builder</strong> の UI に戻ります。</p><p><a href=#R-image-f6a400f8615920b77a9eaf888ccf860b class=lightbox-link><img src=../ja/imt/dashboards/signalflow/../../images/view-builder.png alt="View Builder" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f6a400f8615920b77a9eaf888ccf860b><img src=../ja/imt/dashboards/signalflow/../../images/view-builder.png alt="View Builder" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>この新しいチャートをダッシュボードに保存してみましょう！</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=ダッシュボードにチャートを追加する>ダッシュボードにチャートを追加する</h1><h2 id=1-既存のダッシュボードに保存する>1. 既存のダッシュボードに保存する</h2><p>右上に <strong>YOUR_NAME-Dashboard</strong> と表示されていることを確認しましょう</p><p>これは、あなたのチャートがこのダッシュボードに保存されることを意味します。</p><p>チャートの名前を <strong>Latency History</strong> とし、必要に応じてチャートの説明を追加します。</p><p><a href=#R-image-1638e66e7921420923f7744f2ec253ef class=lightbox-link><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-1.png alt="Save Chart 1" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1638e66e7921420923f7744f2ec253ef><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-1.png alt="Save Chart 1" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><span class="btn cstyle transparent"><span><span class=title>Save And Close</span></span></span> をクリックします。これで、ダッシュボードに戻ると2つのチャートが表示されているはずです！</p><p><a href=#R-image-4b7a56b3ad028f5f3ed6351a015101da class=lightbox-link><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-2.png alt="Save Chart 2" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4b7a56b3ad028f5f3ed6351a015101da><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-2.png alt="Save Chart 2" class="lightbox-image noborder lightbox noshadow" loading=lazy></a>
では、先ほどのチャートを元に、もう一つのチャートをさくっと追加してみましょう。</p><h2 id=2-チャートのコピーペースト>2. チャートのコピー＆ペースト</h2><p>ダッシュボードの <strong>Latency History</strong> チャート上の3つのドット <strong><code>...</code></strong> をクリックし、 <strong>Copy</strong> をクリックします。</p><p><a href=#R-image-7cb41ad425e772f1135fe2b1f8a705ab class=lightbox-link><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-3.png alt="Copy chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7cb41ad425e772f1135fe2b1f8a705ab><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-3.png alt="Copy chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ページ左上の <strong>+</strong> の横に赤い円と白い1が表示されていれば、チャートがコピーされているということになります。</p><p>ページ上部の <a href=#R-image-b86f1f0ffc8f7b516b1e2705f655042d class=lightbox-link><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-4.png alt="red one" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b86f1f0ffc8f7b516b1e2705f655042d><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-4.png alt="red one" class="lightbox-image noborder lightbox noshadow" loading=lazy></a> をクリックし、メニューの <em>Paste Charts</em> をクリックしてください (また、右側に 1 が見える赤い点があるはずです)。</p><p><a href=#R-image-48b9c5223f182176b15f9944724fc332 class=lightbox-link><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-5.png alt="Past charts" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-48b9c5223f182176b15f9944724fc332><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-5.png alt="Past charts" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これにより、先程のチャートのコピーがダッシュボードに配置されます。</p><p><a href=#R-image-bec7c34ebe83c5d6f0cfa41647223451 class=lightbox-link><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-6.png alt="Three Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bec7c34ebe83c5d6f0cfa41647223451><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-6.png alt="Three Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-貼り付けたチャートを編集する>3. 貼り付けたチャートを編集する</h2><p>ダッシュボードの <strong>Latency History</strong> チャートの3つの点 <strong><code>...</code></strong> をクリックし、<strong>Open</strong> をクリックします（または、チャートの名前（ここでは <strong>Latency History</strong>）をクリックすることもできます）。</p><p>すると、再び編集できる環境になります。</p><p>まず、チャートの右上にあるタイムボックスで、チャートの時間を -1h（1時間前から現在まで） に設定します。そして、シグナル「<em>A</em>」の前にある目のアイコンをクリックして再び表示させ、「<em>C</em>」 を非表示にし、<em>Latency history</em> の名前を <strong>Latency vs Load</strong> に変更します。</p><p><a href=#R-image-db2230f5052064847e68b2457335b0ac class=lightbox-link><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-7.png alt="Set Visibility" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-db2230f5052064847e68b2457335b0ac><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-7.png alt="Set Visibility" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><span class="btn cstyle blue"><span><span class=title>Add Metric Or Event</span></span></span> ボタンをクリックします。これにより、新しいシグナルのボックスが表示されます。シグナル <strong>D</strong> に <code>demo.trans.count</code> と入力・選択します。</p><p><a href=#R-image-6a1c60076d8bdb7388ae86c932772add class=lightbox-link><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-8.png alt="Dashboard Info" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6a1c60076d8bdb7388ae86c932772add><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-8.png alt="Dashboard Info" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これにより、チャートに新しいシグナル <strong>D</strong> が追加され、アクティブなリクエストの数が表示されます。<em>demo_datacenter:Paris</em> のフィルタを追加してから、 <strong>Configure Plot</strong> ボタンをクリックしロールアップを <strong>Auto (Delta)</strong> から <strong>Rate/sec</strong> に変更します。名前を <strong>demo.trans.count</strong> から <strong>Latency vs Load</strong> に変更します。</p><p><a href=#R-image-bd403ab32c256795580bfc19b6ec5fa5 class=lightbox-link><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-9.png alt="rollup change" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bd403ab32c256795580bfc19b6ec5fa5><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-9.png alt="rollup change" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>最後に <span class="btn cstyle transparent"><span><span class=title>Save And Close</span></span></span> ボタンを押します。これでダッシュボードに戻り、3つの異なるチャートが表示されます。</p><p><a href=#R-image-fa78dc5eef2c2f485d343717cc27b893 class=lightbox-link><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-10.png alt="three charts" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fa78dc5eef2c2f485d343717cc27b893><img src=../ja/imt/dashboards/adding-charts/../../images/M-MoreCharts-10.png alt="three charts" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>次のモジュールでは、「説明」のメモを追加して、チャートを並べてみましょう！</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=ノートの追加とダッシュボードのレイアウト>ノートの追加とダッシュボードのレイアウト</h1><h2 id=1-メモの追加>1. メモの追加</h2><p>ダッシュボードには、ダッシュボードの利用者を支援するための短い「説明」ペインを配置することがよくあります。</p><p>ここでは、<span class="btn cstyle blue"><span><span class=title>New Text Note</span></span></span> ボタンをクリックして、ノートを追加してみましょう。</p><p><a href=#R-image-bb64003b474e93e3596ea2374d84f67b class=lightbox-link><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-0.png alt="three charts" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bb64003b474e93e3596ea2374d84f67b><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-0.png alt="three charts" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>すると、ノートエディターが開きます。</p><p><a href=#R-image-50a7c721ba66d0e24e29bd2e11e49e2b class=lightbox-link><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-1.png alt="Notes 1" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-50a7c721ba66d0e24e29bd2e11e49e2b><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-1.png alt="Notes 1" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ノートに単なるテキスト以外のものを追加できるように、Splunk ではこれらのノート/ペインで Markdown を使用できるようにしています。
Markdown は、ウェブページでよく使われるプレーンテキストを使ってフォーマットされたテキストを作成するための軽量なマークアップ言語です。</p><p>たとえば、以下のようなことができます (もちろん、それ以外にもいろいろあります)。</p><ul><li>ヘッダー (様々なサイズで)</li><li>強調スタイル</li><li>リストとテーブル</li><li>リンク: 外部の Web ページ (ドキュメントなど) や他の Splunk IM ダッシュボードへの直接リンクできます</li></ul><p>以下は、ノートで使用できる上記のMarkdownオプションの例です。</p><div class=tab-panel data-tab-group=b16ecd34ff6f291bc6ebc90814807c43><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=sample-markdown-text class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("b16ecd34ff6f291bc6ebc90814807c43","sample-markdown-text")'>
<span class=tab-nav-text>Sample Markdown text</span></button></div><div class=tab-content-container><div data-tab-item=sample-markdown-text class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># h1 Big headings
</span></span></span><span class=line><span class=cl><span class=gh></span>
</span></span><span class=line><span class=cl><span class=gu>###### h6 To small headings
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl><span class=gu>##### Emphasis
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl><span class=gs>**This is bold text**</span>, <span class=ge>*This is italic text*</span> , <span class=gd>~~Strikethrough~~</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>##### Lists
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>Unordered
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>+ Create a list by starting a line with <span class=sb>`+`</span>, <span class=sb>`-`</span>, or <span class=sb>`*`</span>
</span></span><span class=line><span class=cl><span class=k>-</span> Sub-lists are made by indenting 2 spaces:
</span></span><span class=line><span class=cl><span class=k>-</span> Marker character change forces new list start:
</span></span><span class=line><span class=cl>    <span class=k>*</span> Ac tristique libero volutpat at
</span></span><span class=line><span class=cl>    + Facilisis in pretium nisl aliquet
</span></span><span class=line><span class=cl><span class=k>*</span> Very easy!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ordered
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>1.</span> Lorem ipsum dolor sit amet
</span></span><span class=line><span class=cl><span class=k>2.</span> Consectetur adipiscing elit
</span></span><span class=line><span class=cl><span class=k>3.</span> Integer molestie lorem at massa
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>##### Tables
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>| Option | Description |
</span></span><span class=line><span class=cl>| ------ | ----------- |
</span></span><span class=line><span class=cl>| chart  | path to data files to supply the data that will be passed into templates. |
</span></span><span class=line><span class=cl>| engine | engine to be used for processing templates. Handlebars is the default. |
</span></span><span class=line><span class=cl>| ext    | extension to be used for dest files. |
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>#### Links
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>[<span class=nt>link to webpage</span>](<span class=na>https://www.splunk.com</span>)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[<span class=nt>link to dashboard with title</span>](<span class=na>https://app.eu0.signalfx.com/#/dashboard/EaJHrbPAEAA?groupId=EaJHgrsAIAA&amp;configId=EaJHsHzAEAA &#34;Link to the Sample chart Dashboard!&#34;</span>)</span></span></code></pre></div></div></div></div></div><p>上記をコピーボタンでコピーして、<em>Edit</em> ボックスにペーストしてみてください。
プレビューで、どのように表示されるか確認できます。</p><hr><h2 id=2-チャートの保存>2. チャートの保存</h2><p>ノートチャートに名前を付けます。この例では、<em>Example text chart</em> としました。そして、<span class="btn cstyle transparent"><span><span class=title>Save And Close</span></span></span> ボタンを押します。</p><p><a href=#R-image-00924da329e3b91278daa44e5b270fce class=lightbox-link><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-2.png alt="saving note" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-00924da329e3b91278daa44e5b270fce><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-2.png alt="saving note" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これでダッシュボードに戻ると、メモが追加されました。</p><p><a href=#R-image-6b09bba3024a591b62ec82403ca17e41 class=lightbox-link><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-3.png alt="three charts and note" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6b09bba3024a591b62ec82403ca17e41><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-3.png alt="three charts and note" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=3-チャートの順序や大きさを変更>3. チャートの順序や大きさを変更</h2><p>デフォルトのチャートの順番やサイズを変更したい場合は、ウィンドウをドラッグして、チャートを好きな場所に移動したり、サイズを変更したりすることができます。</p><p>チャートの <strong>上側の枠</strong> にマウスポインタを移動すると、マウスポインタがドラッグアイコンに変わります。これで、チャートを任意の場所にドラッグすることができます。</p><p><a href=#R-image-34cf6fb311a541dc48e23f7afe264df5 class=lightbox-link><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-4.png alt=Dragging class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-34cf6fb311a541dc48e23f7afe264df5><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-4.png alt=Dragging class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ここでは、 <strong>Latency vs Load</strong> チャートを <strong>Latency History</strong> と <strong>Example text chart</strong> の間に移動してください。</p><p><a href=#R-image-5bfee6825e58d4b576e912edbdddfab3 class=lightbox-link><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-5.png alt=sizing class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5bfee6825e58d4b576e912edbdddfab3><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-5.png alt=sizing class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>チャートのサイズを変更するには、側面または底面をドラッグします。</p><p>最後の練習として、ノートチャートの幅を他のチャートの3分の1程度にしてみましょう。チャートは自動的に、サポートしているサイズの1つにスナップします。他の3つのチャートの幅を、ダッシュボードの約3分の1にします。ノートを他のチャートの左側にドラッグして、他の23個のチャートに合わせてサイズを変更します。</p><p>最後に、時間を -1h に設定すると、以下のようなダッシュボードになります。</p><p><a href=#R-image-f768352a6c26c3184d147c1ed77f7798 class=lightbox-link><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-6.png alt=TaDA! class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f768352a6c26c3184d147c1ed77f7798><img src=../ja/imt/dashboards/notes-and-layout/../../images/M-Notes-6.png alt=TaDA! class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>次は、ディテクターの登場です！</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=ディテクターを利用する>ディテクターを利用する</h1><span class="btn cstyle transparent"><span><i class="fa-fw fas fa-clock"></i> <span class=title>10 分</span></span></span><ul><li>チャートからディテクターを作成する</li><li>アラート条件を設定する</li><li>プリフライトチェックを実行する</li><li>ミューティングルールを設定する</li></ul><hr><h2 id=1-はじめに>1. はじめに</h2><p>Splunk Observability Cloud では、ディテクター（検出器）、イベント、アラート、通知を使用して、特定の条件が満たされたときに情報を提供することができます。たとえば、CPU使用率が95%に達したときや、同時ユーザー数が制限値に近づいてAWSインスタンスを追加で立ち上げなければならない可能性があるときに、Slack チャンネルや Ops チームのメールアドレスにメッセージを送信したいと考えるでしょう。</p><p>これらの条件は1つまたは複数のルールとして表現され、ルール内の条件が満たされたときにアラートが発生します。ディテクターに含まれる個々のルールは、重要度に応じてラベル付けされています。Info、Warning、Minor、Major、Criticalとなっています。</p><h2 id=2-ディテクターの作成>2. ディテクターの作成</h2><p><strong>Dashboards</strong> で、前のモジュールで作成した <strong>Custom Dashboard Group</strong> をクリックし、ダッシュボードの名前をクリックします。</p><p><a href=#R-image-e9eaac9e5728a4ec79ddd30b021f5f6a class=lightbox-link><img src=../ja/imt/detectors/../images/custom-dashboard-group.png alt="Custom Dashboard Group" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e9eaac9e5728a4ec79ddd30b021f5f6a><img src=../ja/imt/detectors/../images/custom-dashboard-group.png alt="Custom Dashboard Group" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>このチャートから、新しいディテクターを作成していきます。<strong>Latency vs Load</strong> チャート上のベルのアイコンをクリックし、 <strong>New Detector From Chart</strong> をクリックします。</p><p><a href=#R-image-7eed86c9b8cf2e886e83a8a6379dd120 class=lightbox-link><img src=../ja/imt/detectors/../images/new-detector.png alt="New Detector" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7eed86c9b8cf2e886e83a8a6379dd120><img src=../ja/imt/detectors/../images/new-detector.png alt="New Detector" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Detector Name</strong> の横にあるテキストフィールドで、提案されたディテクター名の最初に、<strong>あなたのイニシャル</strong> を追加してください。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> ディテクターの名前を決める</div><div class=box-content><p>提案されたディテクター名の前に自分のイニシャルを追加することをお忘れなく。</p><p>次のような名前にしてください: <strong>XY&rsquo;s Latency Chart Detector</strong></p></div></div><p>Click on <span class="btn cstyle blue"><span><span class=title>Create Alert Rule</span></span></span></p><p><a href=#R-image-b7497f28020edbee28cd68632127e5a2 class=lightbox-link><img src=../ja/imt/detectors/../images/create-alert-rule.png alt="Create Alert Rule" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b7497f28020edbee28cd68632127e5a2><img src=../ja/imt/detectors/../images/create-alert-rule.png alt="Create Alert Rule" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Detector ウィンドウの <strong>Alert signal</strong> の中で、アラートするシグナルは <strong>Alert on</strong> 欄に青のベルが表示されています。このベルは、どのシグナルがアラートの生成に使用されているかを示しています。</p><p>Click on <span class="btn cstyle blue"><span><span class=title>Proceed to Alert Condition</span></span></span></p><p><a href=#R-image-9fcc372125a3f1c4031a386b25240045 class=lightbox-link><img src=../ja/imt/detectors/../images/alert-signal.png alt="Alert Signal" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9fcc372125a3f1c4031a386b25240045><img src=../ja/imt/detectors/../images/alert-signal.png alt="Alert Signal" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-アラート条件の設定>3. アラート条件の設定</h2><p><strong>Alert condition</strong> で、<strong>Static Threshold</strong> をクリックし、<span class="btn cstyle blue"><span><span class=title>Proceed to Alert Settings</span></span></span> をクリックしてください。</p><p><a href=#R-image-1e056565603cbb56200d33451b66e63c class=lightbox-link><img src=../ja/imt/detectors/../images/alert-condition.png alt="Alert Condition" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1e056565603cbb56200d33451b66e63c><img src=../ja/imt/detectors/../images/alert-condition.png alt="Alert Condition" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Alert Settings</strong> で、 <strong>Threshold</strong> フィールドに値 <strong><code>290</code></strong> を入力します。同じウィンドウで、右上の <strong>Time</strong> を過去1日（<strong>-1d</strong>）に変更します。</p><h2 id=4-プリフライトチェックの警告>4. プリフライトチェックの警告</h2><p>5秒後にプリフライトチェックが行われます。<strong>Estimated alert count</strong> に、アラート回数の目安が表示されます。現在のアラート設定では、1日に受信するアラート量は <strong>3</strong> となります。</p><p><a href=#R-image-0bb3e0799058c8a5fb4dee3ff6a41534 class=lightbox-link><img src=../ja/imt/detectors/../images/alert-threshold.png alt="Alert Threshold" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0bb3e0799058c8a5fb4dee3ff6a41534><img src=../ja/imt/detectors/../images/alert-threshold.png alt="Alert Threshold" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> プリフライトチェックについて</div><div class=box-content><p>アラート条件を設定すると、UIは現在の設定に基づいて、右上に設定された時間枠（ここでは過去1日）の中で、どのくらいのアラートが発生するかを予測します。</p><p>すぐに、プラットフォームは現在の設定でシグナルの分析を開始し、「プリフライトチェック」と呼ばれる作業を行います。これにより、プラットフォーム内の過去のデータを使用してアラート条件をテストし、設定が妥当であり、誤って大量のアラートを発生させないようにすることができます。Splunk Observability Cloud を使用してのみ利用できるシンプルかつ非常に強力な方法で、アラートの設定から推測作業を取り除くことができます。</p><p>ディテクターのプレビューについての詳細は、こちらのリンクをご覧ください。
<a href=https://docs.splunk.com/Observability/alerts-detectors-notifications/preview-detector-alerts.html#nav-Preview-detector-alerts target=_blank>Preview detector alerts</a></p></div></div><p><span class="btn cstyle blue"><span><span class=title>Proceed to Alert Message</span></span></span> をクリックし、次に進みます。</p><h2 id=5-アラートメッセージ>5. アラートメッセージ</h2><p><strong>Alert message</strong> の <strong>Severity</strong> で <strong>Major</strong> を選択します。</p><p><a href=#R-image-d62b0cac5ea89d7b28b04dd17652838e class=lightbox-link><img src=../ja/imt/detectors/../images/alert-message.png alt="Alert Message" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d62b0cac5ea89d7b28b04dd17652838e><img src=../ja/imt/detectors/../images/alert-message.png alt="Alert Message" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><span class="btn cstyle blue"><span><span class=title>Proceed to Alert Recipients</span></span></span> をクリックします。</p><p><strong>Add Recipient</strong>（受信者の追加）をクリックし、最初の選択肢として表示されているメールアドレスをクリックします。</p><p><a href=#R-image-2d56e557223b95b834ced7b9a196b939 class=lightbox-link><img src=../ja/imt/detectors/../images/add-recipient.png alt="Add Recipient" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2d56e557223b95b834ced7b9a196b939><img src=../ja/imt/detectors/../images/add-recipient.png alt="Add Recipient" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> 通知サービス</div><div class=box-content><p>これは、そのメールアドレスを入力したときと同じです。または、<strong>E-mail&mldr;</strong> をクリックして別のメールアドレスを入力することもできます。</p><p>これは、予め用意されている多くの <strong>Notification Services</strong> の一例です。全てを確認するには、トップメニューの <strong>Integrations</strong> タブに移動し、<strong>Notification Services</strong> を参照してください。</p></div></div><h2 id=6-アラートの有効化>6. アラートの有効化</h2><p><span class="btn cstyle blue"><span><span class=title>Proceed to Alert Activation</span></span></span> をクリックします。</p><p><strong>Activivate&mldr;</strong> で <span class="btn cstyle blue"><span><span class=title>Activate Alert Rule</span></span></span> をクリックします。</p><p><a href=#R-image-407f884913ea096c5d3c1f48ff4c763e class=lightbox-link><img src=../ja/imt/detectors/../images/activate-alert.png alt="Activate Alert" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-407f884913ea096c5d3c1f48ff4c763e><img src=../ja/imt/detectors/../images/activate-alert.png alt="Activate Alert" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>アラートをより早く取得したい場合は、<strong>Alert Settings</strong> をクリックして、値を <strong><code>290</code></strong> から <strong><code>280</code></strong> に下げてみてください。</p><p><strong>Time</strong> を <strong>-1h</strong> に変更すると、過去1時間のメトリクスに基づいて、選択した閾値でどれだけのアラートを取得できるかを確認できます。</p><p>ナビバーにある <a href=#R-image-a0ae41da07dec1807b050cdf743a410c class=lightbox-link><img src=../ja/imt/detectors/../images/alerts-and-detectors.png alt="alerts and detectors button" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a0ae41da07dec1807b050cdf743a410c><img src=../ja/imt/detectors/../images/alerts-and-detectors.png alt="alerts and detectors button" class="lightbox-image noborder lightbox noshadow" loading=lazy></a> ボタンをクリックして、その後 <strong>Detectors</strong> をクリックすると、ディテクターの一覧が表示されます。あなたのイニシャルでフィルタして、作成したディテクターを確認しましょう。表示されない場合は、ブラウザをリロードしてみてください。</p><p><a href=#R-image-8a24e76deb4de0a4eff62d71f8c7ce7e class=lightbox-link><img src=../ja/imt/detectors/../images/detectors.png alt="Detector List" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8a24e76deb4de0a4eff62d71f8c7ce7e><img src=../ja/imt/detectors/../images/detectors.png alt="Detector List" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>おめでとうございます！</strong> 最初のディテクターが作成され、有効化されました。</p><footer class=footline></footer></article><section><h1 class=a11y-only>ディテクターを利用するのサブセクション</h1><article class=default><header class=headline></header><h1 id=ミューティングルールを利用する>ミューティングルールを利用する</h1><ul><li>ミューティングルールを設定する</li><li>通知を再開する</li></ul><hr><h2 id=1-ミューティングルールの設定>1. ミューティングルールの設定</h2><p>特定の通知をミュートする必要がある場合があります。例えば、サーバーやサーバー群のメンテナンスのためにダウンタイムを設定したい場合や、新しいコードや設定をテストしている場合などがあります。このような場合には、Splunk Observability Cloud でミューティングルールを使用できます。それでは作成してみましょう。</p><p>ナビバーにある <a href=#R-image-68ab91735df90c3391f714f09e39e988 class=lightbox-link><img src="../ja/imt/detectors/muting/../../images/alerts-and-detectors.png?classes=inline&amp;height=25px" alt="alerts and detectors" class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-68ab91735df90c3391f714f09e39e988><img src="../ja/imt/detectors/muting/../../images/alerts-and-detectors.png?classes=inline&amp;height=25px" alt="alerts and detectors" class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> ボタンをクリックし、<strong>Detectors</strong> を選択します。現在設定されているディテクターの一覧が表示されます。フィルタを使ってディテクターを探すこともできます。</p><p><a href=#R-image-023f81277e42913a292f74619c4b49bd class=lightbox-link><img src=../ja/imt/detectors/muting/../../images//detectors.png alt="detectors list" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-023f81277e42913a292f74619c4b49bd><img src=../ja/imt/detectors/muting/../../images//detectors.png alt="detectors list" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Creating a Detector</strong> でディテクターを作成した場合は、右端の3つの点 <strong><code>...</code></strong> をクリックすると、そのディテクターが表示されます。</p><p>ドロップダウンから <strong>Create Muting Rule&mldr;</strong> をクリックします。</p><p><a href=#R-image-01cf7ba3f33dcca718334f99c70ea419 class=lightbox-link><img src=../ja/imt/detectors/muting/../../images/create-muting-rule.png alt="Create Muting Rule" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-01cf7ba3f33dcca718334f99c70ea419><img src=../ja/imt/detectors/muting/../../images/create-muting-rule.png alt="Create Muting Rule" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Muting Rule</strong> ウィンドウで、 <strong>Mute Indefinitely</strong> をチェックし、理由を入力します。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Important</div><div class=box-content><p>この操作をすると、ここに戻ってきてこのボックスのチェックを外すか、このディテクターの通知を再開するまで、通知が永久的にミュートされます。</p></div></div><p><a href=#R-image-b1ff5d1261e08c12cadda4a88fe59773 class=lightbox-link><img src=../ja/imt/detectors/muting/../../images//mute-indefinitely.png alt="Mute Indefinitely" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b1ff5d1261e08c12cadda4a88fe59773><img src=../ja/imt/detectors/muting/../../images//mute-indefinitely.png alt="Mute Indefinitely" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Next</strong> をクリックして、新しいモーダルウィンドウでミュートルールの設定を確認します。</p><p><a href=#R-image-624c8510cb8deb799ffc617a0b17515d class=lightbox-link><img src=../ja/imt/detectors/muting/../../images//confirm-rule.png alt="Confirm Rule" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-624c8510cb8deb799ffc617a0b17515d><img src=../ja/imt/detectors/muting/../../images//confirm-rule.png alt="Confirm Rule" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><span class="btn cstyle blue"><span><span class=title>Mute Indefinitely</span></span></span> をクリックして、設定を確定させます。</p><p><a href=#R-image-b0e93edda1f0dc01abe2434b53b8b565 class=lightbox-link><img src=../ja/imt/detectors/muting/../../images/alert-muted.png alt="List muted rule" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b0e93edda1f0dc01abe2434b53b8b565><img src=../ja/imt/detectors/muting/../../images/alert-muted.png alt="List muted rule" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これで、通知を再開するまで、ディテクターからのEメール通知は受け取ることがなくなりました。では、再開する方法を見てみましょう。</p><hr><h2 id=2-通知を再開する>2. 通知を再開する</h2><p><strong>Muting Rules</strong> をクリックして、<strong>Detector</strong> の見出しの下に、通知をミュートしたディテクターの名前が表示されます。</p><p>右端にあるドット <strong><code>...</code></strong> を開いて、<strong>Resume Notifications</strong> をクリックします。</p><p><a href=#R-image-c2484f0da1a559341a22553af5c49b95 class=lightbox-link><img src=../ja/imt/detectors/muting/../../images//muting-list.png alt=Resume class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c2484f0da1a559341a22553af5c49b95><img src=../ja/imt/detectors/muting/../../images//muting-list.png alt=Resume class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><span class="btn cstyle blue"><span><span class=title>Resume</span></span></span> をクリックして、このディテクターの通知を確認し、再開します。</p><p><a href=#R-image-8d786524a0e929702a536567b4c26a25 class=lightbox-link><img src=../ja/imt/detectors/muting/../../images//resume.png alt=Resume class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8d786524a0e929702a536567b4c26a25><img src=../ja/imt/detectors/muting/../../images//resume.png alt=Resume class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>おめでとうございます！</strong> これでアラート通知が再開されました。</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=monitoring-as-code>Monitoring as Code</h1><span class="btn cstyle transparent"><span><i class="fa-fw fas fa-clock"></i> <span class=title>10分</span></span></span><ul><li>Terraform<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> を使用して Observability Cloud のダッシュボードとディテクターを管理します。</li><li>Terraform のSplunk Provider<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> を初期化します</li><li>Terraformを実行して、Splunk Terraform Provider を使用してコードからディテクターとダッシュボードを作成します。</li><li>Terraformでディテクターやダッシュボードを削除する方法を確認します。</li></ul><hr><h2 id=1-初期設定>1. 初期設定</h2><p>Monitoring as Codeは、infrastructure as Codeと同じアプローチを採用しています。アプリケーション、サーバー、その他のインフラコンポーネントと同じようにモニタリングを管理できます。</p><p>Monitoring as Codeでは、可視化したり、何を監視するか定義したり、いつアラートを出すかなどを管理します。つまり、監視設定、プロセス、ルールをバージョン管理、共有、再利用することができます。</p><p>Splunk Terraform Providerの完全なドキュメントは<a href=https://registry.terraform.io/providers/splunk-terraform/signalfx/latest/docs target=_blank>こちら</a>にあります。</p><p>AWS/EC2 インスタンスにログインして、<code>o11y-cloud-jumpstart</code> ディレクトリに移動します</p><div class=tab-panel data-tab-group=6d95436b522cfe9c67aed08f546841f8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=change-directory class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("6d95436b522cfe9c67aed08f546841f8","change-directory")'>
<span class=tab-nav-text>Change directory</span></button></div><div class=tab-content-container><div data-tab-item=change-directory class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> observability-content-contrib/integration-examples/terraform-jumpstart</span></span></code></pre></div></div></div></div></div><p>必要な環境変数は、<a href=../ja/imt/gdi/index.html#2-helmによるインストール>Helmによるインストール</a> ですでに設定されているはずです。そうでない場合は、以下の Terraform のステップで使用するために、以下の環境変数を作成してください。</p><div class=tab-panel data-tab-group=25ffd4e6fee15c55a5f87f063129584d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=export-access-token class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("25ffd4e6fee15c55a5f87f063129584d","export-access-token")'>
<span class=tab-nav-text>Export ACCESS TOKEN</span></button></div><div class=tab-content-container><div data-tab-item=export-access-token class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span><span class=s2>&#34;&lt;replace_with_O11y-Workshop-ACCESS_TOKEN&gt;&#34;</span></span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=8ff6eaf7787cbd57316e3070500529d9><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=export-realm class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8ff6eaf7787cbd57316e3070500529d9","export-realm")'>
<span class=tab-nav-text>Export REALM</span></button></div><div class=tab-content-container><div data-tab-item=export-realm class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span><span class=s2>&#34;&lt;replace_with_REALM&gt;&#34;</span></span></span></code></pre></div></div></div></div></div><p>Terraform を初期化し、Splunk Terraform Provider を最新版にアップグレードします。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note: SignalFx Terraform Provider のアップグレード</div><div class=box-content><p>Splunk Terraform Provider の新バージョンがリリースされるたびに、以下のコマンドを実行する必要があります。リリース情報は <a href=https://github.com/splunk-terraform/terraform-provider-signalfx/releases target=_blank>GitHub</a> で確認できます。</p></div></div><div class=tab-panel data-tab-group=7109f0e09bf2b0a0e5bf2ffc939845f0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=initialise-terraform class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("7109f0e09bf2b0a0e5bf2ffc939845f0","initialise-terraform")'>
<span class=tab-nav-text>Initialise Terraform</span></button>
<button data-tab-item=initialise-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7109f0e09bf2b0a0e5bf2ffc939845f0","initialise-output")'>
<span class=tab-nav-text>Initialise Output</span></button></div><div class=tab-content-container><div data-tab-item=initialise-terraform class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform init -upgrade</span></span></code></pre></div></div></div><div data-tab-item=initialise-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>    Upgrading modules...
</span></span><span class=line><span class=cl>    - aws in modules/aws
</span></span><span class=line><span class=cl>    - azure in modules/azure
</span></span><span class=line><span class=cl>    - docker in modules/docker
</span></span><span class=line><span class=cl>    - gcp in modules/gcp
</span></span><span class=line><span class=cl>    - host in modules/host
</span></span><span class=line><span class=cl>    - kafka in modules/kafka
</span></span><span class=line><span class=cl>    - kubernetes in modules/kubernetes
</span></span><span class=line><span class=cl>    - parent_child_dashboard in modules/dashboards/parent
</span></span><span class=line><span class=cl>    - pivotal in modules/pivotal
</span></span><span class=line><span class=cl>    - rum_and_synthetics_dashboard in modules/dashboards/rum_and_synthetics
</span></span><span class=line><span class=cl>    - usage_dashboard in modules/dashboards/usage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Initializing the backend...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Initializing provider plugins...
</span></span><span class=line><span class=cl>    - Finding latest version of splunk-terraform/signalfx...
</span></span><span class=line><span class=cl>    - Installing splunk-terraform/signalfx v6.20.0...
</span></span><span class=line><span class=cl>    - Installed splunk-terraform/signalfx v6.20.0 (self-signed, key ID CE97B6074989F138)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Partner and community providers are signed by their developers.
</span></span><span class=line><span class=cl>    If you&#39;d like to know more about provider signing, you can read about it here:
</span></span><span class=line><span class=cl>    https://www.terraform.io/docs/cli/plugins/signing.html
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Terraform has created a lock file .terraform.lock.hcl to record the provider
</span></span><span class=line><span class=cl>    selections it made above. Include this file in your version control repository
</span></span><span class=line><span class=cl>    so that Terraform can guarantee to make the same selections by default when
</span></span><span class=line><span class=cl>    you run &#34;terraform init&#34; in the future.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Terraform has been successfully initialized!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    You may now begin working with Terraform. Try running &#34;terraform plan&#34; to see
</span></span><span class=line><span class=cl>    any changes that are required for your infrastructure. All Terraform commands
</span></span><span class=line><span class=cl>    should now work.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    If you ever set or change modules or backend configuration for Terraform,
</span></span><span class=line><span class=cl>    rerun this command to reinitialize your working directory. If you forget, other
</span></span><span class=line><span class=cl>    commands will detect it and remind you to do so if necessary.</span></span></code></pre></div></div></div></div></div><h2 id=2-プランの作成>2. プランの作成</h2><p><code>terraform plan</code> コマンドで、実行計画を作成します。デフォルトでは、プランの作成は以下のように構成されています。</p><ul><li>既に存在するリモートオブジェクトの現在の状態を読み込み、Terraform の状態が最新であることを確認します</li><li>現在の設定を以前の状態と比較し、相違点を抽出します</li><li>適用された場合にリモートオブジェクトと設定とを一致させるための、一連の変更アクションを提案します</li></ul><p>plan コマンドだけでは、提案された変更を実際に実行はされなません。変更を適用する前に、以下のコマンドを実行して、提案された変更が期待したものと一致するかどうかを確認しましょう。</p><div class=tab-panel data-tab-group=f731072f3880a5e2f30c87200f857671><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=execution-plan class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("f731072f3880a5e2f30c87200f857671","execution-plan")'>
<span class=tab-nav-text>Execution Plan</span></button>
<button data-tab-item=execution-plan-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("f731072f3880a5e2f30c87200f857671","execution-plan-output")'>
<span class=tab-nav-text>Execution Plan Output</span></button></div><div class=tab-content-container><div data-tab-item=execution-plan class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform plan -var<span class=o>=</span><span class=s2>&#34;access_token=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;o11y_prefix=[</span><span class=k>$(</span>hostname<span class=k>)</span><span class=s2>]&#34;</span></span></span></code></pre></div></div></div><div data-tab-item=execution-plan-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Plan: 146 to add, 0 to change, 0 to destroy.</span></span></code></pre></div></div></div></div></div><p>プランが正常に実行されれば、そのまま apply することができます。</p><hr><h2 id=3-プランの適用>3. プランの適用</h2><p><code>terraform apply</code> コマンドは、上記の Terraform プランで提案されたアクションを実行します。</p><p>この場合、新しい実行プランが自動的に作成され（<code>terraform plan</code>を実行したときと同様です）、指示されたアクションを実行する前にAccess Token、Realm（プレフィックスのデフォルトは<code>Splunk</code>）の提供とプランの承認を求められます。</p><p>このワークショップでは、プレフィックスがユニークである必要があります。以下の <code>terraform apply</code> を実行してください。</p><div class=tab-panel data-tab-group=8484ce0ea2d19b96f4a52e44fe66f4dd><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=apply-plan class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8484ce0ea2d19b96f4a52e44fe66f4dd","apply-plan")'>
<span class=tab-nav-text>Apply Plan</span></button>
<button data-tab-item=apply-plan-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("8484ce0ea2d19b96f4a52e44fe66f4dd","apply-plan-output")'>
<span class=tab-nav-text>Apply Plan Output</span></button></div><div class=tab-content-container><div data-tab-item=apply-plan class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform apply -var<span class=o>=</span><span class=s2>&#34;access_token=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;o11y_prefix=[</span><span class=k>$(</span>hostname<span class=k>)</span><span class=s2>]&#34;</span></span></span></code></pre></div></div></div><div data-tab-item=apply-plan-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Apply complete! Resources: 146 added, 0 changed, 0 destroyed.</span></span></code></pre></div></div></div></div></div><p>適用が完了したら、 <strong>Alerts → Detectors</strong> でディテクターが作成されたことを確認してください。ディテクターのプレフィックスには、インスタンスのホスト名が入ります。プレフィックスの値を確認するには以下を実行してください。</p><div class=tab-panel data-tab-group=ef11fae95981b3d50ebed16675ee400c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=echo-hostname class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("ef11fae95981b3d50ebed16675ee400c","echo-hostname")'>
<span class=tab-nav-text>Echo Hostname</span></button></div><div class=tab-content-container><div data-tab-item=echo-hostname class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=k>$(</span>hostname<span class=k>)</span></span></span></code></pre></div></div></div></div></div><p>新しいディテクターのリストが表示され、上から出力されたプレフィックスを検索することができます。</p><p><a href=#R-image-ddbfa302d81058b621072b075c2e3a67 class=lightbox-link><img src=../ja/imt/monitoring-as-code/../images/detectors.png alt=Detectors class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ddbfa302d81058b621072b075c2e3a67><img src=../ja/imt/monitoring-as-code/../images/detectors.png alt=Detectors class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=4-苦労して作ったもの全てを壊す>4. 苦労して作ったもの全てを壊す</h2><p><code>terraform destroy</code> コマンドは、Terraform の設定で管理されているすべてのリモートオブジェクトを破壊する便利な方法です。</p><p>通常、本番環境では長期保存可能なオブジェクトを破棄することはありませんが、Terraformでは開発目的で一時的なインフラを管理するために使用されることがあり、その場合は作業が終わった後に <code>terraform destroy</code> を実行して、一時的なオブジェクトをすべてクリーンアップすることができます。</p><p>それでは、ここまでで適用したダッシュボードとディテクターを全て破壊しましょう！</p><div class=tab-panel data-tab-group=78e9867fb5074fb02a35caec6b7f0a3d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=destroy class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("78e9867fb5074fb02a35caec6b7f0a3d","destroy")'>
<span class=tab-nav-text>Destroy</span></button>
<button data-tab-item=destroy-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("78e9867fb5074fb02a35caec6b7f0a3d","destroy-output")'>
<span class=tab-nav-text>Destroy Output</span></button></div><div class=tab-content-container><div data-tab-item=destroy class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform destroy -var<span class=o>=</span><span class=s2>&#34;access_token=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span></span></span></code></pre></div></div></div><div data-tab-item=destroy-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Destroy complete! Resources: 146 destroyed.</span></span></code></pre></div></div></div></div></div><p><em><strong>Alerts → Detectors</strong></em> に移動して、すべてのディテクターが削除されたことを確認してください。</p><p><a href=#R-image-22dddc263fb4a0b26abb54327b4607cc class=lightbox-link><img src=../ja/imt/monitoring-as-code/../images/destroy.png alt=Destroyed class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-22dddc263fb4a0b26abb54327b4607cc><img src=../ja/imt/monitoring-as-code/../images/destroy.png alt=Destroyed class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Terraform は、インフラを安全かつ効率的に構築、変更、バージョン管理するためのツールです。Terraform は、既存の一般的なサービスプロバイダーだけでなく、様々なカスタムソリューションも管理できます。</p><p>Terraform の設定ファイルには、単一のアプリケーションまたはデータセンター全体を実行するために必要なコンポーネントをに記述します。Terraform はそれを受けて、望ましい状態に到達するために何をするかを記述した実行プランを生成し、記述されたインフラを構築するために実行します。設定が変更されても、Terraform は何が変更されたかを判断し、差分の実行プランを作成して適用することができます。</p><p>Terraform が管理できるインフラには、計算機インスタンス、ストレージ、ネットワークなどのローレベルのコンポーネントや、DNSエントリ、SaaS機能などのハイレベルのコンポーネントが含まれます。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>プロバイダーは、APIのインタラクションを理解し、リソースを公開する責務があります。一般的にプロバイダーは、IaaS（Alibaba Cloud、AWS、GCP、Microsoft Azure、OpenStackなど）、PaaS（Herokuなど）、またはSaaSサービス（Splunk、Terraform Cloud、DNSimple、Cloudflareなど）があります。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=管理機能>管理機能</h1><span class="btn cstyle transparent"><span><i class="fa-fw fas fa-clock"></i> <span class=title>10分</span></span></span><ul><li>組織におけるObservability Cloudの利用状況を把握する</li><li>Subscription Usage（サブスクリプション使用量）インターフェースを使って、使用量を追跡する</li><li>チームを作成する</li><li>チームへの通知ルールを管理する</li><li>使用量をコントロールする</li></ul><hr><h2 id=1-利用状況を把握する>1. 利用状況を把握する</h2><p>組織内のObservability Cloudのエンゲージメントを完全に把握するには、左下 <strong>&#187;</strong> を開き、<strong>Settings → Organization Overview</strong> を選択すると、Observability Cloud の組織がどのように使用されているかを示す以下のダッシュボードが表示されます。</p><p><a href=#R-image-8919fc47f4b375abc3dca87edee6e40c class=lightbox-link><img src=../ja/imt/servicebureau/../images/engagement.png alt="Organization overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8919fc47f4b375abc3dca87edee6e40c><img src=../ja/imt/servicebureau/../images/engagement.png alt="Organization overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>左側のメニューには、メンバーのリストが表示され、右側には、ユーザー数、チーム数、チャート数、ダッシュボード数、ダッシュボードグループの作成数、様々な成長傾向を示すチャートが表示されます。</p><p>現在お使いのワークショップ組織では、ワークショップごとにデータが消去されるため、作業できるデータが少ないかもしれません。</p><p>このワークショップインスタンスの Organization Overview にある様々なチャートをじっくりとご覧ください。</p><h2 id=2-subscription-usage>2. Subscription Usage</h2><p>契約に対する使用量を確認したい場合は、 <strong>Subscription Usage</strong> を選択します。</p><p><a href=#R-image-231605752d7d2a999cc598bae4501008 class=lightbox-link><img src=../ja/imt/servicebureau/../images/billing-and-usage-menu.png alt="Left pane" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-231605752d7d2a999cc598bae4501008><img src=../ja/imt/servicebureau/../images/billing-and-usage-menu.png alt="Left pane" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>この画面では、使用量を計算して取り込むため、読み込みに数秒かかることがあります。</p><h2 id=3-使用量を理解する>3. 使用量を理解する</h2><p>下図のような画面が表示され、現在の使用量、平均使用量、およびホスト、コンテナ、カスタムメトリクス、高解像度メトリクスの各カテゴリごとの権利の概要が表示されます。</p><p>これらのカテゴリの詳細については、<a href=https://docs.splunk.com/Observability/admin/imm-billing-usage/monitor-imm-billing-usage.html target=_blank>Monitor Splunk Infrastructure Monitoring subscription usage</a> を参照してください。</p><p><a href=#R-image-fe86551af5650f1b6f45e67d3b6b68f2 class=lightbox-link><img src=../ja/imt/servicebureau/../images/usage-charts.png alt="Billing and Usage" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fe86551af5650f1b6f45e67d3b6b68f2><img src=../ja/imt/servicebureau/../images/usage-charts.png alt="Billing and Usage" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=4-使用状況を詳しく調べる>4. 使用状況を詳しく調べる</h2><p>一番上のチャートには、カテゴリーごとの現在のサブスクリプションレベルが表示されます（下のスクリーンショットでは、上部の赤い矢印で表示されています）。</p><p>また、4つのカテゴリーの現在の使用状況も表示されます（チャート下部の赤い線で示されています）。</p><p>この例では、「ホスト」が25個、「コンテナ」が0個、「カスタムメトリクス」が100個、「高解像度メトリクス」が0個であることがわかります。</p><p><a href=#R-image-4671706e932554ab37ae6195994bfffb class=lightbox-link><img src=../ja/imt/servicebureau/../images/usage-detail.png alt="Billing and Usage-top" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4671706e932554ab37ae6195994bfffb><img src=../ja/imt/servicebureau/../images/usage-detail.png alt="Billing and Usage-top" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>下のグラフでは、現在の期間のカテゴリごとの使用量が表示されています（グラフの右上のドロップダウンボックスに表示されています）。</p><p><strong>Average Usage</strong> と書かれた青い線は、Observability Cloudが現在のサブスクリプション期間の平均使用量を計算するために使用するものを示しています。</p><p><a href=#R-image-d492d5b9c132df911a08d95be5f0c695 class=lightbox-link><img src=../ja/imt/servicebureau/../images/usage-trends.png alt="Billing and Usage-Bottom" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d492d5b9c132df911a08d95be5f0c695><img src=../ja/imt/servicebureau/../images/usage-trends.png alt="Billing and Usage-Bottom" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>スクリーンショットからわかるように、Observability Cloudはコスト計算には最大値や95パーセンタイル値ではなく、実際の平均時間使用量を使用しています。これにより、超過料金のリスクなしに、パフォーマンステストやBlue/Greenスタイルのデプロイメントなどを行うことができます。</p></div></div><p>オプションを確認するには、左の <strong>Usage Metric</strong> ドロップダウンから異なるオプションを選択して表示するメトリックを変更するか、右のドロップダウンで <strong>Billing Period</strong> を変更します。</p><p>また、右側のドロップダウンでサブスクリプション期間を変更することもできます。</p><p>最後に、右側のペインには、お客様のサブスクリプションに関する情報が表示されます。</p><p><a href=#R-image-8d1b843565a0ba3ea725e399c2d0d544 class=lightbox-link><img src=../ja/imt/servicebureau/../images/subscription.png alt="Billing and Usage-Pane" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8d1b843565a0ba3ea725e399c2d0d544><img src=../ja/imt/servicebureau/../images/subscription.png alt="Billing and Usage-Pane" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>管理機能のサブセクション</h1><article class=default><header class=headline></header><h1 id=チーム>チーム</h1><ul><li>チームの管理</li><li>チームの作成とメンバーの追加</li></ul><hr><h2 id=1-チームの管理>1. チームの管理</h2><p>Observability Cloudを使用する際に、ユーザーに関連するダッシュボードやアラートが表示されるようにするために、ほとんどの組織ではObservability Cloudのチーム機能を使用して、メンバーを1つまたは複数のチームに割り当てます。</p><p>これは、仕事に関連した役割と一致するのが理想的で、たとえば、DevOpsグループやプロダクトマネジメントグループのメンバーは、Observability Cloudの対応するチームに割り当てられます。</p><p>ユーザーがObservability Cloudにログインすると、どのチームダッシュボードをホームページにするかを選択することができ、通常は自分の主な役割に応じたページを選択します。</p><p>以下の例では、ユーザーは開発、運用、プロダクトマネジメントの各チームのメンバーであり、現在は運用チームのダッシュボードを表示しています。</p><p>このダッシュボードには、NGINX、Infra、K8s用の特定のダッシュボード・グループが割り当てられていますが、どのダッシュボード・グループもチーム・ダッシュボードにリンクすることができます。</p><p>左上のメニューを使って割り当てられたチーム間を素早く移動したり、右側の <strong>ALL TEAMS</strong> ドロップダウンを使って特定のチームのダッシュボードを選択したり、隣のリンクを使って <strong>ALL Dashboards</strong> に素早くアクセスしたりすることができます。</p><p><a href=#R-image-b57c79d6f82717455ce7d646e24f87b3 class=lightbox-link><img src=../ja/imt/servicebureau/teams/../../images/teams-homepage.png alt=Teams class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b57c79d6f82717455ce7d646e24f87b3><img src=../ja/imt/servicebureau/teams/../../images/teams-homepage.png alt=Teams class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>アラートを特定のチームにリンクすることで、チームは関心のあるアラートだけをモニターすることができます。上記の例では、現在1つのアクティブなクリティカルアラートがあります。</p><p>チームダッシュボードの説明文はカスタマイズ可能で、チーム固有のリソースへのリンクを含むことができます（Markdownを使用します）。</p><h2 id=2-新しいチームの作成>2. 新しいチームの作成</h2><p>Splunk のチーム UI を使用するには、左下の <strong>&#187;</strong> を開き、 <strong>Settings → Teams</strong> を選択します。</p><p><strong>Team</strong> を選択すると、現在のチームのリストが表示されます。</p><p>新しいチームを追加するには、<span class="btn cstyle blue"><span><span class=title>Create New Team</span></span></span> ボタンをクリックします。これにより、<strong>Create New Team</strong> ダイアログが表示されます。</p><p><a href=#R-image-80fbe4e3f2c801f0cf2a529fd40b4207 class=lightbox-link><img src=../ja/imt/servicebureau/teams/../../images/create-new-team.png alt="Add Team" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-80fbe4e3f2c801f0cf2a529fd40b4207><img src=../ja/imt/servicebureau/teams/../../images/create-new-team.png alt="Add Team" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>独自のチームを作ってみましょう。チーム名を <code>[あなたのイニシャル]-Team</code> のように入力し、あなた自身のユーザー選んで、<strong>Add</strong> リンクからチームに追加してみましょう。上手くいくと、次のような表示になるはずです。</p><p><a href=#R-image-c89af4c5f472e1f008f97c4a00e81771 class=lightbox-link><img src=../ja/imt/servicebureau/teams/../../images/add-to-team.png alt="Add Team complete" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c89af4c5f472e1f008f97c4a00e81771><img src=../ja/imt/servicebureau/teams/../../images/add-to-team.png alt="Add Team complete" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>選択したユーザーを削除するには、<strong>Remove</strong> または <strong>x</strong> を押します。</p><p>自分のイニシャルでグループを作成し、自分がメンバーとして追加されていることを確認して、<span class="btn cstyle blue"><span><span class=title>Done</span></span></span> をクリックします。</p><p>これでチームリストに戻り、自分のチームと他の人が作成したチームが表示されます。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>自分がメンバーになっているチームには、グレーの <strong>Member</strong> アイコンが前に表示されています。</p></div></div><p>自分のチームにメンバーが割り当てられていない場合は、メンバー数の代わりに青い <strong>Add Members</strong> のリンクが表示されます。このリンクをクリックすると、<strong>Edit Team</strong> ダイアログが表示され、自分を追加することができます。</p><p>自分のチームの行末にある3つのドット <strong>&mldr;</strong> を押しても、<strong>Edit Team</strong> と同じダイアログが表示されます。</p><p><strong>&mldr;</strong> メニューでは、チームの編集、参加、離脱、削除を行うことができます（離脱と参加は、あなたが現在メンバーであるかどうかによって異なります）。</p><h2 id=3-通知ルールの追加>3. 通知ルールの追加</h2><p>チームごとに特定の通知ルールを設定することができます。<strong>Notification Policy</strong> タブをクリックすると、通知編集メニューが表示されます。</p><p><a href=#R-image-4d78e17bbde07f9b02c1a4336d5c0a08 class=lightbox-link><img src=../ja/imt/servicebureau/teams/../../images/notification-policy.png alt="Base notification menu" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4d78e17bbde07f9b02c1a4336d5c0a08><img src=../ja/imt/servicebureau/teams/../../images/notification-policy.png alt="Base notification menu" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>デフォルトでは、システムはチームの一般的な通知ルールを設定する機能を提供します。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p><strong>Email all team members</strong> オプションは、アラートの種類に関わらず、このチームのすべてのメンバーにアラート情報のメールが送信されることを意味します。</p></div></div><h3 id=31-受信者の追加>3.1 受信者の追加</h3><p><span class="btn cstyle blue"><span><span class=title>Add Recipient</span></span></span> をクリックすると、他の受信者を追加することができます。これらの受信者は Observability Cloud のユーザーである必要はありません。</p><p><strong>Configure separate notification tiers for different severity alerts</strong> をクリックすると、各アラートレベルを個別に設定できます。</p><p><a href=#R-image-c18311d37d41ebd84d91a985f3c56046 class=lightbox-link><img src=../ja/imt/servicebureau/teams/../../images/single-policy.png alt="Multiple Notifications" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c18311d37d41ebd84d91a985f3c56046><img src=../ja/imt/servicebureau/teams/../../images/single-policy.png alt="Multiple Notifications" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>上の画像のように、異なるアラートレベルに対して異なるアラートルールを設定することができます。</p><p>Critical と Major は <a href=https://www.splunk.com/ja_jp/observability/on-call.html target=_blank>Splunk On-Call</a> インシデント管理ソリューションを使用しています。Minor のアラートはチームの Slack チャンネルに送信し、Warning と Info はメールで送信する、という管理もできるようになります。</p><h3 id=32-通知機能の統合>3.2 通知機能の統合</h3><p>Observability Cloud では、アラート通知をメールで送信するだけでなく、以下のようなサービスにアラート通知を送信するように設定することができます。</p><p><a href=#R-image-974f3dfdc9ab85ea9acb5462ed5a5382 class=lightbox-link><img src=../ja/imt/servicebureau/teams/../../images/integrations.png alt="Notifications options" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-974f3dfdc9ab85ea9acb5462ed5a5382><img src=../ja/imt/servicebureau/teams/../../images/integrations.png alt="Notifications options" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>チームの事情に合わせて、通知ルールを作成してください。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=使用量を管理する>使用量を管理する</h1><ul><li>個別のアクセストークンを作成し、制限を設けることで利用を制限する方法を紹介します</li></ul><h2 id=1-アクセストークン>1. アクセストークン</h2><p>ホスト、コンテナ、カスタムメトリクス、高解像度メトリクスの使用量をコントロールしたい場合は、複数のアクセストークンを作成し、組織内の異なる部分に割り当てることができます。</p><p>左下の <strong>&#187;</strong> を開いて、<strong>General Settings</strong> 配下の <strong>Settings → Access Tokens</strong> を選択します。</p><p><strong>Access Tokens</strong> インターフェースでは、生成されたアクセストークンのリストで概要が表示されます。すべての組織では、最初のセットアップ時に <strong>Default</strong> のトークンが生成され、その他のトークンを追加・削除できるようになっています。</p><p>各トークンは一意であり、消費できるホスト、コンテナ、カスタムメトリクス、高解像度メトリクスの量に制限を設けることができます。</p><p><strong>Usage Status</strong> 欄は、トークンが割り当てられた制限値を上回っているか下回っているかを素早く表示します。</p><p><a href=#R-image-ba89ff447fa2079e0e38fd4172dce3fb class=lightbox-link><img src=../ja/imt/servicebureau/tokens/../../images/access-tokens.png alt="New token" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ba89ff447fa2079e0e38fd4172dce3fb><img src=../ja/imt/servicebureau/tokens/../../images/access-tokens.png alt="New token" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-新しいトークンの作成>2. 新しいトークンの作成</h2><p><span class="btn cstyle blue"><span><span class=title>New Token</span></span></span> ボタンをクリックして、新しいトークンを作成しましょう。<strong>Name Your Access Token</strong> ダイアログが表示されます。</p><p>ここでは、<strong>Ingest Token</strong> と <strong>API Token</strong> の両方のチェックボックスにチェックを入れてください。</p><p><a href=#R-image-aff9bc56605b5decb050c1c882299b78 class=lightbox-link><img src=../ja/imt/servicebureau/tokens/../../images/new-access-token.png alt="Name Your token" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aff9bc56605b5decb050c1c882299b78><img src=../ja/imt/servicebureau/tokens/../../images/new-access-token.png alt="Name Your token" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><span class="btn cstyle blue"><span><span class=title>OK</span></span></span> を押すと、<strong>Access Token</strong> のUIに戻ります。ここでは、既存のトークンの中に、あなたの新しいトークンが表示されているはずです。</p><p><a href=#R-image-df237c4a063fd4f3e13d3bf128c32a21 class=lightbox-link><img src=../ja/imt/servicebureau/tokens/../../images/access-token-created.png alt="full tokenlist" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-df237c4a063fd4f3e13d3bf128c32a21><img src=../ja/imt/servicebureau/tokens/../../images/access-token-created.png alt="full tokenlist" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>名前を間違えたり、トークンを無効/有効にしたり、トークンの制限を設定したい場合は、トークンの制限の後ろにある省略記号(<strong>&mldr;</strong>)のメニューボタンをクリックして、トークンの管理メニューを開きます。</p><p><a href=#R-image-c14754d234f914b75a6538da2638d0a5 class=lightbox-link><img src=../ja/imt/servicebureau/tokens/../../images/manage-access-token.png alt="Show Menu" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c14754d234f914b75a6538da2638d0a5><img src=../ja/imt/servicebureau/tokens/../../images/manage-access-token.png alt="Show Menu" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>タイプミスがあった場合は、<strong>Rename Token</strong> オプションを使用して、トークンの名前を修正することができます。</p><h2 id=3-トークンの無効化>3. トークンの無効化</h2><p>トークンがメトリクスの送信に使用できないようにする必要がある場合は、トークンを無効にすることができます。</p><p><strong>Disable</strong> ボタンを押すことで、トークンを無効化できます。これにより、トークンがSplunk Observability Cloudへのデータ送信に使用できなくなります。</p><p>以下のスクリーンショットのように、トークンの行がグレーになり、無効化されたことを示しています。</p><p><a href=#R-image-dc34a8082f2385e76012d5aa173e106e class=lightbox-link><img src=../ja/imt/servicebureau/tokens/../../images/disable-access-token.png alt="Token disabled" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dc34a8082f2385e76012d5aa173e106e><img src=../ja/imt/servicebureau/tokens/../../images/disable-access-token.png alt="Token disabled" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>省略記号(<strong>&mldr;</strong>)のメニューボタンをクリックして、トークンの無効化と有効化を行ってください。</p><h2 id=4-トークンの使用制限の管理>4. トークンの使用制限の管理</h2><p><strong>&mldr;</strong> メニューの <strong>Manage Token Limit</strong> をクリックして、使用量を制限してみましょう。</p><p>トークン制限管理ダイアログが表示されます。</p><p><a href=#R-image-0cdcf4c94f0a0054d453da0051c155ba class=lightbox-link><img src=../ja/imt/servicebureau/tokens/../../images/manage-token-limit.png alt="Set Limits on token" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0cdcf4c94f0a0054d453da0051c155ba><img src=../ja/imt/servicebureau/tokens/../../images/manage-token-limit.png alt="Set Limits on token" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>このダイアログでは、カテゴリごとに制限を設定することができます。</p><p>先に進み、各使用指標に対して以下のように制限を指定してください。</p><table><thead><tr><th>リミット</th><th>値</th></tr></thead><tbody><tr><td>ホストの制限</td><td>5</td></tr><tr><td>コンテナ制限</td><td>15</td></tr><tr><td>カスタムメトリクスの制限</td><td>20</td></tr><tr><td>高解像度メトリックの制限</td><td>0</td></tr></tbody></table><p>また、上の表に示すように、ダイアログボックスに正しい数字が表示されていることを再確認してください。</p><p>トークンリミットは、5分間の使用量がリミットの90％を超えたときに、1人または複数の受信者に通知するアラートのトリガーとして使用されます。</p><p>受信者を指定するには、<span class="btn cstyle blue"><span><span class=title>Add Recipient</span></span></span> をクリックして、使用する受信者または通知方法を選択します（受信者の指定は任意ですが、強くお勧めします）。</p><p>トークンアラートの重要度は常に「Critical」です。</p><p><span class="btn cstyle blue"><span><span class=title>Update</span></span></span> をクリックすると、アクセストークンの制限とアラートの設定が保存されます。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note: トークンの上限を超えると、何が起こるのか</div><div class=box-content><p>トークンが使用カテゴリの上限に達したとき、または上限を超えたとき、その使用カテゴリの新しいメトリクスはObservability Cloudに保存されず、処理されません。これにより、チームが無制限にデータを送信することによる予期せぬコストが発生しないようになります。</p></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note: 高度なアラート通知</div><div class=box-content><p>90%に達する前にアラートを取得したい場合は、必要な値を使用して追加のディテクターを作成できます。これらのディテクターは、特定のアクセストークンを消費しているチームをターゲットにすることができ、管理者が関与する必要がある前に行動を起こすことができます。</p></div></div><p>これらの新しいアクセストークンを様々なチームに配布し、Observability Cloudに送信できる情報やデータの量をコントロールできるようになります。</p><p>これにより、Observability Cloudの使用量を調整することができ、過剰な使用を防ぐことができます。</p><p><strong>おめでとうございます！</strong> これで、管理機能のモジュールは終わりです！</p><footer class=footline></footer></article></section></section><article class=default><header class=headline></header><h1 id=splunk4rookies---observability-cloud>Splunk4Rookies - Observability Cloud</h1><p><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2分</span></span> <span class="badge cstyle blue badge-with-title"><span class=badge-title>著者</span><span class=badge-content>Robert Castley & Pieter Hagen</span></span></p><p>このワークショップでは、<strong>Splunk Observability Cloud</strong> が提供する、フロントエンドアプリケーションからバックエンドサービスまで、ユーザーエクスペリエンスを即時に可視化する能力について紹介します。これを通じて、<strong>Splunk Observability Cloud</strong> の最も魅力的な製品機能と差別化要因のいくつかを体験できます。</p><ul><li>インフラモニタリング</li><li><strong>完全で忠実な</strong>リアルユーザーモニタリング（RUM）</li><li>アプリケーションパフォーマンスモニタリング（APM）による <strong>End to End の NoSample™ で完全忠実な</strong>トレースの可視性</li><li><strong>コード入力を必要としない</strong>ログクエリ</li><li>シンセティックモニタリング</li><li>タグ分析とエラースタックを使用した根本原因の特定</li><li>関連するコンテンツ</li></ul><p>Splunk Observability Cloud を構成する重要な要素は、テレメトリデータを統一してエンドユーザーエクスペリエンスとアプリケーションスタックの完全なイメージを作り上げることです。</p><p>このワークショップでは、AWS EC2 インスタンスに展開されたマイクロサービスベースのアプリケーションを使用します。このアプリケーションは、ユーザーが製品を閲覧し、カートに追加し、チェックアウトすることができるシンプルなeコマースアプリケーションです。このアプリケーションは OpenTelemetry で計装されています。</p><hr><p><strong><a href=https://opentelemetry.io target=_blank>OpenTelemetry</a></strong> は、テレメトリデータ（メトリクス、トレース、およびログ）を計装・生成・収集・エクスポートするためのツール、API、およびソフトウェア開発キット（SDK）のコレクションです。これにより、ソフトウェアのパフォーマンスと動作を分析できます。</p><p>OpenTelemetry コミュニティは成長を続けています。Splunk、Google、Microsoft、Amazonなど多くの組織が協力したプロジェクトで、現在、Kubernetes の次に多くの貢献者を有するプロジェクトとなっています。</p><p><a href=#R-image-4e05ea15e026a5914f743d061c6c440f class=lightbox-link><img src=../ja/s4r/images/splunk-full-stack.png alt="Full Stack" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4e05ea15e026a5914f743d061c6c440f><img src=../ja/s4r/images/splunk-full-stack.png alt="Full Stack" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Splunk4Rookies - Observability Cloudのサブセクション</h1><article class=chapter><header class=headline></header><div class=article-subheading>第1章</div><h1 id=ワークショップの概要>ワークショップの概要</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>2分</span></span><h4 id=イントロダクション>イントロダクション</h4><p>このワークショップの目的は、ある問題を体験し、Splunk Observability Cloud を使用してトラブルシューティングを行い、根本原因を特定することです。そのために、私たちは Kubernetes で動作する完全なマイクロサービスベースのアプリケーションを提供し、それが Splunk Observability Cloud に<strong>メトリクス、トレース、ログ</strong>を送信するように計装しました。</p><h4 id=参加対象者は>参加対象者は？</h4><p>Splunk Observability をハンズオンの環境で理解したいと考えている方。このワークショップは、Splunk Observability にほとんど、または、まったく経験がない人向けに設計されています。</p><h4 id=必要なものは何ですか>必要なものは何ですか？</h4><p>参加者本人と、パソコン、外部のウェブサイトにアクセスできるブラウザがあれば十分です。私たちはこれらのワークショップを対面、または、Zoom で実施しています。あなたのデバイスに Zoom クライアントがない場合でも、ウェブブラウザを通じてワークショップ環境にアクセスすることができます。</p><h4 id=このワークショップで何がカバーされていますか>このワークショップで何がカバーされていますか？</h4><p>この3時間のセッションでは、ハンズオンの環境で<strong>ストリーミング分析</strong>、<strong>NoSample™ で完全忠実な</strong>分散トレーシングを備えた唯一の可観測性プラットフォームである Splunk Observability の基本を学びます。</p><h5 id=opentelemetry>OpenTelemetry</h5><p><strong>なぜ OpenTelemetry が必要なのか</strong>、そしてそれが可観測性にとってなぜ重要なのかについて簡単に紹介します。</p><h5 id=splunk-observability-ユーザーインターフェースのツアー>Splunk Observability ユーザーインターフェースのツアー</h5><p>Splunk Observability Cloud のさまざまなコンポーネントを渡り歩きながら、5つの主要なコンポーネント（<strong>APM、RUM、Log Observer、Synthetics、Infrastructure</strong>）を容易に操作する方法を紹介します。</p><h5 id=リアルユーザーデータの生成>リアルユーザーデータの生成</h5><p>Online Boutique Website を使用してお買い物を楽しみます。ブラウザ、モバイル、タブレットを使用いただき、架空の通貨で買い物を行っていただきます。これを通じて、 <strong>メトリクス（問題があるのか？）</strong>、<strong>トレース（問題はどこにあるのか？）</strong>、<strong>ログ（問題は何か？）</strong> を送信します。</p><h5 id=splunk-real-user-monitoring-rum>Splunk Real User Monitoring (RUM)</h5><p>すべての参加者のブラウザセッションから受信したテレメトリーによって提供されたリアルユーザーデータを調査します。目標は、パフォーマンスが悪かったブラウザ、モバイル、タブレットのセッションを見つけて、トラブルシューティングのプロセスを開始することです。</p><h5 id=splunk-application-performance-monitoring-apm>Splunk Application Performance Monitoring (APM)</h5><p>RUM トレース（フロントエンド）から APM トレース（バックエンド）へとジャンプすることで、<strong>End to End の全体としての可視性</strong>の力を理解します。すべてのサービスはテレメトリー（トレースとスパン）を送信しており、Splunk Observability Cloud はそれを視覚化、分析し、異常やエラーを検出するために使用できます。</p><h5 id=splunk-log-observer-lo>Splunk Log Observer (LO)</h5><p>Related Content は、一つのコンポーネントから別のコンポーネントにジャンプすることを可能にする強力な機能です。この場合、私たちは APM トレースからログにジャンプし、関連するログにジャンプします。</p><h5 id=splunk-synthetics>Splunk Synthetics</h5><p>私たちのアプリケーションを<strong>24時間365日</strong>で監視し、問題が発生したときに<strong>アラート</strong>を受け取ることができたら素晴らしいことではないでしょうか？これが Synthetics の役割です。私たちは、1分ごとに実行され、Online Boutique を通じた典型的なユーザージャーニーのパフォーマンスと可用性をチェックするシンプルなテストを示します。</p><footer class=footline></footer></article><article class=chapter><header class=headline></header><div class=article-subheading>第2章</div><h1 id=opentelemetry-とは何かなぜ注目するべきなのか>OpenTelemetry とは何か、なぜ注目するべきなのか？</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>2分</span></span><h2 id=opentelemetry>OpenTelemetry</h2><p>クラウドコンピューティング、マイクロサービスアーキテクチャ、そしてますます複雑なビジネス要件の台頭により、可観測性へのニーズはこれまで以上に高まっています。可観測性とは、システムの内部状態をその出力を調べることで理解する能力のことです。ソフトウェアの文脈では、これは<strong>メトリクス</strong>、<strong>トレース</strong>、および<strong>ログ</strong>を含むテレメトリーデータを調べることでシステムの内部状態を理解する能力を意味します。</p><p>システムを観測可能にするためには、計装が必要です。つまり、コードはトレース、メトリクス、およびログを出力する必要があります。計装されたデータは次に、<strong>Splunk Observability Cloud</strong> などの可観測性バックエンドに送信される必要があります。</p><table><thead><tr><th style=text-align:center>メトリクス</th><th style=text-align:center>トレース</th><th style=text-align:center>ログ</th></tr></thead><tbody><tr><td style=text-align:center><em><strong>問題があるのか？</strong></em></td><td style=text-align:center><em><strong>問題はどこにあるのか？</strong></em></td><td style=text-align:center><em><strong>問題は何か？</strong></em></td></tr></tbody></table><p>OpenTelemetry は2つの重要な側面を持ちます。</p><ul><li>プロプライエタリなデータ形式やツールに縛られることなく、自分が生成するデータを<strong>自分のものとする</strong>ことを可能にします。</li><li><strong>単一の</strong> API と規約を学ぶことを可能にします</li></ul><p>これら2つのことが組み合わさることで、チームや組織は今日の現代的なコンピューティングの世界で必要な柔軟性を得ることができます。</p><p>可観測性に取りかかるときに考慮すべきことはたくさんありますが、その中でも重要な質問は <em>「可観測性ツールにデータをどのように取り込むのか？」</em> というものです。OpenTelemetry の業界全体での採用により、これまで以上に簡単に、この質問に答えることができるようになっています。</p><h2 id=なぜ注目するべきなのか>なぜ注目するべきなのか？</h2><p>OpenTelemetry は完全にオープンソースで、無料で使用することができます。過去には、監視および可観測性ツールはプロプライエタリなエージェントに大きく依存していました。これは、追加のツールを設定したり、変更したりするために必要な労力が、インフラストラクチャレベルからアプリケーションレベルまでのシステム全体で大量の変更を必要とすることを意味していました。</p><p>OpenTelemetry はベンダーニュートラルであり、可観測性に関わる多くの業界のリーダーによってサポートされているため、利用者はいつでもサポートされている可観測性ツール間をわずかな計装に対する変更によって切り替えることができます。これは、どの OpenTelemetry のディストリビューションが使用されているかに関係なく真実です。Linux と同様に、さまざまなディストリビューションは設定とアドオンをバンドルしますが、すべてが根本的にコミュニティ主導の OpenTelemetry プロジェクトに基づいています。</p><p>Splunk は OpenTelemetry に完全にコミットしています。これにより、お客様は<strong>すべての</strong>データを収集し、いかなるタイプ、いかなる構造、いかなるソース、いかなるスケールであっても、すべてリアルタイムで使用することができます。OpenTelemetry は監視の風景を根本的に変えており、IT チームと DevOps チームがすべての疑問とすべてのアクションに対してデータを活用することを可能にしています。これらのワークショップ中にこのことを体験することになります。</p><p><a href=#R-image-54d5e3aef89f176f3c9b9b41194812fd class=lightbox-link><img src=../ja/s4r/2-opentelemetry/images/otel.png alt=OpenTelemetryのロゴ class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-54d5e3aef89f176f3c9b9b41194812fd><img src=../ja/s4r/2-opentelemetry/images/otel.png alt=OpenTelemetryのロゴ class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=chapter><header class=headline></header><div class=article-subheading>第3章</div><h1 id=ui---クイックツアー->UI - クイックツアー 🚌</h1><p>Splunk Observability Cloud のさまざまなコンポーネントの短いウォークスルーを始めます。これは UI に慣れるためのものです。</p><ol><li><strong>Splunk Observability Cloud へのサインイン</strong></li><li><strong>リアルユーザーモニタリング (RUM)</strong></li><li><strong>アプリケーションパフォーマンスモニタリング (APM)</strong></li><li><strong>Log Observer</strong></li><li><strong>Synthetics</strong></li><li><strong>Infrastructure Monitoring</strong></li></ol><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Tip</div><div class=box-content><p>このワークショップをナビゲートする最も簡単な方法は、次の方法を使用することです：</p><ul><li>このページの右上にある左矢印（<strong>&lt;</strong> | <strong>></strong>）</li><li>キーボードの左（◀️）および右（▶️）のカーソルキー</li></ul></div></div><footer class=footline></footer></article><section><h1 class=a11y-only>UI - クイックツアー 🚌のサブセクション</h1><article class=default><header class=headline></header><h1 id=はじめに>はじめに</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>2分</span></span><h3 id=1-splunk-observability-cloud-にサインインする>1. Splunk Observability Cloud にサインインする</h3><p>あなたは Splunk からワークショップの組織への招待メールを受け取るはずです。下のスクリーンショットのようなメールです。もし見つけられない場合は、スパム/ごみ箱フォルダを確認するか、講師に知らせてください。また、<a href=../ja/s4r/3-quick-tour/1-homepage/99-login-faq/index.html><strong>ログイン - よくある質問</strong></a>で他の解決策を確認いただくことも可能です。</p><p><strong>Join Now</strong> ボタンをクリックするか、メールに記載されているリンクをクリックして、次に進んでください。</p><p>すでに登録プロセスを完了している場合は、残りをスキップして直接 Splunk Observability Cloud に進み、ログインすることができます</p><ul><li><a href=https://app.eu0.signalfx.com target=_blank><strong>https://app.eu0.signalfx.com (EMEA)</strong></a></li><li><a href=https://app.us1.signalfx.com target=_blank><strong>https://app.us1.signalfx.com (APAC/AMER)</strong></a></li></ul><p><a href=#R-image-115948e481ab74d97b28bf466d772460 class=lightbox-link><img src="../ja/s4r/3-quick-tour/1-homepage/images/invite-email.png?width=25vw" alt=email class="figure-image noborder lightbox noshadow" style=height:auto;width:25vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-115948e481ab74d97b28bf466d772460><img src="../ja/s4r/3-quick-tour/1-homepage/images/invite-email.png?width=25vw" alt=email class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Splunk Observability Cloud を初めて使用する場合は、登録フォームが表示されます。あなたのフルネームと希望のパスワードを入力してください。パスワードの要件は以下の通りです</p><ul><li><strong>必須</strong> 8文字から32文字の間でなければなりません</li><li><strong>必須</strong> 少なくとも1つの大文字を含む必要があります</li><li><strong>必須</strong> 少なくとも1つの数字を含む必要があります</li><li><strong>必須</strong> 少なくとも1つの記号を含む必要があります（例：!@#$%^&*()_+）</li></ul><p>利用規約に同意するためのチェックボックスをクリックし、<strong>SIGN IN NOW</strong> ボタンをクリックします。</p><p><a href=#R-image-5367840e8cf199aa3ada6df3302ecc10 class=lightbox-link><img src="../ja/s4r/3-quick-tour/1-homepage/images/enter-password.png?width=25vw" alt=User-Setup class="figure-image noborder lightbox noshadow" style=height:auto;width:25vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5367840e8cf199aa3ada6df3302ecc10><img src="../ja/s4r/3-quick-tour/1-homepage/images/enter-password.png?width=25vw" alt=User-Setup class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>はじめにのサブセクション</h1><article class=default><header class=headline></header><h1 id=ホームページ>ホームページ</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5分</span></span><p>Splunk Observability Cloud に登録しログインすると、ホーム画面であるランディングページに移動します。ここでは、取り掛かる際に役に立ついくつかの機能を確認できます。</p><p><a href=#R-image-5d1cfec50ed4b756ba53d30a1303fbbb class=lightbox-link><img src=../ja/s4r/3-quick-tour/1-homepage/1-home-page/../images/home-screen.png alt=ホームページ class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d1cfec50ed4b756ba53d30a1303fbbb><img src=../ja/s4r/3-quick-tour/1-homepage/1-home-page/../images/home-screen.png alt=ホームページ class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>&ldquo;Explorer your data&rdquo; ：</strong> 有効になっているインテグレーションを表示し、管理者であればさらにインテグレーションを追加できます。</li><li><strong>&ldquo;Documentation&rdquo; ：</strong> Splunk Observability Cloud に取り組み始める際に利用できるトレーニングビデオやドキュメンテーションへのリンクです。</li><li><strong>&ldquo;Recents&rdquo; ：</strong> 最近作成/訪問したダッシュボードや Detector へのクイックアクセスです。</li><li><strong>メインメニュー：</strong> Splunk Observability Cloud の各機能に移動できます。</li><li><strong>組織(Org)切り替え：</strong> 組織間を簡単に切り替えることができます（複数の組織のメンバーである場合）。</li><li><strong>メインメニューの展開/縮小：</strong> 画面サイズに応じて、メインメニューを展開 <strong>&#187;</strong> / 縮小 <strong>&#171;</strong> します。</li></ol><p>まずは、最初の Exercise から始めましょう。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>メインメニューを展開し、<strong>Settings</strong> をクリックします。</li><li><strong>組織切り替え</strong>で、複数の組織にアクセスできるかどうかを確認します。</li></ul></div></div><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Hint</div><div class=box-content><p>以前にSplunk Observabilityを使用したことがある場合、以前使用した組織に配置される可能性があります。正しいワークショップの組織にいることを確認してください。複数の組織にアクセスできる場合は、インストラクターに確認してください。</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>Onboarding Guidance</strong> をクリックします（ここでは、オンボーディングパネルの表示を切り替えることができます。これは、製品を十分に理解していて、より多くの情報を表示するためのスペースを使用できる場合に便利です）。</li><li><strong>Home Page</strong> のオンボーディングコンテンツを非表示にします。</li><li>メニューの下部で、好みの外観を選択します。<strong>Light</strong>、<strong>Dark</strong>、または <strong>Auto</strong> モードが選択できます。</li><li><strong>Sign Out</strong> オプションがある場所でもあることに気付きましたか？ でも、押さないでくださいね😊!</li><li>メインメニューに戻るために <strong>&lt;</strong> をクリックします。</li></ul></div></div><p>次に、<strong>Splunk Real User Monitoring (RUM)</strong> をチェックしましょう。</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=リアルユーザーモニタリングの概要>リアルユーザーモニタリングの概要</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5分</span></span><p>Splunk RUM は業界唯一の End to End, <strong>NoSample™</strong> RUM ソリューションであり、すべての Web およびモバイルセッションに関するユーザーエクスペリエンス全体を可視化し、フロントエンドの全てのトレースをバックエンドのメトリクス、トレース、ログとを一意に組み合わせることができます。IT 運用チームとエンジニアリングチームは、迅速にエラー範囲の特定、対処の優先度付け、他の問題との切り分け、実際のユーザーに対する影響の測定を行うことができ、また、すべてのユーザー操作をビデオでリプレイしながらパフォーマンス指標と相関させることでエンドユーザー体験を最適化することができます。</p><p><strong>全てのユーザーセッションを分析する：</strong> ストリーミング分析によって、シングルページおよびマルチページアプリまで、全てのユーザーセッションをキャプチャし、すべてのリソース、画像、ルート変更、API 呼び出しが与える顧客への影響を測定します。</p><p><strong>問題をより迅速に関連付ける：</strong> 無限のカーディナリティと完全なトランザクション分析により、複雑な分散システム全体で問題をより迅速に特定し、相関付けることができます。</p><p><strong>遅延とエラーを特定する：</strong> それぞれのコード変更やデプロイに対して遅延、エラー、パフォーマンスが悪い状態を簡単に特定します。コンテンツ、画像、およびサードパーティの依存関係が顧客にどのような影響を与えるかを測定します。</p><p><strong>ページパフォーマンスを取得し改善する：</strong> Core Web Vitals を活用してページロード体験、対話性、視覚的安定性を測定し、改善します。影響を及ぼす JavaScript エラーを見つけて修正し、最初に改善すべきページを簡単に理解できます。</p><p><strong>意味のあるメトリクスを探索する：</strong> 特定のワークフロー、カスタムタグ、およびインデックス化されていないタグに関する自動提案に基づいたメトリクスによって、顧客への影響を即座に視覚化し、問題の根本原因を迅速に特定します。</p><p><strong>エンドユーザー体験を最適化する：</strong> すべてのユーザーインタラクションをビデオリプレイで確認しながらパフォーマンスメトリクスと関連付け、エンドユーザー体験を最適化することができます。</p><p><a href=#R-image-83ddeeefe6d42e72fefabe0c98f02c04 class=lightbox-link><img src=../ja/s4r/3-quick-tour/2-rum-home/images/rum-architecture.png alt=アーキテクチャの概要 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-83ddeeefe6d42e72fefabe0c98f02c04><img src=../ja/s4r/3-quick-tour/2-rum-home/images/rum-architecture.png alt=アーキテクチャの概要 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>リアルユーザーモニタリングの概要のサブセクション</h1><article class=default><header class=headline></header><h1 id=リアルユーザーモニタリングのホームページ>リアルユーザーモニタリングのホームページ</h1><p>メインメニューで <strong>RUM</strong> をクリックすると、RUM の中心となるホーム画面、ランディングページに移動します。このページの主なコンセプトは、一目で、選んだすべての RUM アプリケーション全体のステータスを提供することです。これはフルダッシュボードまたはコンパクトビューのいずれかで可能です。</p><p>ステータスダッシュボードのタイプに関係なく、RUM ホームページは3つの明確なセクションで構成されています：</p><p><a href=#R-image-7fe05987dbf0143bf3b5d7d7b032044e class=lightbox-link><img src=../ja/s4r/3-quick-tour/2-rum-home/1-rum-home/../images/rum-main.png alt="RUM ページ" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7fe05987dbf0143bf3b5d7d7b032044e><img src=../ja/s4r/3-quick-tour/2-rum-home/1-rum-home/../images/rum-main.png alt="RUM ページ" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>オンボーディングパネル：</strong> Splunk RUM を始めるためのトレーニングビデオとドキュメンテーションへのリンク（画面のスペースが必要な場合は、このパネルを非表示にできます）</li><li><strong>フィルターパネル：</strong> 時間枠、環境、アプリケーション、ソースタイプでフィルタリングします。</li><li><strong>アプリケーションサマリーパネル：</strong> RUM データを送信するすべてのアプリケーションのサマリー。</li></ol><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> RUM における 環境（Environment）,アプリケーション（App）,ソースタイプ（Source）</div><div class=box-content><ul><li>Splunk Observability は、RUM トレースの一部として送信される <strong>Environment</strong> タグを使用して、&ldquo;Production&rdquo; や &ldquo;Development&rdquo; などの異なる環境からのデータを分けています。</li><li>さらに <strong>App</strong> タグによって分けることもできます。これにより、同じ環境で動作する別々のブラウザ/モバイルアプリケーションを区別することができます。</li><li>Splunk RUM はブラウザとモバイルアプリケーションの両方で利用可能であり、<strong>Source</strong> を使用してそれらを区別することができますが、このワークショップでは、ブラウザベースの RUM のみを使用します。</li></ul></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>時間枠が <strong>-15m</strong> に設定されていることを確認します</li><li>ドロップダウンボックスからワークショップの Environment を選択します。命名規則は <strong>[ワークショップの名前]</strong> です（これを選択すると、ワークショップの RUM アプリケーションが表示されることが確認できます）</li><li><strong>App</strong> を選択します。命名規則は <strong>[ワークショップの名前]-shop</strong> で、<strong>Source</strong> は <strong>All</strong> に設定したままにします</li><li><strong>JavaScript Errors</strong> タイルで <em>Cannot read properties of undefined (reading &lsquo;Prcie&rsquo;)</em> と表示される <strong>TypeError</strong> エントリをクリックし、詳細を確認します。エラーが発生したウェブサイトのどの部分かをすばやく気づくことができ、これにより迅速に修正することができます。</li><li>パネルを閉じます。</li><li>3列目のタイルは <strong>Web Vitals</strong> を表示しています。これはユーザーエクスペリエンスの3つの重要な側面である<em>ページのローディング</em>、<em>対話性</em>、および<em>視覚的安定性</em>に焦点を当てたメトリックです。</li></ul><div class=tab-panel data-tab-group=073b797d67267e544990efc31a8b5289><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=質問 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("073b797d67267e544990efc31a8b5289","質問")'>
<span class=tab-nav-text>質問</span></button>
<button data-tab-item=回答 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("073b797d67267e544990efc31a8b5289","回答")'>
<span class=tab-nav-text>回答</span></button></div><div class=tab-content-container><div data-tab-item=質問 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>Web Vitals メトリクスに基づいて、現在のウェブサイトのパフォーマンスをどのように評価しますか？</strong></p></div></div><div data-tab-item=回答 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>Web Vitals メトリクスによれば、サイトの初期ロードはOKで、<em>良好</em> と評価されています</strong></p></div></div></div></div><ul><li>最後のタイル、<strong>Most recent detectors</strong> タイルは、アプリケーションでトリガーされたアラートがあるかどうかを表示します。</li><li>アプリケーション名の前の下向き <strong>⌵</strong> 矢印をクリックして、ビューをコンパクトスタイルに切り替えます。このビューでも主要な情報がすべて利用可能です。コンパクトビューの任意の場所をクリックしてフルビューに戻ります。</li></ul></div></div><p>次に、<strong>Splunk Application Performance Monitoring (APM)</strong> をチェックしましょう。</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=アプリケーションパフォーマンスモニタリングの概要>アプリケーションパフォーマンスモニタリングの概要</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5分</span></span><p>Splunk APM は、<strong>NoSample™</strong> で End to End の可視性を提供し、モノリシックとマイクロサービスの両方で問題をより迅速に解決します。チームは新しいデプロイメントからの問題をすぐに検出し、問題の発生源を絞り込み、切り分けることで自信を持ってトラブルシューティングを行い、バックエンドサービスがエンドユーザーとビジネスワークフローに与える影響を理解することでサービスパフォーマンスを最適化することができます。</p><p><strong>リアルタイムモニタリングとアラート：</strong> Splunk は、すぐに利用可能なサービスダッシュボードを提供します。急激な変化があると RED メトリクス（処理量、エラー、遅延）に基づいて自動的に問題を検出・アラートを発します。</p><p><strong>動的なテレメトリーマップ：</strong> モダンなプロダクション環境でのサービスパフォーマンスをリアルタイムで簡単に視覚化します。インフラストラクチャ、アプリケーション、エンドユーザー、およびすべての依存関係からサービスパフォーマンスをエンドツーエンドで可視化することで、新しい問題を迅速に絞り込み、より効果的にトラブルシューティングを行うことができるようになります。</p><p><strong>インテリジェントなタグ付けと分析：</strong> ビジネス、インフラストラクチャ、アプリケーションからのすべてのタグを一か所で表示し、特定のタグに対して遅延やエラーに関する新しい傾向を簡単に比較・理解することができます。</p><p><strong>AI を活用したトラブルシューティングによる最も影響の大きい問題の特定：</strong> 問題をより効率的に隔離します。個々のダッシュボードを手間をかけて掘り下げる必要はありません。サービスと顧客に最も影響を与える異常とエラーの源を自動的に特定します。</p><p><strong>すべてのトランザクションに対する完全な分散トレーシング分析：</strong> クラウドネイティブ環境の問題をより効果的に特定します。Splunk の分散トレーシングは、インフラストラクチャ、ビジネスワークフロー、アプリケーションの特徴を踏まえた上で、バックエンドとフロントエンドからのすべてのトランザクションを視覚化し、その関係性を明らかにします。</p><p><strong>フルスタックでの相関性の可視化：</strong> Splunk Observability 内で、APM はトレース、メトリクス、ログ、プロファイリングをすべてリンクさせ、スタック全体における各コンポーネントの依存関係やパフォーマンスを簡単に理解できるようにします。</p><p><strong>データベースクエリパフォーマンスの監視：</strong> SQL および NoSQL データベースからの遅いクエリや高頻度に実行されるクエリが、サービス、エンドポイント、およびビジネスワークフローにどのような影響を与えるかを簡単に特定できるようにします。計装は必要ありません。</p><p><a href=#R-image-534d33a8e5655ec303b0778742e8ce89 class=lightbox-link><img src=../ja/s4r/3-quick-tour/3-apm-home/images/arch-overview.png alt=アーキテクチャの概要 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-534d33a8e5655ec303b0778742e8ce89><img src=../ja/s4r/3-quick-tour/3-apm-home/images/arch-overview.png alt=アーキテクチャの概要 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>アプリケーションパフォーマンスモニタリングの概要のサブセクション</h1><article class=default><header class=headline></header><h1 id=アプリケーションパフォーマンスモニタリングのホームページ>アプリケーションパフォーマンスモニタリングのホームページ</h1><p>メインメニューで <strong>APM</strong> をクリックすると、APM ホームページが表示されます。このページは3つの明確なセクションで構成されています。</p><p><a href=#R-image-024b494537c8cb2b383de6bd639c41b6 class=lightbox-link><img src=../ja/s4r/3-quick-tour/3-apm-home/1-apm-home/../images/apm-main.png alt=APMページ class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-024b494537c8cb2b383de6bd639c41b6><img src=../ja/s4r/3-quick-tour/3-apm-home/1-apm-home/../images/apm-main.png alt=APMページ class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>オンボーディングパネル：</strong> Splunk APM を始める際に参考になるトレーニングビデオとドキュメンテーションへのリンク</li><li><strong>APM Overview：</strong> トップサービスとトップビジネスワークフローのリアルタイムメトリクス</li><li><strong>機能パネル：</strong> サービス、タグ、トレース、データベースクエリパフォーマンス、コードプロファイリングの詳細分析を行う際に使用するリンク</li></ol><p><strong>APM Overview</strong> パネルは、アプリケーションのヘルスステータスに関する概要を示します。これにはアプリケーションのサービス、レイテンシー、エラーのサマリーが含まれています。また、エラーレートが最も高いサービスとビジネスワークフローのリストも含まれています（ビジネスワークフローは、特定の活動やトランザクションに関連する一連のトレースの集合で、エンドツーエンドの KPI を監視し、根本原因とボトルネック特定することができるようになります）。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> 環境（Environment）について</div><div class=box-content><p>複数のアプリケーションを簡単に区別するために、Splunk は <strong>Environment</strong> を使用します。ワークショップ環境の命名規則は <strong>[ワークショップの名前]-workshop</strong> です。インストラクターが正しい名前を案内します。</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>表示されている画面上の時間枠が過去15分（<strong>-15m</strong>）に設定されていることを確認します。</li><li>ドロップダウンボックスからワークショップの Environment を選択します。そのワークショップ環境名のみが選択されていることを確認します。</li></ul><div class=tab-panel data-tab-group=428cc5338e6c68d076b28df3f3920f4e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=質問 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("428cc5338e6c68d076b28df3f3920f4e","質問")'>
<span class=tab-nav-text>質問</span></button>
<button data-tab-item=回答 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("428cc5338e6c68d076b28df3f3920f4e","回答")'>
<span class=tab-nav-text>回答</span></button></div><div class=tab-content-container><div data-tab-item=質問 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>エラーレートが最も高いサービスに関するチャートから、どんなことが分かりますか？</strong></p></div></div><div data-tab-item=回答 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>paymentservice が高いエラーレートを持っています</strong></p></div></div></div></div></div></div><p>概要ページを下にスクロールすると、一部のサービスに <strong>Inferred Service</strong> が表示されることに気づくでしょう。</p><p>Splunk APM は、リモートサービスを呼び出すスパンに必要な情報がある場合、Inferred Service を推測することができます。Inferred Service として検出されるサービスの例としては、データベース、HTTPエンドポイント、メッセージキューなどがあります。Inferred Service は計装されていませんが、サービスマップとサービスリストに表示されます。</p><p>次に、<strong>Splunk Log Observer (LO)</strong> をチェックしましょう。</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=log-observer-overview>Log Observer Overview</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5 minutes</span></span><p>Log Observer Connect は、Splunk Platform 上に取得されたログデータを直感的かつ<strong>ノーコード</strong>のインターフェースにシームレスに取り込むことが可能で、素早く問題を見つけて修正できるよう設計されています。ログベースの分析を簡単に実行でき、Splunk Infrastructure Monitoring のリアルタイムメトリクスや Splunk APM のトレースを1つの画面でシームレスに関連付けて確認することができます。</p><p><strong>End to End の可視性:</strong> Splunk Platform の強力なログ機能を Splunk Observability Cloud のトレースとリアルタイムメトリクスと組み合わせることで、ハイブリッド環境のより深い洞察とコンテキストを提供します。</p><p><strong>迅速かつ簡単なログベースの調査:</strong> Splunk Cloud Platform または Enterprise に既に取り込まれているログを Splunk Observability Cloud の簡素で直感的なインターフェースで再利用することができます。カスタマイズできて、すぐに使えるダッシュボードも活用できます（SPL の知識は不要です！）</p><p><strong>大規模組織での利用が可能で、操作効率も向上:</strong> ログ管理をチームをまたいで一元化することで、データとチームの障壁を取り払い、システム全体に対するサポートを向上させます。</p><p><a href=#R-image-e87e87da5fe8f8d947dae9b5eceba74e class=lightbox-link><img src=../ja/s4r/3-quick-tour/4-log-observer-home/images/logo-image-loop.png alt="Logo graph" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e87e87da5fe8f8d947dae9b5eceba74e><img src=../ja/s4r/3-quick-tour/4-log-observer-home/images/logo-image-loop.png alt="Logo graph" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Log Observer Overviewのサブセクション</h1><article class=default><header class=headline></header><h1 id=log-observer-home-page>Log Observer Home Page</h1><p>メインメニューで <strong>Log Observer</strong> をクリックしてみましょう。Log Observer ホームページは4つの異なるセクションで構成されます。</p><p><a href=#R-image-aefb33177c54bc492bfbf2086ea0bb4d class=lightbox-link><img src=../ja/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/log-observer-main.png alt="Lo Page" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aefb33177c54bc492bfbf2086ea0bb4d><img src=../ja/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/log-observer-main.png alt="Lo Page" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>オンボーディングパネル:</strong> Splunk Log Observer を始めるためのトレーニングビデオとドキュメンテーションへのリンク。</li><li><strong>フィルターパネル:</strong> 時間、index、および Field に基づいてフィルタリングします。また、保存しておいたクエリを利用することもできます。</li><li><strong>Log table:</strong> 現在のフィルタ条件に一致するログエントリのリスト。</li><li><strong>Fields:</strong> 現在選択されている index で使用可能なフィールドのリスト。</li></ol><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Splunk index</div><div class=box-content><p>一般的に、Splunk では「index」はデータが保存される指定された場所を指します。これはデータのためのフォルダまたはコンテナのようなものです。 Splunk index 内のデータは検索と分析が容易になるように整理され構造化されています。異なるインデックスを作成して特定のタイプのデータを格納することができます。たとえば、Web サーバーログ用の1つの index、アプリケーションログ用の別の index などが考えられます。</p></div></div><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Hint</div><div class=box-content><p>以前に Splunk Enterprise または Splunk Cloud を使用したことがある場合、おそらくログから調査を開始することに慣れているでしょう。次の演習でも同じようにできますが、このワークショップでは調査にすべての <strong>OpenTelemetry</strong> シグナルを使用します。</p></div></div><p>さて、簡単なログ検索の演習を行いましょう。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><p>時間枠を <strong>-15分</strong> に設定します。</p></li><li><p>Filter で <span class="btn cstyle gray"><span><span class=title>Add Filter</span></span></span> をクリックし、次にダイアログで <strong>Fields</strong> をクリックします。</p></li><li><p><strong>cardType</strong> と入力して選択します。</p></li><li><p><strong>Top values</strong> の下で <strong>visa</strong> をクリックし、その後 <strong>=</strong> をクリックしてフィルターに追加します。</p><p><a href=#R-image-40922499fec048b9c0d9740f052f0485 class=lightbox-link><img src="../ja/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/log-filter-bar.png?width=920px" alt="logo search" class="figure-image noborder lightbox noshadow" style=height:auto;width:920px loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-40922499fec048b9c0d9740f052f0485><img src="../ja/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/log-filter-bar.png?width=920px" alt="logo search" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></li><li><p>ログテーブル内のログエントリの1つをクリックして、そのエントリに <code>cardType: "visa"</code> が含まれていることを確認します。</p></li><li><p>出荷されたすべての注文を探してみましょう。Filter で <strong>Clear All</strong> をクリックして前のフィルターを削除します。</p></li><li><p>再度 Filter で <span class="btn cstyle gray"><span><span class=title>Add Filter</span></span></span> をクリックし、次に <strong>Keyword</strong> を選択します。次に <strong>Enter Keyword&mldr;</strong> ボックスに <code>order:</code> と入力してエンターキーを押します。</p></li><li><p>これで「 order： 」という単語を含むログ行しか表示されなくなります。まだ多くのログ行がありますので、さらにフィルタリングしましょう。</p></li><li><p>別のフィルターを追加します。今度は <strong>Fields</strong> ボックスを選択し、<strong>Find a field&mldr;</strong> と表示されている検索ボックスに <code>severity</code> と入力して選択します。
<a href=#R-image-dc4b9427f499caeb5a4038d7a9698014 class=lightbox-link><img src="../ja/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/find-severity.png?width=15vw&amp;classes=left" alt=severity class="figure-image noborder left lightbox noshadow" style=height:auto;width:15vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dc4b9427f499caeb5a4038d7a9698014><img src="../ja/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/find-severity.png?width=15vw&amp;classes=left" alt=severity class="lightbox-image noborder left lightbox noshadow" loading=lazy></a></p></li><li><p>ダイアログボックスの下部にある <span class="btn cstyle gray"><span><span class=title><strong>Exclude all logs with this fields</strong></span></span></span> をクリックしてください。なぜなら、注文ログ行には重要度が割り当てられていないからです。これにより他のログが削除されます。</p></li><li><p>まだ画面上部にオンボーディングコンテンツが表示されている場合は、<strong>Exclude all logs with this fields</strong> ボタンを見るためにページをスクロールする必要があります。</p></li><li><p>これで過去15分間に販売された注文のリストが表示されます。</p></li></ul></div></div><p>次に、<strong>Splunk Synthetics</strong> を確認しましょう。</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=synthetics-overview>Synthetics Overview</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5 minutes</span></span><p>Splunk Synthetic Monitoring は、URL、API、および重要な Web サービス全体に対する可視性を提供し、問題の解決を迅速に行います。IT オペレーションおよびエンジニアリングチームは、簡単に問題を検出、アラートを発報することができます。また、問題の優先順位づけ、複数ステップから成るユーザージャーニーのシミュレーション、新しいコードのデプロイによるビジネスへの影響の測定、Web のパフォーマンスの最適化を行うことができます。さらに、ステップバイステップのアドバイスにより、より良いデジタルエクスペリエンスを担保することにもつながります。</p><p><strong>可用性の確認:</strong> 重要なサービス、URL、および API のヘルスステータスや可用性を、ユーザーエクスペリエンスを構成する多段階のワークフローをシミュレートするブラウザテストによって監視し、アラートすることができます。</p><p><strong>パフォーマンス指標の改善:</strong> Core Web Vitals およびモダンなパフォーマンスメトリクスを使用することで、すべてのパフォーマンス上の問題点を1つの画面上で示し、ページパフォーマンスを改善するために必要となるページの読み込み、対話性、視覚的な安定性に関するメトリクスを測定・改善させたり、JavaScript エラーを見つけて修正したりすることができます。</p><p><strong>フロントエンドからバックエンドまで:</strong> Splunk APM、Infrastructure Monitoring、On-Call、および ITSI との統合により、チームはバックエンドサービスやこれを支えるインフラストラクチャの状況、インシデント対応状況を踏まえたエンドポイントの稼働状態を確認することができ、環境全体を横断的に捉えてトラブルシュートを行うことができます。</p><p><strong>問題の検知とアラート:</strong> エンドユーザーエクスペリエンスを監視およびシミュレートすることで、顧客に影響を与える前に API やサービスエンドポイント、重要なビジネストランザクションに対する問題を検知、アラートし、解決することができます。</p><p><strong>ビジネスパフォーマンス:</strong> 主要なビジネストランザクションのために多段階のユーザーフローを簡単に定め、レコーディングすることで、数分でクリティカルなユーザージャーニーに関するテストを開始することができます。アップタイムやパフォーマンスに関わる SLA および SLO をトラックし知らせてくれます。</p><p><strong>表示画面の記録とビデオ再生:</strong> 定期実行されるテストを通じて断続的に録画・記録した画面やスクリーンショットとともに、現代でよく用いられるパフォーマンススコア、比較用のベンチマークやメトリクスを確認できるようにすることで、エンドユーザーエクスペリエンスを可視化します。視覚コンテンツの提供速度を最適化したり、ページの安定性と対話性を向上させることで、より良いデジタルエクスペリエンスを提供できるようにします。</p><p><a href=#R-image-876d2627c274ac82581098975a194eec class=lightbox-link><img src=../ja/s4r/3-quick-tour/5-synthetics-home/images/synthetic-tests.png alt="Synthetics overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-876d2627c274ac82581098975a194eec><img src=../ja/s4r/3-quick-tour/5-synthetics-home/images/synthetic-tests.png alt="Synthetics overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Synthetics Overviewのサブセクション</h1><article class=default><header class=headline></header><h1 id=synthetics-home-page>Synthetics Home Page</h1><p><strong>Synthetics</strong> をメインメニューでクリックしてみましょう。これにより Synthetics ホームページに移動します。このページには、役立つ情報を確認したり、Synthetic テストを選択または作成したりするための3つのセクションがあります。</p><p><a href=#R-image-1f1e93f62b2a6d160b2bedcdbe2a2885 class=lightbox-link><img src=../ja/s4r/3-quick-tour/5-synthetics-home/1-synthetics-home/../images/synthetics-main.png alt="Synthetic main" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1f1e93f62b2a6d160b2bedcdbe2a2885><img src=../ja/s4r/3-quick-tour/5-synthetics-home/1-synthetics-home/../images/synthetics-main.png alt="Synthetic main" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>オンボーディングパネル:</strong> Splunk Synthetics を始めるためのトレーニングビデオとドキュメンテーションへのリンク。</li><li><strong>テストパネル:</strong> 設定されているすべてのテストのリスト（<strong>Browser</strong>、<strong>API</strong>、および <strong>Uptime</strong>）</li><li><strong>Add new test:</strong> 新しい Synthetic テストを作成するためのドロップダウン。</li></ol><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>ワークショップの一環として、実行しているアプリケーションに対するデフォルトのブラウザーテストが作成されています。テストパネル（<strong>2</strong>）で見つけることができます。その名前はワークショップの名前に続いて <strong>Workshop Browser Test for</strong> となります（講師が名前をご連絡いたします）。</p></div></div><p>ツアーを続けましょう。ワークショップ用の自動ブラウザーテストの結果を見てみます。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>テストパネルで、ワークショップの名前が含まれている行をクリックします。以下のように表示されるはずです。</li></ul><p><a href=#R-image-20411fe3ef868eb891f8c5530e42343c class=lightbox-link><img src=../ja/s4r/3-quick-tour/5-synthetics-home/1-synthetics-home/../images/synthetics-test-overview.png alt=Synthetics-overview class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-20411fe3ef868eb891f8c5530e42343c><img src=../ja/s4r/3-quick-tour/5-synthetics-home/1-synthetics-home/../images/synthetics-test-overview.png alt=Synthetics-overview class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Synthetic Tests ページでは、最後の1日、8日、および30日の間にサイトのパフォーマンスが表示されます。上のスクリーンショットに示されているように、テストが過去に十分に開始された場合のみ、対応するチャートに有効なデータが含まれます。テストが作成された時点によっては、一部のデータが表示されない場合があります。</li><li>Performance KPI のドロップダウンで、デフォルトの last 4 hours から last 1 hour に時間を変更してください。</li></ul><div class=tab-panel data-tab-group=fbacf572d0844f716dfa62d07d49b342><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=質問 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("fbacf572d0844f716dfa62d07d49b342","質問")'>
<span class=tab-nav-text>質問</span></button>
<button data-tab-item=回答 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("fbacf572d0844f716dfa62d07d49b342","回答")'>
<span class=tab-nav-text>回答</span></button></div><div class=tab-content-container><div data-tab-item=質問 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>テストはどれくらいの頻度で実行され、どこから実行されていますか？</strong></p></div></div><div data-tab-item=回答 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>テストはフランクフルト、ロンドン、およびパリから、1分間隔のラウンドロビンで実行されます</strong></p></div></div></div></div></div></div><p>次に、<strong>Splunk Infrastructure Monitoring (IM)</strong> を使用してアプリケーションが実行されているインフラストラクチャを調査しましょう。</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=infrastructure-overview>Infrastructure Overview</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5 minutes</span></span><p>Splunk Infrastructure Monitoring (IM) は、ハイブリッドクラウド環境向けの市場をリードするモニタリングおよびオブザビリティサービスです。特許取得済みのストリーミングアーキテクチャに基づいており、従来のソリューションよりも短時間かつ高精度でインフラストラクチャ、サービス、およびアプリケーションのパフォーマンスを視覚化および分析する<strong>リアルタイム</strong>ソリューションを提供します。</p><p><strong>OpenTelemetry 標準化:</strong> あなたのデータを完全にコントロールすることができ、ベンダーロックインから解放され、独自のエージェントの実装が不要になります。</p><p><strong>Splunk の OTel Collector:</strong> シームレスなインストールとダイナミックな構成が可能で、ほんのわずかな時間ですべてのスタックに対して自動検出を行うことができます。これによりクラウド、サービス、およびシステム全体を横断的に可視化することができます。</p><p><strong>300 以上の簡単に使用可能な OOTB コンテンツ:</strong> 事前に構築されたナビゲータとダッシュボードを利用可能で、すべてのデータをリアルタイムに扱うことで環境全体を即座に視覚化できます。</p><p><strong>Kubernetes ナビゲータ:</strong> ノード、Pod、およびコンテナの関係性を包括的かつ簡単に理解できるプリセットのビューが利用可能です。わかりやすいインタラクティブなクラスターマップで、初心者でも簡単に理解できるでしょう。</p><p><strong>自動検出されるアラートと Detector:</strong> 特に重要なメトリクスを自動的に識別することができます。構成などを行う必要はことなく、テレメトリデータが取り込まれるとすぐに正確なアラート条件を作成することができ、ほんのわずかな時間で重要な通知をリアルタイムにアラートする機能を利用できます。</p><p><strong>ダッシュボード内のログ参照:</strong> ログメッセージとリアルタイムメトリクスを 1 ページで組み合わせて表示することができます。共通のフィルタ条件や時間制御により、共通のコンテキストに基づくトラブルシューティングを迅速に行うことができます。</p><p><strong>メトリクスパイプラインの管理:</strong> データ取り込み時点でメトリクスのボリュームを制御することができます。Instrumentation（計装）を変更することなく、必要なデータのみを保存および分析するためのデータ集約やドロップの設定が可能です。メトリクスのボリュームを削減し、オブザビリティの支出を最適化することができます。</p><p><a href=#R-image-ab09bd68e8d7fc42cf5090949ccda31c class=lightbox-link><img src=../ja/s4r/3-quick-tour/6-infrastructure-home/images/infrastructure-overview.png alt="Infrastructure Overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ab09bd68e8d7fc42cf5090949ccda31c><img src=../ja/s4r/3-quick-tour/6-infrastructure-home/images/infrastructure-overview.png alt="Infrastructure Overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Infrastructure Overviewのサブセクション</h1><article class=default><header class=headline></header><h1 id=infrastructure-navigators>Infrastructure Navigators</h1><p><strong>Infrastructure</strong> をメインメニューでクリックします。Infrastructure ホームページは4つの異なるセクションで構成されています。</p><p><a href=#R-image-449a92cb1cc15f081d1413e7447dc876 class=lightbox-link><img src=../ja/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/infrastructure-main.png alt="Infra main" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-449a92cb1cc15f081d1413e7447dc876><img src=../ja/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/infrastructure-main.png alt="Infra main" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>オンボーディングパネル:</strong> Splunk Infrastructure Monitoring を始めるためのトレーニングビデオとドキュメンテーションへのリンク。</li><li><strong>時間とフィルタパネル:</strong> 時間ウィンドウ（一覧画面上では設定変更できません）</li><li><strong>Integration パネル:</strong> Splunk Observability Cloud にメトリクスを送信しているすべてのテクノロジのリスト。</li><li><strong>タイルパネル:</strong> Integration によって監視されているサービスの合計数（Integration 別に表示）</li></ol><p>Infrastructure パネルを使用して、興味のあるインフラストラクチャ/テクノロジーを選択できます。やってみましょう。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><p>Integration パネルの <strong>Containers</strong> セクション（<strong>3</strong>）にある、<strong>Kubernetes</strong> を調査対象のテクノロジーとして選択します。</p></li><li><p><strong>K8s Nodes</strong> と <strong>K8s Workloads</strong> の2つのタイルが表示されるはずです。</p></li><li><p>各タイルの下部には過去の推移を表すグラフがあり、上部にはアラートの通知が表示されます。これらの追加情報は全てのタイルに表示されており、インフラストラクチャのヘ健全性に関する概要を確認するのに役立つでしょう。</p></li><li><p><strong>K8s Nodes</strong> タイルをクリックします。</p></li><li><p>Kubernetes クラスターが1つ以上の表示されます。</p></li><li><p>次に <span class="btn cstyle transparent"><span><span class=title>Add filters</span></span></span> ボタンをクリックします。 <code>k8s.cluster.name</code> と入力し、検索結果をクリックします。</p></li><li><p>リストから <strong>[WORKSHOPの名前]-k3s-cluster</strong> を選択し、<span class="btn cstyle blue"><span><span class=title>Apply Filter</span></span></span> ボタンをクリックします。</p><p><a href=#R-image-a49b92f37f8a098d65cbc1c04204fc3a class=lightbox-link><img src=../ja/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/k8s-cluster.png alt=cluster class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a49b92f37f8a098d65cbc1c04204fc3a><img src=../ja/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/k8s-cluster.png alt=cluster class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></li><li><p>Kubernetes Navigator では、健全性を色で示します。ご覧の通り、2つの Pod またはサービスが健全ではなく、Failed 状態にあります（<strong>1</strong>）。残りは問題なく動いています。これは共用の Kubernetes 環境では一般的に発生することがあるもので、ワークショップではこれを再現しています。</p></li><li><p>サイドにあるタイルに注目してください。<strong>Nodes dependencies</strong>（<strong>2</strong>）の下に、MySQL と Redis のタイルが表示されています。これらは我々のeコマースアプリケーションで使用されている2つのデータベースです。</p></li></ul></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Node Dependencies</div><div class=box-content><p>OpenTelemetry Collector による監視が構成されている場合、UI 上には選択したノードで実行されているサービスが表示されます。</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>Redis</strong> タイルをクリックすると、<strong>Redis instances</strong> ナビゲータに移動します。<strong>REDIS INSTANCE</strong> の下で <strong>redis-[WORKSHOPの名前]</strong> をクリックします。</li><li>これにより、<strong>Redis instance</strong> に移動します。このナビゲータは、我々のeコマースサイトのアクティブな Redis インスタンスからのメトリクスデータを含むチャートを表示します。
<a href=#R-image-623b943d563b768a6c114c40d95fc689 class=lightbox-link><img src=../ja/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/redis-2.png alt=redis class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-623b943d563b768a6c114c40d95fc689><img src=../ja/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/redis-2.png alt=redis class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul><div class=tab-panel data-tab-group=a703cf70b7916acd3cc9b150d1459306><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=質問 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("a703cf70b7916acd3cc9b150d1459306","質問")'>
<span class=tab-nav-text>質問</span></button>
<button data-tab-item=回答 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a703cf70b7916acd3cc9b150d1459306","回答")'>
<span class=tab-nav-text>回答</span></button></div><div class=tab-content-container><div data-tab-item=質問 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>このビューでの Instance dependencies タイルの名前を挙げられますか？</strong></p></div></div><div data-tab-item=回答 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>はい、Kubernetes に関するタイルです。</strong></p></div></div></div></div><ul><li>タイルをクリックすると、Redis サービスを実行する Pod が表示される Pod レベルでの Kubernetes Navigator に移動します。</li><li>クラスターレベルに戻るには、画面の上部にある <strong>Cluster</strong>（<strong>1</strong>）のリンクをクリックします。</li></ul><p><a href=#R-image-788c9186a007ba37e75f370e5392ce92 class=lightbox-link><img src=../ja/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/node-link.png alt=node class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-788c9186a007ba37e75f370e5392ce92><img src=../ja/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/node-link.png alt=node class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></div></div><p>これで <strong>Splunk Observability Cloud</strong> のツアーが完了しました。</p><p>さて、仮想の💶をお持ちいただき、eコマースサイト「Online Boutique」を見て、ショッピングをしてみましょう。</p><footer class=footline></footer></article></section></section><article class=default><header class=headline></header><h1 id=lets-go-shopping->Let's go shopping 💶</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5 分</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> ペルソナ</div><div class=box-content><p>あなたは<strong>都会に暮らす、流行に敏感な人です</strong>。有名なオンラインブティックショップで次の新しいアイテムを買いたくてウズウズしています。オンラインブティックは、あらゆる流行の最先端を求める人のニーズを満たす場所であると聞いています。</p></div></div><p>この演習の目的は、オンラインブティックのウェブアプリケーションとやり取りすることです。これは Splunk Observability Cloud の機能をデモンストレーションするために使用されるサンプルアプリケーションで、アイテムを閲覧し、カートに追加してからチェックアウトすることができるシンプルなeコマースサイトです。</p><p>アプリケーションは既に展開されており、インストラクターからオンラインブティックのウェブサイトへのリンクが提供されます。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise - ショッピングを始めましょう</div><div class=box-content><ul><li>オンラインブティックへのリンクが手に入ったら、いくつかのアイテムを見て、カートに追加して、最後にチェックアウトしてみてください。</li><li>この演習を数回繰り返し、可能であれば異なるブラウザ、モバイルデバイス、またはタブレットを使用してください。これにより、調査のために利用するより多くのデータを生成することができます。</li></ul></div></div><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Hint</div><div class=box-content><p>ページの読み込みを待っている間に、マウスカーソルをページ上で動かしてください。これにより、後でこのワークショップで調査を行うためのさらに多くのデータが生成されます。</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise（続き）</div><div class=box-content><ul><li>チェックアウト処理で何か気づきませんか？ 完了までに時間がかかったように見えましたが、最終的には完了しましたか？ こういったことが発生した場合は、<strong>注文確認 ID (Order Confirmation ID)</strong> をコピーして、後で使用できるようにローカルに保存してください。</li><li>ショッピングに使用したブラウザセッションを閉じてください。</li></ul></div></div><p>ユーザーエクスペリエンスが悪いと感じるかもしれません。これは潜在的な顧客満足度の問題なので、これを解決するために手を打ってみましょう。</p><p><a href=#R-image-daafe84861951bb574dec545ca0966e8 class=lightbox-link><img src=../ja/s4r/4-online-boutique/images/shop.png alt="Online Boutique" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-daafe84861951bb574dec545ca0966e8><img src=../ja/s4r/4-online-boutique/images/shop.png alt="Online Boutique" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>では、<strong>Splunk RUM</strong> でデータがどのように見えるか、確認してみましょう。</p><footer class=footline></footer></article><article class=chapter><header class=headline></header><div class=article-subheading>第5章</div><h1 id=splunk-rum>Splunk RUM</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>15 分</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> ペルソナ</div><div class=box-content><p>あなたは<strong>フロントエンドエンジニア</strong>または <strong>SRE</strong> で、パフォーマンスの問題について最初のトリアージを実行するように指示されています。オンラインブティックアプリケーションに関する潜在的な顧客満足度の問題を調査するように求められています。</p></div></div><p>私たちは、すべての参加者のブラウザセッションから受信したテレメトリによって提供された実際のユーザーデータを調査します。目標は、パフォーマンスが低い可能性のあるブラウザ、モバイル、またはタブレットセッションを見つけ、トラブルシューティングプロセスを開始することです。</p><footer class=footline></footer></article><section><h1 class=a11y-only>Splunk RUMのサブセクション</h1><article class=default><header class=headline></header><h1 id=1-rum-ダッシュボード>1. RUM ダッシュボード</h1><p>Splunk Observability Cloud のメインメニューから <strong>RUM</strong> をクリックします。RUM ホームページに移動しますが、このビューは以前の短い紹介で既に見たことがあるでしょう。</p><p><a href=#R-image-bddb9f34b6d5749fcc1a36d6def0763f class=lightbox-link><img src=../ja/s4r/5-rum/1-rum-dashboard/../images/multiple-apps.png alt="multiple apps" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bddb9f34b6d5749fcc1a36d6def0763f><img src=../ja/s4r/5-rum/1-rum-dashboard/../images/multiple-apps.png alt="multiple apps" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>あなたのワークショップ環境が選択されていることを確かめるために、次のようにドロップダウンが設定/選択されていることを確認してください。<ul><li><strong>時間枠</strong>が <strong>-15m</strong> に設定されています。</li><li><strong>Environment</strong> は <strong>[NAME OF WORKSHOP]-workshop</strong> が選択されています。</li><li><strong>App</strong> は <strong>[NAME OF WORKSHOP]-store</strong> が選択されています。</li><li><strong>Source</strong> は <strong>All</strong> に設定されています。</li></ul></li><li>次に、<strong>Page Views / JavaScript Errors</strong> チャートの上にある <strong>[NAME OF WORKSHOP]-store</strong> をクリックします。</li><li>これにより、新しいダッシュボードビューが表示され、メトリクスが <strong>UX Metrics</strong>、<strong>Front-end Health</strong>、<strong>Back-end Health</strong>、<strong>Custom Events</strong> に分解され、それらを過去のメトリクスと比較します（デフォルトでは1時間）。</li></ul></div></div><p><a href=#R-image-17980f8b8f26722ffc7d5a68de5c3976 class=lightbox-link><img src=../ja/s4r/5-rum/1-rum-dashboard/../images/rum-dashboard.png alt="RUM Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-17980f8b8f26722ffc7d5a68de5c3976><img src=../ja/s4r/5-rum/1-rum-dashboard/../images/rum-dashboard.png alt="RUM Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li><strong>UX Metrics:</strong> ページビュー、ページ読み込み、Web Vitals メトリクス。</li><li><strong>Front-end Health:</strong> Javascript エラーおよび Long Task の期間と回数の分解。</li><li><strong>Back-end Health:</strong> ネットワークエラーおよびリクエスト、Time to First Byte。</li><li><strong>Custom Events:</strong> カスタムイベントの RED メトリクス（Rate、Error＆Duration）。</li></ul><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>各タブ（<strong>UX Metrics</strong>、<strong>Front-end Health</strong>、<strong>Back-end Health</strong>、<strong>Custom Events</strong>）をクリックしてデータを調査してください。</li></ul><div class=tab-panel data-tab-group=6e723486b5fdb91490b86b5bcbf97ee0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("6e723486b5fdb91490b86b5bcbf97ee0","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("6e723486b5fdb91490b86b5bcbf97ee0","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><em><em><em>Custom Events</em> タブのチャートを調査した場合、明確に</em>処理時間の急激な増加</em>を示しているチャートはどれですか？**</p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong><em>Custom Event Latency</em> チャートです。</strong></p></div></div></div></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=2-tag-spotlight>2. Tag Spotlight</h1><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><p><strong>Custom Events</strong> タブが選択されていることを確認してください。</p></li><li><p><strong>Custom Event Latency</strong> チャートを見てください。ここで表示されるメトリクスは、アプリケーションのレイテンシを示しています。横に表示されている比較メトリクスは、1時間前と比較したレイテンシを示しています（これは上部のフィルターバーで選択されています）。</p></li><li><p>チャートタイトルの下にある <strong>see all</strong> リンクをクリックします。</p></li></ul></div></div><p><a href=#R-image-73e2d15f949848be876c50d0c4b17365 class=lightbox-link><img src=../ja/s4r/5-rum/2-tag-spotlight/../images/rum-tag-spotlight.png alt="RUM Tag Spotlight" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-73e2d15f949848be876c50d0c4b17365><img src=../ja/s4r/5-rum/2-tag-spotlight/../images/rum-tag-spotlight.png alt="RUM Tag Spotlight" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>このダッシュボードビューでは、RUM データに関連付けられたすべてのタグが表示されます。タグは、データを識別するために使用されるキーと値のペアです。この場合、タグは OpenTelemetry の計装によって自動的に生成されます。これらのタグはデータをフィルタリングし、チャートやテーブルを作成するために使用されます。Tag Spotlight ビューを使用することで、ユーザーセッションに関するドリルダウンができます。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>タイムフレームを <strong>Last 1 hour</strong> に変更します。</li><li><strong>Add Filters</strong> をクリックし、<strong>OS Version</strong> を選択し、<strong>!=</strong> をクリックして <strong>Synthetics</strong> および <strong>RUMLoadGen</strong> を選択し、<span class="btn cstyle blue"><span><span class=title>Apply Filter</span></span></span> ボタンをクリックします。</li><li><strong>Custom Event Name</strong> チャートを見つけ、リストで <strong>PlaceOrder</strong> を見つけてクリックし、<strong>Add to filter</strong> を選択します。</li><li>グラフ上の大きなスパイクに注意してください。</li><li><strong>User Sessions</strong> タブをクリックします。</li><li>表の上で <strong>Duration</strong> 見出しを2回クリックして、セッションを持続時間の降順でソートします。</li><li>テーブルの上にある<i class="fa-fw fas fa-cog"></i>をクリックし、<strong>Sf Geo City</strong> を追加の列のリストから選択して、<span class="btn cstyle blue"><span><span class=title>Save</span></span></span> をクリックします。</li></ul></div></div><p>これで、最長の処理時間から降順に並べられ、サイトで買い物をしているすべてのユーザーの都市を含むユーザーセッションテーブルができました。さらにデータを絞り込むために、OSバージョン、ブラウザバージョンなどを適用できます。</p><p><a href=#R-image-beb9173fc3d56e7c3ae160d112eeffd7 class=lightbox-link><img src=../ja/s4r/5-rum/2-tag-spotlight/../images/rum-user-sessions.png alt="RUM Tag Spotlight" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-beb9173fc3d56e7c3ae160d112eeffd7><img src=../ja/s4r/5-rum/2-tag-spotlight/../images/rum-user-sessions.png alt="RUM Tag Spotlight" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=3-session-replay>3. Session Replay</h1><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> セッション</div><div class=box-content><p>セッションは、あるユーザーがアプリケーションを操作するときに実行するアクションに対応するトレースの集合です。 デフォルトでは、セッションは、セッション内でキャプチャされた最後のイベントから 15 分が経過するまで継続します。 セッションの最大継続時間は 4 時間です。</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>User Sessions</strong> テーブルで、最長の <strong>Duration</strong>（20秒以上）を持つトップの <strong>Session ID</strong> をクリックします。これにより、RUM セッションビューに移動します。</li></ul></div></div><p><a href=#R-image-e67e997c97b99aeca780a2cbd9eb9e4a class=lightbox-link><img src=../ja/s4r/5-rum/3-session-replay/../images/rum-session.png alt="RUM Session" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e67e997c97b99aeca780a2cbd9eb9e4a><img src=../ja/s4r/5-rum/3-session-replay/../images/rum-session.png alt="RUM Session" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>RUM セッションリプレイ <span class="btn cstyle transparent"><span><i class="fa-fw fas fa-play"></i> <span class=title>Replay</span></span></span> ボタンをクリックします。RUM セッションリプレイを使用すると、ユーザーセッションを再生して表示できます。これはユーザーが実際にどのような体験をしたかを正確に確認するための素晴らしい方法です。</li><li>リプレイを開始するためにボタンをクリックします。</li></ul></div></div><p><a href=#R-image-1931b8bd827f3a2032f7a3c38a66657d class=lightbox-link><img src=../ja/s4r/5-rum/3-session-replay/../images/rum-session-replay.png alt="RUM Session" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1931b8bd827f3a2032f7a3c38a66657d><img src=../ja/s4r/5-rum/3-session-replay/../images/rum-session-replay.png alt="RUM Session" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>RUM セッションリプレイでは、デフォルトでテキストがマスキングされますが、画像もマスキングできます（このワークショップの例ではマスキングされています）。これは、セッションに機密情報が含まれている場合に役立ちます。再生速度を変更したり、リプレイを一時停止したりすることもできます。</p><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Tip</div><div class=box-content><p>セッションを再生する際に、マウスの動きがどのようにキャプチャされるかに注目してください。これは、ユーザーがどこに注意を集中しているかを確認するのに役立ちます。</p></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=4-user-sessions>4. User Sessions</h1><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>RUM Session Replay 右上の <strong>X</strong> をクリックして閉じます。前回の演習で <strong>PlaceOrder</strong> にフィルターを設定していました。この演習でも選択されているはずです。以下のスクリーンショット（<strong>1</strong>）に示されています。</li><li>スパンの長さに注意してください。これは注文を完了するのにかかった時間です。良くありません！</li><li>ページを下にスクロールすると、<strong>Tags</strong> メタデータ（Tag Spotlight で使用される）が表示されます。タグの後には、読み込まれたページオブジェクトが表示されます（HTML、CSS、画像、JavaScriptなど）。</li><li>ページを下にスクロールして、青い <strong>APM</strong> リンク（URLの末尾に <code>/cart/checkout</code> が含まれているもの）にカーソルを合わせます。</li></ul></div></div><p><a href=#R-image-3d5a96f4ab633ed568ae81067978f1e7 class=lightbox-link><img src=../ja/s4r/5-rum/4-user-session/../images/rum-waterfall.png alt="RUM Session" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3d5a96f4ab633ed568ae81067978f1e7><img src=../ja/s4r/5-rum/4-user-session/../images/rum-waterfall.png alt="RUM Session" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これにより、APM パフォーマンスサマリーが表示されます。これはトラブルシューティング時に非常に役立つ End to End（RUM から APM への）ビューです。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>paymentservice</strong>（<strong>2</strong>）と <strong>checkoutservice</strong>（<strong>3</strong>）がエラー状態であることがスクリーンショットで確認できます。</li><li><strong>Workflow Name</strong> の下にある <code>front-end:/cart/checkout</code> をクリックすると、<strong>APM Service Map</strong> が表示されます。</li></ul></div></div><p><a href=#R-image-d65810759e863c1ea1897a38aa91a3dd class=lightbox-link><img src=../ja/s4r/5-rum/4-user-session/../images/rum-to-apm.png alt="RUM to APM" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d65810759e863c1ea1897a38aa91a3dd><img src=../ja/s4r/5-rum/4-user-session/../images/rum-to-apm.png alt="RUM to APM" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article></section><article class=chapter><header class=headline></header><div class=article-subheading>第6章</div><h1 id=splunk-apm>Splunk APM</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>20 minutes</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> ペルソナ</div><div class=box-content><p>あなたは<strong>バックエンドの開発者</strong>で、SRE によって発見された問題の調査を支援するように呼ばれました。SRE はユーザーエクスペリエンスが悪いと特定し、その問題の調査をお願いしています。</p></div></div><p>RUM トレース（フロントエンド）から APM トレース（バックエンド）にジャンプすることで、完全な End to End の可視性の力を理解できるでしょう。すべてのサービスが Splunk Observability Cloud によって視覚化、分析、異常およびエラーの検出が可能となるテレメトリ（トレースやスパン）を送信しています。</p><p>RUM と APM は同じコインの二つの側面です。RUM はアプリケーションのクライアント側のビューであり、APM はサーバー側のビューです。このセクションでは、APM を使用してどこに問題が潜んでいるかドリルダウンし、特定します。</p><footer class=footline></footer></article><section><h1 class=a11y-only>Splunk APMのサブセクション</h1><article class=default><header class=headline></header><h1 id=1-apm-explore>1. APM Explore</h1><p>APM サービスマップは、APM で計装されたサービス、および、存在が推測されるサービス間の依存関係とつながりを表示します。このマップは、時間範囲、環境、ワークフロー、サービス、およびタグのフィルタで選択した内容に基づいて動的に生成されます。</p><p>RUM ウォーターフォールで APM リンクをクリックすると、サービスマップビューに自動的にフィルタが追加され、その <strong>Workflow Name</strong>（<code>frontend:/cart/checkout</code>）に関与したサービスが表示されます。</p><p><strong>Service Map</strong> でワークフローに関係するサービスが表示されます。画面右側の <strong>Business Workflow</strong> の下には、選択したワークフローのチャートが表示されます。<strong>Service Map</strong> と <strong>Business Workflow</strong> のチャートは同期されています。<strong>Service Map</strong> 内であるサービスを選択すると、<strong>Business Workflow</strong> ペインのチャートが更新され、選択したサービスのメトリクスが表示されます。</p><p><a href=#R-image-493f1d40c4558e969d0e853b07bfebdc class=lightbox-link><img src=../ja/s4r/6-apm/1-apm-explore/../images/apm-business-workflow.png alt="APM Business Workflow" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-493f1d40c4558e969d0e853b07bfebdc><img src=../ja/s4r/6-apm/1-apm-explore/../images/apm-business-workflow.png alt="APM Business Workflow" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>paymentservice</strong> を Service Map でクリックしてください。</li></ul></div></div><p><a href=#R-image-b88766299ef47b0b5cae54cc7061e27b class=lightbox-link><img src=../ja/s4r/6-apm/1-apm-explore/../images/apm-explore.png alt="APM Explore" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b88766299ef47b0b5cae54cc7061e27b><img src=../ja/s4r/6-apm/1-apm-explore/../images/apm-explore.png alt="APM Explore" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Splunk APM は、発生している問題をリアルタイムに確認し、特定のサービス、特定のエンドポイント、またはこれらを支えるインフラストラクチャに関連しているかどうかを迅速に判断するために利用できる、メトリクスをチャートとして可視化する一連の組み込みダッシュボードを提供しています。これを詳しく見てみましょう。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>paymentservice</strong> パネルの右上にある <strong>View Dashboard</strong> をクリックしてください。</li></ul></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=2-apm-service-dashboard>2. APM Service Dashboard</h1><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Service Dashboard</div><div class=box-content><p>APM サービスダッシュボードは、サービス、エンドポイント、および Business Workflow のエンドポイントスパンから生成されたモニタリングメトリクセットに基づいて、リクエスト、エラー、および所要時間（<strong>RED</strong>）メトリクスを提供します。ダッシュボードを下にスクロールすると、基盤や Kubernetes に関連するメトリクスも表示され、インフラストラクチャに問題があるかどうかを判断するのに役立ちます。</p></div></div><p><a href=#R-image-e0f435b9cd137f86307cc4678d4db9b7 class=lightbox-link><img src=../ja/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-dashboard.png alt="Service Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e0f435b9cd137f86307cc4678d4db9b7><img src=../ja/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-dashboard.png alt="Service Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>Time</strong> の枠 <strong>(1)</strong> を確認してください。ダッシュボードには、選択したアプリケーションの APM トレースによって取得された、処理にかかった時間に関するデータのみが表示されています（チャートは静的です）。</li><li><strong>Time</strong> の枠に <strong>-1h</strong> と入力し、Enter キーを押します。</li><li><strong>Request rate</strong>、<strong>Request latency (p90)</strong>、<strong>Error rate</strong> の Single Value チャートは 10 秒ごとに更新されており、引き続き多くのエラーが発生していることを示しています。</li><li>これらのチャートはパフォーマンスの問題を迅速に特定するのに非常に役立ちます。このダッシュボードを使用してサービスの健康状態を監視したり、ダッシュボードを作成・構成する際のベースとして利用することができます。</li><li>これらのチャートをいくつか、後の演習で使用したいと思います。<ul><li><strong>Request rate</strong> Single Value チャート(<strong>2</strong>)で <strong>&mldr;</strong> をクリックし、<strong>Copy</strong> を選択します。これにより、ページの右上(<strong>3</strong>)の部分に <strong>1</strong> が表示され、クリップボードにコピーされたチャートがあることを示しています。</li><li><strong>Request rate</strong> の折れ線グラフ(<strong>4</strong>)では、<strong>Add to clipboard</strong> アイコンをクリックしてクリップボードに追加するか、<strong>&mldr;</strong> を使用して <strong>Add to clipboard</strong> を選択します。</li></ul></li><li>ページの右上(<strong>3</strong>)の部分に<strong>2</strong>が表示されていることを確認してください。</li><li>それでは、エクスプロービューに戻りましょう。ブラウザの戻るボタンをクリックしてください。</li></ul></div></div><p><a href=#R-image-9b8243c90721f1029e8e52b42981205f class=lightbox-link><img src=../ja/s4r/6-apm/2-apm-service-dashboard/../images/apm-explore.png alt="APM Explore" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9b8243c90721f1029e8e52b42981205f><img src=../ja/s4r/6-apm/2-apm-service-dashboard/../images/apm-explore.png alt="APM Explore" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><div class=tab-panel data-tab-group=89880e85b64b3b968996779ffe3b261c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("89880e85b64b3b968996779ffe3b261c","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("89880e85b64b3b968996779ffe3b261c","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>サービスマップで <strong>paymentservice</strong> の上にカーソルを合わせてください。ポップアップして表示されたサービスに関するチャートからどんなことがわかりますか？</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>エラー率が非常に高いです。</strong></p></div></div></div></div></div></div><p><a href=#R-image-05887d92f07c85989fd9c7c04d0619e6 class=lightbox-link><img src=../ja/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-popup-chart.png alt="APM Service Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-05887d92f07c85989fd9c7c04d0619e6><img src=../ja/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-popup-chart.png alt="APM Service Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>このエラー率にパターンがあるかどうかを理解する必要があります。そのためには、<strong>Tag Spotlight</strong> が便利です。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=3-apm-tag-spotlight>3. APM Tag Spotlight</h1><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>paymentservice</strong> のタグを表示するには、<strong>paymentservice</strong> をクリックしてから右側の機能ペインで <strong>Tag Spotlight</strong> をクリックします（画面解像度によってはスクロールが必要な場合があります）。</li><li><strong>Tag Spotlight</strong> に入ったら、<strong>Show tags with no values</strong> のトグルスイッチがオフになっていることを確認してください。</li></ul></div></div><p><a href=#R-image-5544d3419f0f394c55836ce2c2210b39 class=lightbox-link><img src=../ja/s4r/6-apm/3-apm-tag-spotlight/../images/apm-tag-spotlight.png alt="APM Tag Spotlight" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5544d3419f0f394c55836ce2c2210b39><img src=../ja/s4r/6-apm/3-apm-tag-spotlight/../images/apm-tag-spotlight.png alt="APM Tag Spotlight" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Tag Spotlight</strong> には、2つの表示モードがあります。デフォルトは <strong>Request/Errors</strong> で、もう1つは <strong>Latency</strong> です。</p><p>Request/Error チャートでは、リクエストの合計数、エラーの合計数、および根本原因のエラーが表示されます。Latency チャートでは、p50、p90、および p99 のレイテンシが表示されます。これらの値は、Splunk APM がインデックス化された各スパンタグに対して生成する Troubleshooting MetricSets（TMS）に基づいています。これらは RED メトリクス（リクエスト、エラー、および所要時間）として知られています。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><div class=tab-panel data-tab-group=f1c4aceaab2db36bbe92516a2279dec7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("f1c4aceaab2db36bbe92516a2279dec7","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("f1c4aceaab2db36bbe92516a2279dec7","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>どのチャートが問題を特定するタグでしょうか？</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong><em>version</em> チャートです。<code>v350.10</code> に対するリクエストの数はエラーの数と一致しています。</strong></p></div></div></div></div><ul><li>これで、問題を引き起こしている <strong>paymentservice</strong> のバージョンを特定したので、エラーに関する詳細情報を見つけることができるかどうかを確認してみましょう。ページの上部にある <strong>← Tag Spotlight</strong> をクリックして Service Map に戻ります。</li></ul></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=4-apm-service-breakdown>4. APM Service Breakdown</h1><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>右側のペインで <span class="btn cstyle grey"><span><span class=title>Breakdown</span></span></span> をクリックします。</li><li>リストから <code>tenant.level</code> を選択します。これは顧客のステータスを表すタグであり、顧客のステータスに関連するトレンドを見るのに役立ちます。</li><li>Service Map で <strong>gold</strong> をクリックして選択します。</li><li>さらに <span class="btn cstyle grey"><span><span class=title>Breakdown</span></span></span> をクリックし、<code>version</code> を選択します。これはサービスのバージョンを示すタグです。</li><li><strong>silver</strong> と <strong>bronze</strong> についても同様の手順を繰り返します。</li></ul><div class=tab-panel data-tab-group=eb6e0eb93969df7485b9ab675496ab9f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=質問 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("eb6e0eb93969df7485b9ab675496ab9f","質問")'>
<span class=tab-nav-text>質問</span></button>
<button data-tab-item=回答 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("eb6e0eb93969df7485b9ab675496ab9f","回答")'>
<span class=tab-nav-text>回答</span></button></div><div class=tab-content-container><div data-tab-item=質問 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>見ているものからどんな結論を得ることができますか？</strong></p></div></div><div data-tab-item=回答 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>すべてのテナントがバージョン <code>v350.10</code> による影響を受けている</strong></p></div></div></div></div></div></div><p><strong>paymentservice</strong> が <strong>gold</strong>、<strong>silver</strong>、<strong>bronze</strong> の3つのサービスに分けて表示されていることが分かるでしょう。各テナントはバージョン (<code>v350.10</code> と <code>v350.9</code>) ごとのサービスに分けられています。</p><p><a href=#R-image-b67bf651a3486d2ea8475147b2d57d6f class=lightbox-link><img src=../ja/s4r/6-apm/4-apm-service-breakdown/../images/apm-service-breakdown.png alt="APM サービスのBreakdown" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b67bf651a3486d2ea8475147b2d57d6f><img src=../ja/s4r/6-apm/4-apm-service-breakdown/../images/apm-service-breakdown.png alt="APM サービスのBreakdown" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>3つの赤い円を囲む外側のメインボックスをクリックします。ボックスがハイライト表示されます。</li></ul></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> スパンのタグ</div><div class=box-content><p>スパンに付与されるタグに基づいてサービスの分析は非常に強力な機能です。これにより、異なる顧客、異なるバージョン、異なる地域などに対するサービスのパフォーマンスを確認できます。この演習では、<strong>paymentservice</strong> の <code>v350.10</code> がすべての顧客に問題を引き起こしていることが判明しました。</p></div></div><p>次に、トレースを詳細に調査して問題の原因を見つける必要があります。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=5-apm-trace-analyzer>5. APM Trace Analyzer</h1><p>Splunk APM では、<strong>NoSample™</strong> の End to End の可視性が提供され、すべてのサービスのトレースがキャプチャされます。このワークショップでは、<strong>Order Confirmation ID</strong> がタグとして利用可能です。これにより、ワークショップの前半で遭遇したユーザーエクスペリエンスの問題のトレースを正確に検索できます。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Trace Analyzer</div><div class=box-content><p>Splunk Observability Cloud は、アプリケーションモニタリングデータを探索するための複数のツールを提供しています。<strong>Trace Analyzer</strong> は、未知の問題や新しい問題を調査するために高カーディナリティで粒度の細かなデータを検索・探索するシナリオに適しています。</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>paymentservice</strong> の外側のボックスを選択した状態で、右側のペインで <strong>Traces</strong> をクリックします。</li><li><strong>Trace Analyzer</strong> を使用していることを確認するために、<span class="btn cstyle transparent"><span><span class=title>Switch to Classic View</span></span></span> が表示されていることを確認します。表示されていない場合は、<span class="btn cstyle blue"><span><span class=title>Switch to Trace Analyzer</span></span></span> をクリックします。</li></ul></div></div><p><a href=#R-image-9d239a0753bcefbe6ebd7e99151fef75 class=lightbox-link><img src=../ja/s4r/6-apm/5-apm-trace-analyzed/../images/apm-trace-analyzer.png alt="APM Trace Analyzer" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9d239a0753bcefbe6ebd7e99151fef75><img src=../ja/s4r/6-apm/5-apm-trace-analyzed/../images/apm-trace-analyzer.png alt="APM Trace Analyzer" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>表示する時間枠として <strong>Last 1 hour</strong> を選択します。</li><li>ほとんどのトレースがエラー（赤）であり、エラーのない（青の）トレースは限られています。</li><li><strong>Sample Ratio</strong> が <code>1:10</code> ではなく <code>1:1</code> に設定されていることを確認します。</li><li><strong>Add filters</strong> をクリックし、<code>orderId</code> を入力し、リストから <strong>orderId</strong> を選択します。</li><li>ワークショップの前半でショッピングを行った際の <strong>Order Confirmation ID</strong> を貼り付けて Enter キーを押します。入力する ID が分からない場合は、インストラクターにお問い合わせください。
<a href=#R-image-76db02ef4c4af479165dfe66278bd227 class=lightbox-link><img src=../ja/s4r/6-apm/5-apm-trace-analyzed/../images/apm-trace-by-duration.png alt="Traces by Duration" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-76db02ef4c4af479165dfe66278bd227><img src=../ja/s4r/6-apm/5-apm-trace-analyzed/../images/apm-trace-by-duration.png alt="Traces by Duration" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul></div></div><p>これで、あなたが体験した、チェックアウト処理で長時間待たされユーザーエクスペリエンスを損ねていた処理のトレースを絞り込むことができました。このトレースは最大13ヶ月間アクセスすることができます。そのため、例えば、開発者は後日この問題に再び取り組む際にも、このトレースを確認できるでしょう。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>リスト内のトレースをクリックします。</li></ul></div></div><p>次に、トレースのウォーターフォールを見ていきましょう。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=6-apm-waterfall>6. APM Waterfall</h1><p><strong>Trace Analyzer</strong> から <strong>Trace Waterfall</strong> に移動しました。トレースは、同じトレース ID を共有するスパンの集合であり、アプリケーションとその構成サービスによって処理される一意のトランザクションを表します。</p><p>Splunk APM の各スパンは、単一の操作をキャプチャします。Splunk APM は、スパンに記録された操作がエラーとなった場合、スパンをエラースパンと見なします。</p><p><a href=#R-image-41d560d9142283a3e88d38eedff01f4c class=lightbox-link><img src=../ja/s4r/6-apm/6-apm-waterfall/../images/apm-trace-waterfall.png alt="Trace Waterfall" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-41d560d9142283a3e88d38eedff01f4c><img src=../ja/s4r/6-apm/6-apm-waterfall/../images/apm-trace-waterfall.png alt="Trace Waterfall" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>ウォーターフォール内の <code>paymentservice:grpc.hipstershop.PaymentService/Charge</code> スパンの隣にある <span class="btn cstyle red"><span><span class=title>!</span></span></span> をクリックします。</li></ul><div class=tab-panel data-tab-group=96373e73d2290b4a30db50afd6691ef1><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=質問 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("96373e73d2290b4a30db50afd6691ef1","質問")'>
<span class=tab-nav-text>質問</span></button>
<button data-tab-item=回答 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("96373e73d2290b4a30db50afd6691ef1","回答")'>
<span class=tab-nav-text>回答</span></button></div><div class=tab-content-container><div data-tab-item=質問 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>スパンのメタデータに記録されているエラーメッセージとバージョンは何ですか？</strong></p></div></div><div data-tab-item=回答 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>無効なリクエストと <code>v350.10</code></strong>。</p></div></div></div></div></div></div><p>問題を引き起こしている <strong>paymentservice</strong> のバージョンを既に特定しているので、エラーに関してより詳細な情報を見つけられるか、やってみましょう。ここで <strong>Related logs</strong> が役立ちます。</p><p><a href=#R-image-555188e56456f05eed091e22020e0e53 class=lightbox-link><img src=../ja/s4r/6-apm/6-apm-waterfall/../images/apm-related-logs.png alt="Related Logs" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-555188e56456f05eed091e22020e0e53><img src=../ja/s4r/6-apm/6-apm-waterfall/../images/apm-related-logs.png alt="Related Logs" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>関連するコンテンツは、特定のメタデータによって実現されており、これにより、APM, Infrastructure Monitoring, Log Observer が Splunk Observability Cloud 内でフィルター条件を共有することで可能になっています。Related Logs が機能するには、ログに次のメタデータが必要です。</p><ul><li><code>service.name</code></li><li><code>deployment.environment</code></li><li><code>host.name</code></li><li><code>trace_id</code></li><li><code>span_id</code></li></ul><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>Trace Waterfall</strong> の一番下で <strong>Logs (1)</strong> と書かれた部分をクリックします。これにより、このトレースに紐づく <strong>Related Logs</strong> があることが分かります。</li><li>ポップアップ内の <strong>Logs for trace XXX</strong> エントリをクリックすると、トレース全体と関係のあるログが <strong>Log Observer</strong> で表示されます。</li></ul></div></div><footer class=footline></footer></article></section><article class=chapter><header class=headline></header><div class=article-subheading>第7章</div><h1 id=splunk-log-observer>Splunk Log Observer</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>20 分</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> ペルソナ</div><div class=box-content><p>引き続き <strong>バックエンド開発者</strong> の役割で、アプリケーションのログを調査して問題の原因を特定する必要があります。</p></div></div><p>APM トレースに関連するコンテンツ（ログ）を使用して、Splunk Log Observer を使用して問題を正確に理解するために、深掘りをしていきます。</p><p>Related Content は、1つのコンポーネントから別のコンポーネントにジャンプするための強力な機能で、<strong>メトリクス</strong>、<strong>トレース</strong>、および <strong>ログ</strong> に対して利用できます。</p><footer class=footline></footer></article><section><h1 class=a11y-only>Splunk Log Observerのサブセクション</h1><article class=default><header class=headline></header><h1 id=1-log-filtering>1. Log Filtering</h1><p><strong>Log Observer (LO)</strong> は複数の方法で使用できます。クイックツアーでは、LO <strong>ノーコードインターフェース</strong> を使用してログの特定のエントリを検索しました。ただし、このセクションでは、APM のトレースから LO に移動したと想定しています。</p><p>RUM と APM の間のリンクと同じように、前のアクションのコンテキストを引き継いでログを調査することができるのは一つの利点です。今回の場合、時間枠（<strong>1</strong>）を見てみると、これはトレースが取得された時間帯と一致しています。また、Filter(<strong>2</strong>)にも、<strong>trace_id</strong> の情報が既に設定されています。</p><p><a href=#R-image-139cf677d0770d32bb0d8412ec827474 class=lightbox-link><img src=../ja/s4r/7-log-observer/1-log-filtering/../images/log-observer-trace-logs.png alt="Trace Logs" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-139cf677d0770d32bb0d8412ec827474><img src=../ja/s4r/7-log-observer/1-log-filtering/../images/log-observer-trace-logs.png alt="Trace Logs" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>このビューには、オンラインブティックでエンドユーザーが実施した操作によって実行されたバックエンドのトランザクションに関わる <strong>すべて</strong> のアプリケーションまたはサービスの <strong>すべて</strong> のログ行が含まれます。</p><p>オンラインブティックのような小さなアプリケーションでも、膨大な量のログが検出され、調査をしている実際のインシデントに関わる特定のログを見つけ出すのが難しくなる場合があります。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><p>ログに含まれるエラーメッセージだけに焦点を当てる必要があります。</p><ul><li><strong>Group By</strong> ドロップダウンボックスをクリックして、<strong>Severity</strong> を検索します。</li><li>選択したら、<span class="btn cstyle blue"><span><span class=title>Apply</span></span></span> ボタンをクリックします（チャートの凡例が、debug、error、info に変化します）。
<a href=#R-image-7f062d6b3d726154e18a479c2d1a3a08 class=lightbox-link><img src=../ja/s4r/7-log-observer/1-log-filtering/../images/severity-logs.png alt=legend class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7f062d6b3d726154e18a479c2d1a3a08><img src=../ja/s4r/7-log-observer/1-log-filtering/../images/severity-logs.png alt=legend class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>エラーログだけを選択するには、レジェンドの単語 error（<strong>1</strong>）をクリックして、<strong>Add to filter</strong> を選択します。</li><li>複数のサービスに対するエラーログがある場合は、フィルタにサービス名 <code>sf_service=paymentservice</code> を追加することもできます。今回の場合は不要です。
<a href=#R-image-32e9a27a948bfd8683fd051474499e22 class=lightbox-link><img src=../ja/s4r/7-log-observer/1-log-filtering/../images/log-observer-errors.png alt="Error Logs" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-32e9a27a948bfd8683fd051474499e22><img src=../ja/s4r/7-log-observer/1-log-filtering/../images/log-observer-errors.png alt="Error Logs" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul></div></div><p>次に、詳細なログエントリを見ていきましょう。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=2-ログエントリの参照>2. ログエントリの参照</h1><p>特定のログ行を見る前に、これまでに何を行ってきたかと、オブザーバビリティの3本柱に基づいて、なぜここに辿り着いたのかを簡単に振り返りましょう。</p><table><thead><tr><th style=text-align:center>Metrics</th><th style=text-align:center>Traces</th><th style=text-align:center>Logs</th></tr></thead><tbody><tr><td style=text-align:center><em><strong>問題があるか？</strong></em></td><td style=text-align:center><em><strong>問題はどこにあるか？</strong></em></td><td style=text-align:center><em><strong>問題は何か？</strong></em></td></tr></tbody></table><ul><li>メトリクスを使用して、アプリケーションに<strong>問題がある</strong>ことが判明しました。これは、サービスダッシュボードのエラーレートが本来の状態よりも高かったことから明らかです。</li><li>トレースとスパンタグを使用して、<strong>問題がどこにあるか</strong>を見つけました。 <strong>paymentservice</strong> は <code>v350.9</code> と <code>v350.10</code> の2つのバージョンで構成されており、 <code>v350.10</code> に対するエラーレートは <strong>100%</strong> でした。</li><li>バージョン <code>v350.10</code> の <strong>paymentservice</strong> から生成されるエラーがオンラインブティックのチェックアウト処理の応答において、複数回の再試行と長時間の遅延を引き起こしていたことを確認しました。</li><li>トレースから <strong>Related Content</strong> の強力な機能を使用して、失敗した <strong>paymentservice</strong> バージョンのログエントリに到達しました。これにより、問題が <strong>何であるか</strong> を特定できるようになりました。</li></ul><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Logs tables のエラーエントリをクリックします（異なるサービスからのまれなエラーがある場合は、エントリに <code>hostname: "paymentservice-xxxx"</code> と表示されていることを確認してください）。</li></ul><div class=tab-panel data-tab-group=c490e8e4e86742d95fa98bb702142505><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=質問 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("c490e8e4e86742d95fa98bb702142505","質問")'>
<span class=tab-nav-text>質問</span></button>
<button data-tab-item=回答 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("c490e8e4e86742d95fa98bb702142505","回答")'>
<span class=tab-nav-text>回答</span></button></div><div class=tab-content-container><div data-tab-item=質問 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>メッセージに基づくと、問題を解決するためには、開発チームに何を伝えますか？</strong></p></div></div><div data-tab-item=回答 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>開発チームは、有効なAPIトークンを使用してコンテナを再構築およびデプロイするか、 <code>v350.9</code> にロールバックする必要があります。</strong></p></div></div></div></div><p><a href=#R-image-581bbb50638b7728eed0bf6af10c172f class=lightbox-link><img src=../ja/s4r/7-log-observer/2-log-entry/../images/log-observer-log-message.png alt="Log Message" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-581bbb50638b7728eed0bf6af10c172f><img src=../ja/s4r/7-log-observer/2-log-entry/../images/log-observer-log-message.png alt="Log Message" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>ログメッセージペインの <strong>X</strong> をクリックして閉じます。</li></ul></div></div><div class="box notices cstyle blue"><div class=box-label><i class="fa-fw fas fa-wine-bottle"></i> おめでとうございます</div><div class=box-content><p>Splunk Observability Cloud を使用することで、オンラインブティックでのショッピング中にユーザーエクスペリエンスが悪かったのはなぜかを理解することができました。オブザーバビリティの3本柱である <strong>メトリクス</strong>、<strong>トレース</strong>、<strong>ログ</strong> に基づいて、RUM、APM、およびログを利用することで、サービス全体で何が起こっており、その後、その根底にある原因を見つけることができました。</p><p>また、Splunkがもつ、アプリケーションの振る舞いのパターンを検出する <strong>Tag Spotlight</strong> による<strong>インテリジェントなタグ付けと分析</strong>の機能や、問題のコンテキストを維持しながら異なるコンポーネント間を素早く移動する <strong>Related Contents</strong> によるスタック全体を相関させる機能についても、その使い方を理解したはずです。</p></div></div><p>ワークショップの次のパートでは、<strong>問題の特定</strong> から <strong>緩和</strong>、 <strong>予防</strong>、および <strong>プロセスの改善</strong> に進んでいきます。</p><p>次に、カスタムダッシュボードでログチャートを作成します。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=3-log-timeline-chart>3. Log Timeline Chart</h1><p>Log Observer である決まったビューを持っておくと、あるダッシュボードの中でそのビューを活用し、将来的に問題の検出と解決にかかる時間を削減することに寄与するでしょう。ワークショップの一環として、これらのチャートを使用するカスタムダッシュボードの例を作成します。</p><p>まず、<strong>Log Timeline</strong> チャートの作成を見てみましょう。Log Timeline チャートは、時間の経過とともにログメッセージを表示するために使用されます。これはログメッセージの頻度を確認し、パターンを識別するのに適した表現方法です。また、環境全体でのログメッセージの出力傾向を確認するのにも適しています。これらのチャートはカスタムダッシュボードに保存できます。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><p>まず、表示するログの列を必要なものに絞り込みます。</p><ul><li><strong>Logs table</strong> 上の <strong>Configure Table</strong> <i class="fa-fw fas fa-cog"></i> アイコンをクリックして <strong>Table Settings</strong> を開きます。 <code>_raw</code> のチェックを外し、<code>k8s.pod_name</code>, <code>message</code>, <code>version</code> のフィールドが選択されていることを確認します。
<a href=#R-image-44b7490800c8e7f948537bd255f3ef18 class=lightbox-link><img src=../ja/s4r/7-log-observer/3-log-timeline-chart/../images/log-observer-table.png alt="Log Table Settings" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-44b7490800c8e7f948537bd255f3ef18><img src=../ja/s4r/7-log-observer/3-log-timeline-chart/../images/log-observer-table.png alt="Log Table Settings" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>時間枠として固定の時間が入っている設定を外し、 <strong>Last 15 minutes</strong> を設定します。</li><li>すべてのトレースに対してログ参照ができるように、フィルタ設定から <code>trace_id</code> を削除し、 <code>sf_service=paymentservice</code> および <code>sf_environment=[WORKSHOPNAME]</code> フィールドを追加します。</li><li><strong>Save</strong> をクリックし、<strong>Save to Dashboard</strong> を選択します。
<a href=#R-image-ab6cd6af72856c4d9af96ed091234279 class=lightbox-link><img src=../ja/s4r/7-log-observer/3-log-timeline-chart/../images/save-query.png alt="save it" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ab6cd6af72856c4d9af96ed091234279><img src=../ja/s4r/7-log-observer/3-log-timeline-chart/../images/save-query.png alt="save it" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>チャート作成に関するダイアログが表示されます。<strong>Chart name</strong> に <code>Log Timeline</code> を入力します。</li><li>次に、<span class="btn cstyle blue"><span><span class=title>Select Dashboard</span></span></span> をクリックします。ダッシュボード選択のダイアログでは <span class="btn cstyle blue"><span><span class=title>New dashboard</span></span></span> をクリックします。</li><li><strong>New dashboard</strong> ダイアログで、新しいダッシュボードの名前を入力します（Description 欄は入力不要です）。名前には以下を使用します： <code>&lt;受講者の方のイニシャル> - Service Health Dashboard</code> と入力し、 <span class="btn cstyle blue"><span><span class=title>Save</span></span></span> をクリックします。</li><li>新しいダッシュボードがリストでハイライト表示されていることを確認し（<strong>1</strong>）、 <span class="btn cstyle blue"><span><span class=title>OK</span></span></span> をクリックします（<strong>2</strong>）。
<a href=#R-image-e1165aff74e756d3864c4f9cba8ddf8b class=lightbox-link><img src=../ja/s4r/7-log-observer/3-log-timeline-chart/../images/dashboard-save.png alt="Save dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e1165aff74e756d3864c4f9cba8ddf8b><img src=../ja/s4r/7-log-observer/3-log-timeline-chart/../images/dashboard-save.png alt="Save dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li><strong>Chart Type</strong> として <strong>Log Timeline</strong> が選択されていることを確認します。
<a href=#R-image-346b0cc970a953495a016f630d74abda class=lightbox-link><img src="../ja/s4r/7-log-observer/3-log-timeline-chart/../images/log-timeline.png?classes=left&amp;width=25vw" alt="log timeline" class="figure-image noborder left lightbox noshadow" style=height:auto;width:25vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-346b0cc970a953495a016f630d74abda><img src="../ja/s4r/7-log-observer/3-log-timeline-chart/../images/log-timeline.png?classes=left&amp;width=25vw" alt="log timeline" class="lightbox-image noborder left lightbox noshadow" loading=lazy></a></li><li>最後に <span class="btn cstyle transparent"><span><span class=title>Save</span></span></span> ボタンをクリックします（この時点で <strong>Save and goto dashboard</strong> をクリックしないでください）。</li></ul></div></div><p>次に、<strong>Log View</strong> チャートを作成します。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=4-log-view-chart>4. Log View Chart</h1><p>次に、ログに関するチャートタイプである <strong>Log View</strong> チャートタイプを見ていきます。このチャートを使用すると、事前に定義しておいたフィルタに基づいてログメッセージを表示できます。</p><p>前の Log Timeline チャートと同様に、Log View のチャートを Customer Health Service Dashboard に追加します。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>前の演習完了後、<strong>Log Observer</strong> 画面が表示されていることを確認してください。</li><li>フィルタ設定は前の演習と同じです。表示する時間枠を <strong>Last 15 minutes</strong> に設定し、<code>severity=error</code>、<code>sf_service=paymentservice</code> および <code>sf_environment=[WORKSHOPNAME]</code> でフィルタリングしているはずです。</li><li>Log Views のヘッダーについても、前の演習で設定したフィールドのみが選択されていることを確認してください。</li><li>再び <strong>Save</strong> をクリックしてから <strong>Save to Dashboard</strong> をクリックします。</li><li>これにより、改めて、チャート作成ダイアログが提供されます。</li><li><strong>Chart name</strong> に <strong>Log View</strong> を入力します。</li><li>今回は <span class="btn cstyle blue"><span><span class=title>Select Dashboard</span></span></span> をクリックし、前回の演習で作成したダッシュボードを検索します。検索ボックスにご自身のイニシャルを入力することで見つけることができるでしょう。（<strong>1</strong>）。
<a href=#R-image-f2b5c59a8e6cdc68d0fd32ae25131bde class=lightbox-link><img src=../ja/s4r/7-log-observer/4-log-view-chart/../images/search-dashboard.png alt="search dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f2b5c59a8e6cdc68d0fd32ae25131bde><img src=../ja/s4r/7-log-observer/4-log-view-chart/../images/search-dashboard.png alt="search dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>ダッシュボード名をクリックしてハイライト表示し（<strong>2</strong>）、 <span class="btn cstyle blue"><span><span class=title>OK</span></span></span> をクリックします（<strong>3</strong>）。</li><li>これで、チャート作成ダイアログに戻ります。</li><li><strong>Chart Type</strong> として <strong>Log View</strong> が選択されていることを確認してください。
<a href=#R-image-ad73b11998173187c44fb38937376157 class=lightbox-link><img src="../ja/s4r/7-log-observer/4-log-view-chart/../images/log-view.png?classes=left&amp;width=30vw" alt="log view" class="figure-image noborder left lightbox noshadow" style=height:auto;width:30vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ad73b11998173187c44fb38937376157><img src="../ja/s4r/7-log-observer/4-log-view-chart/../images/log-view.png?classes=left&amp;width=30vw" alt="log view" class="lightbox-image noborder left lightbox noshadow" loading=lazy></a></li><li>次に、<span class="btn cstyle blue"><span><span class=title>Save and go to dashboard</span></span></span> をクリックしてダッシュボードを表示します。</li><li>結果的に、以下のようなダッシュボードが表示されるはずです。
<a href=#R-image-82585faa43cf5768b744c54c850d001c class=lightbox-link><img src=../ja/s4r/7-log-observer/4-log-view-chart/../images/log-observer-custom-dashboard.png alt="Custom Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-82585faa43cf5768b744c54c850d001c><img src=../ja/s4r/7-log-observer/4-log-view-chart/../images/log-observer-custom-dashboard.png alt="Custom Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>この演習の最後のステップとして、ダッシュボードをワークショップのチームページに追加しましょう。ワークショップ中に後からダッシュボードを探すのが簡単になるはずです。</li><li>ページの上部で、ダッシュボード名の左にある <em><strong>&mldr;</strong></em> をクリックします（<strong>1</strong>）。
<a href=#R-image-c3f4c2236ace65f92b66ab0bb77a0e71 class=lightbox-link><img src=../ja/s4r/7-log-observer/4-log-view-chart/../images/linking.png alt=linking class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c3f4c2236ace65f92b66ab0bb77a0e71><img src=../ja/s4r/7-log-observer/4-log-view-chart/../images/linking.png alt=linking class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>ドロップダウンから <strong>Link to teams</strong> を選択します（<strong>2</strong>）。</li><li>次に表示される <strong>Link to teams</strong> ダイアログで、インストラクターが提供したワークショップのチームを見つけ、 <span class="btn cstyle blue"><span><span class=title>Done</span></span></span> をクリックします。</li></ul></div></div><p>次のセッションでは、Splunk Synthetics を見て、Web ベースのアプリケーションのテストを自動化する方法を見ていきます。</p><footer class=footline></footer></article></section><article class=chapter><header class=headline></header><div class=article-subheading>第8章</div><h1 id=splunk-synthetics>Splunk Synthetics</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>15分</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> ペルソナ</div><div class=box-content><p>あなたは <strong>SRE</strong> の帽子をかぶり、Online Boutique のモニタリングを設定するように求められました。アプリケーションが24時間365日利用可能で、パフォーマンスが良好であることを確認する必要があります。</p></div></div><p>アプリケーションのモニタリングを24時間365日行い、問題が発生したときにアラートを受け取ることができたら素晴らしいですよね？それが Synthetics の役割です。ここでは、Online Boutique での典型的なユーザージャーニーが問題なく、良好なパフォーマンスで利用できることを確認する、1分おきに実行されるシンプルなテストをご紹介します。</p><footer class=footline></footer></article><section><h1 class=a11y-only>Splunk Syntheticsのサブセクション</h1><article class=default><header class=headline></header><h1 id=1-synthetics-dashboard>1. Synthetics Dashboard</h1><p>Splunk Observability Cloud のメインメニューから <strong>Synthetics</strong> をクリックします。<strong>All</strong> または <strong>Browser tests</strong> をクリックして、アクティブなテストの一覧を表示します。</p><p>RUM セクションでの調査中、<strong>Place Order</strong> トランザクションに問題があることを見つけました。Synthetics テストでもこれを確認できるかどうか見てみましょう。テストの4番目のページ、つまり <strong>Place Order</strong> ステップのメトリック <strong>First byte time</strong> を使用します。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>Search</strong> ボックスに <strong>[WORKSHOP NAME]</strong> を入力し、ワークショップに対応するテストを選択します（インストラクターから指示します）。</li><li><strong>Performance KPIs</strong> の下部にある時間枠を <strong>-30m</strong> に設定し、Enter キーを押します。</li><li><strong>Location</strong> と表示されている箇所をクリックし、ドロップダウンから <strong>Page</strong> を選択します。隣の Filter 欄にはテストに含まれるページが表示されます。</li><li><strong>Duration</strong> と表示されている箇所をクリックして <strong>Duration</strong> の選択を解除し、<strong>First byte time</strong> を選択します。
<a href=#R-image-db58f7d25a1e3d498905add096ab2d67 class=lightbox-link><img src=../ja/s4r/8-synthetics/1-synthetics-dashboard/../images/synthetics-transaction-filter.png alt="Transaction Filter" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-db58f7d25a1e3d498905add096ab2d67><img src=../ja/s4r/8-synthetics/1-synthetics-dashboard/../images/synthetics-transaction-filter.png alt="Transaction Filter" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>凡例を確認し、<strong>First byte time - Page 4</strong> の色に着目しましょう。</li><li><strong>First byte time - Page 4</strong> の値が最も大きくなるデータポイントを選択します。</li><li>右から新しいペインが表示されます。ペインの上部にある所要時間を確認してください。リスト内でこの所要時間が表示されている行を見つけ、クリックします。最も時間がかかったテスト結果を見つけられました。
<a href=#R-image-90774261614e8c33ae8c39d2eff6cd81 class=lightbox-link><img src=../ja/s4r/8-synthetics/1-synthetics-dashboard/../images/synthetics-multiple-runs.png alt="Multiple Runs" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-90774261614e8c33ae8c39d2eff6cd81><img src=../ja/s4r/8-synthetics/1-synthetics-dashboard/../images/synthetics-multiple-runs.png alt="Multiple Runs" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul></div></div><p>この特定のテスト実行に関して、<strong>Run results</strong> に移動して見てみましょう。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=2-synthetics-test-detail>2. Synthetics Test Detail</h1><p>現在、ある1つの Synthetic Browser Test の結果を見ています。このテストは <strong>Business Transactions</strong> として分けられています。これは、1つまたは複数の論理的に関連する操作の集合であり、ビジネスクリティカルなユーザーフローを表すものと考えてください。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>以下のスクリーンショットにはエラーが含まれていませんが、みなさんのテスト結果にはエラーが含まれている場合があります。テスト実行は時折失敗する場合があるため、これは想定通りの挙動であり、ワークショップにも影響ありません。</p></div></div><p><a href=#R-image-95a0bad8dd595175c1c45f167882d3b6 class=lightbox-link><img src=../ja/s4r/8-synthetics/2-synthetics-detail/../images/synth-waterfall.png alt=waterfall class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-95a0bad8dd595175c1c45f167882d3b6><img src=../ja/s4r/8-synthetics/2-synthetics-detail/../images/synth-waterfall.png alt=waterfall class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>Filmstrip:</strong> サイトのパフォーマンスを一連のスクリーンショットで表示し、ページのリアルタイムな応答を確認できます。</li><li><strong>Video:</strong> テスト実行元デバイスや地理的な場所からテスト対象のサイトを読み込むユーザーがどのような体験をするかを確認できます。</li><li><strong>Browser test metrics:</strong> ウェブサイトのパフォーマンスの概要を確認することができます。</li><li><strong>Synthetic transactions:</strong> ユーザーとサイト間での通信や操作からなる Synthetic トランザクションをリスト表示しています。</li><li><strong>Waterfall chart:</strong> テスト実行元とテスト対象サイト間での通信や操作に関する一連の様子を視覚的に表現しています。</li></ol><p>デフォルトでは、Splunk Syntheticsはテストのスクリーンショットとビデオのキャプチャを提供します。これは問題のデバッグに役立ちます。たとえば、大きな画像の遅い読み込み、ページの遅い描画などが確認できます。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>マウスを使ってフィルムストリップを左右にスクロールし、テスト実行中、どのようにサイトが表示されていたかを確認します。</li><li>ビデオペインでは、再生ボタン <strong>▶</strong> を押して録画を再生できます。再生画面右下の <strong>⋮</strong> をクリックすると、再生速度を変更したり、<strong>Picture in Picture</strong> で表示したり、ビデオを <strong>Download</strong> したりできます。</li><li>Synthetic Transaction ペインで、<em>Business Transactions</em> のヘッダーの下に表示されている最初のボタン <span class="btn cstyle blue"><span><span class=title><strong>Home</strong></span></span></span> をクリックします。</li><li>以下のウォーターフォールでは、ページを構成するオブジェクトがすべて表示されます。最初の行は HTML ページそのものです。次の行はページを構成するオブジェクト（HTML、CSS、JavaScript、画像、フォントなど）です。</li><li>ウォーターフォールで <strong>GET</strong> <em>splunk-otel-web.js</em> の行を見つけます。</li><li><strong>></strong> ボタンをクリックして、メタデータセクションを開き、リクエスト/レスポンスヘッダー情報を確認します。</li><li>Synthetic Transaction ペインで、2番目の Business Transaction <span class="btn cstyle blue"><span><span class=title><strong>Shop</strong></span></span></span> をクリックします。フィルムストリップが調整され、新しいトランザクションの先頭に移動します。</li><li>他のトランザクションについても同様に繰り返し、最後に <span class="btn cstyle blue"><span><span class=title><strong>PlaceOrder</strong></span></span></span> トランザクションを選択します。</li></ul></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=3-synthetics-to-apm>3. Synthetics to APM</h1><p>さきほどの演習を通じて、以下のような画面が表示されているはずです。</p><p><a href=#R-image-3569fb449a1c8030f8d2cf4579634f66 class=lightbox-link><img src=../ja/s4r/8-synthetics/3-synthetics-to-apm/../images/run-results-place-order.png alt="Place Order" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3569fb449a1c8030f8d2cf4579634f66><img src=../ja/s4r/8-synthetics/3-synthetics-to-apm/../images/run-results-place-order.png alt="Place Order" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>ウォーターフォールの中から <strong>POST checkout</strong> で始まるエントリを見つけます。</li><li>その前にある <strong>></strong> ボタンをクリックして、メタデータセクションを展開します。収集されているメタデータを観察してみてください。また、<strong>Server-Timing</strong> ヘッダーに着目してみましょう。このヘッダーにより、テスト実行の情報とバックエンドのトレースを関連付けることができます。</li><li>ウォーターフォールの中の <strong>POST checkout</strong> 行の前にある青い <i class="fa-fw fas fa-link"></i> <strong>APM</strong> リンクをクリックします。</li></ul></div></div><p><a href=#R-image-69b8ce4685078b17aa663cf51c108b78 class=lightbox-link><img src=../ja/s4r/8-synthetics/3-synthetics-to-apm/../images/apm-trace.png alt="APM trace" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-69b8ce4685078b17aa663cf51c108b78><img src=../ja/s4r/8-synthetics/3-synthetics-to-apm/../images/apm-trace.png alt="APM trace" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><strong>paymentservice</strong> に1つ以上のエラーが表示されることを確認してください（<strong>1</strong>）。</li><li>同じエラーであることを確認するには、<strong>Logs</strong> の Related Contents をクリックします（<strong>2</strong>）。</li><li>以前の演習と同様に、エラーのみに絞り込むための手順を繰り返します。</li><li>エラーログを表示して、無効なトークンによって支払い処理が失敗したことを検証しましょう。</li></ul></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=4-synthetics-detector>4. Synthetics Detector</h1><p>これらのテストは24時間365日実行できます。そのため、テストが失敗したり所定のSLAよりも処理時間がかかるようになりつつある場合に早期に警告を受けることができる理想的なツールです。ソーシャルメディアやウェブサイトの稼働チェックサイトなどから状態を通知されるような事態を防ぐことができます。</p><p><a href=#R-image-8ca6a6053291a445cb2be011ae1b990a class=lightbox-link><img src=../ja/s4r/8-synthetics/4-synthetics-detector/../images/social-media-post.png alt="Social media" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8ca6a6053291a445cb2be011ae1b990a><img src=../ja/s4r/8-synthetics/4-synthetics-detector/../images/social-media-post.png alt="Social media" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>それでは、テストが1.1分以上かかる場合に検出しましょう。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><p>左のメニューから Synthetics のホームページに戻ります。</p></li><li><p>ワークショップのテストをもう一度選択し、ページの上部の <span class="btn cstyle white"><span><span class=title>Create Detector</span></span></span> ボタンをクリックします。
<a href=#R-image-6a48c1fb251221ca566c35f51f0621e5 class=lightbox-link><img src=../ja/s4r/8-synthetics/4-synthetics-detector/../images/synth-detector.png alt="synth detector" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6a48c1fb251221ca566c35f51f0621e5><img src=../ja/s4r/8-synthetics/4-synthetics-detector/../images/synth-detector.png alt="synth detector" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></li><li><p><strong>New Synthetics Detector</strong> (<strong>1</strong>) と表示されているテキストを編集し、<code>&lt;受講者のイニシャル> - [WORKSHOPNAME]</code> に置き換えます。</p></li><li><p>次に、<span class="btn cstyle transparent"><span><span class=title>Run duration</span></span></span> と <span class="btn cstyle transparent"><span><span class=title>Static threshold</span></span></span> が選択されていることを確認します。</p></li><li><p><strong>Trigger threshold</strong> （<strong>2</strong>）を <code>65,000</code> から <code>68,000</code> 程度に設定し、Enter キーを押してグラフを更新します。上記のように、しきい値を超えるスパイクが複数あることを確認してください（実際の処理時間に合わせてしきい値を調整する必要があるかもしれません）。</p></li><li><p>それ以外はデフォルトのままにします。</p></li><li><p>これで、スパイクの下に赤と白の三角形の列が表示されるようになります（<strong>3</strong>）。赤い三角形は、テストが指定されたしきい値を超過したことを示し、白い三角形は指定されたしきい値以下に戻ったことを示します。赤い三角形ごとにアラートがトリガーされます。</p></li><li><p>アラートの重大度（<strong>4</strong>）やアラートの方法を変更できます。 アラート受信者は追加しないでください。大量のアラート通知にさらされる可能性があります！</p></li><li><p>Detector を有効化するために、<span class="btn cstyle blue"><span><span class=title>Activate</span></span></span> をクリックします。</p></li><li><p>作成した Detector を表示するには、<span class="btn cstyle white"><span><span class=title>Edit Test</span></span></span> ボタンをクリックします。</p></li><li><p>ページの一番下にアクティブな Detector のリストがあります。</p><p><a href=#R-image-169696bfff79bb39692cbb66f0cd68d9 class=lightbox-link><img src=../ja/s4r/8-synthetics/4-synthetics-detector/../images/detector-list.png alt="list of detectors" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-169696bfff79bb39692cbb66f0cd68d9><img src=../ja/s4r/8-synthetics/4-synthetics-detector/../images/detector-list.png alt="list of detectors" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></li><li><p>自分のものが見つからない場合は、<em>New Synthetic Detector</em> という名前のものが表示され、名前が正しく保存されていない可能性があります。<em>New Synthetic Detector</em> リンクをクリックして、名前を再度変更してください。</p></li><li><p>編集モードを終了するには <span class="btn cstyle transparent"><span><span class=title>Close</span></span></span> ボタンをクリックします。</p></li></ul></div></div><footer class=footline></footer></article></section><article class=chapter><header class=headline></header><div class=article-subheading>第9章</div><h1 id=カスタム-サービスヘルスダッシュボード->カスタム サービスヘルスダッシュボード 🏥</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>15 分</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> ペルソナ</div><div class=box-content><p><strong>SRE</strong> の役割はあなたにぴったりです。そのため <strong>paymentservice</strong> 用のカスタムサービスヘルスダッシュボードを作り上げてほしいと求められています。要件は、RED メトリクス、ログ、および Synthetic テストの所要時間の結果を表示することです。</p></div></div><p>一般的に、開発チームやSREチームがアプリケーションやサービスの健康状態の概要を必要とします。壁掛けのテレビ画面にこういった情報を常時表示しておくこともよくあります。Splunk Observability Cloud は、カスタムダッシュボードを作成することで、こういった要望に完璧に応えることができます。</p><p>このセクションでは、チームのモニターやテレビに表示するための <strong>サービスヘルスダッシュボード</strong> を構築します。</p><footer class=footline></footer></article><section><h1 class=a11y-only>カスタム サービスヘルスダッシュボード 🏥のサブセクション</h1><article class=default><header class=headline></header><h1 id=ダッシュボードの拡張>ダッシュボードの拡張</h1><p>すでに Log Observer の演習でダッシュボードに便利なログチャートを保存していますので、そのダッシュボードを拡張します。</p><p><a href=#R-image-e79a9ae2737643573cb7d1a25aa87208 class=lightbox-link><img src=../ja/s4r/9-custom-dashboard/1-custom-dashboard/../images/wall-mount.png alt="Wall mounted" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e79a9ae2737643573cb7d1a25aa87208><img src=../ja/s4r/9-custom-dashboard/1-custom-dashboard/../images/wall-mount.png alt="Wall mounted" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>2つのログチャートが含まれたダッシュボードに戻るために、メインメニューから <strong>Dashboards</strong> をクリックし、Team Dashboard ビューに移動します。<strong>Dashboards</strong> の下にある <strong>Search dashboards</strong> をクリックして、Service Health Dashboard グループを検索します。</li><li>名前をクリックすると、以前に保存したダッシュボードが表示されます。
<a href=#R-image-f7bf99a02c3fb9926e6002e468019e46 class=lightbox-link><img src=../ja/s4r/9-custom-dashboard/1-custom-dashboard/../../7-log-observer/images/log-observer-custom-dashboard.png alt="log list" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f7bf99a02c3fb9926e6002e468019e46><img src=../ja/s4r/9-custom-dashboard/1-custom-dashboard/../../7-log-observer/images/log-observer-custom-dashboard.png alt="log list" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>ログ情報は有用ですが、チームがこれが何かを理解できるようにするには、もう少し情報が必要です。</li><li>まず最初のステップとして、ダッシュボードに説明チャートを追加してみましょう。<span class="btn cstyle grey"><span><span class=title>New text note</span></span></span> をクリックし、ノートのテキストを次のテキストに置き換えます。その後 <span class="btn cstyle blue"><span><span class=title>Save and close</span></span></span> ボタンをクリックし、チャートに <strong>Instructions</strong> という名前を付けます。</li></ul><div class="box notices cstyle grey"><div class=box-label>Text note に使用する情報</div><div class=box-content><p>これは <strong>Payment service</strong> 用のカスタムヘルスダッシュボードです。<br>ログに含まれるエラーに注意してください。<br>詳細については、<a href=https://https://www.splunk.com/en_us/products/observability.html target=_blank>リンク</a>を参照してください。</p></div></div><ul><li>チャートの順序があまりよくないので、役立つように順序を入れ替えてみましょう。</li><li>マウスを <strong>Instructions</strong> チャートの上端に移動させると、マウスポインタが <strong>☩</strong> に変わります。あなたはダッシュボード内でチャートをドラッグして移動することができます。<strong>Instructions</strong> チャートを左上の場所に移動させましょう。さらに、チャートの右端をドラッグしてページの 1/3 にサイズを変更しましょう。</li><li><strong>Log Timeline view</strong> チャートを <strong>Instruction</strong> チャートの横にドラッグして移動させ、ページの残りの 2/3 を埋めるようにサイズを変更します。</li><li>次に、<strong>Log lines</strong> チャートをページの幅にリサイズし、少なくとも2倍の長さにリサイズします。</li><li>以下のダッシュボードのようになったはずです。
<a href=#R-image-62144d2326ba825fd9e86e36da4fa3af class=lightbox-link><img src=../ja/s4r/9-custom-dashboard/1-custom-dashboard/../images/inital-dashboard.png alt="Initial Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-62144d2326ba825fd9e86e36da4fa3af><img src=../ja/s4r/9-custom-dashboard/1-custom-dashboard/../images/inital-dashboard.png alt="Initial Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul></div></div><p>見栄えが良くなりました。さらに続けて、役立ちそうなチャートを追加していきましょう。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=コピーしたチャートの追加>コピーしたチャートの追加</h1><p>このセクションでは、<strong>コピー＆ペースト</strong>の機能を使用してダッシュボードを拡張します。以前、APMサービスダッシュボードのセクションでチャートをコピーしました。これらのチャートをカスタムダッシュボードに追加します。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>ページの上部にある <strong>2+</strong> を選択し、<strong>Paste charts</strong> を選択します。これによってカスタムダッシュボードにチャートを作成することができます。</li><li>チャートは現在、すべての <strong>Environments</strong> および <strong>Services</strong> のデータを表示しています。したがって、環境名と <strong>paymentservice</strong> にフィルタする設定を追加しましょう。</li><li><strong>Request Rate</strong> の単一の値が表示されているチャートの右上にある <strong>&mldr;</strong>（3つのドット）をクリックします。すると、このチャートが編集モードで開かれます。</li><li>新しい画面で、画面の中央にある<span class="btn cstyle blue"><span><span class=title>sf_environment:* x</span></span></span> ボタン（<strong>1</strong>）の <strong>x</strong> をクリックして閉じます。</li><li>次に、<span class="btn cstyle blue"><span><span class=title><strong>+</strong></span></span></span>をクリックして新しいフィルタを追加します。<strong>sf_environment</strong> を選択して、ドロップダウンから [WORKSHOPNAME] を選択して <strong>Apply</strong> をクリックします。ボタンは <strong>sf_environment:[WORKSHOPNAME]</strong> に変わります。</li><li>同様の操作を <span class="btn cstyle blue"><span><span class=title>sf_service</span></span></span> ボタン（<strong>2</strong>）に対して行います。 一度今の設定を削除して、<strong>sf_service</strong> に関するフィルタ設定を作成します。フィルタの対象として、<code>paymentservice</code> を指定します。
<a href=#R-image-ba6c90561b1fae25330e3210aa64b664 class=lightbox-link><img src=../ja/s4r/9-custom-dashboard/2-add-chart/../images/edit-chart.png alt="edit chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ba6c90561b1fae25330e3210aa64b664><img src=../ja/s4r/9-custom-dashboard/2-add-chart/../images/edit-chart.png alt="edit chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>設定が完了したら、<span class="btn cstyle blue"><span><span class=title>Save and close</span></span></span> ボタン（<strong>3</strong>）をクリックします。</li><li><strong>Request Rate</strong> の数値を表示しているチャートについても、前述の4つの手順を繰り返します。</li><li>2つのチャートを更新したら、<span class="btn cstyle blue"><span><span class=title>Save</span></span></span> をクリックします。</li><li>新しく貼り付けられたチャートはダッシュボードの一番下に表示されたため、再びダッシュボードを並べ替える必要があります。</li><li>既に学んだドラッグアンドドロップおよびサイズ変更を行い、ダッシュボードを以下の画像のように整えます。
<a href=#R-image-f5ae03aedabc6fe59369040556deb777 class=lightbox-link><img src=../ja/s4r/9-custom-dashboard/2-add-chart/../images/copyandpastedcharts.png alt="New dashboard look" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f5ae03aedabc6fe59369040556deb777><img src=../ja/s4r/9-custom-dashboard/2-add-chart/../images/copyandpastedcharts.png alt="New dashboard look" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul></div></div><p>次に、実行中の Synthetic テストに基づいたカスタムチャートを作成します。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=カスタムチャートの追加>カスタムチャートの追加</h1><p>ワークショップのこのセクションでは、ダッシュボードに追加するチャートを作成し、以前に構築した Detector と紐づけします。これにより、テスト時の振る舞いを確認し、テストによって SLA 違反が発生した場合にアラートを受け取ることができます。</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>ダッシュボードの上部で <strong>+</strong> をクリックし、<strong>Chart</strong> を選択します。
<a href=#R-image-a80e2f4113c66acf319b9309117001f8 class=lightbox-link><img src=../ja/s4r/9-custom-dashboard/3-custom-chart/../images/new-chart.png alt="new chart screen" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a80e2f4113c66acf319b9309117001f8><img src=../ja/s4r/9-custom-dashboard/3-custom-chart/../images/new-chart.png alt="new chart screen" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>まず、<span class="btn cstyle grey"><span><span class=title>Untitled chart</span></span></span> の入力フィールドを使用して、チャートの名前を <strong>Overall Test Duration</strong> にします。</li><li>このエクササイズでは、棒グラフまたはカラムグラフを使いたいので、チャートオプションの3番目のアイコン <i class="fa-fw fas fa-chart-bar"></i> をクリックします。</li><li><strong>Plot editor</strong> で、<strong>Signal</strong> の入力欄に <code>synthetics.run.duration.time.ms</code>（これはテストの実行の所要時間を表します）を入力し Enter キーを押します。</li><li>現時点では、異なる色の棒が表示されます。これはテスト実行元の地域ごとに色分けされたものです。ですが、これは不要なので、いくつかの解析ルールを追加してこの表示を変更できます。</li><li>では <span class="btn cstyle blue"><span><span class=title>Add analytics</span></span></span> ボタンをクリックします。</li><li>ドロップダウンから <strong>Mean</strong> オプションを選択し、<code>mean:aggregation</code> を選択してダイアログの外側をクリックします。メトリクスが統合され、チャートが単一の色に変わることに着目してください。</li><li>x 軸は現在、時間を表していません。これを変更するには、プロットラインの末尾にある設定 <i class="fa-fw fas fa-cog"></i> アイコンをクリックします。次のダイアログが表示されるはずです。
<a href=#R-image-dc23d74396288e5bbb9153fc61cce188 class=lightbox-link><img src=../ja/s4r/9-custom-dashboard/3-custom-chart/../images/signal-setup.png alt="signal setup" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dc23d74396288e5bbb9153fc61cce188><img src=../ja/s4r/9-custom-dashboard/3-custom-chart/../images/signal-setup.png alt="signal setup" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li><strong>Display units</strong>（<strong>2</strong>）を <strong>None</strong> から <strong>Time (autoscaling)/Milliseconds(ms)</strong> に変更します。ドロップダウンが <strong>Millisecond</strong> に変わり、チャートの x 軸がテストの実行時間を表すようになります。</li><li>設定 <i class="fa-fw fas fa-cog"></i> アイコンまたは<span class="btn cstyle gray"><span><span class=title>close</span></span></span>ボタンをクリックし、ダイアログを閉じます。</li><li>Detector を追加するには、<span class="btn cstyle blue"><span><span class=title>Link Detector</span></span></span> ボタンをクリックして、以前に作成した Detector の名前を入力します。</li><li>Detector の名前をクリックして選択します。</li><li>チャートの周りにカラーの枠が表示されることに着目しましょう。これは、アラートの状態を示しています。ダッシュボードの上部にあるベルアイコンについても同様です。以下の画像のように見えるはずです。
<a href=#R-image-ebdc543754ae6e25051c3b4a7951edac class=lightbox-link><img src=../ja/s4r/9-custom-dashboard/3-custom-chart/../images/detector-added.png alt="detector added" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ebdc543754ae6e25051c3b4a7951edac><img src=../ja/s4r/9-custom-dashboard/3-custom-chart/../images/detector-added.png alt="detector added" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>完了したら、<span class="btn cstyle blue"><span><span class=title>Save and close</span></span></span> ボタンをクリックします。</li><li>ダッシュボードで、チャートを以下のスクリーンショットのように移動させます。
<a href=#R-image-840bdd523723551de754e4beae16d38b class=lightbox-link><img src=../ja/s4r/9-custom-dashboard/3-custom-chart/../images/service-health-dashboard.png alt="Service Health Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-840bdd523723551de754e4beae16d38b><img src=../ja/s4r/9-custom-dashboard/3-custom-chart/../images/service-health-dashboard.png alt="Service Health Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>最後に、ページの上部の三点リーダー <strong>&mldr;</strong>（<strong>Event Overlay</strong> の横）をクリックし、<strong>View fullscreen</strong> をクリックします。これで壁に取り付けられたTVモニターで表示するのにも利用できます（戻るにはEscキーを押します）。</li></ul></div></div><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Tip</div><div class=box-content><p>時間がある場合には、RUM メトリクスを使用してダッシュボードに別のカスタムチャートを追加してみてください。事前に用意・提供されている <strong>RUM applications</strong> ダッシュボードグループからチャートをコピーするか、<code>rum.client_error.count</code> を使用してアプリケーションのクライアントエラーの数を表示するチャートを作成できます。</p></div></div><p>最後に、ワークショップの締めくくりを行います。</p><footer class=footline></footer></article></section><article class=chapter><header class=headline></header><div class=article-subheading>第10章</div><h1 id=ワークショップのまとめ->ワークショップのまとめ 🎁</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>10 分</span></span><p>おめでとうございます！ <strong>Splunk4Rookies - Observability Cloud Workshop</strong> を完了しました。これで、あなたは Splunk Observability Cloud をどのように活用してアプリケーションとインフラストラクチャを監視すればよいか理解することができました。</p><p>この証明書を <span class="badge cstyle blue badge-with-title"><span class=badge-title><i class="fab fa-fw fa-linkedin-in"></i></span><span class=badge-content><a href='https://www.linkedin.com/profile/add?startTask=CERTIFICATION_NAME&name=Splunk4Rookies%20-%20Observability%20Cloud&organizationId=20226&issueYear
=2024&issueMonth=2&certUrl=https%3A%2F%2Fsplunk.github.io%2Fobservability-workshop%2Flatest%2Fen%2Fs4r%2Fimages%2Fcertificate.png' style=color:#fff target=_blank>LinkedIn</a></span></span> プロフィールに追加して、あなたの成し遂げたことをお祝いしましょう。</p><p>学んだことと、次にできることを振り返ってみましょう。</p><p><a href=#R-image-97559c13a86acf6350cdd3812c372bc1 class=lightbox-link><img src="../ja/s4r/10-wrap-up/images/champagne.png?width=45vw" alt=Champagne class="figure-image noborder lightbox noshadow" style=height:auto;width:45vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-97559c13a86acf6350cdd3812c372bc1><img src="../ja/s4r/10-wrap-up/images/champagne.png?width=45vw" alt=Champagne class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>ワークショップのまとめ 🎁のサブセクション</h1><article class=default><header class=headline></header><h1 id=主なポイント>主なポイント</h1><p>ワークショップでは、Splunk Observability Cloud と OpenTelemetry シグナル（<strong>メトリクス</strong>、<strong>トレース</strong>、<strong>ログ</strong>）を組み合わせることで、平均検出時間（<strong>MTTD</strong>）の短縮、平均解決時間（<strong>MTTR</strong>）の短縮にどれほど寄与するかを見てきました。</p><ul><li>主なユーザーインターフェースとそのコンポーネント、<em>ランディングページ、Infrastructure、APM、RUM、Synthetics、ダッシュボードページ</em> および <em>設定ページ</em>の理解を深めました。</li><li>時間が許す場合、<em>インフラストラクチャ</em>の演習を行い、Kubernetes ナビゲーターで使用される<em>メトリクス</em>を見て、Kubernetes クラスターで見つかった関連するサービスを確認しました。</li></ul><p><a href=#R-image-3500374440ed6ebf68e6dd19dfb4c376 class=lightbox-link><img src=../ja/s4r/10-wrap-up/key-takeaways/../images/infra.png alt=Kubernetes class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3500374440ed6ebf68e6dd19dfb4c376><img src=../ja/s4r/10-wrap-up/key-takeaways/../images/infra.png alt=Kubernetes class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>ユーザーが経験していることを理解し、RUM および APM を使用して特に時間のかかるページ読み込みをトラブルシュートしました。その際には、そのトレースをフロントエンドからバックエンドまで追跡し、ログエントリまで確認しました。
また、<em>RUM Session Replay</em> および <em>APM Dependency map</em> と <em>Breakdown</em> などのツールを使用して、問題の原因を発見しました。</li></ul><p><a href=#R-image-bc713d6f6da557c085254da2d1954936 class=lightbox-link><img src=../ja/s4r/10-wrap-up/key-takeaways/../images/rum-apm.png alt="rum and apm" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bc713d6f6da557c085254da2d1954936><img src=../ja/s4r/10-wrap-up/key-takeaways/../images/rum-apm.png alt="rum and apm" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>RUM および APM の両方で <em>Tag Spotlight</em> を使用して問題の影響範囲やパフォーマンス問題とエラーの傾向とコンテキストを理解しました。 <em>APM Trace waterfall</em> の <em>Span</em> を掘り下げて、サービスがどのように相互作用ているかを確認し、エラーを見つけました。</li></ul><p><a href=#R-image-acf24309841f667e871bb44f3c5ca6d5 class=lightbox-link><img src=../ja/s4r/10-wrap-up/key-takeaways/../images/tag-spotlight-waterfall.png alt="tag and waterfall" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-acf24309841f667e871bb44f3c5ca6d5><img src=../ja/s4r/10-wrap-up/key-takeaways/../images/tag-spotlight-waterfall.png alt="tag and waterfall" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li><em>Related content</em> 機能を使用して、<em>Trace</em> からその Trace に関連する <em>Logs</em> へのリンクを辿り、フィルターを使用して問題の正確な原因まで掘り下げました。</li></ul><p><a href=#R-image-aef86a8781181589012418e90f7dbbb8 class=lightbox-link><img src=../ja/s4r/10-wrap-up/key-takeaways/../images/log.png alt=logs class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aef86a8781181589012418e90f7dbbb8><img src=../ja/s4r/10-wrap-up/key-takeaways/../images/log.png alt=logs class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li><p>さらに、Synthetics を確認し、ここでウェブおよびモバイルトラフィックをシミュレートしました。 Synthetics テストを活用し、RUM / APM および Log Observer から見つけた内容を確認するとともに、テスト実行での所要時間が SLA を超えた場合に警告を受けられるように <em>Detector</em> を作成しました。</p></li><li><p>最後の演習では、開発者とSREがTVスクリーンで状態をチェックし続けられるように、ヘルスダッシュボードを作成しました。</p></li></ul><p><a href=#R-image-38bd93930b81c20c93f076bafffc53d9 class=lightbox-link><img src=../ja/s4r/10-wrap-up/key-takeaways/../images/synth-tv.png alt="synth and TV" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-38bd93930b81c20c93f076bafffc53d9><img src=../ja/s4r/10-wrap-up/key-takeaways/../images/synth-tv.png alt="synth and TV" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article></section></section><article class=default><header class=headline></header><h1 id=splunk-apm>Splunk APM</h1><p>Splunk APM は、クラウドネイティブなマイクロサービスベースのアプリケーション向けの NoSample™ で 完全忠実なアプリケーションパフォーマンスモニタリングおよびトラブルシューティングソリューションです。</p><p>サンプリングされた部分的な情報ではなく、すべてのトレースを収集することで、異常が検出されないことはありません。ユーザーがエラーを経験しても、通常より長いレイテンシーを経験しても、数秒以内にそれを知り、対処することができます。ときに、悪い動作がエラーとして扱われないこともあります。開発者が新しいアプリケーションを作成する際には、そのカナリアリリースが期待通りの結果をもたらすかどうかを知る必要があります。すべてのトレースデータを収集して、初めて、クラウドネイティブアプリケーションが想定通り動作していることを確信できるようになります。</p><p>インフラとアプリケーションのパフォーマンスは相互に依存しています。全体像を把握するために、Splunk APM はクラウドのインフラとその上で動作するマイクロサービスをシームレスに相関付けます。メモリリーク、ノイズの多い隣のコンテナ、その他のインフラ関連の問題が原因でアプリケーションが動作した場合、Splunk がすぐに知らせてくれます。さらに、Splunk のログやイベントにインコンテキストでアクセスすることで、より詳細なトラブルシューティングや根本原因の分析が可能になります。</p><p><a href=#R-image-68574fdfe3882aaf2e5ecbbe19bbc46a class=lightbox-link><img src=../ja/apm/images/arch-overview.png alt="Architecture Overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-68574fdfe3882aaf2e5ecbbe19bbc46a><img src=../ja/apm/images/arch-overview.png alt="Architecture Overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="children children-h3 children-sort-"><h3><a href=../ja/apm/online-boutique/index.html>1. Online Boutiqueのデプロイ</a></h3><p>Online BoutiqueアプリケーションをKubernetes（K3s）にデプロイし、Locustを使って人工的なトラフィックを発生させます。</p><h3><a href=../ja/apm/using-splunk-apm/index.html>2. トレースとスパン</a></h3><p>Splunk APMの概要と使用方法</p></div><footer class=footline></footer></article><section><h1 class=a11y-only>Splunk APMのサブセクション</h1><article class=default><header class=headline></header><h1 id=1-online-boutiqueのデプロイ>1. Online Boutiqueのデプロイ</h1><span class="btn cstyle transparent"><span><i class="fa-fw fas fa-clock"></i> <span class=title>15分</span></span></span><ul><li>Online BoutiqueアプリケーションをKubernetes(K3s)にデプロイします</li><li>アプリケーションが動作していることを確認します</li><li>Locustを使って人工的なトラフィックを生成します</li><li>UI で APM のメトリクスを見ましょう</li></ul><hr><h2 id=1-ec2サーバーを確認>1. EC2サーバーを確認</h2><p>これからの操作は、IMワークショップを実行した後で、まだEC2インスタンスにアクセスできる状態であることを想定しています。
もしアクセスできる場合は、 2. Online Boutiqueをデプロイする に進みます。
新しいインスタンスを受け取った場合は、 <a href=../ja/imt/gdi/index.html>データを取り込む</a> の最初の2つのセクションを実行して、システムをAPMワークショップのために準備し、次のセクションを続行してください。</p><h2 id=2-online-boutiqueをデプロイする>2. Online Boutiqueをデプロイする</h2><p>Online BoutiqueアプリケーションをK3sにデプロイするには、以下のデプロイメントを適用します。</p><div class=tab-panel data-tab-group=057001ee7d4a1ffcf27e32a64189e0eb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=deploy-online-boutique class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("057001ee7d4a1ffcf27e32a64189e0eb","deploy-online-boutique")'>
<span class=tab-nav-text>Deploy Online Boutique</span></button>
<button data-tab-item=deployment-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("057001ee7d4a1ffcf27e32a64189e0eb","deployment-output")'>
<span class=tab-nav-text>Deployment Output</span></button></div><div class=tab-content-container><div data-tab-item=deploy-online-boutique class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/apm
</span></span><span class=line><span class=cl>kubectl apply -f deployment.yaml</span></span></code></pre></div></div></div><div data-tab-item=deployment-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>APM Only Deployment
</span></span><span class=line><span class=cl>deployment.apps/recommendationservice created
</span></span><span class=line><span class=cl>service/recommendationservice created
</span></span><span class=line><span class=cl>deployment.apps/productcatalogservice created
</span></span><span class=line><span class=cl>service/productcatalogservice created
</span></span><span class=line><span class=cl>deployment.apps/cartservice created
</span></span><span class=line><span class=cl>service/cartservice created
</span></span><span class=line><span class=cl>deployment.apps/adservice created
</span></span><span class=line><span class=cl>service/adservice created
</span></span><span class=line><span class=cl>deployment.apps/paymentservice created
</span></span><span class=line><span class=cl>service/paymentservice created
</span></span><span class=line><span class=cl>deployment.apps/loadgenerator created
</span></span><span class=line><span class=cl>service/loadgenerator created
</span></span><span class=line><span class=cl>deployment.apps/shippingservice created
</span></span><span class=line><span class=cl>service/shippingservice created
</span></span><span class=line><span class=cl>deployment.apps/currencyservice created
</span></span><span class=line><span class=cl>service/currencyservice created
</span></span><span class=line><span class=cl>deployment.apps/redis-cart created
</span></span><span class=line><span class=cl>service/redis-cart created
</span></span><span class=line><span class=cl>deployment.apps/checkoutservice created
</span></span><span class=line><span class=cl>service/checkoutservice created
</span></span><span class=line><span class=cl>deployment.apps/frontend created
</span></span><span class=line><span class=cl>service/frontend created
</span></span><span class=line><span class=cl>service/frontend-external created
</span></span><span class=line><span class=cl>deployment.apps/emailservice created
</span></span><span class=line><span class=cl>service/emailservice created
</span></span><span class=line><span class=cl>deployment.apps/rum-loadgen-deployment created</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> 変数未セットに関するメッセージが表示された場合</div><div class=box-content><p><code>kubectl delete -f deployment.yaml</code> コマンドを実行しAPM環境のデプロイ削除します。
次にガイド、メッセージに表示されていた変数をexportし上記のデプロイスクリプトを再実行します。</p></div></div><p>Online Boutique アプリケーションが起動していることを確認するには:</p><div class=tab-panel data-tab-group=72cd16fa4552e4447fb9b98e3699dcaa><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=get-pods class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("72cd16fa4552e4447fb9b98e3699dcaa","get-pods")'>
<span class=tab-nav-text>Get Pods</span></button>
<button data-tab-item=get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("72cd16fa4552e4447fb9b98e3699dcaa","get-pods-output")'>
<span class=tab-nav-text>Get Pods Output</span></button></div><div class=tab-content-container><div data-tab-item=get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                          READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-56585564cc-xclzj   1/1     Running   0          84s
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-hkshj                             1/1     Running   0          84s
</span></span><span class=line><span class=cl>svclb-frontend-external-c74n6                                 1/1     Running   0          53s
</span></span><span class=line><span class=cl>currencyservice-747b74467f-xxrl9                              1/1     Running   0          52s
</span></span><span class=line><span class=cl>redis-cart-74594bd569-2jb6c                                   1/1     Running   0          54s
</span></span><span class=line><span class=cl>adservice-6fb948b8c6-2xlrc                                    0/1     Running   0          53s
</span></span><span class=line><span class=cl>recommendationservice-b5df8776c-sbt4h                         1/1     Running   0          53s
</span></span><span class=line><span class=cl>shippingservice-6d6f7b8d87-5lg9g                              1/1     Running   0          53s
</span></span><span class=line><span class=cl>svclb-loadgenerator-jxwct                                     1/1     Running   0          53s
</span></span><span class=line><span class=cl>emailservice-9dd74d87c-wjdqr                                  1/1     Running   0          53s
</span></span><span class=line><span class=cl>checkoutservice-8bcd56b46-bfj7d                               1/1     Running   0          54s
</span></span><span class=line><span class=cl>productcatalogservice-796cdcc5f5-vhspz                        1/1     Running   0          53s
</span></span><span class=line><span class=cl>paymentservice-6c875bf647-dklzb                               1/1     Running   0          53s
</span></span><span class=line><span class=cl>frontend-b8f747b87-4tkxn                                      1/1     Running   0          53s
</span></span><span class=line><span class=cl>cartservice-59d5979db7-bqf64                                  1/1     Running   1          53s
</span></span><span class=line><span class=cl>loadgenerator-57c8b84966-7nr4f                                1/1     Running   3          53s</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>通常、ポッドがRunning状態に移行するのに1分30秒程度かかります。</p></div></div><hr><h2 id=3-uiで検証する>3. UIで検証する</h2><p>Splunk UIでInfrastructure <a href=#R-image-bb8fdc06fa451e0dd23310e35cd6d9e1 class=lightbox-link><img src=../ja/apm/online-boutique/../images/infrastructure.png alt="infrastructure button" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bb8fdc06fa451e0dd23310e35cd6d9e1><img src=../ja/apm/online-boutique/../images/infrastructure.png alt="infrastructure button" class="lightbox-image noborder lightbox noshadow" loading=lazy></a> をクリックします。Infrastructure Overviewダッシュボードに遷移しますので、 <strong>Kubernetes</strong> をクリックします。</p><p><strong>Cluster</strong> のドロップダウンを使用してクラスタを選択すると、新しいポッドが開始され、コンテナがデプロイされていることが確認できます。</p><p>Splunk UI で Cluster をクリックすると、次のような画面が表示されているはずです。</p><p><a href=#R-image-9b486c2c81fe22bad44ce1a91fb730ed class=lightbox-link><img src=../ja/apm/online-boutique/../images/online-boutique-k8s.png alt="back to Cluster" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9b486c2c81fe22bad44ce1a91fb730ed><img src=../ja/apm/online-boutique/../images/online-boutique-k8s.png alt="back to Cluster" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>もう一度 <strong>WORKLOADS</strong> タブを選択すると、いくつかのデプロイメントとレプリカセットがあることがわかるはずです。</p><p><a href=#R-image-a4ff82b4e4b3a304db06be24b5a6824b class=lightbox-link><img src=../ja/apm/online-boutique/../images/online-boutique-workload.png alt="HOTROD loaded" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a4ff82b4e4b3a304db06be24b5a6824b><img src=../ja/apm/online-boutique/../images/online-boutique-workload.png alt="HOTROD loaded" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=4-online-boutique-を閲覧する>4. Online Boutique を閲覧する</h2><p>Online Boutique は、EC2インスタンスのIPアドレスの81番ポートで閲覧できます。このIPアドレスは、ワークショップの冒頭でインスタンスにSSH接続したときに使用したものと同じIPアドレスです。</p><p>ウェブブラウザを開き、 <code>http://&lt;EC2-IP>:81/</code> にアクセスすると、Online Boutique が起動しているのが確認できます。</p><p><a href=#R-image-eaeb3b9757b53e89d2d8eccd5adf5339 class=lightbox-link><img src=../ja/apm/online-boutique/../images/online-boutique.png alt="Online Boutique" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eaeb3b9757b53e89d2d8eccd5adf5339><img src=../ja/apm/online-boutique/../images/online-boutique.png alt="Online Boutique" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>1. Online Boutiqueのデプロイのサブセクション</h1><article class=default><header class=headline></header><h1 id=11-locustでトラフィックを発生させる>1.1 Locustでトラフィックを発生させる</h1><span class="btn cstyle transparent"><span><i class="fa-fw fas fa-clock"></i> <span class=title>5分</span></span></span><h2 id=1-トラフィックを発生させる>1. トラフィックを発生させる</h2><p>Online Boutique のデプロイメントには、Locust が動作するコンテナが含まれており、これを使用してウェブサイトに対する負荷トラフィックを生成し、メトリクス、トレース、スパンを生成することができます。</p><p>Locust は、EC2インスタンスのIPアドレスの82番ポートで利用できます。ウェブブラウザで新しいタブを開き、 <code>http://&lt;EC2-IP>:82/</code> にアクセスすると、Locust が動作しているのが確認できます。</p><p><a href=#R-image-78254c50bb4003065a016885130e217a class=lightbox-link><img src=../ja/apm/online-boutique/locust/../../images/locust.png alt=Locust class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-78254c50bb4003065a016885130e217a><img src=../ja/apm/online-boutique/locust/../../images/locust.png alt=Locust class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Spawn rate</strong> を 2 に設定し、<strong>Start Swarming</strong> をクリックすると、アプリケーションに緩やかな負荷がかかり続けます。</p><p><a href=#R-image-74b9b34262b31d10cf05406cdd262aab class=lightbox-link><img src=../ja/apm/online-boutique/locust/../../images/locust-spawn-rate.png alt="Spawn Rate" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-74b9b34262b31d10cf05406cdd262aab><img src=../ja/apm/online-boutique/locust/../../images/locust-spawn-rate.png alt="Spawn Rate" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-71d6582bca29aade4c9edb6556d82077 class=lightbox-link><img src=../ja/apm/online-boutique/locust/../../images/locust-statistics.png alt=Statistics class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-71d6582bca29aade4c9edb6556d82077><img src=../ja/apm/online-boutique/locust/../../images/locust-statistics.png alt=Statistics class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><p>それでは、 <strong>Dashboards → All Dashboards → APM Services → Service</strong> を開きましょう。</p><p>そのためには、アプリケーションの Environment 名を知る必要があります。このワークショップでは、<code>&lt;hostname>-workshop</code> のような Environment 名で定義されています。</p><p>ホスト名を調べるには、AWS/EC2インスタンス上で以下のコマンドを実行します:</p><div class=tab-panel data-tab-group=3467050625c49f46585a39348ccd67da><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=echo-hostname class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("3467050625c49f46585a39348ccd67da","echo-hostname")'>
<span class=tab-nav-text>Echo Hostname</span></button>
<button data-tab-item=output-example class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("3467050625c49f46585a39348ccd67da","output-example")'>
<span class=tab-nav-text>Output Example</span></button></div><div class=tab-content-container><div data-tab-item=echo-hostname class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=k>$(</span>hostname<span class=k>)</span>-workshop</span></span></code></pre></div></div></div><div data-tab-item=output-example class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>bdzx-workshop</span></span></code></pre></div></div></div></div></div><p>前のステップで見つけた Environment を選択し、「frontend」サービスを選択し、時間を「Past 15 minutes」に設定します。</p><p><a href=#R-image-f3836255cef9159c976a0d9017ae4e02 class=lightbox-link><img src=../ja/apm/online-boutique/locust/../../images/online-boutique-service-dashboard.png alt="APM Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f3836255cef9159c976a0d9017ae4e02><img src=../ja/apm/online-boutique/locust/../../images/online-boutique-service-dashboard.png alt="APM Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>この自動生成されたダッシュボードでは、RED (Rate, Error & Duration) メトリクスを使用して、サービスの状態を監視することができます。このダッシュボードでは、パフォーマンスに関連したさまざまなチャートのほか、基盤となるホストやKubernetesポッド（該当する場合）の相関情報も提供されます。</p><p>ダッシュボードの様々なチャートを見てみましょう。</p><hr><h2 id=2-splunk-apm-のメトリクスを確認する>2. Splunk APM のメトリクスを確認する</h2><p>画面左のメニューからAPMをクリックするとAPM Overviewダッシュボードが表示されます。</p><p><a href=#R-image-ec956c7d1d19033a6331920723f4066c class=lightbox-link><img src=../ja/apm/online-boutique/locust/../../images/online-boutique-apm.png alt="select APM" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ec956c7d1d19033a6331920723f4066c><img src=../ja/apm/online-boutique/locust/../../images/online-boutique-apm.png alt="select APM" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>右側の <strong>Explore</strong> を選択し、先ほど見つけた Environment を選択し、時間を15分に設定します。これにより、自動的に生成されたOnline BoutiqueアプリケーションのDependency/Service Mapが表示されます。</p><p>以下のスクリーンショットのように表示されます:</p><p><a href=#R-image-228fa129ad4b78b3d041946b4380fc7b class=lightbox-link><img src=../ja/apm/online-boutique/locust/../../images/online-boutique-map.png alt="Online Boutique in APM" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-228fa129ad4b78b3d041946b4380fc7b><img src=../ja/apm/online-boutique/locust/../../images/online-boutique-map.png alt="Online Boutique in APM" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ページの下部にある凡例では、依存関係/サービスマップでの表記について説明しています。</p><p><a href=#R-image-cd49ab6f13a80014bd023bf079a37442 class=lightbox-link><img src=../ja/apm/online-boutique/locust/../../images/apm-legend.png alt="APM Legend" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cd49ab6f13a80014bd023bf079a37442><img src=../ja/apm/online-boutique/locust/../../images/apm-legend.png alt="APM Legend" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>サービスリクエスト、エラーレート、ルートエラーレート。</li><li>リクエストレート、レイテンシー、エラーレート</li></ul><p>また、このビューでは、全体的なエラー率とレイテンシー率のタイムチャートを見ることができます。</p><h2 id=3-opentelemetry-ダッシュボード>3. OpenTelemetry ダッシュボード</h2><p>Open Telemetery Collector がデプロイされると、プラットフォームは自動的に OpenTelemetry Collector のメトリクスを表示するダッシュボードを作成します。</p><p>左上のナブメニューから、 <strong>Dashboards → OpenTelemetry Collector</strong> を選択し、メトリクスとスパンが送信されていることを確認しましょう。</p><p><a href=#R-image-34c9d4165f8c831061e0a8a03b4997df class=lightbox-link><img src=../ja/apm/online-boutique/locust/../../images/otel-dashboard.png alt="OpenTelemetry Collector dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-34c9d4165f8c831061e0a8a03b4997df><img src=../ja/apm/online-boutique/locust/../../images/otel-dashboard.png alt="OpenTelemetry Collector dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=4-opentelemetry-zpages>4. OpenTelemetry zpages</h2><p>送信されたトレースをデバッグするには、zpages 拡張機能を使用できます。<a href=https://github.com/open-telemetry/opentelemetry-specification/blob/main/experimental/trace/zpages.md#tracez target=_blank>zpages</a> は OpenTelemetry Collector の一種で、トラブルシューティングや統計用のライブデータを提供します。これらは、EC2インスタンスのIPアドレスのポート <code>55679</code> で利用できます。Webブラウザで新しいタブを開き、 <code>http://{==EC2-IP==}:55679/debug/tracez</code> と入力すると、zpages の出力を見ることができます。</p><p><a href=#R-image-edd2518c9dde359f04924ceadc89a71b class=lightbox-link><img src=../ja/apm/online-boutique/locust/../../images/zpages.png alt=zpages class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-edd2518c9dde359f04924ceadc89a71b><img src=../ja/apm/online-boutique/locust/../../images/zpages.png alt=zpages class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>また、シェルプロンプトから、テキストベースのブラウザを実行することもできます。</p><div class=tab-panel data-tab-group=c8ae023a72a48b11d8d99e6269da2759><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=lynx-command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("c8ae023a72a48b11d8d99e6269da2759","lynx-command")'>
<span class=tab-nav-text>Lynx Command</span></button></div><div class=tab-content-container><div data-tab-item=lynx-command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>lynx http://localhost:55679/debug/tracez</span></span></code></pre></div></div></div></div></div><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=2-トレースとスパン>2. トレースとスパン</h1><span class="btn cstyle transparent"><span><i class="fa-fw fas fa-clock"></i> <span class=title>15分</span></span></span><ul><li>APM の概要 - RED メトリクス</li><li>サービスマップを利用する</li><li>タグスポットライトの紹介</li><li>トレースの例</li><li>インフラとのリンク</li></ul><h2 id=トレースとスパンについて>トレースとスパンについて</h2><p>トレースは、同じトレースIDを共有するスパンの集合体であり、アプリケーションとその構成サービスが処理する固有のトランザクションを表します。</p><p><a href=#R-image-8fa3aa945603ce52cd4f61b97e5fb3d2 class=lightbox-link><img src=../ja/apm/using-splunk-apm/../images/trace-spans.png alt="Traces and Spans" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8fa3aa945603ce52cd4f61b97e5fb3d2><img src=../ja/apm/using-splunk-apm/../images/trace-spans.png alt="Traces and Spans" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>各スパンには、そのスパンでキャプチャされた操作を表す名前と、その操作がどのサービス内で行われたかを表すサービス名があります。</p><p>さらにスパンは、その親として別のスパンを参照することができ、そのトランザクションを処理するために実行されたトレースでキャプチャされた処理の関係を定義します。</p><p>各スパンには、キャプチャされたメソッド、オペレーション、コードブロックに関する以下のような多くの情報が含まれています。例えば:</p><ul><li>処理名</li><li>処理の開始時間（マイクロ秒単位の精度）</li><li>処理の実行時間（マイクロ秒単位の精度）</li><li>処理が行われたサービスの論理名</li><li>処理が行われたサービスインスタンスのIPアドレス</li></ul><footer class=footline></footer></article><section><h1 class=a11y-only>2. トレースとスパンのサブセクション</h1><article class=default><header class=headline></header><h1 id=21-サービスマップ>2.1 サービスマップ</h1><h2 id=サービスマップ>サービスマップ</h2><p>サービスマップの <strong>paymentservice</strong> をクリックし、<strong>paymentservice</strong> の下にある<code>breakdown</code>のドロップダウンフィルタから <strong>version</strong> を選択します。これにより、カスタムスパンタグの <strong>version</strong> でサービスマップがフィルタリングされます。</p><p>これで、サービスマップが以下のスクリーンショットのように更新され、<strong>paymentservice</strong> の異なるバージョンが表示されていることがわかります。</p><p><a href=#R-image-2646693deba306afe2ff42e40661c945 class=lightbox-link><img src=../ja/apm/using-splunk-apm/service_map/../../images/paymentservice.png alt="Payment Service" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2646693deba306afe2ff42e40661c945><img src=../ja/apm/using-splunk-apm/service_map/../../images/paymentservice.png alt="Payment Service" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=22-tag-spotlight>2.2 Tag Spotlight</h1><h2 id=タグスポットライト>タグスポットライト</h2><p>画面の右側にある <strong>Tag Spotlight</strong> をスクロールダウンし、ドロップダウンから <strong>Top Across All Indexed Tags</strong> を選択します。選択したら、下のスクリーンショットにあるように をクリックします。</p><p><a href=#R-image-89aadf926e2dca7ee7ecbedd358536f4 class=lightbox-link><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight.png alt="Tag Spotlight" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-89aadf926e2dca7ee7ecbedd358536f4><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight.png alt="Tag Spotlight" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>タグスポットライトのページが表示されます。このページでは、アプリケーションの上位のタグと、それに対応するエラー率や秒間リクエスト数を確認できます。</p><p><strong>version</strong> スパンタグでは、バージョン <code>350.10</code> のエラー率が100%であることがわかります。また、<strong>tenant.level</strong> スパンタグでは、3つのテナント（Gold、Silver、Bronze）すべてにエラーがあることがわかります。</p><p><a href=#R-image-71ce4a99d1a3cbc398b1192b435fbfb4 class=lightbox-link><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight-dashboard.png alt="Tag Spotlight Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-71ce4a99d1a3cbc398b1192b435fbfb4><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight-dashboard.png alt="Tag Spotlight Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>タグスポットライトのページはインタラクティブに、目的のタグをクリックするだけでフィルタとしてタグを追加することができます。<strong>tenant.level</strong> の下の <strong>gold</strong> をクリックして、フィルターとして追加します。これを行うと、ページには <strong>tenant.level</strong> が <strong>gold</strong> のデータのみが表示されます。</p><p><a href=#R-image-2e7827ca6a6fee7e5ff3faac00c3702e class=lightbox-link><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/gold-tenant.png alt="Gold Tenant" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2e7827ca6a6fee7e5ff3faac00c3702e><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/gold-tenant.png alt="Gold Tenant" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>タグスポットライトは、データを分析して傾向を見極めるのに非常に便利です。Gold Tenantでは、リクエストの総数のうち55件がエラーであることがわかります。（この数字はワークショップの実施時刻により異なります）</p><p>これをバージョンタグと関連付けると、バージョン <code>350.10</code> が55件、バージョン <code>350.9</code> が17件のリクエストに対応していることがわかります。つまり、バージョン <code>350.10</code> を経由したリクエストは、すべてエラー状態になったということになります。</p><p><strong>paymentservice</strong> のバージョン <code>350.10</code> からのすべてのリクエストがエラーになるというこの理論をさらに検証するために、タグセレクタを使用して、フィルタを別のテナントに変更することができます。フィルターを <strong>gold</strong> テナントから <strong>silver</strong> テナントに変更します。</p><p><a href=#R-image-b71c62e248603610eef29dc88b8f21fd class=lightbox-link><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/silver-tag-filter.png alt="Silver Tag Filter" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b71c62e248603610eef29dc88b8f21fd><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/silver-tag-filter.png alt="Silver Tag Filter" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ここで、<strong>silver</strong> テナントのエラーのあるリクエスト数を見て、バージョン番号と相関させることで、同様の分析を行うことができます。<strong>silver</strong> テナントのエラー数は、バージョン <code>350.10</code> のリクエスト数と一致していることに注目してください。</p><p><a href=#R-image-5ac93e34c4c51a2175545c11ae928c8a class=lightbox-link><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/silver-tenant.png alt="Silver Tenant" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5ac93e34c4c51a2175545c11ae928c8a><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/silver-tenant.png alt="Silver Tenant" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>タグスポットライトでは、秒間リクエスト数やエラー率だけでなく、サービスごとのレイテンシーも見ることができます。これを行うには、レイテンシーボタンを選択し、silver テナントタグを削除することで、すべての paymentservice のレイテンシーを確認することができます。</p><p><a href=#R-image-2d9f945f9c72556d940f929844ed5f51 class=lightbox-link><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/latency.png alt=Latency class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2d9f945f9c72556d940f929844ed5f51><img src=../ja/apm/using-splunk-apm/tag_spotlight/../../images/latency.png alt=Latency class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>右端の <strong>Clear All</strong> の下にある X ボタンを押して、サービスマップに戻りましょう。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=23-サンプルトレース>2.3 サンプルトレース</h1><h2 id=サンプルトレース>サンプルトレース</h2><p>右上にある「Services by Error Rate」グラフのピンク色の線上をクリックします。選択すると、サンプルトレースのリストが表示されます。<code>Initiating Operation of</code>が <strong>frontend: POST /cart/checkout</strong> であるサンプルトレースの1つをクリックしてください。</p><p><a href=#R-image-9b3fa5eaeef057b97ccf107b730dcf99 class=lightbox-link><img src=../ja/apm/using-splunk-apm/example_trace/../../images/example-trace.png alt="Example Trace" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9b3fa5eaeef057b97ccf107b730dcf99><img src=../ja/apm/using-splunk-apm/example_trace/../../images/example-trace.png alt="Example Trace" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>スパンとともに、選択したトレースの全体が表示されます。エラーが発生したスパンは、その横に赤い！マークが表示されます。グレーのボックスに<strong>x6</strong>などの数字が表示されている場合は、それをクリックすると<code>paymentservice</code> スパンを展開することができます。</p><p><a href=#R-image-8f77905aaeed5017fc40d274eae26173 class=lightbox-link><img src=../ja/apm/using-splunk-apm/example_trace/../../images/trace-span.png alt="Example Trace" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8f77905aaeed5017fc40d274eae26173><img src=../ja/apm/using-splunk-apm/example_trace/../../images/trace-span.png alt="Example Trace" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>赤い！マークが表示された<code>paymentservice</code> スパンの一つをクリックすると展開され、関連するメタデータやエラーの詳細が表示されます。このエラーが401エラーによるものであることがわかります。また、「テナント」や「バージョン」などの有用な情報も表示されています。</p><p><a href=#R-image-d9b06d62c9382b779d65f797de1a8879 class=lightbox-link><img src=../ja/apm/using-splunk-apm/example_trace/../../images/trace-metadata.png alt="Traces and Spans" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d9b06d62c9382b779d65f797de1a8879><img src=../ja/apm/using-splunk-apm/example_trace/../../images/trace-metadata.png alt="Traces and Spans" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>エラーの原因が <strong>無効なリクエスト</strong> であることがわかりましたが、正確なリクエストが何であるかはわかりません。ページの下部に、ログへのコンテキストリンクが表示されます。このリンクをクリックすると、このスパンに関連付けられているログが表示されます。</p><p><a href=#R-image-35969269546853596caa1b2a4027bc67 class=lightbox-link><img src=../ja/apm/using-splunk-apm/example_trace/../../images/logs_link.png alt="Logs Link" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-35969269546853596caa1b2a4027bc67><img src=../ja/apm/using-splunk-apm/example_trace/../../images/logs_link.png alt="Logs Link" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>下の画像と同様の <strong>Log Observer</strong> ダッシュボードが表示されます。</p><p><a href=#R-image-b4557fe6a860a85d23ba4162dde83ca4 class=lightbox-link><img src=../ja/apm/using-splunk-apm/example_trace/../../images/log_observer.png alt="Log Observer" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b4557fe6a860a85d23ba4162dde83ca4><img src=../ja/apm/using-splunk-apm/example_trace/../../images/log_observer.png alt="Log Observer" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>フィルタを使用して、エラーログのみを表示できます。右上にある<code>ERROR</code>をクリックしてから、<code>Add to filter</code>をクリックします。</p><p><a href=#R-image-47be4f8a3c3fa969fc88c495c401cf60 class=lightbox-link><img src=../ja/apm/using-splunk-apm/example_trace/../../images/error_filter.png alt="Error Filter" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-47be4f8a3c3fa969fc88c495c401cf60><img src=../ja/apm/using-splunk-apm/example_trace/../../images/error_filter.png alt="Error Filter" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><code>severity</code>が<code>ERROR</code>であるログエントリに絞り込まれます。</p><p><a href=#R-image-f76a147ee7ee3f94b3806c7871ce1474 class=lightbox-link><img src=../ja/apm/using-splunk-apm/example_trace/../../images/filtered_results.png alt="Filtered Results" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f76a147ee7ee3f94b3806c7871ce1474><img src=../ja/apm/using-splunk-apm/example_trace/../../images/filtered_results.png alt="Filtered Results" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>いずれかのエントリを選択して詳細を表示します。これで、開発者が誤って本番環境にプッシュした <strong>無効なAPIトークン</strong> の使用によってエラーがどのように発生したかを確認できます。</p><p><a href=#R-image-f9aec52888892ce69e16d5c33ab94da7 class=lightbox-link><img src=../ja/apm/using-splunk-apm/example_trace/../../images/error_details.png alt="Error Details" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f9aec52888892ce69e16d5c33ab94da7><img src=../ja/apm/using-splunk-apm/example_trace/../../images/error_details.png alt="Error Details" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>おめでとうございます。これで、このAPMワークショップは完了です。</p><footer class=footline></footer></article></section></section><article class=default><header class=headline></header><h1 id=splunk-rum>Splunk RUM</h1><p>Splunk RUM は、業界唯一のエンド・ツー・エンドで完全忠実なリアルユーザーモニタリングソリューションです。パフォーマンスを最適化し、トラブルシューティングを迅速に行い、エンドユーザーエクスペリエンスを完全に可視化するために構築されています。</p><p>Splunk RUM は、ユーザーエクスペリエンスに影響を与える Web およびモバイルアプリケーションのパフォーマンス問題を特定することができます。Core Web Vitalによるページパフォーマンスのベンチマークと計測をサポートします。W3C タイミング、長時間実行されるタスクの特定、ページロードに影響を与える可能性のあるあらゆるものが含まれますが、これらに限定されるものではありません。</p><p>Splunk のエンドツーエンドモニタリング機能を使用すると、アプリケーションを構成する、サービス自身を始めとしてデータベースコール数などのインフラメトリクスやその他関与するすべてに対して、サービス間の遅延を表示することができます。</p><p>私たちの完全忠実なエンドツーエンドモニタリングソリューションは、お客様のSpanデータを100％取得します。サンプリングは行わず、フレームワークにとらわれず、Open Telemetryに標準化されています。</p><p>フロントエンドとバックエンドのアプリケーションのパフォーマンスは相互に依存していることがよくあります。バックエンドサービスとユーザーエクスペリエンスとの関連性を十分に理解し、可視化できることがますます重要になっています。
全体像を把握するために、Splunk RUM は当社のフロントエンドとバックエンドのマイクロサービス間のシームレスな相関関係を提供します。マイクロサービスやインフラストラクチャに関連する問題によって、ユーザーが Web ベースのアプリケーションで最適とは言えない状態を経験している場合、Splunk はこの問題を検出して警告することができます。</p><p>また、Splunk は、より深いトラブルシューティングと根本原因の分析を可能にするために、インコンテキストログとイベントを表示することができます。</p><p><a href=#R-image-cfb1bd8e077d6d67c4178ac6ebb8e011 class=lightbox-link><img src=../ja/rum/images/rum-architecture.png alt="Architecture Overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cfb1bd8e077d6d67c4178ac6ebb8e011><img src=../ja/rum/images/rum-architecture.png alt="Architecture Overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Splunk RUMのサブセクション</h1><article class=default><header class=headline></header><h1 id=1-概要>1. 概要</h1><h2 id=rum-ワークショップの概要>RUM ワークショップの概要</h2><p>このSplunk Real User Monitoring (RUM) ワークショップの目的は以下の通りです。</p><ul><li><p>素敵な商品を買えるOnline Boutiqueサイトでトラフィックを発生させ、</br>RUM ユーザーセッション<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>を作成し、Splunk Observability Suiteで確認します</p></li><li><p>Application Summary Dashboard (モバイル、Web両方) で</br>アプリケーション全体のパフォーマンスの概要を確認します</p></li><li><p>RUM メトリクスで、特定のWebサイトやモバイルアプリのパフォーマンスを検証します</p></li><li><p>Webサイトやバックエンドサービスの問題を調査します</p></li><li><p>(オプション) あなたのWebサイトへの RUM の追加方法を学びます</p></li></ul><p>この目的のため、Online Boutiqueで様々な商品を注文することになります。Online Boutiqueで買い物をするとき、あなたはユーザーセッション<sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>と呼ばれるものを作成します。</p><p>この Web サイトでいくつかの問題に遭遇することがなりますが、Splunk RUM を使用して問題を特定し、開発者が問題を解決できるようにします。</p><p>RUM 単体のワークショップの場合、ワークショップ講師が RUM を導入しているOnline BoutiqueのURLをお知らせします。</p><p>IM/APM ワークショップの一環としてこのセッションを実施する場合、講師側でRUMを有効にした後、現在お使いのOnline Boutiqueを使用することが可能です。</p><p>これらのOnline Boutiqueには、それぞれ数人の合成ユーザー（シミュレートされたユーザーセッション）が訪問しており、これによって、後で分析するためのより多くのライブデータを生成することができます。</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>RUM ユーザーセッションは、アプリケーション上でのユーザーインタラクションの「記録」であり、基本的にはエンドユーザーのブラウザまたはモバイルアプリケーションから直接測定されたウェブサイトまたはアプリケーションのパフォーマンスを収集します。これを行うために、各ページに数行のJavaScriptが埋め込まれています。このスクリプトは、各ユーザーがページを探索する際にデータを収集し、解析のためにそのデータを転送します。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=2-online-boutiqueでのrumの利用例>2. Online BoutiqueでのRUMの利用例</h1><ul><li>Online Boutiqueのアドレスを探します</li><li>Online Boutiqueのウェブショップで買い物しトラフィックを生成させます</li></ul><hr><h2 id=1-rumが有効化されたonline-boutiqueのurl>1. RUMが有効化されたOnline BoutiqueのURL</h2><p>前のセクションで説明したように、RUMホスト上で動作するOnline Boutiqueを使用します。
RUMのみのワークショップに参加される方は、使用するシステムは既に準備されていますので、RUMインスタンスのURLを受け取った後、セクション4 <a href=../ja/rum/index.html#4-online-boutiqueを使ってシステムに負荷を与える>Online Boutiqueを使ってシステムに負荷を与える</a> まで進むことができます。</p><h2 id=2-rum-access-token-の入手>2. RUM Access Token の入手</h2><p>APMワークショップでサービスをインストールしました。これから、RUM機能もデプロイメントに追加していきます。</p><p>まず、RUM Authorization スコープを持つ RUM_ACCESS_TOKEN を取得する必要があります。ワークショップのRUM Access Tokenは、 <strong>settings</strong> <a href=#R-image-611f9c5f1677d34c790b768614ad8244 class=lightbox-link><img src=../ja/rum/2-showcase/../images/setting.png alt=settings class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-611f9c5f1677d34c790b768614ad8244><img src=../ja/rum/2-showcase/../images/setting.png alt=settings class="lightbox-image noborder lightbox noshadow" loading=lazy></a> メニューボタンをクリックし、 <strong>Access Tokens</strong> を選択することで見つけることができます。</p><p>講師が使用するように指示したRUMワークショップトークン（例： <strong>O11y-Workshop-RUM-TOKEN</strong> ）を展開し、 <strong>Show Token</strong> をクリックしてトークンを表示します。 <span class="btn cstyle grey"><span><span class=title>Copy</span></span></span> ボタンをクリックし、クリップボードにコピーしてください。 <strong>Default</strong> トークンは使用しないでください。トークンのAuthorization ScopeがRUMであることを確認してください。</p><p><a href=#R-image-395b9861a01e49f6d83fc2fce7319de9 class=lightbox-link><img src=../ja/rum/2-showcase/../images/RUM-Access-Token.png alt="Access Token" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-395b9861a01e49f6d83fc2fce7319de9><img src=../ja/rum/2-showcase/../images/RUM-Access-Token.png alt="Access Token" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> 自分のトークンを作らないでください</div><div class=box-content><p>このワークショップのために、皆さんが行う演習に適した設定をしたRUM Tokenを作成ししています。</p></div></div><p>進行中のシェルスクリプトで環境変数 <code>RUM_TOKEN</code> を作成し、デプロイメントをパーソナライズします。</p><div class=tab-panel data-tab-group=1a0261e7a5e3f49a7dd3d70c3ddb8585><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=export-variables class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("1a0261e7a5e3f49a7dd3d70c3ddb8585","export-variables")'>
<span class=tab-nav-text>Export Variables</span></button></div><div class=tab-content-container><div data-tab-item=export-variables class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>RUM_TOKEN</span><span class=o>=</span>&lt;replace_with_O11y-Workshop-RUM-TOKEN&gt;</span></span></code></pre></div></div></div></div></div><h2 id=3-rumを組み込んだonline-boutiqueのデプロイ>3. RUMを組み込んだOnline Boutiqueのデプロイ</h2><p>EC2インスタンスのkubernetes（K3s）にOnline Boutiqueのアプリケーションをデプロイするには、元のデプロイメントを削除し、RUM用のapm configスクリプトを実行し、RUMのデプロイメントを適用します。</p><div class=tab-panel data-tab-group=5f781b541cc4c5c04ff5a0d15d1763d7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=deploy-online-boutique-with-rum class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("5f781b541cc4c5c04ff5a0d15d1763d7","deploy-online-boutique-with-rum")'>
<span class=tab-nav-text>Deploy Online Boutique with RUM</span></button>
<button data-tab-item=partial-deployment-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("5f781b541cc4c5c04ff5a0d15d1763d7","partial-deployment-output")'>
<span class=tab-nav-text>Partial Deployment Output</span></button></div><div class=tab-content-container><div data-tab-item=deploy-online-boutique-with-rum class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/apm
</span></span><span class=line><span class=cl>kubectl delete -f deployment.yaml
</span></span><span class=line><span class=cl>kubectl apply -f deployment.yaml</span></span></code></pre></div></div></div><div data-tab-item=partial-deployment-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>......
</span></span><span class=line><span class=cl>Adding RUM_TOKEN to deployment
</span></span><span class=line><span class=cl>deployment.apps/recommendationservice created
</span></span><span class=line><span class=cl>service/recommendationservice created
</span></span><span class=line><span class=cl>deployment.apps/productcatalogservice created
</span></span><span class=line><span class=cl>service/productcatalogservice created
</span></span><span class=line><span class=cl>deployment.apps/cartservice created
</span></span><span class=line><span class=cl>service/cartservice created
</span></span><span class=line><span class=cl>deployment.apps/adservice created
</span></span><span class=line><span class=cl>service/adservice created
</span></span><span class=line><span class=cl>deployment.apps/paymentservice created
</span></span><span class=line><span class=cl>service/paymentservice created
</span></span><span class=line><span class=cl>deployment.apps/loadgenerator created
</span></span><span class=line><span class=cl>service/loadgenerator created
</span></span><span class=line><span class=cl>deployment.apps/shippingservice created
</span></span><span class=line><span class=cl>service/shippingservice created
</span></span><span class=line><span class=cl>deployment.apps/currencyservice created
</span></span><span class=line><span class=cl>service/currencyservice created
</span></span><span class=line><span class=cl>deployment.apps/redis-cart created
</span></span><span class=line><span class=cl>service/redis-cart created
</span></span><span class=line><span class=cl>deployment.apps/checkoutservice created
</span></span><span class=line><span class=cl>service/checkoutservice created
</span></span><span class=line><span class=cl>deployment.apps/frontend created
</span></span><span class=line><span class=cl>service/frontend created
</span></span><span class=line><span class=cl>service/frontend-external created
</span></span><span class=line><span class=cl>deployment.apps/emailservice created
</span></span><span class=line><span class=cl>service/emailservice created
</span></span><span class=line><span class=cl>deployment.apps/rum-loadgen-deployment created</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle default" style=--VARIABLE-BOX-color:warning><div class=box-label>変数未セットに関するメッセージが表示された場合</div><div class=box-content><p><strong>kubectl delete -f deployment.yaml</strong> コマンドを実行しAPM環境のデプロイ削除します。
次にガイド、メッセージに表示されていた変数をexportし上記のデプロイスクリプトを再実行します。</p></div></div><h2 id=4-online-boutiqueを使ってシステムに負荷を与える>4. Online Boutiqueを使ってシステムに負荷を与える</h2><p>皆さんと一緒にOnline Boutiqueに接続し買い物をシミュレートする合成ユーザーもいます。これにより、複数の場所からのトラフィックが発生し、よりリアルなデータが得られます。</p><p>ワークショップ講師からURLを受け取っているはずです。
新しいWebブラウザを立ち上げ <code>http://{==RUM-HOST-EC2-IP==}:81/</code> にアクセスするとRUMが有効化されたOnline Boutiqueが表示されます。</p><p><a href=#R-image-86be56c2ad223a452ddd13aa5f4a1697 class=lightbox-link><img src=../ja/rum/2-showcase/../images/online-boutique.png alt="Online Boutique" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-86be56c2ad223a452ddd13aa5f4a1697><img src=../ja/rum/2-showcase/../images/online-boutique.png alt="Online Boutique" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=5-トラフィックを発生させる>5. トラフィックを発生させる</h2><p>この演習の目的は、RUMが有効化されたOnline Boutiqueを閲覧し、さまざまな商品と数量の組み合わせで購入することです。
さらに別のブラウザやスマートフォンからアクセスすることもできます。</p><p>これにより複数のセッションが作成され、調査することができます。じっくりと吟味して、いろいろな商品を購入しカートに入れてください。</p><p><a href=#R-image-2618c44819290332f97f859bf62eb6a6 class=lightbox-link><img src=../ja/rum/2-showcase/../images/cart.png alt="Cart Online Boutique" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2618c44819290332f97f859bf62eb6a6><img src=../ja/rum/2-showcase/../images/cart.png alt="Cart Online Boutique" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Home Barista Kitかっこよくないですか？&mldr; ショッピングを楽しんでください！</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=3-自分のwebサイトでrumを有効化する場合の例>3. 自分のWebサイトでRUMを有効化する場合の例</h1><ul><li>ブラウザでOnline BoutiqueのウェブページのオリジナルのHEADセクション（またはここにある例を使用）をチェックします</li><li>ワークショップ Online Boutique の Webアドレスを検索します</li><li>Online Boutiqueに加えられた変更を確認します</li></ul><hr><h2 id=1-rumなしのonline-boutiqueのオリジナルコードを確認する>1. RUMなしのOnline Boutiqueのオリジナルコードを確認する</h2><p>APMセッションの一部でEC2インスタンスにOnline Boutiqueをインストールしていれば、ポート番号81でサイトにアクセスできます。</p><p>Online BoutiqueがインストールされたEC2インスタンスにアクセスできない場合は、講師からRUMがインストールされていないOnline BoutiqueのURLを教えてもらい、次のステップに進んでください。</p><h2 id=2-rum-access-tokenの入手>2. RUM Access Tokenの入手</h2><p>これから行うデプロイメントは、RUM ワークショップセクションの一部としても使用されます。Splunk UIからRUM Access Tokenを取得する必要があります。ワークショップのアクセストークンは、左下の <strong>&#187;</strong> をクリックし <a href=#R-image-d07825532ebca8ae2b0e51ea15852eea class=lightbox-link><img src=../ja/rum/3-setup/../images/setting.png alt=settings class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d07825532ebca8ae2b0e51ea15852eea><img src=../ja/rum/3-setup/../images/setting.png alt=settings class="lightbox-image noborder lightbox noshadow" loading=lazy></a> メニューをクリックして、 <strong>Settings → Access Tokens</strong> を選択すると見つけることができます。</p><p>講師が使用するように指示したRUMワークショップトークン（例： <strong>O11y-Workshop-RUM-TOKEN</strong> ）を展開し、 <strong>Show Token</strong> をクリックしてトークンを公開します。 <span class="btn cstyle grey"><span><span class=title>Copy</span></span></span> ボタンをクリックし、クリップボードにコピーしてください。 <strong>Default</strong> のトークンは使用しないでください。トークンのAuthorization ScopeがRUMであることを確認してください。</p><p><a href=#R-image-d49f3a217b375239e8894b00ebbf6eeb class=lightbox-link><img src=../ja/rum/3-setup/../images/RUM-Access-Token.png alt="Access Token" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d49f3a217b375239e8894b00ebbf6eeb><img src=../ja/rum/3-setup/../images/RUM-Access-Token.png alt="Access Token" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle default" style=--VARIABLE-BOX-color:warning><div class=box-label>新規にトークンを作らないでください</div><div class=box-content><p>このワークショップのために、皆さんが行う演習に適した設定をしたRUM Tokenを作成しています。</p></div></div><p>EC2にSSHアクセスしているシェルスクリプトで環境変数 <code>RUM_TOKEN</code> を作成し、デプロイメントをパーソナライズします。</p><div class=tab-panel data-tab-group=ca21e3d732f2c7efcb3e8af554aaae52><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=export-variables class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("ca21e3d732f2c7efcb3e8af554aaae52","export-variables")'>
<span class=tab-nav-text>Export Variables</span></button></div><div class=tab-content-container><div data-tab-item=export-variables class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>RUM_TOKEN</span><span class=o>=</span>&lt;replace_with_O11y-Workshop-RUM-TOKEN&gt;</span></span></code></pre></div></div></div></div></div><h2 id=2-online-boutiqueのデプロイ>2. Online Boutiqueのデプロイ</h2><p>Online BoutiqueアプリケーションをK3sにデプロイするには、apm configスクリプトを実行し、デプロイを適用してください。</p><div class=tab-panel data-tab-group=53d0106ef733c8eaf0c032f4fb76b2b9><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=deploy-online-boutique class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("53d0106ef733c8eaf0c032f4fb76b2b9","deploy-online-boutique")'>
<span class=tab-nav-text>Deploy Online Boutique</span></button>
<button data-tab-item=deployment-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("53d0106ef733c8eaf0c032f4fb76b2b9","deployment-output")'>
<span class=tab-nav-text>Deployment Output</span></button></div><div class=tab-content-container><div data-tab-item=deploy-online-boutique class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/apm
</span></span><span class=line><span class=cl>kubectl apply -f deployment.yaml</span></span></code></pre></div></div></div><div data-tab-item=deployment-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>deployment.apps/checkoutservice created
</span></span><span class=line><span class=cl>service/checkoutservice created
</span></span><span class=line><span class=cl>deployment.apps/redis-cart created
</span></span><span class=line><span class=cl>service/redis-cart created
</span></span><span class=line><span class=cl>deployment.apps/productcatalogservice created
</span></span><span class=line><span class=cl>service/productcatalogservice created
</span></span><span class=line><span class=cl>deployment.apps/loadgenerator created
</span></span><span class=line><span class=cl>service/loadgenerator created
</span></span><span class=line><span class=cl>deployment.apps/frontend created
</span></span><span class=line><span class=cl>service/frontend created
</span></span><span class=line><span class=cl>service/frontend-external created
</span></span><span class=line><span class=cl>deployment.apps/paymentservice created
</span></span><span class=line><span class=cl>service/paymentservice created
</span></span><span class=line><span class=cl>deployment.apps/emailservice created
</span></span><span class=line><span class=cl>service/emailservice created
</span></span><span class=line><span class=cl>deployment.apps/adservice created
</span></span><span class=line><span class=cl>service/adservice created
</span></span><span class=line><span class=cl>deployment.apps/cartservice created
</span></span><span class=line><span class=cl>service/cartservice created
</span></span><span class=line><span class=cl>deployment.apps/recommendationservice created
</span></span><span class=line><span class=cl>service/recommendationservice created
</span></span><span class=line><span class=cl>deployment.apps/shippingservice created
</span></span><span class=line><span class=cl>service/shippingservice created
</span></span><span class=line><span class=cl>deployment.apps/currencyservice created
</span></span><span class=line><span class=cl>service/currencyservice created</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle default" style=--VARIABLE-BOX-color:warning><div class=box-label>変数未セットに関するメッセージが表示された場合</div><div class=box-content><p><strong>kubectl delete -f deployment.yaml</strong> コマンドを実行しAPM環境のデプロイ削除します。
次にガイド、メッセージに表示されていた変数をexportし上記のデプロイスクリプトを再実行します。</p></div></div><p>ウェブブラウザーを起動し、Online Boutiqueにアクセスします。 (以前使用したもの、または新しくワークショップ講師が提供したもの）。RUMなしのOnline Boutiqueが起動していることが確認できます。</p><p><a href=#R-image-0b9e2932c07e7697a003361bb881f8a4 class=lightbox-link><img src=../ja/rum/3-setup/../images/online-boutique.png alt="Online Boutique" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0b9e2932c07e7697a003361bb881f8a4><img src=../ja/rum/3-setup/../images/online-boutique.png alt="Online Boutique" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>下記のお使いのブラウザの説明に従ってください。</p><h3 id=11-chrome-firefox--microsoft-edge-ユーザー---ページのソースを確認>1.1 Chrome, FireFox & Microsoft Edge ユーザー - ページのソースを確認</h3><p>Chrome、Firefox、Microsoft Edgeでは、Online Boutiqueのサイト上で右クリックすると、 <strong>「ページのソースを表示」</strong> のオプションが表示されます。</p><p><a href=#R-image-a4d4d28c8e38561a0298d9dd22d25b00 class=lightbox-link><img src=../ja/rum/3-setup/../images/Chrome-1.png alt=Chrome-see-source class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a4d4d28c8e38561a0298d9dd22d25b00><img src=../ja/rum/3-setup/../images/Chrome-1.png alt=Chrome-see-source class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これを選択すると、HTMLページのソースコードが別のタブで表示されます。</p><p><a href=#R-image-270dd9733b20011eaa5ae0251bdda3e9 class=lightbox-link><img src=../ja/rum/3-setup/../images/Chrome-html.png alt=Chrome-see-html class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-270dd9733b20011eaa5ae0251bdda3e9><img src=../ja/rum/3-setup/../images/Chrome-html.png alt=Chrome-see-html class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>成功すれば、 <a href=../ja/rum/index.html#2---変更前のheadセクションの確認>2 - 変更前のHEADセクションの確認</a> へ進みます。</p><h3 id=12-safari-ユーザー---ページのソースを確認>1.2 Safari ユーザー - ページのソースを確認</h3><p>Safariでは機能を有効化する必要がある場合があります。OS Xメニューバーの <em>Safari</em> の配下にある <strong>「設定」</strong> をクリックします。</p><p><a href=#R-image-6515ca2343893d09206a7dc797a0f6c8 class=lightbox-link><img src=../ja/rum/3-setup/../images/Safari-1.png alt=Safari-1 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6515ca2343893d09206a7dc797a0f6c8><img src=../ja/rum/3-setup/../images/Safari-1.png alt=Safari-1 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ダイアログがポップアップしますので、 <strong>「詳細」</strong> ペイン内の <strong>「メニューバーに"開発"メニューを表示」</strong> にチェックをいれ、ダイアログボックスを閉じます。</p><p><a href=#R-image-ce9d6c52329d1776ddea4ee7accded7b class=lightbox-link><img src=../ja/rum/3-setup/../images/Safari-2.png alt=Safari-2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ce9d6c52329d1776ddea4ee7accded7b><img src=../ja/rum/3-setup/../images/Safari-2.png alt=Safari-2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Online Boutiqueを右クリックすると、「ページのソースを表示する」オプションが表示されるようになります。</p><p><a href=#R-image-03566511dd24bbb43151e7008eb0d342 class=lightbox-link><img src=../ja/rum/3-setup/../images/Safari-3.png alt=Safari-3 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-03566511dd24bbb43151e7008eb0d342><img src=../ja/rum/3-setup/../images/Safari-3.png alt=Safari-3 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Online Boutiqueでそのオプションを選択すると、以下のようなHTMLソースコードが表示されます。</p><p><a href=#R-image-db65ecee387e55200c2c2c262f45523a class=lightbox-link><img src=../ja/rum/3-setup/../images/Safari-html.png alt=Safari-html class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-db65ecee387e55200c2c2c262f45523a><img src=../ja/rum/3-setup/../images/Safari-html.png alt=Safari-html class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>成功すれば、 <a href=../ja/rum/index.html#2---変更前のheadセクションの確認>2 - 変更前のHEADセクションの確認</a> へ進みます。</p><h3 id=13-internet-explorer-ユーザー---ページのソースを確認>1.3 Internet Explorer ユーザー - ページのソースを確認</h3><p>Internet Explorer 11 をお使いの場合、この演習では Web/RUM 用のSplunk Open Telemetry JavaScriptの特定のバージョンが必要になるため、問題が発生する可能性があります。
ただし、Online Boutiqueサイトを右クリックすると、<strong>「ソースを表示」</strong> のオプションが表示され、必要な変更を確認することができます。</p><p><a href=#R-image-ebbb8aa4f8a57bdb4d30c1d75a808cdc class=lightbox-link><img src=../ja/rum/3-setup/../images/IE-1.png alt=IE-1 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ebbb8aa4f8a57bdb4d30c1d75a808cdc><img src=../ja/rum/3-setup/../images/IE-1.png alt=IE-1 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Online Boutiqueでそのオプションを選択すると、以下のようなHTMLソースコードが表示されます。</p><p><a href=#R-image-7e09d36612433deeb07dad9cd60c32ef class=lightbox-link><img src=../ja/rum/3-setup/../images/IE-2.png alt=IE-2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7e09d36612433deeb07dad9cd60c32ef><img src=../ja/rum/3-setup/../images/IE-2.png alt=IE-2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2---変更前のheadセクションの確認>2 - 変更前のHEADセクションの確認</h2><p>RUMのための変更は、WebページのHEADセクションで実施します。以下は、あなたのローカルのBaseバージョンにあるべきオリジナルの行です。</p><p><a href=#R-image-959810cf4fb5f2b0055b8e2565abce31 class=lightbox-link><img src=../ja/rum/3-setup/../images/ViewBase-HEAD-html.png alt="Online Boutique" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-959810cf4fb5f2b0055b8e2565abce31><img src=../ja/rum/3-setup/../images/ViewBase-HEAD-html.png alt="Online Boutique" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Splunk または Open Telemetry Beacon (RUM Metrics と Traces を送信するために使用される関数) への参照はありません。</p><h2 id=3-rum有効online-boutiqueのウェブurlを探す>3. RUM有効Online Boutiqueのウェブ（URL）を探す</h2><p>RUMで使用するOnline Boutiqueは、RUM有効インスタンスのIPアドレスの81番ポートで見ることができます。URLはワークショップの講師から提供されます。</p><p>このRUMのセッションでは、講師が用意したRUM有効Online Boutiqueにアクセスできます。新しいウェブブラウザを開き、 <code>http://{==RUM-HOST-EC2-IP==}:81/</code> にアクセスすると、RUM有効Online Boutiqueが動作しているのが見えます。ここでも、前のセクションで説明したように、HTMLページのソースを表示します。</p><h2 id=4-rumを有効にするために行った変更をheadセクションで確認>4. RUMを有効にするために行った変更をHEADセクションで確認</h2><p>RUMに必要な変更は、WebページのHEADセクションに配置されます。以下は、RUMを有効にするために必要な変更を加えたhostsの更新されたHEADセクションです。</p><p><a href=#R-image-aa0f34f137393997a00d029e894e5ae5 class=lightbox-link><img src=../ja/rum/3-setup/../images/ViewRUM-HEAD-html.png alt="Online Boutique" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aa0f34f137393997a00d029e894e5ae5><img src=../ja/rum/3-setup/../images/ViewRUM-HEAD-html.png alt="Online Boutique" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>最初の3行（赤色でマーク）は、RUMトレースを有効にするためにWebページのHEADセクションに追加されています。最後の3行（青色でマーク）はオプションで、カスタムRUMイベントを有効にするために使用します。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span><span class=nb>window</span><span class=p>.</span><span class=nx>SplunkRum</span> <span class=o>&amp;&amp;</span> <span class=nb>window</span><span class=p>.</span><span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span><span class=nx>beaconUrl</span><span class=o>:</span> <span class=s2>&#34;https://rum-ingest.eu0.signalfx.com/v1/rum&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>rumAuth</span><span class=o>:</span> <span class=s2>&#34;1wCqZVUWIP5XSdNjPoQRFg&#34;</span><span class=p>,</span> <span class=nx>app</span><span class=o>:</span> <span class=s2>&#34;ksnq-store&#34;</span><span class=p>,</span> <span class=nx>environment</span><span class=o>:</span> <span class=s2>&#34;ksnq-workshop&#34;</span><span class=p>});&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>Provider</span> <span class=o>=</span> <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>provider</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>tracer</span><span class=o>=</span><span class=nx>Provider</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=s1>&#39;appModuleLoader&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span></span></span></code></pre></div><ul><li>最初の行は、Splunk Open Telemetry Javascript ファイルをダウンロードする場所を指定しています。<em><a href=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js target=_blank>https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js</a></em> (必要であれば、ローカルに読み込むこともできます)</li><li>2行目は、Beacon URLでトレースの送信先を定義しています。 <code>{beaconUrl: "https://rum-ingest.eu0.signalfx.com/v1/rum"</code></li><li>また、Access Tokenを追加しています。 <code>rumAuth: "1wCqZVUWIP5XSdNjPoQRFg"</code> (もちろんこれは例です。全てのアプリケーションに対して、複数のRUM Access Tokenを作成することができます。) *</li><li>また、SPLUNK RUM UIで使用するために、アプリケーション名や環境などの識別タグをRUMトレースに追加するために使用されます。 <code>app: "ksnq-store", environment: "ksnq-workshop"}</code></li></ul><div class="box notices cstyle default" style=--VARIABLE-BOX-color:info><div class=box-label>Info</div><div class=box-content><p>この例ではアプリ名は <strong>ksnq-store</strong> ですが、これはワークショップでは異なるでしょう。RUMセッションで使用するアプリ名と環境は講師に確認し、メモしておいてください。</p></div></div><p>上記の2行だけであなたのWebサイトでRUMを有効にすることができます。</p><p>(青色の)オプションのセクションでは、 <code>var tracer=Provider.getTracer('appModuleLoader');</code> を使用して、すべてのページ変更に対してカスタムイベントを追加し、ウェブサイトのコンバージョンと使用状況をよりよく追跡できるようにします。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=4-rumランディングページの確認>4. RUMランディングページの確認</h1><ul><li>RUMランディングページにアクセスし、アプリケーションサマリーダッシュボード（モバイルおよびウェブベース）でRUM対応アプリケーションすべてのパフォーマンスの概要を確認します。</li></ul><hr><h2 id=1-rumランディングページにアクセス>1. RUMランディングページにアクセス</h2><p>Splunk IM/APM/RUM ウェブサイトにログインします。左側のメニューバーから <strong>RUM</strong> を選択します。 <a href=#R-image-5c1011646d1eb445d7d243391f452d65 class=lightbox-link><img src=../ja/rum/4-rum-landing/../images/RUM_ico.png alt=RUM-ico class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5c1011646d1eb445d7d243391f452d65><img src=../ja/rum/4-rum-landing/../images/RUM_ico.png alt=RUM-ico class="lightbox-image noborder lightbox noshadow" loading=lazy></a> RUMのランディングページが表示されます。</p><p>このページの目的は、アプリケーションの健全性、パフォーマンス、潜在的なエラーを1つのページで明確に示し、Webページ/アプリケーションから収集したユーザーセッションに関する情報をより深く掘り下げることができるようにすることです。アクティブなRUMアプリケーションごとにペインが表示されます。(以下のビューは、デフォルトの拡張ビューです。）</p><p><a href=#R-image-63689e0cb7ca594085b37802e9e3934e class=lightbox-link><img src=../ja/rum/4-rum-landing/../images/Applicationsummarydashboard.png alt=RUM-App-sum class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-63689e0cb7ca594085b37802e9e3934e><img src=../ja/rum/4-rum-landing/../images/Applicationsummarydashboard.png alt=RUM-App-sum class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>複数のアプリケーションがある場合（RUMワークショップの参加者全員が自分のec2インスタンスを使用する場合）、以下のようにペインを折りたたむことで自動的にペインビューが縮小される場合があります。</p><p><a href=#R-image-f129afe4dbdfec740fff496b2caa4e0e class=lightbox-link><img src=../ja/rum/4-rum-landing/../images/multiple_apps_collapsed.png alt=RUM-App-sum-collapsed class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f129afe4dbdfec740fff496b2caa4e0e><img src=../ja/rum/4-rum-landing/../images/multiple_apps_collapsed.png alt=RUM-App-sum-collapsed class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>アプリケーション名の前にある左側の赤い矢印で強調されている <a href=#R-image-fdd04d19d7c53c7687d0c3c41bd0089e class=lightbox-link><img src=../ja/rum/4-rum-landing/../images/browser.png alt=RUM-browser class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fdd04d19d7c53c7687d0c3c41bd0089e><img src=../ja/rum/4-rum-landing/../images/browser.png alt=RUM-browser class="lightbox-image noborder lightbox noshadow" loading=lazy></a> または <a href=#R-image-b02dec89f91ad64294cc9fd3a0289bcc class=lightbox-link><img src=../ja/rum/4-rum-landing/../images/mobile.png alt=RUM-mobile class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b02dec89f91ad64294cc9fd3a0289bcc><img src=../ja/rum/4-rum-landing/../images/mobile.png alt=RUM-mobile class="lightbox-image noborder lightbox noshadow" loading=lazy></a> アイコン(アプリケーションの種類が <em>モバイル</em> か <em>ブラウザー</em> かによる）をクリックすると、RUM Application Summryビューをフルダッシュボードに展開することが可能です。</p><p>まず、ワークショップに使用する適切なアプリケーションを見つけます。</p><p>単独のRUMワークショップに参加する場合、ワークショップ講師が使用するアプリケーションの名前を教えてくれます。複合ワークショップの場合、IMとAPMで使用した命名規則に従い、上のスクリーンショットの一番最後に表示されているように、 <strong>jmcj-store</strong> のようにユニークIDとしてEC2ノードの名前に従います。</p><h2 id=2-rum-application-summary-ダッシュボード-のヘッダーセクションを設定する>2. RUM Application Summary ダッシュボード のヘッダーセクションを設定する</h2><p>RUM Application Summary ダッシュボードは5つの主要なセクションで構成されています。一つ目は選択ヘッダーで、多くのオプションを設定/フィルタリングすることができます。</p><ul><li>表示対象時間のための <strong>タイム・ウィンドウ</strong> ドロップダウン（デフォルトでは過去15分間）</li><li><strong>Environment</strong><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> を選択するためのドロップダウン。これにより、その環境に属するアプリケーションのサブセットのみにフォーカスすることができます。</li><li>監視対象のさまざまな <strong>Apps</strong> を含むドロップダウンリスト。ワークショップ講師によって提供されたものを使用するか、あなた自身のものを選択することができます。これにより、1つのアプリケーションにフォーカスすることができます。</li><li><strong>Source</strong> 、 <strong>Browser</strong> 、 <strong>Mobile</strong> アプリケーションを選択するためのドロップダウン。ワークショップの場合は、 <em>All</em> を選択したままにしてください。</li><li>ヘッダーの右側にあるハンバーガーメニューで、Splunk RUM アプリケーションのいくつかの設定を行うことができます(これについては、後のセクションで説明します)。</li></ul><p><a href=#R-image-0273b6fcf85c96b4a252b3776d8d84ae class=lightbox-link><img src=../ja/rum/4-rum-landing/../images/RUM_SummaryHeader.png alt=RUM-SummaryHeader class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0273b6fcf85c96b4a252b3776d8d84ae><img src=../ja/rum/4-rum-landing/../images/RUM_SummaryHeader.png alt=RUM-SummaryHeader class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>次のセクションでは「Application Summary」画面をより深く掘り下げて説明します。</p><hr><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>デプロイメント環境（Environment）は、システムまたはアプリケーションの個別のデプロイメントであり、同じアプリケーションの他のデプロイメントの設定と重複しないように設定を行うことができます。開発、ステージング、本番など、開発プロセスの段階ごとに別々のデプロイメント環境を使用することがよくあります。</br></br>一般的なアプリケーションのデプロイメントパターンとして、互いに直接影響し合わない複数の異なるアプリケーション環境を持ち、それらをすべて Splunk APM または RUM で監視することがあります。たとえば、品質保証 (QA) 環境と本番環境、または異なるデータセンター、地域、クラウドプロバイダーでの複数の異なるデプロイメントが挙げられます。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=5-ブラウザーアプリケーションの健全性を一目で確認>5. ブラウザーアプリケーションの健全性を一目で確認</h1><ul><li>ランディングページで利用できるUIとオプションに慣れる</li><li>ページビュー/エラー、リクエスト/エラー、およびJavaScriptエラーを1つのビューで識別しする</br>Web Vitalメトリクスと、ブラウザーアプリケーションに関連して発生したディテクターを確認する</li></ul><hr><h2 id=1-application-summary-ダッシュボードの概要>1. Application Summary ダッシュボードの概要</h2><h3 id=11-ヘッダーバー>1.1. ヘッダーバー</h3><p>前のセクションで見たように、RUM Application Summary ダッシュボードは5つの主要セクションで構成されています</br>。
最初のセクションは選択ヘッダーで、 <a href=#R-image-897af6b40a6da2e1aee90dd0cdd64a84 class=lightbox-link><img src=../ja/rum/5-browser-app-summary/../images/browser.png alt=RUM-browser class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-897af6b40a6da2e1aee90dd0cdd64a84><img src=../ja/rum/5-browser-app-summary/../images/browser.png alt=RUM-browser class="lightbox-image noborder lightbox noshadow" loading=lazy></a> ブラウザーアイコンまたはアプリケーション名の前の <strong>></strong> を使用してペインを折りたたむことができます。また、アプリケーション名(下の例では <em>jmcj-store</em> )のリンクをクリックすると、<em>Application Overview</em> ページにアクセスできます。</p><p>また、右側のトリプルドット <a href=#R-image-d0e5a065015683b39d172f38830d19f2 class=lightbox-link><img src=../ja/rum/5-browser-app-summary/../images/trippleburger.png alt=trippleburger class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d0e5a065015683b39d172f38830d19f2><img src=../ja/rum/5-browser-app-summary/../images/trippleburger.png alt=trippleburger class="lightbox-image noborder lightbox noshadow" loading=lazy></a> メニューから、 <em>Application Overview</em> や <em>App Health ダッシュボード</em> を開くことができます。</p><p><a href=#R-image-db9288dd14dc64f4acc8bb5bdbdfdae8 class=lightbox-link><img src=../ja/rum/5-browser-app-summary/../images/summaryHeader.png alt=RUM-SummaryHeader class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-db9288dd14dc64f4acc8bb5bdbdfdae8><img src=../ja/rum/5-browser-app-summary/../images/summaryHeader.png alt=RUM-SummaryHeader class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>まず <em>View Dashboard</em> リンクをクリックし Browser App Health ダッシュボード を開きます（別タブで開かれます）。 次に元のRUMタブに戻り <em>Open Application Overview</em> リンクか、アプリの名前をクリックして、Application Overview ダッシュボードを開きます。</p><p><em>Application Overview</em> と <em>Browser App Health</em> ダッシュボードを次のセクションで詳しく見ていきます。</p><h2 id=2-application-overview>2. Application Overview</h2><p>RUM Application Overview ダッシュボードでは <em>一目で</em> アプリケーションの状態の概要を確認できます。</p><h3 id=21-page-views--network-requests--errors>2.1. Page Views / Network Requests / Errors</h3><p>最初セクションに表示されている <em>Page Views / Errors</em> と <em>Network Requests and Errors</em> チャートはアプリケーション内のリクエスト数と問題の傾向を示しています。 これは、Javascriptのエラーや、バックエンドサービスへのネットワーク呼び出しに失敗した可能性があります。</p><p><a href=#R-image-f10fecb206472401e2eb50d0d14826a8 class=lightbox-link><img src=../ja/rum/5-browser-app-summary/../images/Rum-chart.png alt=RUM-chart class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f10fecb206472401e2eb50d0d14826a8><img src=../ja/rum/5-browser-app-summary/../images/Rum-chart.png alt=RUM-chart class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>上の例では、Networkチャートではネットワーク呼び出しに失敗していないことがわかりますが、Page Viewsチャートでは多くのページで何らかのエラーが発生していることが確認できます。このようなエラーは一般ユーザーからは見えないことが多いのですが、Web サイトのパフォーマンスに重大な影響を与える可能性があります。</p><p>チャート上にカーソルをホバーすると Page Views / Network Requests / Errors の件数を確認できます。</p><p><a href=#R-image-38aea99df6f524e25f7bb3e2ff1ecc46 class=lightbox-link><img src=../ja/rum/5-browser-app-summary/../images/RUM-Chart-Clicked.png alt=RUM-chart-clicked class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-38aea99df6f524e25f7bb3e2ff1ecc46><img src=../ja/rum/5-browser-app-summary/../images/RUM-Chart-Clicked.png alt=RUM-chart-clicked class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=22-javascript-errors>2.2. JavaScript Errors</h3><p>2番目のセクションでは、アプリケーションで発生したJavaScriptエラーの概要と、各エラーの件数が表示されます。
<a href=#R-image-df6ea6568c5122ddaf16d04767e65ece class=lightbox-link><img src=../ja/rum/5-browser-app-summary/../images/RUM-Javascripterrors.png alt=RUM-javascript class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-df6ea6568c5122ddaf16d04767e65ece><img src=../ja/rum/5-browser-app-summary/../images/RUM-Javascripterrors.png alt=RUM-javascript class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>上の例では、3種類のJavaScriptエラーがあることがわかります。1つは選択した時間帯に29回発生し、他の2つはそれぞれ12回発生しています。</p><p>エラーの一つをクリックすると、ポップアウトが開き、時系列でエラーの概要（下図）が表示されます。また、JavaScript エラーのスタックトレースが表示され、問題が発生した場所を知ることができます（詳細については、次のセクションで説明します）。</p><p><a href=#R-image-7d8b310563465f9856dc5167dc693b7c class=lightbox-link><img src=../ja/rum/5-browser-app-summary/../images/expandedRUmJAVAscript-error.png alt=RUM-javascript-chart class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7d8b310563465f9856dc5167dc693b7c><img src=../ja/rum/5-browser-app-summary/../images/expandedRUmJAVAscript-error.png alt=RUM-javascript-chart class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=23-web-vitals>2.3. Web Vitals</h3><p>3番目のセクションでは、Googleがランキングシステムで使用する3つのメトリクスである重要な（Google）Web Vitalsを表示しており、エンドユーザーにとってのサイトの表示速度を非常によく表しています。</p><p><a href=#R-image-a40907a9d06ce37b6f8184e0dabbf006 class=lightbox-link><img src=../ja/rum/5-browser-app-summary/../images/RUM-QuickWebVitals.png alt=WEB-vitals class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a40907a9d06ce37b6f8184e0dabbf006><img src=../ja/rum/5-browser-app-summary/../images/RUM-QuickWebVitals.png alt=WEB-vitals class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ご覧の通り、当サイトは3つのメトリクスすべてで <em>Good</em> スコアを獲得し、良好な動作をしています。これらのメトリクスは、アプリケーションの変更がもたらす影響を特定し、サイトのパフォーマンスを向上させるために使用することができます。</p><p>Web Vitalsペインに表示されているメトリクスをクリックすると、対応する Tag Spotlight ダッシュボードに移動します。例えば <strong>Largest Contentful Paint (LCP)</strong> をクリックすると、以下のスクリーンショットのようなダッシュボードが表示され、このメトリクスのパフォーマンスに関するタイムラインとテーブルビューを見ることができます。これにより、OS やブラウザーのバージョンなど、より一般的な問題の傾向を把握することができます。</p><p><a href=#R-image-fb83dbb7e928789acbdfa9b82159b361 class=lightbox-link><img src=../ja/rum/5-browser-app-summary/../images/RUM-Tag-Spotlight.png alt=WEB-vitals-tag class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fb83dbb7e928789acbdfa9b82159b361><img src=../ja/rum/5-browser-app-summary/../images/RUM-Tag-Spotlight.png alt=WEB-vitals-tag class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=24-most-recent-detectors>2.4. Most Recent Detectors</h3><p>4番目であり最後のセクションでは、アプリケーションでトリガーされたディテクターの概要を表示することにフォーカスしています。このスクリーンショット用にディテクターを作成しているため、皆さんのペインでは何も表示されていないはずです。次のセクションで実際にディテクターを追加し、トリガーされるようにします。</p><p><a href=#R-image-c29a69cf2d7a3bccbe8677f3e2b0b73a class=lightbox-link><img src=../ja/rum/5-browser-app-summary/../images/rum-detector.png alt=detectors class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c29a69cf2d7a3bccbe8677f3e2b0b73a><img src=../ja/rum/5-browser-app-summary/../images/rum-detector.png alt=detectors class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>下のスクリーンショットでは、 <em>RUM Aggregated View Detector</em> のクリティカルアラートと、選択した時間ウィンドウでこのアラートが何回トリガーされたかを示す件数が表示されています。アラートが表示されている場合は、アラートの名前（青いリンクで表示されている）をクリックすると、アラートの詳細を表示するアラート概要ページに移動します（注意：この操作を行うと、現在のページから離れることになります。）</p><p><a href=#R-image-c0179b0714bae64b1dbc3b08b166ac33 class=lightbox-link><img src=../ja/rum/5-browser-app-summary/../images/click-alert.png alt=alert class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c0179b0714bae64b1dbc3b08b166ac33><img src=../ja/rum/5-browser-app-summary/../images/click-alert.png alt=alert class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><p>次のセクションに進む前に、RUM Application Summaryダッシュボードとその基礎となるチャートとダッシュボードを数分間試してみてください。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=6-rumメトリクスの分析>6. RUMメトリクスの分析</h1><ul><li>RUM UIでRUMメトリクスとセッション情報を見る</li><li>RUM & APM UIで相関するAPMトレースを見る</li></ul><hr><h2 id=1-rum-overview-pages>1. RUM Overview Pages</h2><p>RUM Application Summaryダッシュボードの右側のトリプルドット <a href=#R-image-42f2b865a2244c11da6f847e367f241c class=lightbox-link><img src=../ja/rum/6-analyzing-metrics/../images/trippleburger.png alt=trippleburger class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-42f2b865a2244c11da6f847e367f241c><img src=../ja/rum/6-analyzing-metrics/../images/trippleburger.png alt=trippleburger class="lightbox-image noborder lightbox noshadow" loading=lazy></a> メニューから <em>Open Application Overview</em> を選択するか、アプリケーション名のリンク（以下の例では <em>jmcj-store</em> ）をクリックして Application Overviewページを開き、詳細情報を確認することができます。</p><p><a href=#R-image-8cfa64cf0d909efbf126ed99b32f34e4 class=lightbox-link><img src=../ja/rum/6-analyzing-metrics/../images/summaryHeader.png alt=RUM-SummaryHeader class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8cfa64cf0d909efbf126ed99b32f34e4><img src=../ja/rum/6-analyzing-metrics/../images/summaryHeader.png alt=RUM-SummaryHeader class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>以下のような RUM Application Overview ページが表示されます。</p><p><a href=#R-image-188aed5cc03d1e8980bd5d0b1851f278 class=lightbox-link><img src=../ja/rum/6-analyzing-metrics/../images/RUM-1.png alt=RUM-1 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-188aed5cc03d1e8980bd5d0b1851f278><img src=../ja/rum/6-analyzing-metrics/../images/RUM-1.png alt=RUM-1 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-rum-browserの概要>2. RUM Browserの概要</h2><h3 id=21-ヘッダー>2.1. ヘッダー</h3><p>RUMのUIは、大きく6つのセクションで構成されています。一つ目は選択ヘッダーで、多くのオプションを設定/フィルタリングすることができます。</p><ul><li>レビューする時間ウィンドウを選択するドロップダウン（この場合は過去15分）。</li><li>比較ウィンドウを選択するためのドロップダウン（現在のパフォーマンスをローリングウィンドウで比較します - この場合は1時間前と比較）。</li><li>Environmentを選択するドロップダウン (ワークショップ講師が提供するもの、またはこの例のように <em>All</em> を選択）。</li><li>様々なWebアプリのドロップダウン（ワークショップ講師が提供するものか、 <em>All</em> を使用）。</li><li><em><strong>オプション</strong></em> ブラウザまたはモバイルメトリクスを選択するドロップダウン（<em>ワークショップでは恐らく利用できません</em>)
<a href=#R-image-a07f3b6172b8e24e971fc56f7b6e88d2 class=lightbox-link><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Header.png alt=RUM-Header class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a07f3b6172b8e24e971fc56f7b6e88d2><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Header.png alt=RUM-Header class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul><h3 id=22-概要ペイン>2.2. 概要ペイン</h3><p>ページの左側にある概要ペインでは、ロード時間が長くなったページの概要を確認することができます。</p><p>この例では <strong>checkout</strong> と <strong>cart</strong> ページに黄色の三角形でエラーを示しており、ロード時間が 2.38 秒から 5.50 秒に増加したことがわかります。</p><p><a href=#R-image-0208ec010c28722b51ee97f05be00942 class=lightbox-link><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Page-Load-Times.png alt=RUM-Top class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0208ec010c28722b51ee97f05be00942><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Page-Load-Times.png alt=RUM-Top class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>また、1分あたりのFrontend ErrorとBackend Errorsの件数の概要が表示され、このサイトでは3種類のJavaScriptエラーが発生していることが分かります。</p><p><a href=#R-image-5d7e09715e42d2ba4ea48259cc43df72 class=lightbox-link><img src=../ja/rum/6-analyzing-metrics/../images/RUM-JS-Errors.png alt=RUM-Top class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d7e09715e42d2ba4ea48259cc43df72><img src=../ja/rum/6-analyzing-metrics/../images/RUM-JS-Errors.png alt=RUM-Top class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>最後の2つのペインでは、<strong>Top Page Views</strong> と <strong>Top Network Requests</strong> が表示されます。</p><p><a href=#R-image-34bbc347ac382fc9f019762530510128 class=lightbox-link><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Page-Views-Network.png alt=RUM-Top class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-34bbc347ac382fc9f019762530510128><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Page-Views-Network.png alt=RUM-Top class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=23-key-metricsペイン>2.3. Key Metricsペイン</h3><p>Key Metricsペインでは、毎分の <strong>JavaScript Errors</strong> と <strong>Network Errors</strong> の件数、また <strong>Backend/Resource Request Duration</strong> を確認できます。これらのメトリクスはサイトで問題が発生した場合に、発生個所を特定するのに非常に便利です。</p><p><a href=#R-image-9008a92cad1bc20e6d4f94cd62d8bf55 class=lightbox-link><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Key-Metrics.png alt=RUM-KeyMetrics class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9008a92cad1bc20e6d4f94cd62d8bf55><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Key-Metrics.png alt=RUM-KeyMetrics class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=24-web-vitalsペイン>2.4. Web Vitalsペイン</h3><p>Web Vitalsペインは、Web Vitalのメトリクスに基づいてエンドユーザーに提供しているエクスペリエンスに関する洞察を得たい場合に使用する場所です。
Web Vitalは、ウェブ上で優れたユーザーエクスペリエンスを提供するために不可欠な品質シグナルの統一ガイダンスを提供するGoogleのイニシアチブであり、3つの主要なパラメーターに焦点を当てています。</p><ul><li><strong>Largest Contentful Paint (LCP)</strong> （最大コンテンツの描画）：読み込みのパフォーマンスを測定するものです。良いユーザーエクスペリエンスを提供するために、LCPはページが読み込まれてから2.5秒以内に発生する必要があります。</li><li><strong>First Input Delay (FID)</strong> （初回入力までの遅延時間）：インタラクティブ性を評価するものです。良いユーザーエクスペリエンスを提供するために、ページのFIDは100ミリ秒以下であるべきです。</li><li><strong>Cumulative Layout Shift (CLS)</strong> （累積レイアウトシフト数）：視覚的な安定性を測定します。良いユーザーエクスペリエンスを提供するためには、CLSを 0.1 以下で維持する必要があります。</li></ul><p><a href=#R-image-9452e0482bc59b95eebaa39879321a1f class=lightbox-link><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Web-Vitals.png alt=RUM-WebVitals class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9452e0482bc59b95eebaa39879321a1f><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Web-Vitals.png alt=RUM-WebVitals class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=25-other-metricsペイン>2.5. Other Metricsペイン</h3><p>Other Metricsペインでは、ページの初期ロード時間や完了までに時間がかかりすぎているタスクなどを中心に、その他のパフォーマンスメトリクスを確認することができます。</p><ul><li><strong>Time To First Byte (TTFB)</strong> ：クライアントのブラウザーがサーバーからレスポンスの最初のバイトを受信するまでの時間を測定します。サーバーがリクエストを処理し、レスポンスを送信するまでの時間が長いほど、訪問者のブラウザーがページを表示する際の速度が遅くなります。</li><li><strong>Long Task Duration</strong> ：開発者がユーザーエクスペリエンス悪化を理解するために使用できるパフォーマンスメトリクスであり、問題の兆候である可能性もあります。</li><li><strong>Long Task Count</strong> ：長いタスクの発生頻度を示すメトリクスで、これもユーザーエクスペリエンスの調査や問題の検出に使用されます。</li></ul><p><a href=#R-image-02eaba7fa3682b34162873db656e7776 class=lightbox-link><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Other.png alt=RUM-Other class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-02eaba7fa3682b34162873db656e7776><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Other.png alt=RUM-Other class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=26-custom-eventペイン>2.6. Custom Eventペイン</h3><p>Custom Eventペインでは、監視しているウェブページに自分で追加したイベントのメトリクスが表示されます。</p><p>RUMを有効化したサイトで見れるように、以下の2行を追加しています。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>Provider</span> <span class=o>=</span> <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>provider</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>tracer</span><span class=o>=</span><span class=nx>Provider</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=s1>&#39;appModuleLoader&#39;</span><span class=p>);</span></span></span></code></pre></div><p>これらの行は、すべての新しいページに対して自動的にカスタムイベントを作成します。また、フレームワークや作成したイベントの一部ではないカスタムコードにこれらを追加することで、アプリケーションのフローをより良く理解することができます。
<strong>Custom Event Requests</strong> 、 <strong>Custom Event Error Rates</strong> 、 <strong>Custom Event Latency</strong> をサポートしています。</p><p><a href=#R-image-be017eff941b114d226a99ec5f756d01 class=lightbox-link><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Custom-Events.png alt=RUM-CustomMetrics class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-be017eff941b114d226a99ec5f756d01><img src=../ja/rum/6-analyzing-metrics/../images/RUM-Custom-Events.png alt=RUM-CustomMetrics class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=7-tag-spotlightの使用>7. Tag Spotlightの使用</h1><ul><li>より深く分析のために様々なエンドポイントのメトリクスビューを調査したりTag spotlightに送信されたTagを使用します。</li></ul><hr><h2 id=1-cartエンドポイントのurlを探す>1. CartエンドポイントのURLを探す</h2><p>RUMの概要ページから、<strong>Cart</strong> エンドポイントのURLを選択し、このエンドポイントで利用可能な情報をさらに深く掘り下げてみてください。</p><p><a href=#R-image-d8bd64fd70238523ef8eebbc7af7094c class=lightbox-link><img src=../ja/rum/7-tag-spotlight/../images/RUM-select-cart.png alt=RUM-Cart2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d8bd64fd70238523ef8eebbc7af7094c><img src=../ja/rum/7-tag-spotlight/../images/RUM-select-cart.png alt=RUM-Cart2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>青色のURLをクリックすると、 <strong>Tag Spotlight</strong> の概要に遷移します。</p><p><a href=#R-image-191d97bfc695d24a341a78be6950daa1 class=lightbox-link><img src=../ja/rum/7-tag-spotlight/../images/RUM-TAG-Overview.png alt=RUM-Tag class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-191d97bfc695d24a341a78be6950daa1><img src=../ja/rum/7-tag-spotlight/../images/RUM-TAG-Overview.png alt=RUM-Tag class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ここでは、RUM トレースの一部として Splunk RUM に送信されたすべてのタグが表示されます。表示されるタグは、あなたが選択した概要に関連するものです。これらはトレースが送信されたときに自動的に作成された一般的なタグと、ウェブサイトの設定の一部でトレースに追加した追加タグです。</p><div class="box notices cstyle default" style=--VARIABLE-BOX-color:info><div class=box-label>追加タグ</div><div class=box-content><p>既に2つの追加タグを送信しています。それは皆さんのウェブサイトに追加された <em>Beacon url</em> に定義されている <em>app: &ldquo;[nodename]-store&rdquo;, environment: &ldquo;[nodename]-workshop&rdquo;</em> です（詳しくは後で確認します）。同様の方法で、タグを追加することができます。</p></div></div><p>この例では、以下のように <strong>Document Load Latency</strong> ビューを選択しています。</p><p><a href=#R-image-b67b205d3ca70177f29ceee6b5a694af class=lightbox-link><img src=../ja/rum/7-tag-spotlight/../images/RUM-Selection.png alt=RUM-Header class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b67b205d3ca70177f29ceee6b5a694af><img src=../ja/rum/7-tag-spotlight/../images/RUM-Selection.png alt=RUM-Header class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>特定のメトリクスにフォーカスした以下のタグビューのいずれかを選択することができます。</p><p><a href=#R-image-3812cec95c4a1b0bbb547d80c4d2fb77 class=lightbox-link><img src=../ja/rum/7-tag-spotlight/../images/RUM-Tag-views.png alt=RUM-views class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3812cec95c4a1b0bbb547d80c4d2fb77><img src=../ja/rum/7-tag-spotlight/../images/RUM-Tag-views.png alt=RUM-views class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=2-tag-spotlight内の情報を探索>2. Tag Spotlight内の情報を探索</h2><p>Tag Spotlightは、チャートビューで異常値を確認したり、タグで問題を特定するのに役立つように設計されています。</p><p><strong>Document Load Latency</strong> ビューで、<strong>Browser</strong> 、 <strong>Browser Version</strong> 、 <strong>OS Name</strong> タグビューを見ると、様々なブラウザーの種類とバージョン、そして基盤となるOSを確認することができます。
これにより、特定のブラウザやOSのバージョンに関連する問題が強調表示されるため、特定が容易になります。</p><p><a href=#R-image-b1d959a568af25ca95ae5f91ce65a6d5 class=lightbox-link><img src=../ja/rum/7-tag-spotlight/../images/RUMBrowserTags.png alt=RUM-Tag2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b1d959a568af25ca95ae5f91ce65a6d5><img src=../ja/rum/7-tag-spotlight/../images/RUMBrowserTags.png alt=RUM-Tag2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>上記の例では、Firefoxのレスポンスが最も遅く、様々なバージョンのブラウザ（Chrome）のレスポンスが異なること、Android端末のレスポンスが遅いことが分かります。</p><p>さらに、ISPや場所などに関連する問題を特定するために使用できる地域タグがあります。ここでは、Online Boutiqueにアクセスするために使用している場所を見つけることができます。以下のように、Online Boutiqueにアクセスしている都市や国をクリックしてドリルダウンしてください（City内のAmsterdam）。</p><p><a href=#R-image-6c76f8d0bff661a27f865339789479c9 class=lightbox-link><img src=../ja/rum/7-tag-spotlight/../images/RUM-Region.png alt=RUM-click class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6c76f8d0bff661a27f865339789479c9><img src=../ja/rum/7-tag-spotlight/../images/RUM-Region.png alt=RUM-click class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>以下のように選択した都市に関連するトレースのみが選択されます。</p><p><a href=#R-image-f1eb701376c5d24a2d6f51c44f80a70e class=lightbox-link><img src=../ja/rum/7-tag-spotlight/../images/RUM-Adam.png alt=RUM-Adam class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f1eb701376c5d24a2d6f51c44f80a70e><img src=../ja/rum/7-tag-spotlight/../images/RUM-Adam.png alt=RUM-Adam class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>様々なタグを選択することでフィルターを構築することができ、現在の選択項目も確認できます。</p><p><a href=#R-image-03ab8efd20f3c0fe529bddc6be56b7da class=lightbox-link><img src=../ja/rum/7-tag-spotlight/../images/RUM-Filter.png alt=RUM-Adam class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-03ab8efd20f3c0fe529bddc6be56b7da><img src=../ja/rum/7-tag-spotlight/../images/RUM-Filter.png alt=RUM-Adam class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>フィルタを解除してすべてのトレースを表示するには、ページ右上の <strong>Clear All</strong> をクリックしてください。</p><p>概要ページが空であるか、 <a href=#R-image-404e079d8b59114129cc8b53e4d8c2a7 class=lightbox-link><img src=../ja/rum/7-tag-spotlight/../images/RUM-NoTime.png alt=RUM-Adam class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-404e079d8b59114129cc8b53e4d8c2a7><img src=../ja/rum/7-tag-spotlight/../images/RUM-NoTime.png alt=RUM-Adam class="lightbox-image noborder lightbox noshadow" loading=lazy></a> と表示されている場合、選択したタイムスロットでトレースが受信されていないことを示します。
左上のタイムウィンドウを広げる必要があります。例えば、<em>Last 12 hours</em> で調べることができます。</p><p>下の図のように表示したい時間帯を選択し、小さな虫眼鏡のアイコンをクリックして時間フィルタをセットにすることができます。</p><p><a href=#R-image-c43459d9e966b45643f00eeec7fe081c class=lightbox-link><img src=../ja/rum/7-tag-spotlight/../images/RUM-TimeSelect.png alt=RUM-time class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c43459d9e966b45643f00eeec7fe081c><img src=../ja/rum/7-tag-spotlight/../images/RUM-TimeSelect.png alt=RUM-time class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=8-rum-sessionの分析>8. RUM Sessionの分析</h1><ul><li>RUM UIでRUM Sessionの情報を調査する</li><li>ユーザーインタラクションのSpanでJavascriptのエラーを特定する</li></ul><hr><h2 id=1-cart-urlを再び選択>1. cart URLを再び選択</h2><p>タイムセレクタで時間帯を選択した後、以下のように <strong>Url Name</strong>ビューから <em>cart</em> URLを再選択する必要があります。</p><p><a href=#R-image-c6679a000111fb5e2260d48f407b03d8 class=lightbox-link><img src=../ja/rum/8-rum-sessions/../images/RUM-Cart-All.png alt=RUM-Cart-3 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c6679a000111fb5e2260d48f407b03d8><img src=../ja/rum/8-rum-sessions/../images/RUM-Cart-All.png alt=RUM-Cart-3 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>上の例では <code>http://34.246.124.162:81/cart</code> を選択しました。</p><h2 id=2-sessionsにドリルダウン>2. Sessionsにドリルダウン</h2><p>Tag Spotlightで情報を分析し、トレースのサブセットをドリルダウンした後、エンドユーザーのブラウザーで実行された実際のセッションを表示することができます。</p><p>以下のように <strong>Example Sessions</strong> というリンクをクリックすることで行います。</p><p><a href=#R-image-b6c2a6669a765411fb7220c23b5f58f3 class=lightbox-link><img src=../ja/rum/8-rum-sessions/../images/RUM-ExampleSessions.png alt=RUM-Header class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b6c2a6669a765411fb7220c23b5f58f3><img src=../ja/rum/8-rum-sessions/../images/RUM-ExampleSessions.png alt=RUM-Header class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これにより、時間フィルタとタグプロファイルで選択したサブセットの両方に一致するセッションのリストが表示されます。</p><p>セッションIDをクリックします。最も長い時間（700 ミリ秒以上が望ましい）のものを選択するとよいでしょう。</p><p><a href=#R-image-13db789cd397ad595138fc71bf31e493 class=lightbox-link><img src=../ja/rum/8-rum-sessions/../images/RUM-Session-Selected.png alt=RUM-Header class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-13db789cd397ad595138fc71bf31e493><img src=../ja/rum/8-rum-sessions/../images/RUM-Session-Selected.png alt=RUM-Header class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>セッションを選択すると、セッションの詳細ページが表示されます。セッションの一部である特定のアクションを選択しているため、セッション内のどこかのインタラクションにたどり着く可能性が高いです。
先ほど選択したURL <code>http://34.246.124.162:81/cart</code> が、セッションストリームでフォーカスしている場所であることがわかります。</p><p><a href=#R-image-684ba8e5f072bfac5abf03897e425b7d class=lightbox-link><img src=../ja/rum/8-rum-sessions/../images/Session-Tag.png alt=RUM-Session-Tag class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-684ba8e5f072bfac5abf03897e425b7d><img src=../ja/rum/8-rum-sessions/../images/Session-Tag.png alt=RUM-Session-Tag class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ページを少し下にスクロールすると、以下のように操作の終わりが表示されます。</p><p><a href=#R-image-f8c959b1549f56efc7499f8ad350eb18 class=lightbox-link><img src=../ja/rum/8-rum-sessions/../images/Session-Tag-2.png alt=RUM-Session-info class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f8c959b1549f56efc7499f8ad350eb18><img src=../ja/rum/8-rum-sessions/../images/Session-Tag-2.png alt=RUM-Session-info class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>エンドユーザーには検出されなかったか、または表示されなかった可能性のあるいくつかのJavaScript Consoleエラーが発生していることがわかります。これらのエラーを詳しく調べるには、真ん中のエラー <strong>Cannot read properties of undefined (reading &lsquo;Prcie&rsquo;)</strong> をクリックしてください。</p><p><a href=#R-image-6ef97927895034687983c19c83c4f726 class=lightbox-link><img src=../ja/rum/8-rum-sessions/../images/Session-Tag-3.png alt=RUM-Session-info class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6ef97927895034687983c19c83c4f726><img src=../ja/rum/8-rum-sessions/../images/Session-Tag-3.png alt=RUM-Session-info class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これによってページが展開され、このインタラクションのSpanの詳細が表示されます。このページには、問題を解決するために開発者に渡すことができる詳細な <em>error.stack</em> が含まれます。Online Boutiqueで商品を購入した際、最終的な合計金額が常に0ドルであることにお気づきでしょうか。</p><p><a href=#R-image-a39dea3719fc4a82dd26ba113bd9e02e class=lightbox-link><img src=../ja/rum/8-rum-sessions/../images/Session-Tag-4.png alt=RUM-Session-info class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a39dea3719fc4a82dd26ba113bd9e02e><img src=../ja/rum/8-rum-sessions/../images/Session-Tag-4.png alt=RUM-Session-info class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=9-splunk-rum-と-apm-バックエンドサービスの相関>9. Splunk RUM と APM バックエンドサービスの相関</h1><ul><li>RUM UIでRUM Sessionの情報を続けます</li><li>APM & Log Observer UI で相関する APM トレースとログを確認します</li></ul><hr><h2 id=1-バックエンドサービスの問題を発見>1. バックエンドサービスの問題を発見</h2><p><a href=#R-image-58513f9cc35a8db7160b9ea798d83392 class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/RUM-JS-Error.png alt=RUM-JS class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-58513f9cc35a8db7160b9ea798d83392><img src=../ja/rum/9-apm-correlation/../images/RUM-JS-Error.png alt=RUM-JS class="lightbox-image noborder lightbox noshadow" loading=lazy></a> をクリックして、Spanビューを閉じます。
次に下にスクロールし、 <strong>POST /cart/checkout</strong> の行を見つけます。</p><p><a href=#R-image-768e62d152d6918170d990edb4c48b6c class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/RUM-APM-Click.png alt=RUM-APM-Click class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-768e62d152d6918170d990edb4c48b6c><img src=../ja/rum/9-apm-correlation/../images/RUM-APM-Click.png alt=RUM-APM-Click class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>青色の <a href=#R-image-77c9593a77507c001ef4242c01978256 class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/RUM-APM.png alt=RUM-APM-BLUE class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-77c9593a77507c001ef4242c01978256><img src=../ja/rum/9-apm-correlation/../images/RUM-APM.png alt=RUM-APM-BLUE class="lightbox-image noborder lightbox noshadow" loading=lazy></a> リンクをクリックすると、エンドユーザが行ったチェックアウト操作の一部であるバックエンドサービスに関する情報を示すダイアログがポップアップ表示されます。</p><p><a href=#R-image-ba58f8b49bcfcbe63df1edaa1401f756 class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/RUM-Trace.png alt=RUM-APM-Trace class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ba58f8b49bcfcbe63df1edaa1401f756><img src=../ja/rum/9-apm-correlation/../images/RUM-Trace.png alt=RUM-APM-Trace class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>このポップアップでは複数のセクションが用意されており、バックエンドサービスの挙動を素早く把握することができます。例えば、Performance Summaryセクションでは、バックエンドの呼び出し中にどこに時間が費やされたかを知ることができます。</p><p><a href=#R-image-8bb364c9877cc33bdd10bee12feb9347 class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/RUM-Trace-Performance.png alt=RUM-APM-Trace-perf class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8bb364c9877cc33bdd10bee12feb9347><img src=../ja/rum/9-apm-correlation/../images/RUM-Trace-Performance.png alt=RUM-APM-Trace-perf class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>上記の例では77.9%以上が外部サービスに費やされていることがわかります。</p><p>ダイアログの一番下までスクロールすると、下図のような「トレースとサービス」セクションが表示されます。</p><p><a href=#R-image-5d64b6d84025db086f0c2ab8492c6ec5 class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/RUM-Trace-Services.png alt=RUM-APM-Trace-services class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d64b6d84025db086f0c2ab8492c6ec5><img src=../ja/rum/9-apm-correlation/../images/RUM-Trace-Services.png alt=RUM-APM-Trace-services class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Checkout</strong> サービスと <strong>Payment</strong> サービスが、両方とも濃い赤色で表示されています。薄い赤はエラーを受け取ったことを意味し、濃い赤はそのサービスから発生したエラーを意味します。</p><p><a href=#R-image-ad80c89d7770d4fb19f0df46851c78b0 class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/RUM-Trace-Services-Detail.png alt=RUM-APM-Trace-services-detail class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ad80c89d7770d4fb19f0df46851c78b0><img src=../ja/rum/9-apm-correlation/../images/RUM-Trace-Services-Detail.png alt=RUM-APM-Trace-services-detail class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>つまり、すでにバックエンドのサービスに問題があることは明白なのです。</p><p>調査してみましょう！</p><h2 id=2--backendサービスまでのトレースをたどる>2. Backendサービスまでのトレースをたどる</h2><p>Trace Idリンクをクリックすることができます。</p><p><a href=#R-image-a2ac60efa9f1ace56f0df9dcacd0504a class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/RUM-Trace-url.png alt=RUM-APM-Trace-link class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a2ac60efa9f1ace56f0df9dcacd0504a><img src=../ja/rum/9-apm-correlation/../images/RUM-Trace-url.png alt=RUM-APM-Trace-link class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これにより、バックエンドサービスへの呼び出しで何が起こったかを詳細に示すウォーターフォールAPMビューが表示されます。
右側には、Trace IDと、前に見たように、Performance Summuryが表示されています。
ウォーターフォールでは、フロントエンドからの呼び出しの一部である様々なバックエンドサービスを特定することができます。</p><p>ご覧のように、 <strong>Checkout</strong> サービスと <strong>Payment</strong> サービスの前に赤いエラーインジケータ <a href=#R-image-847aa4af548f016c709f4724c0cf5b61 class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/APM_Error_Flag.png alt=RUM-APM-error-flag class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-847aa4af548f016c709f4724c0cf5b61><img src=../ja/rum/9-apm-correlation/../images/APM_Error_Flag.png alt=RUM-APM-error-flag class="lightbox-image noborder lightbox noshadow" loading=lazy></a> が見えます。</p><p><a href=#R-image-bb02cbc2a5dd1d57736095316fb71da8 class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/RUM-APM-Waterfall.png alt=RUM-APM-waterfall class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bb02cbc2a5dd1d57736095316fb71da8><img src=../ja/rum/9-apm-correlation/../images/RUM-APM-Waterfall.png alt=RUM-APM-waterfall class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>paymentservice: grpc.hipstershop.PaymentService/Charge</strong> の行の後にある <a href=#R-image-30742c93fbf4a633a801535ed1b650c2 class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/APM_Error_Flag.png alt=RUM-APM-error-flag class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-30742c93fbf4a633a801535ed1b650c2><img src=../ja/rum/9-apm-correlation/../images/APM_Error_Flag.png alt=RUM-APM-error-flag class="lightbox-image noborder lightbox noshadow" loading=lazy></a> をクリックしてください。</p><p><a href=#R-image-805c52c14af9db52038d8fd01b1a571d class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/payment-click.png alt=RUM-payment-click class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-805c52c14af9db52038d8fd01b1a571d><img src=../ja/rum/9-apm-correlation/../images/payment-click.png alt=RUM-payment-click class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Spanの詳細ページが表示され、このサービスコールの詳細情報が表示されます。
<strong>401</strong> エラーコード、つまり <em>Invalid Request</em> が返されたことが確認できます。</p><h2 id=3--関連するログを確認>3. 関連するログを確認</h2><p>Splunk Observability Cloudは、トレースメトリクスとログを自動的に関連付けるため、ページ下部の関連コンテンツバーに、このトレースに対応するログが表示されます。</p><p><a href=#R-image-a65bf4888e5d63cbd65237cddd366355 class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/log-corelation.png alt=RUM-payment-related-content class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a65bf4888e5d63cbd65237cddd366355><img src=../ja/rum/9-apm-correlation/../images/log-corelation.png alt=RUM-payment-related-content class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Logのリンクをクリックすると、ログが表示されます。</p><p>ログが表示されたら、ページの上部にあるフィルターにクリック元のTrace IDがセットされ、このトレースに関連するログが表示されていることに注意してください。
次にPaymentサービスのエラーを示す行の1つを選択すると右側にログメッセージが表示されます。</p><p>ここにPaymentサービスが失敗した理由が明確に示されています。サービスに対して無効なトークンを使用しているのです。</p><p>*<strong>Failed payment processing through ButtercupPayments: Invalid API Token (test-20e26e90-356b-432e-a2c6-956fc03f5609)</strong></p><p><a href=#R-image-ce91dacd434afe68738761cb295e5d55 class=lightbox-link><img src=../ja/rum/9-apm-correlation/../images/RUM-LogObserver.png alt=RUM-logs class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ce91dacd434afe68738761cb295e5d55><img src=../ja/rum/9-apm-correlation/../images/RUM-LogObserver.png alt=RUM-logs class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=4-まとめ>4. まとめ</h2><p>このワークショップではRUMをWebサイトに追加する方法を確認しました。
RUMメトリクスを使用してWebサイトのパフォーマンスを調査しました。
Tag Profileを使用して、自分のセッションを検索し、セッションウォーターフォールを使用して、2つの問題を特定しました。</p><ul><li>JavaScriptのエラーにより、価格の計算が 0 になっていました。</li><li>支払いバックエンドサービスに問題があり支払いに失敗することがありました。</li></ul><p>RUMのトレースとバックエンドAPMのトレースおよびログを関連付ける機能を使用して、支払い失敗の原因を発見しました。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=10-rumメトリクスに基づくカスタムチャートとアラート>10. RUMメトリクスに基づくカスタムチャートとアラート</h1><ul><li>RUMメトリクスを使用して、問題が発生した場合に警告するAlertsを設定する</li><li>RUMメトリクスに基づくカスタムチャートを作成する</li></ul><hr><p>SplunkのRUMは完全忠実なソリューションとして設計されているため、お客様のトレースを100％取得することができ、Webサイトの動作の変化を検知して警告することができます。また、カスタムチャートとダッシュボードを作成することで、Webサイトの挙動を正確に把握することができます。
これにより、ウェブサイト、バックエンド・サービス、基盤となるインフラストラクチャからのデータを組み合わせることができます。これにより、お客様のアプリケーションやソリューションを構成する完全なスタックを観察することができます。</p><p>RUMメトリクスのチャートまたはアラートの作成は、インフラストラクチャのメトリクスと同じ方法で行います。このセクションでは、簡単なチャート、ディテクター、およびアラートを作成します。</p><p>Splunk IM ワークショップを受講したことがある方は、このセクションをよくご存知でしょう。Splunk IM ワークショップの経験がない場合は、RUM ワークショップの終了後に <a href=../ja/imt/dashboards/index.html>ダッシュボード</a> と <a href=../ja/imt/detectors/index.html>ディテクター</a> モジュールを参照して、機能をよりよく理解することをお勧めします。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=11-モバイルアプリケーション-紹介>11. モバイルアプリケーション (紹介)</h1><ul><li>Mobile RUMの簡単な紹介</li><li>Application Summary ダッシュボードで、モバイルアプリケーションの<ul><li>パフォーマンスの概要を確認できます</li></ul></li></ul><hr><h2 id=1-rum-application-summary-ダッシュボードにアクセス>1. RUM Application Summary ダッシュボードにアクセス</h2><p>左側のメニューバーから <strong>RUM</strong> <a href=#R-image-3db115f4c26d51ff2cf5f3a99e2742e4 class=lightbox-link><img src=../ja/rum/11-mobile-app-summary/../images/RUM_ico.png alt=RUM-ico class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3db115f4c26d51ff2cf5f3a99e2742e4><img src=../ja/rum/11-mobile-app-summary/../images/RUM_ico.png alt=RUM-ico class="lightbox-image noborder lightbox noshadow" loading=lazy></a> を選択します。これで、RUM Application Summryページが表示されます。</p><p>このページの目的は、アプリケーションの健全性、パフォーマンス、潜在的なエラーを1つのペイン/ダッシュボードに表示し、Webサイトに対して実行されたユーザーセッションに関する情報を深く掘り下げることができるようにすることです。</p><p>アクティブな RUM アプリケーションごとにペインが表示されます。(以下のビューは、デフォルトの拡張ビューです。）</p><p><a href=#R-image-8c458534a0afd56113047c2b9f45ae20 class=lightbox-link><img src=../ja/rum/11-mobile-app-summary/../images/Applicationsummarydashboard.png alt=RUM-App-sum class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8c458534a0afd56113047c2b9f45ae20><img src=../ja/rum/11-mobile-app-summary/../images/Applicationsummarydashboard.png alt=RUM-App-sum class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>複数のアプリケーションを使用している場合、以下のようにペインが自動的に折りたたまれ、ペインビューが縮小されることがあります。</p><p><a href=#R-image-beb0d6b93be9cee75c1878d22d8cff33 class=lightbox-link><img src=../ja/rum/11-mobile-app-summary/../images/multiple_apps_collapsed.png alt=RUM-App-sum-collapsed class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-beb0d6b93be9cee75c1878d22d8cff33><img src=../ja/rum/11-mobile-app-summary/../images/multiple_apps_collapsed.png alt=RUM-App-sum-collapsed class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>アプリケーション名の前にある左側の赤い矢印で強調されている <a href=#R-image-eb98d9abf9328de1ca37d378b1dab90f class=lightbox-link><img src=../ja/rum/11-mobile-app-summary/../images/browser.png alt=RUM-browser class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eb98d9abf9328de1ca37d378b1dab90f><img src=../ja/rum/11-mobile-app-summary/../images/browser.png alt=RUM-browser class="lightbox-image noborder lightbox noshadow" loading=lazy></a> または <a href=#R-image-93ca57498638540ef8f69b8e3c749b90 class=lightbox-link><img src=../ja/rum/11-mobile-app-summary/../images/mobile.png alt=RUM-mobile class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-93ca57498638540ef8f69b8e3c749b90><img src=../ja/rum/11-mobile-app-summary/../images/mobile.png alt=RUM-mobile class="lightbox-image noborder lightbox noshadow" loading=lazy></a> アイコン(アプリケーションの種類が <em>モバイル</em> か <em>ブラウザー</em> かによる）をクリックすると、RUM Application Summryビューをフルダッシュボードに展開することが可能です。</p><h2 id=2-rum-mobileの概要>2. RUM Mobileの概要</h2><p>Splunk RUM は Apple iPhone と Android Phone 向けの Native Mobile RUM をサポートしています。スマートフォンのネイティブアプリのエンドユーザーエクスペリエンスを確認するために使用することができます。</p><p><a href=#R-image-05a1251f758810fcf28cad2ee84310f9 class=lightbox-link><img src=../ja/rum/11-mobile-app-summary/../images/RUM-Mobile.png alt=RUM-Header class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-05a1251f758810fcf28cad2ee84310f9><img src=../ja/rum/11-mobile-app-summary/../images/RUM-Mobile.png alt=RUM-Header class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>上の画面は、Splunk Mobile RUM が追跡できるさまざまなメトリクスやデータを表示するものです。例えば、以下のようなものです。</p><ul><li><strong>Custom events</strong> ：ブラウザーアプリケーションのものと同様です。</li><li><strong>App Errors</strong> ：1分あたりの <em>アプリエラー</em> と <em>クラッシュ</em> 。</li><li><strong>App Lifecycle Performance</strong> ：OSごとの <em>コールドスタートアップ時間</em> 、 <em>ホットスタートアップ時間</em> 。</li><li><strong>Request/Response</strong> ：ブラウザーアプリケーションのものと同様です。</li></ul><p>この時点では、スマートフォン上でネイティブアプリを実行するか、エミュレーションを実行する必要があるため、Mobile RUMについて深く掘り下げることはしません。必要に応じて、より詳細な情報をデモで提供することができます。</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=splunk-synthetics>Splunk Synthetics</h1><p><strong>Splunk Synthetic Monitoring</strong> は、完全なオブザーバビリティスイートである Splunk Observability Cloud の一部として、アップタイムと Webパフォーマンスの最適化のための最も包括的で詳細な機能を提供します。</p><p>API、サービスエンドポイント、エンドユーザーエクスペリエンスの監視を簡単に設定できます。Splunk Synthetic Monitoringを使用すれば、基本的な稼働時間やパフォーマンスの監視にとどまらず、問題の発見と修正、Web パフォーマンスの最適化、顧客が最高のユーザーエクスペリエンスを得られるようにすることに注力することができます。</p><p>Splunk Synthetic Monitoringによって得られるもの:</p><ul><li>重要なユーザーフロー、ビジネストランザクション、APIエンドポイントにおける問題を迅速に検出し解決</li><li>インテリジェンスなWeb最適化エンジンで、Webパフォーマンスの問題が顧客に影響を与えることを防止</li><li>すべてのページリソースとサードパーティの依存関係のパフォーマンスを向上</li></ul><footer class=footline></footer></article><section><h1 class=a11y-only>Splunk Syntheticsのサブセクション</h1><article class=default><header class=headline></header><h1 id=real-browser-checks>Real Browser Checks</h1><p>このラボでは <a href="https://chrome.google.com/webstore/detail/selenium-ide/mooikfkahbdckldjjndioackbalphokd?hl=en" target=_blank>Chrome Selenium IDE</a> エクステンションを使用したSplunkデモインスタンスに対する合成トランザクションと、Splunk Synthetic Monitoring Real Browser Check (RBC)を作成します。</p><h2 id=1-前提>1. 前提</h2><p><a href=https://monitoring.rigor.com target=_blank>https://monitoring.rigor.com</a> と <a href=https://optimization.rigor.com target=_blank>https://optimization.rigor.com</a> にログインできることを確認します。また、 <strong>O11y Workshop</strong> のようなアカウントにアサインされていることを確認します。</p><p>Splunk Synthetic Monitoring アカウントの個人情報を編集し、タイムゾーンとメール通知を編集します。Splunk Synthetic Monitoring はデフォルトで通知しますが、モニターの設定で通知をオフにすることができます。</p><p><a href=#R-image-6b776792b80ae1caa9d50daac84d73f8 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image5.png alt="Edit Personal Information" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6b776792b80ae1caa9d50daac84d73f8><img src=../ja/synthetics/real-browser-checks/../images/image5.png alt="Edit Personal Information" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href="https://chrome.google.com/webstore/detail/selenium-ide/mooikfkahbdckldjjndioackbalphokd?hl=en-US" target=_blank>Chrome Selenium IDE</a> エクステンションをあなたの <strong>Chrome</strong> ブラウザーに追加します。インストールした後、エクステンションをクリックすることで次の画面が表示されます。</p><p><a href=#R-image-e519bf2c5da8550b911f6605b0c7468f class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image17.png alt="Selenium IDE" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e519bf2c5da8550b911f6605b0c7468f><img src=../ja/synthetics/real-browser-checks/../images/image17.png alt="Selenium IDE" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-selenium-ide-の使用>2. Selenium IDE の使用</h2><p><a href=http://splunk.o11ystore.com target=_blank>http://splunk.o11ystore.com</a> にアクセスし、Selenium IDEを使いウェブトランザクションを記録する準備が整いました。</p><p><strong>Record a new test in a new project</strong> をクリックしプロジェクト名に <strong>[あなたのイニシャル] - O11y Store</strong> （例：RWC - O11y Store）と入力します。</p><p>!!! 質問 「Selenium IDEとは何ですか？」
- Selenium IDE は、オープンソースの Web 用の記録と再生のテスト自動化ツールです。
- SeleniumはWebアプリケーションをテストするためのポータブルなフレームワークです。
- Selenium はテストスクリプト言語 (Selenium IDE) を学ぶ必要なしに機能テストを作成するための再生ツールを提供します。
- C#、Groovy、Java、Perl、PHP、Python、Ruby、Scalaなどの多くの一般的なプログラミング言語でテストを記述するためのテストドメイン固有の言語（Selenese）を提供します。
- テストはほとんどの最新のWebブラウザで実行できます。
- Seleniumは、Windows、Linux、macOS上で動作します。
- Apache License 2.0の下で公開されているオープンソースソフトウェアです。</p><p><a href=#R-image-68cb1499584a0f1b6468fa17c53f7e48 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image29.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-68cb1499584a0f1b6468fa17c53f7e48><img src=../ja/synthetics/real-browser-checks/../images/image29.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Base URLに <code>http://splunk.o11ystore.com</code> と入力します。</p><p><a href=#R-image-2b3d5bebc3ee9fabccf05811a75dc406 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image11.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2b3d5bebc3ee9fabccf05811a75dc406><img src=../ja/synthetics/real-browser-checks/../images/image11.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Start Recording をクリックすると <a href=http://splunk.o11ystore.com target=_blank>splunk.o11ystore.com</a> が開かれた新しいウインドウが立ち上がります。 <strong>Vintage Camera Lens</strong> をクリックし、 <strong>Add To Cart</strong> をクリックし、次に <strong>Place Order</strong> をクリックします。</p><p>ウインドウを閉じ、Selenium IDEに戻りレコーディングを停止します。最後にテストケースに名前を付けます。 <strong>[あなたのイニシャル] - Checkout Flow (Desktop)</strong> （例：RWC - Checkout Flow (Desktop)）</p><p><a href=#R-image-f56a9c5f23407138ce0be96cc592ed25 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image10.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f56a9c5f23407138ce0be96cc592ed25><img src=../ja/synthetics/real-browser-checks/../images/image10.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>あなたのSelenium IDEプロジェクトは、このようになります。</p><p><a href=#R-image-1118c48c72524e54097b39c246e1e9e7 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image19.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1118c48c72524e54097b39c246e1e9e7><img src=../ja/synthetics/real-browser-checks/../images/image19.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>再生ボタンを押してレコーディングをテストし、レコーディングがトランザクションを正常に完了することを確認してください。</p><p><a href=#R-image-14ee173f0cbdccd4017653c00a2e62db class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image26.png alt=Run class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-14ee173f0cbdccd4017653c00a2e62db><img src=../ja/synthetics/real-browser-checks/../images/image26.png alt=Run class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Selenium IDE プロジェクトをダウンロードフォルダに <code>Workshop.side</code> という名前で保存します。</p><p><a href=#R-image-71d8b99aeec25edb56dc5b77a6d0ae89 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image30.png alt=Save class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-71d8b99aeec25edb56dc5b77a6d0ae89><img src=../ja/synthetics/real-browser-checks/../images/image30.png alt=Save class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-e0eb1642376157ae2dabd2a3b3801329 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/save-side-project.png alt="Save SIDE Project" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e0eb1642376157ae2dabd2a3b3801329><img src=../ja/synthetics/real-browser-checks/../images/save-side-project.png alt="Save SIDE Project" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-real-browser-check-の作成>3. Real Browser Check の作成</h2><p><a href=https://monitoring.rigor.com target=_blank>https://monitoring.rigor.com</a> からSplunk Synthetic Monitoringにログインします。 <strong>REAL BROWSER</strong> をクリックし、 <strong>+New</strong>{: .label-button .sfx-ui-button-blue} をクリックします。</p><p><a href=#R-image-6a524d639e6d22687ae7bf83268d89c6 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image3.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6a524d639e6d22687ae7bf83268d89c6><img src=../ja/synthetics/real-browser-checks/../images/image3.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>「<strong>From File</strong>」をクリックしレコーディングファイルを選択し、Importをクリックします。</p><p><a href=#R-image-55d54b0c8d285dfcbb13289f0395fda0 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image1.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-55d54b0c8d285dfcbb13289f0395fda0><img src=../ja/synthetics/real-browser-checks/../images/image1.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Frequency</strong> を <strong>5 Minutes</strong> にセットします。</p><p><a href=#R-image-16dbde1bcba0fa3da1493a29193caabe class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image15.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-16dbde1bcba0fa3da1493a29193caabe><img src=../ja/synthetics/real-browser-checks/../images/image15.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>各Stepをクリックし、次のように分かりやすい名前を付けてあげます。</p><p>Step 1: Click Camera</p><p>Step 2: Add to Cart</p><p>Step 3: Place Order</p><p><a href=#R-image-06bd70434b651bfa1bd12044e5b4e89d class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image6.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-06bd70434b651bfa1bd12044e5b4e89d><img src=../ja/synthetics/real-browser-checks/../images/image6.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>次に <strong>+ Add Step</strong> をクリックし、バリデーション用のステップを追加します。これはチェックアウトが成功したかどうかを確かめるものです。</p><p><strong>Name</strong> に <strong>Confirm Order</strong> と入力し、 <strong>Action</strong> を <strong>Wait for text present</strong> に変更し、 <strong>Value</strong> に <strong>Your order is complete!</strong> と入力します。ここまでで <strong>Start Url</strong> と4つのステップが作られました。</p><p><a href=#R-image-e12b956d70426be0217208aefacd44cc class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image2.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e12b956d70426be0217208aefacd44cc><img src=../ja/synthetics/real-browser-checks/../images/image2.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle default" style=--VARIABLE-BOX-color:info><div class=box-label>Tip</div><div class=box-content><p>Step作成時には非常に強力な <a href=https://help.rigor.com/hc/en-us/articles/360049442854-How-Do-I-Use-Business-Transactions target=_blank>Business Transaction</a> 機能の利用もご検討ください。<em>「Business Transactionとは、Real Browserスクリプト内の連続したステップをまとめたものです。これらのトランザクションは、フローの類似部分を論理的にグループ化し、ユーザーは複数のステップとページ（複数可）のパフォーマンスを1つのビジネストランザクションにまとめて表示できるようにします。"</em></p></div></div><p><strong>Advanced</strong> をクリックし、 <strong>Viewport Size</strong> が <strong>Default desktop: 1366 x 768</strong> であることを確認します。</p><p><a href=#R-image-5db5c42ae70704ac97f69f861f4a5b9a class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/viewport-size.png alt="Viewport Size" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5db5c42ae70704ac97f69f861f4a5b9a><img src=../ja/synthetics/real-browser-checks/../images/viewport-size.png alt="Viewport Size" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>「<strong>Test</strong>」をクリックしモニター設定をテストします。テストが正常に完了した後、Step 4の「<strong>AFTER</strong>」をクリックし、注文完了のスクリーンショットを取得できたことを確認してください。</p><p><a href=#R-image-e8c6d4f9d671bee813eb6c1ac4ece698 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image22.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e8c6d4f9d671bee813eb6c1ac4ece698><img src=../ja/synthetics/real-browser-checks/../images/image22.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Create</strong>{: .label-button .sfx-ui-button-blue} をクリックし、Real Browser Monitorを保存します。5から10分後にモニターが動作し、以下のようなチェック成功が表示されることを確認します。</p><p><a href=#R-image-9c90c2b0185e6740239ed1d037dc675e class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image27.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9c90c2b0185e6740239ed1d037dc675e><img src=../ja/synthetics/real-browser-checks/../images/image27.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle default" style=--VARIABLE-BOX-color:info><div class=box-label>Tip</div><div class=box-content><p><strong>Run Now</strong> を実行することでモニターを即座に実行できます。</p><p><a href=#R-image-78f3d9e0e3a534436f18c0e4227b78b0 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image8.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-78f3d9e0e3a534436f18c0e4227b78b0><img src=../ja/synthetics/real-browser-checks/../images/image8.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></div></div><p><strong>Segment by location</strong> をクリックし、見た目の変化を確認してください。クリックすることで各ロケーションのon/offが可能です。</p><p>!!! 問題です！
<strong>Response Time</strong> が一番低いロケーションはどこでしょうか？</p><p><a href=#R-image-b22713d223f83a314dca70df0743831e class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image9.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b22713d223f83a314dca70df0743831e><img src=../ja/synthetics/real-browser-checks/../images/image9.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>成功した円のうちどれかをクリックし、実行結果にドリルダウンします。</p><p><a href=#R-image-de7fc6ae9e94a8a69b46b325fd6ab271 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image33.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-de7fc6ae9e94a8a69b46b325fd6ab271><img src=../ja/synthetics/real-browser-checks/../images/image33.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>CONFIGURE METRICS/HIDE METRICS</strong> ドロップダウンで、取得しているメトリクスを確認してみてください。</p><p><a href=#R-image-ee00a3d532db7a40763487dd97add1a4 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image14.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ee00a3d532db7a40763487dd97add1a4><img src=../ja/synthetics/real-browser-checks/../images/image14.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ドロップダウンの <strong>Page 2</strong> をクリックし、 <strong>Filmstrip</strong> と <strong>Waterfall Chart</strong> までスクロールダウンして結果を確認してください。</p><p><a href=#R-image-97086f3a6a9a75e59eb449792b5c519c class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image16.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-97086f3a6a9a75e59eb449792b5c519c><img src=../ja/synthetics/real-browser-checks/../images/image16.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-1bf8d81f9caac92f971c0a5c0003a3a1 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/filmstrip.png alt=Filmstrip class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1bf8d81f9caac92f971c0a5c0003a3a1><img src=../ja/synthetics/real-browser-checks/../images/filmstrip.png alt=Filmstrip class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-5a97f21745835d80d0b5694c0d32487e class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/waterfall.png alt=Waterfall class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5a97f21745835d80d0b5694c0d32487e><img src=../ja/synthetics/real-browser-checks/../images/waterfall.png alt=Waterfall class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Click Here to Analyze with Optimization</strong> をクリックするとSplunk Synthetic Monitoring Optimizationへのログインができます。もし <strong>このオプションが表示されない場合</strong> 、この <a href="https://optimization.rigor.com/s/2373818/?sh=3AF8C48AADD6D3E5F5DAA8B4B7BB7F45" target=_blank>ページ</a> にアクセスしてください。</p><p><a href=#R-image-2d43b01dc252becef4cd21588967e332 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image31.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2d43b01dc252becef4cd21588967e332><img src=../ja/synthetics/real-browser-checks/../images/image31.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>「<strong>Best Practices Score</strong>」タブをクリックします。スクロールダウンし、結果を確認します。</p><p><a href=#R-image-e29878a3bc8ac74902d686014148910d class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image23.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e29878a3bc8ac74902d686014148910d><img src=../ja/synthetics/real-browser-checks/../images/image23.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-83b16a7019a86e027333b1b2eedeef94 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/best-practices.png alt="Best Practices" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-83b16a7019a86e027333b1b2eedeef94><img src=../ja/synthetics/real-browser-checks/../images/best-practices.png alt="Best Practices" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>時間をとって、結果をレビューしてみてください。他の項目もクリックしてみてください。</p><h2 id=4-mobile-check-の作成>4. Mobile Check の作成</h2><p>作成したRBC (Real Browser Check）をコピーします。</p><p><a href=#R-image-a15a15dc7511c574c1ed60936065aee2 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/copy-check.png alt="Copy Check" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a15a15dc7511c574c1ed60936065aee2><img src=../ja/synthetics/real-browser-checks/../images/copy-check.png alt="Copy Check" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>名前を <strong>RWC - Checkout Flow (Tablet)</strong> のように変更します。</p><p><a href=#R-image-765076419bedac65ab7531dc20148848 class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/rename-check.png alt="Copy Check" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-765076419bedac65ab7531dc20148848><img src=../ja/synthetics/real-browser-checks/../images/rename-check.png alt="Copy Check" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Advanced</strong> タブ配下で以下の3つの設定を変更し、新しいモバイル用のRBCを作成します。</p><p><a href=#R-image-ed8a3b7b7205331295a69f95b36f224c class=lightbox-link><img src=../ja/synthetics/real-browser-checks/../images/image18.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ed8a3b7b7205331295a69f95b36f224c><img src=../ja/synthetics/real-browser-checks/../images/image18.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>新しいモニター設定をテスト＆確認します。</p><div class="box notices cstyle default" style=--VARIABLE-BOX-color:info><div class=box-label>Tip</div><div class=box-content><p>Step作成時には非常に強力な <a href=https://help.rigor.com/hc/en-us/articles/360049442854-How-Do-I-Use-Business-Transactions target=_blank>Business Transaction</a> 機能の利用もご検討ください。<em>「Business Transactionとは、Real Browserスクリプト内の連続したステップをまとめたものです。これらのトランザクションは、フローの類似部分を論理的にグループ化し、ユーザーは複数のステップとページ（複数可）のパフォーマンスを1つのビジネストランザクションにまとめて表示できるようにします。"</em></p></div></div><h2 id=5-リソース>5. リソース</h2><ul><li><p><a href="https://help.rigor.com/hc/en-us/articles/115004652007?flash_digest=b1ef7d1a07b68d5279ee5fef8adb87fb878cf010" target=_blank>Getting Started With Selenium IDE</a></p></li><li><p><a href=http://www2.rigor.com/scripting-guide target=_blank>Splunk Synthetic Monitoring Scripting Guide</a></p></li><li><p><a href=https://help.rigor.com/hc/en-us/articles/115004443988-How-Can-I-Fix-A-Broken-Script target=_blank>How Can I Fix A Broken Script?</a></p></li><li><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction target=_blank>Introduction to the DOM</a> (Document Object Model (DOM)</p></li><li><p><a href=https://www.selenium.dev/selenium-ide/ target=_blank>Selenium IDE</a></p></li></ul><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=api-checks>API Checks</h1><p>API Checkは、APIエンドポイントの機能およびパフォーマンスをチェックする柔軟な方法を提供します。APIファーストの開発へのシフトにより、フロントエンドのコア機能を提供するバックエンドサービスを監視する必要性が高まっています。複数ステップのAPIインタラクションのテストに興味がある場合でも、エンドポイントのパフォーマンスを可視化したい場合でも、API Checkは目標の達成に役立ちます。</p><h2 id=1-グローバル変数の作成>1. グローバル変数の作成</h2><p>API Checkを行うために使用するグローバル変数を表示します。 <strong>Admin Tools</strong> の下にある <strong>Global Variables</strong> をクリックします。 spotifyのAPIトランザクションを行うために使用するグローバル変数を確認してください。</p><p><a href=#R-image-386c42fd8ce6f4c59f15432a383cb082 class=lightbox-link><img src=../ja/synthetics/api-checks/../images/global-variable.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-386c42fd8ce6f4c59f15432a383cb082><img src=../ja/synthetics/api-checks/../images/global-variable.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-api-check-の作成>2. API Check の作成</h2><p>新しい API Check を作成し、<code>&lt;あなたのイニシャル></code> の後に Splunk REST API Check をつけた名前にします （例: <strong>AP - Spotify API</strong>）</p><p><a href=#R-image-5d94a219ea6246930fa122f45748d5c9 class=lightbox-link><img src=../ja/synthetics/api-checks/../images/new-api-check.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d94a219ea6246930fa122f45748d5c9><img src=../ja/synthetics/api-checks/../images/new-api-check.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>チェックに名前を付けたら、notificationタブを開いて、どのような設定があるか眺めてみましょう。</p><p>次に、以下のAPI Check Stepsを追加します。</p><p><a href=#R-image-87965991d721f5d0d86d7d3ef51d25e4 class=lightbox-link><img src=../ja/synthetics/api-checks/../images/api-check-steps.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-87965991d721f5d0d86d7d3ef51d25e4><img src=../ja/synthetics/api-checks/../images/api-check-steps.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>変数はこちらから選ぶことができます:</p><p><a href=#R-image-583fba6b72830504316f82792e3b7436 class=lightbox-link><img src=../ja/synthetics/api-checks/../images/available-variables.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-583fba6b72830504316f82792e3b7436><img src=../ja/synthetics/api-checks/../images/available-variables.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong><a href=https://help.rigor.com/hc/en-us/articles/115004583747-API-Check-Request-Step target=_blank>Request Step</a></strong></p><ul><li>リクエストステップは、あるエンドポイントにHTTPリクエストを行い、そのレスポンスからデータを取得します。他のチェックタイプとは異なり、APIチェックでは、チェックを開始するための初期URLは必要ありません。すべてのHTTPリクエストは、リクエストステップ内で設定されます。</li></ul><p><strong><a href=https://help.rigor.com/hc/en-us/articles/115004582607-API-Check-Extract-Step target=_blank>Extract Step</a></strong></p><ul><li><p>Extractステップでは、JSON、XML、HTML形式のデータからデータを抽出します。</p></li><li><p>JSONからデータを抽出するには、次の3つを用意します:</p></li><li><p>JSONを含むソース</p></li><li><p>データを抽出するためのJSONPath式</p></li><li><p>保存先のカスタム変数名</p></li><li><p>ソースはどのようなJSONでもかまいませんが、たいていはレスポンスのBodyから取得するでしょう。レスポンスヘッダから取得することもできますし、また、カスタムの値も可能です。ソースは、整形されたJSONでなければなりません。</p></li></ul><p><strong><a href=https://help.rigor.com/hc/en-us/articles/115004743868-API-Check-Save-Step target=_blank>Save Step</a></strong></p><ul><li><p>Saveステップでは、チェックの後で再利用するためのデータを保存します。データを保存するには、ソースと保存先のカスタム変数名を指定します。ソースは、応答ヘッダを含むプリセットから選択するか、カスタム値を指定します。</p></li><li><p>その他の使用例としては、他のステップで簡単に再利用できるように情報を追加したり、リクエストの結果を保存して別のリクエストで再利用できるようにするなどがあります。</p></li><li><p>リクエスト変数は、リクエストが作成された後にのみ使用可能であることを覚えておくことが重要です。もし、リクエストから値を保存しようとしても、まだリクエストを行っていない場合は、空の文字列が保存されます。</p></li></ul><p><strong><a href=https://help.rigor.com/hc/en-us/articles/115004742408-API-Check-Assert-Step target=_blank>Assert Step</a></strong></p><ul><li>Assertステップは、2つの値に対してアサーションを行います。アサーションを行うには、2つのパラメータと、その2つの比較方法を指定します。</li></ul><p><strong><a href=https://help.rigor.com/hc/en-us/articles/115004742408-API-Check-Assert-Step target=_blank>Comparisons</a></strong></p><ul><li><p>現在、<strong>string（文字列）</strong>、 <strong>numeric（数値）</strong>、<strong>regular expression（正規表現）</strong> の3種類の比較をサポートしています。</p></li><li><p><strong>string</strong> と <strong>numeric</strong> では、値が比較タイプに強制されます。</p></li><li><p><strong>reqular expression</strong> での比較の場合、最初のパラメータは文字列で、2番目のパラメータは正規表現になります。</p></li></ul><p>API Check に Splunk と API のタグを付けて SAVE します。</p><p><a href=#R-image-7fbf1cda78061a7f2265c68dcb372b83 class=lightbox-link><img src=../ja/synthetics/api-checks/../images/tags.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7fbf1cda78061a7f2265c68dcb372b83><img src=../ja/synthetics/api-checks/../images/tags.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-rest-api-checkのテスト>3. REST API Checkのテスト</h2><p>edit configuration に戻り、ページの下にある &rsquo;test&rsquo; を押して、エラーがないことを確認します。</p><p><a href=#R-image-2fa707992e4aee0f7c6f581abff64eee class=lightbox-link><img src=../ja/synthetics/api-checks/../images/test-api-check.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2fa707992e4aee0f7c6f581abff64eee><img src=../ja/synthetics/api-checks/../images/test-api-check.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ウィンドウを上にスライドさせると、正常に実行された場合の詳細が表示されます</p><p><a href=#R-image-b7f65705713bae3be4523f1929066da9 class=lightbox-link><img src=../ja/synthetics/api-checks/../images/successful-run.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b7f65705713bae3be4523f1929066da9><img src=../ja/synthetics/api-checks/../images/successful-run.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-534cc90208b7f3320865f2667b0f37d9 class=lightbox-link><img src=../ja/synthetics/api-checks/../images/request-step.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-534cc90208b7f3320865f2667b0f37d9><img src=../ja/synthetics/api-checks/../images/request-step.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>さて、モニターにもう少し機能を追加してみましょう。詳細ウィンドウを下にスライドさせ、手順5～8を追加します。</p><p><strong>BONUS</strong>：ステップ6を使用して、以下のレスポンスがタイムリーに戻ってきたことをアサートします（1000 ms)</p><p><a href=#R-image-8fea88404162dec15b0cf02c0a50d89f class=lightbox-link><img src=../ja/synthetics/api-checks/../images/additional-steps.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8fea88404162dec15b0cf02c0a50d89f><img src=../ja/synthetics/api-checks/../images/additional-steps.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ステップを追加したら、モニターをテストして保存します。</p><h2 id=4-リソース>4. リソース</h2><ul><li><p><a href=https://help.rigor.com/hc/en-us/articles/115004817308-How-to-Create-an-API-Check target=_blank>How to Create an API Check</a></p></li><li><p><a href=https://help.rigor.com/hc/en-us/articles/115004952508-API-Check-Overview target=_blank>API Check Overview</a></p></li><li><p><a href=https://help.rigor.com/hc/en-us/articles/360049442854-How-Do-I-Use-Business-Transactions target=_blank>How Do I Use Business Transactions?</a></p></li></ul><footer class=footline></footer></article></section><article class=home><header class=headline></header><h1 id=ninja-workshops>Ninja Workshops</h1><div class="children children-h5 children-sort-"><h5><a href=../ja/other/pet-clinic/index.html>Pet Clinic Java ワークショップ</a></h5><p>JavaアプリケーションをつかったSplunk Oservabilityのワークショップです</p><h5><a href=../ja/other/opentelemetry-collector/index.html>OpenTelemetryでクラウドネイティブ環境のオブザーバビリティを実現する</a></h5><p>OpenTelemetry Collectorのコンセプトを学び、Splunk Observability Cloudにデータを送信する方法を理解しましょう。</p></div><footer class=footline></footer></article><section><h1 class=a11y-only>Ninja Workshopsのサブセクション</h1><article class=default><header class=headline></header><h1 id=pet-clinic-java-ワークショップ>Pet Clinic Java ワークショップ</h1><p>このワークショップでは、Splunk Observabilityプラットフォームの以下のコンポーネントを構成するための、基本的なステップを体験できます：</p><ul><li>Splunk Infrastructure Monitoring (IM)</li><li>Splunk APM<ul><li>Endpoint Performance</li><li>Database Query Performance</li><li>AlwaysOn Profiling</li></ul></li><li>Splunk Real User Monitoring (RUM)</li><li>Splunk LogObserver</li></ul><p>ワークショップの中では、Javaのサンプルアプリケーション（Spring Pet Clinic）をクローン（ダウンロード）し、アプリケーションのコンパイル、パッケージ、実行していきます。</p><p>アプリケーションを起動すると、OpenTelemetry Javaエージェントを通じて、Splunk APMでメトリクスとトレースが即座に表示されるようになります。</p><p>その後、Splunk OpenTelemetry Javascript Libraries (RUM)を使用して、Pet Clinicのエンドユーザーインターフェース（アプリケーションによってレンダリングされるHTMLページ）を計装し、エンドユーザーが実行する個々のクリックとページロードのすべてについて、RUMトレースを生成していきます。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> 前提条件</div><div class=box-content><p>このワークショップは、ホスト/インスタンスが提供されるSplunk実行ワークショップ <strong>または</strong> 自前のホスト/<a href=https://github.com/splunk/observability-workshop/tree/main/multipass target=_blank>Multipassインスタンス</a> で行う、自己主導型のワークショップです。</p><p>ご自身のシステムには、以下のものがインストールされ、有効になっている必要があります：</p><ol><li>JDK 17</li><li>ポート <code>8083</code> が開いていること（インバウンド/アウトバウンド）</li></ol></div></div><p><a href=#R-image-f9f3acf765f1610288b2340de8b9e5bb class=lightbox-link><img src=../ja/other/pet-clinic/images/petclinic-exercise.png alt="PetClinic Exercise" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f9f3acf765f1610288b2340de8b9e5bb><img src=../ja/other/pet-clinic/images/petclinic-exercise.png alt="PetClinic Exercise" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Pet Clinic Java ワークショップのサブセクション</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collectorをインストールする>OpenTelemetry Collectorをインストールする</h1><h2 id=1-はじめに>1. はじめに</h2><p>OpenTelemetry Collectorは、インフラストラクチャーとアプリケーションを計装するためのコアコンポーネントです。 その役割は収集と送信です：</p><ul><li>インフラストラクチャーのメトリクス（ディスク、CPU、メモリなど）</li><li>アプリケーションパフォーマンスモニタリング（APM）のトレース情報</li><li>プロファイリングに関するデータ</li><li>ホストおよびアプリケーションのログ</li></ul><p>Splunk Observability Cloudでは、インフラストラクチャーとアプリケーションの両方で Collector のセットアップを案内するウィザードを提供しています。デフォルトでは、ウィザードはコレクターのインストールのみを行うコマンドのみを提供します。</p><h2 id=2-環境変数を設定する>2. 環境変数を設定する</h2><p>すでに <strong>Splunk IM</strong> ワークショップを終了している場合は、既存の環境変数を利用することができます。そうでない場合は、<code>ACCESS_TOKEN</code>と<code>REALM</code>の環境変数を設定して、OpenTelemetry Collectorのインストールコマンドを実行していきます。</p><p>例えば、Realmが <code>us1</code> の場合、<code>export REALM=us1</code> と入力し、<code>eu0</code> の場合は <code>export REALM=eu0</code> と入力します。</p><div class=tab-panel data-tab-group=b7fd7bad1ab1315c2d62a216ff14e0a6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=access-tokenを環境変数に設定する class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("b7fd7bad1ab1315c2d62a216ff14e0a6","access-tokenを環境変数に設定する")'>
<span class=tab-nav-text>ACCESS TOKENを環境変数に設定する</span></button></div><div class=tab-content-container><div data-tab-item=access-tokenを環境変数に設定する class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span><span class=s2>&#34;&lt;replace_with_O11y-Workshop-ACCESS_TOKEN&gt;&#34;</span></span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=512d9834c35cc20cc139e2588a28571e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=realmを環境変数に設定する class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("512d9834c35cc20cc139e2588a28571e","realmを環境変数に設定する")'>
<span class=tab-nav-text>REALMを環境変数に設定する</span></button></div><div class=tab-content-container><div data-tab-item=realmを環境変数に設定する class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span><span class=s2>&#34;&lt;replace_with_REALM&gt;&#34;</span></span></span></code></pre></div></div></div></div></div><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> 既存のOpenTelemetryコレクターをすべて削除する</div><div class=box-content><p>同じVMインスタンスにSplunk IM ワークショップのセットアップをしている場合、Otel Collectorをインストールする前に Kubernetes で実行中の Collector を削除していることを確認してください。これは、以下のコマンドを実行することで行うことができます：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></div><h2 id=3-opentelemetry-collectorをインストールする>3. OpenTelemetry Collectorをインストールする</h2><p>次に、Collectorをインストールします。インストールスクリプトに渡される追加のパラメータは <code>--deployment-environment</code> です。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -sSL https://dl.signalfx.com/splunk-otel-collector.sh &gt; /tmp/splunk-otel-collector.sh <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>sudo sh /tmp/splunk-otel-collector.sh --deployment-environment <span class=k>$(</span>hostname<span class=k>)</span>-petclinic --realm <span class=nv>$REALM</span> -- <span class=nv>$ACCESS_TOKEN</span></span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> AWS/EC2インスタンスの場合</div><div class=box-content><p>。
AWS/EC2インスタンス上でこのワークショップを行う場合、インスタンスのホスト名を公開するためにコレクターにパッチを適用する必要があります：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo sed -i <span class=s1>&#39;s/gcp, ecs, ec2, azure, system/system, gcp, ecs, ec2, azure/g&#39;</span> /etc/otel/collector/agent_config.yaml</span></span></code></pre></div><p><code>agent_config.yaml</code> にパッチを適用したあと、Collector を再起動してください：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart splunk-otel-collector</span></span></code></pre></div></div></div><p>インストールが完了したら、Splunk Observabilityの <strong>Hosts with agent installed</strong> ダッシュボードに移動して、<strong>Dashboards → Hosts with agent installed</strong> からホストのデータを確認してみましょう。</p><p>ダッシュボードのフィルタを使用して <code>host.name</code>を選択し、仮想マシンのホスト名を入力または選択します。ホストのデータが表示されたら、APMコンポーネントを使用する準備が整いました。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-javaエージェントをインストールする>OpenTelemetry Javaエージェントをインストールする</h1><h2 id=1-spring-petclinic-アプリケーションを動かす>1. Spring PetClinic アプリケーションを動かす</h2><p>APMをセットアップするためにまず必要なのは&mldr;そう、アプリケーションです！この演習では、Spring PetClinicアプリケーションを使用します。これはSpringフレームワーク（Spring Boot）で作られた、非常に人気のあるサンプルJavaアプリケーションです。</p><p>まずはPetClinicリポジトリをクローンし、そして、アプリケーションをコンパイル、ビルド、パッケージ、テストしていきます。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/spring-projects/spring-petclinic</span></span></code></pre></div><p><code>spring-petclinic</code> ディレクトリに移動します:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> spring-petclinic</span></span></code></pre></div><p>PetClinic が使用する MySQL データベースを起動します:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run -d -e <span class=nv>MYSQL_USER</span><span class=o>=</span>petclinic -e <span class=nv>MYSQL_PASSWORD</span><span class=o>=</span>petclinic -e <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span>root -e <span class=nv>MYSQL_DATABASE</span><span class=o>=</span>petclinic -p 3306:3306 docker.io/mysql:5.7.8</span></span></code></pre></div><p>そして、Splunk版のOpenTelemetry Java APMエージェントをダウンロードしておきましょう。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -L https://github.com/signalfx/splunk-otel-java/releases/latest/download/splunk-otel-javaagent.jar <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-o splunk-otel-javaagent.jar</span></span></code></pre></div><p>次に、mavenコマンドを実行してPetClinicをコンパイル/ビルド/パッケージ化します:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> 情報</div><div class=box-content><p>実際にアプリをコンパイルする前に、mavenが多くの依存ライブラリをダウンロードするため、初回実行時には数分かかるでしょう。2回目以降の実行はもっと短くなります。</p></div></div><p>そして、以下のコマンドでアプリケーションを実行することができます:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java -javaagent:./splunk-otel-javaagent.jar <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=k>$(</span>hostname<span class=k>)</span>.service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span>deployment.environment<span class=o>=</span><span class=k>$(</span>hostname<span class=k>)</span>,version<span class=o>=</span>0.314 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.profiler.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.profiler.memory.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.metrics.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>アプリケーションが動作しているかどうかは、<code>http://&lt;VM_IP_ADDRESS>:8083</code> にアクセスして確認することができます。
次に、トラフィックを生成し、クリックしまくり、エラーを生成し、ペットを追加するなどしてください。</p><ul><li><code>-Dotel.service.name=$(hostname).service</code> では、アプリケーションの名前を定義しています。サービスマップ上のアプリケーションの名前等に反映されます。</li><li><code>-Dotel.resource.attributes=deployment.environment=$(hostname),version=0.314</code> では、Environmentと、versionを定義しています。<ul><li><code>deployment.environment=$(hostname)</code> は、Splunk APM UIの上部「Environment」に反映されます。</li><li><code>version=0.314</code> はここでは、アプリケーションのバージョンを示しています。トレースをドリルダウンしたり、サービスマップの Breakdown の機能で分析したり、Tag Spotlightを開くと <code>version</code> 毎のパフォーマンス分析が使えます。</li></ul></li><li><code>-Dsplunk.profiler.enabled=true</code> および <code>splunk.profiler.memory.enabled=true</code> では、CPUとメモリのプロファイリングを有効にしています。Splunk APM UIから、AlwaysOn Profilingを開いてみてください。</li><li><code>-Dsplunk.metrics.enabled=true</code> では、メモリやスレッドなどJVMメトリクスの送信を有効にしています。Dashboardsから、APM java servicesを開いてみてください。</li></ul><p>その後、Splunk APM UIにアクセスして、それぞれのテレメトリーデータを確認してみましょう！</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Troubleshooting MetricSetsを追加する</div><div class=box-content><p>サービスマップやTab Spotlightで、 <code>version</code> などのカスタム属性で分析できるようにするためには、Troubleshooting MetricSetsの設定をあらかじめ追加する必要があります。
左メニューの <strong>Settings → APM MetricSets</strong> で、設定を管理することができます。 もしお使いのアカウントで分析できなければ、設定を追加してみましょう。</p></div></div><p>次のセクションではカスタム計装を追加して、OpenTelemetryでは何ができるのか、さらに見ていきます。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=マニュアル計装>マニュアル計装</h1><h2 id=1-依存ライブラリを追加する>1. 依存ライブラリを追加する</h2><p>前のセクション足したような、プロセス全体に渡る属性は便利なのですが、ときにはさらに、リクエストの内容に応じた状況を知りたくなるかもしれません。
心配ありません、OpenTelemetryのAPIを通じてそれらを計装し、データを送り、Splunk Observabilityで分析できるようになります。</p><p>最初に、JavaアプリケーションがOpenTelemetryのAPIを使えるように、ライブラリの依存を追加していきます。
もちろん、vimなどのお好みのエディタをお使い頂いても大丈夫です！</p><p>アプリケーションが起動中であれば、一旦停止しましょう。ターミナルで <strong><code>Ctrl-c</code></strong> を押すと、停止することができます。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano pom.xml</span></span></code></pre></div><p>そして、<code>&lt;dependencies></code> セクションの中（33行目）に↓を追加してください。
ファイル修正後、 <strong><code>ctrl-O</code></strong> のあとに <strong><code>Enter</code></strong> で、ファイルを保存します。次に <strong><code>ctrl-X</code></strong> で、nanoを終了します。</p><div class="wrap-code highlight"><pre tabindex=0><code>    &lt;dependency&gt;
        &lt;groupId&gt;io.opentelemetry&lt;/groupId&gt;
        &lt;artifactId&gt;opentelemetry-api&lt;/artifactId&gt;
    &lt;/dependency&gt;</code></pre></div><p>念のため、コンパイルできるか確かめてみましょう:</p><div class="wrap-code highlight"><pre tabindex=0><code>./mvnw package -Dmaven.test.skip=true</code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Tips: nanoの使い方と壊れたファイルの直し方</div><div class=box-content><p>nanoはLinux環境でよく使われる、シンプルなエディタの一つです。</p><ul><li><code>Alt-U</code> で、アンドゥができます。Macの場合は <code>Esc</code> キーを押したあとに <code>U</code> を押してください！</li><li><code>ctrl-_</code> のあとに数字を入力すると、指定した行数にジャンプします。</li><li><code>ctrl-O</code> のあとに <code>Enter</code> で、ファイルを保存します。</li><li><code>ctrl-X</code> で、nanoを終了します。</li></ul><p>もしファイルをどうしようもなく壊してしまって元に戻したい場合は、gitを使って次のようにするとよいでしょう。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git checkout pom.xml</span></span></code></pre></div></div></div><p>これで、JavaのアプリケーションでOpenTelemetryのAPIが使う準備ができました。</p><h2 id=2-javaのコードにマニュアル計装を追加する>2. Javaのコードにマニュアル計装を追加する</h2><p>では、アプリケーションコードをちょっと変更して、リクエストのコンテキストのデータをスパン属性に追加してみましょう。</p><p>ここでは Pet Clinic アプリケーションの中で <code>Find Owners</code> が使われたときに、どのような検索文字列が指定されたのかを調査できるようにしていきます。
検索条件によってパフォーマンスが劣化してしまうケース、よくありませんか？そんなときは <code>OwnerController</code> に計装を追加していきましょう！</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano src/main/java/org/springframework/samples/petclinic/owner/OwnerController.java</span></span></code></pre></div><p>このコードを <strong>変更するのは2箇所</strong> です。</p><p>まず、<code>import jakarta.validation.Valid;</code> の下、37行目付近に↓を足します:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span> <span class=nn>io.opentelemetry.api.trace.Span</span><span class=o>;</span></span></span></code></pre></div><p>次に、 <code>// find owners by last name</code> のコメントがある箇所（おそらく95行目付近にあります）の下に、次のコードを足していきましょう:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>                <span class=n>Span</span> <span class=n>span</span> <span class=o>=</span> <span class=n>Span</span><span class=o>.</span><span class=na>current</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>span</span><span class=o>.</span><span class=na>setAttribute</span><span class=o>(</span><span class=s>&#34;lastName&#34;</span><span class=o>,</span> <span class=n>owner</span><span class=o>.</span><span class=na>getLastName</span><span class=o>());</span></span></span></code></pre></div><p>このコードで、Last Nameとして指定された検索条件が、スパン属性 <code>lastName</code> としてSplunk Observabilityに伝えるようになりました。</p><p>アプリケーションをコンパイルし直ししますが、Javaコードを多少汚してしまったかもしれません。 <code>spring-javaformat:apply</code> を指定しながらコンパイルしてみましょう。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw spring-javaformat:apply package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><p>アプリケーションを起動します。せっかくなので、バージョンを一つあげて <code>version=0.315</code> としましょう。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java -javaagent:./splunk-otel-javaagent.jar <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=k>$(</span>hostname<span class=k>)</span>.service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span>deployment.environment<span class=o>=</span><span class=k>$(</span>hostname<span class=k>)</span>,version<span class=o>=</span>0.315 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.profiler.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.profiler.memory.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.metrics.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p><code>http://&lt;VM_IP_ADDRESS>:8083</code> にアクセスして、オーナー検索をいくつか試してましょう。そしてSplunk APM UIからExploreを開き、アプリケーションのトレースを見ていきます。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> さらなる情報: マニュアル計装について</div><div class=box-content><p>マニュアル計装で何ができるか、他の言語でのやり方などは、OpenTelemetryの公式ウェブサイトにある <a href=https://opentelemetry.io/docs/instrumentation/ target=_blank>Instrumentation</a> ページをご覧ください。</p></div></div><p>検証が完了したら、ターミナルで <strong><code>Ctrl-c</code></strong> を押すと、アプリケーションを停止することができます。</p><p>次のセクションでは、RUMを使ってブラウザ上のパフォーマンスデータを収集してみましょう。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=real-user-monitoring>Real User Monitoring</h1><h2 id=1-rumを有効にする>1. RUMを有効にする</h2><p>Real User Monitoring (RUM)計装のために、Open Telemetry Javascript <a href=https://github.com/signalfx/splunk-otel-js-web target=_blank>https://github.com/signalfx/splunk-otel-js-web</a> スニペットをページ内に追加します。再度ウィザードを使用します <strong>Data Management → Add Integrationボタン → Monitor user experience（画面上部タブ） → Browser Instrumentation</strong>を開きます。</p><p>ドロップダウンから設定済みの <strong>RUM ACCESS TOKEN</strong> を選択し、<strong>Next</strong> をクリックします。以下の構文で <strong>App name</strong> と<strong>Environment</strong> を入力します：</p><p>次に、ワークショップのRUMトークンを選択し、 App nameとEnvironmentを定義します。ウィザードでは、ページ上部の <code>&lt;head></code> セクションに配置する必要のある HTML コードの断片が表示されます。この例では、次のように記述していますが、ウィザードでは先程入力した値が反映されてるはずです。</p><ul><li>Application Name: <code>&lt;hostname>-petclinic-service</code></li><li>Environment: <code>&lt;hostname>-petclinic-env</code></li></ul><p>ウィザードで編集済みコードスニペットをコピーするか、以下のスニペットをコピーして適宜編集してください。ただし：</p><ul><li><code>[hostname]-petclinic-service</code> - <code>[hostname]</code> をお使いのホスト名に書き換えてください</li><li><code>[hostname]-petclinic-env</code> - <code>[hostname]</code> をお使いのホスト名に書き換えてください</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>beaconUrl</span><span class=o>:</span> <span class=s2>&#34;https://rum-ingest.&lt;REALM&gt;.signalfx.com/v1/rum&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>rumAuth</span><span class=o>:</span> <span class=s2>&#34;&lt;RUM_ACCESS_TOKEN&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>app</span><span class=o>:</span> <span class=s2>&#34;&lt;hostname&gt;.service&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>environment</span><span class=o>:</span> <span class=s2>&#34;&lt;hostname&gt;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span></span></span></code></pre></div><p>Spring PetClinicアプリケーションでは、1つのHTMLページを「レイアウト」ページとして使用し、アプリケーションのすべてのページで再利用しています。これは、Splunk RUM計装ライブラリを挿入するのに最適な場所であり、すべてのページで自動的に読み込まれます。</p><p>では、レイアウトページを編集してみましょう：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano src/main/resources/templates/fragments/layout.html</span></span></code></pre></div><p>そして、上で生成したスニップをページの <code>&lt;head></code> セクションに挿入してみましょう。さて、アプリケーションを再構築して、再び実行する必要があります。</p><h2 id=2-petclinicを再ビルドする>2. PetClinicを再ビルドする</h2><p>mavenコマンドを実行して、PetClinicをコンパイル/ビルド/パッケージ化します：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><p>そして、アプリケーションを動かしてみましょう。バージョンを <code>version=0.316</code> とするのをお忘れなく。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java -javaagent:./splunk-otel-javaagent.jar <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=k>$(</span>hostname<span class=k>)</span>.service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span>deployment.environment<span class=o>=</span><span class=k>$(</span>hostname<span class=k>)</span>,version<span class=o>=</span>0.316 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.profiler.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.profiler.memory.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.metrics.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> versionを自動で設定する</div><div class=box-content><p>ここまできて <code>version</code> を毎回変えるためにコマンドラインを修正するのは大変だと思うことでしょう。実際、修正が漏れた人もいるかもしれません。
本番環境では、環境変数でアプリケーションバージョンを与えたり、コンテナイメージの作成時にビルドIDを与えたりすることになるはずです。</p></div></div><p>次に、より多くのトラフィックを生成するために、アプリケーションに再度アクセスしてみましょう。 <code>http://&lt;VM_IP_ADDRESS>:8083</code> にアクセスすると、今度はRUMトレースが報告されるはずです。</p><p>RUMにアクセスして、トレースとメトリクスのいくつかを見てみましょう。左のメニューから <strong>RUM</strong> を選ぶと、Spring Pet Clinicでのユーザー（あなたです！）が体験したパフォーマンスが表示されます。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=log-observer>Log Observer</h1><p>このセクションでは、Spring PetClinicアプリケーションをファイルシステムのファイルにログを書き込むように設定し、
Splunk OpenTelemetry Collectorがそのログファイルを読み取り（tail）、Splunk Observability Platformに情報を報告するように設定していきます。</p><h2 id=1-fluentdの設定>1. FluentDの設定</h2><p>Splunk OpenTelemetry Collectorを、Spring PetClinicのログファイルをtailし
Splunk Observability Cloudエンドポイントにデータを報告するように設定する必要があります。</p><p>Splunk OpenTelemetry Collectorは、FluentDを使用してログの取得/報告を行い、
Spring PetClinicのログを報告するための適切な設定を行うには、
デフォルトディレクトリ（<code>/etc/otel/collector/fluentd/conf.d/</code>）にFluentDの設定ファイルを追加するだけです。</p><p>以下は、サンプルのFluentD設定ファイル <code>petclinic.conf</code> を新たに作成し、</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/otel/collector/fluentd/conf.d/petclinic.conf</span></span></code></pre></div><p>ファイル <code>/tmp/spring-petclinic.log</code>を読み取るよう設定を記述します。</p><div class="wrap-code highlight"><pre tabindex=0><code>&lt;source&gt;
  @type tail
  @label @SPLUNK
  tag petclinic.app
  path /tmp/spring-petclinic.log
  pos_file /tmp/spring-petclinic.pos_file
  read_from_head false
  &lt;parse&gt;
    @type none
  &lt;/parse&gt;
&lt;/source&gt;</code></pre></div><p>このとき、ファイル <code>petclinic.conf</code> のアクセス権と所有権を変更する必要があります。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo chown td-agent:td-agent /etc/otel/collector/fluentd/conf.d/petclinic.conf
</span></span><span class=line><span class=cl>sudo chmod <span class=m>755</span> /etc/otel/collector/fluentd/conf.d/petclinic.conf</span></span></code></pre></div><p>ファイルが作成されたら、FluentDプロセスを再起動しましょう。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart td-agent</span></span></code></pre></div><h2 id=3-logbackの設定>3. Logbackの設定</h2><p>Spring Pet Clinicアプリケーションは、いくつかのJavaログライブラリを使用することができます。
このシナリオでは、logbackを使ってみましょう。</p><p>リソースフォルダに <code>logback.xml</code> という名前のファイルを作成して…</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano src/main/resources/logback.xml</span></span></code></pre></div><p>以下の設定を保存しましょう:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE xml&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;configuration</span> <span class=na>scan=</span><span class=s>&#34;true&#34;</span> <span class=na>scanPeriod=</span><span class=s>&#34;30 seconds&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;contextListener</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.classic.jul.LevelChangePropagator&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;resetJUL&gt;</span>true<span class=nt>&lt;/resetJUL&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/contextListener&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;logger</span> <span class=na>name=</span><span class=s>&#34;org.springframework.samples.petclinic&#34;</span> <span class=na>level=</span><span class=s>&#34;debug&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;appender</span> <span class=na>name=</span><span class=s>&#34;file&#34;</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;file&gt;</span>/tmp/spring-petclinic.log<span class=nt>&lt;/file&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;rollingPolicy</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;fileNamePattern&gt;</span>springLogFile.%d{yyyy-MM-dd}.log<span class=nt>&lt;/fileNamePattern&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;maxHistory&gt;</span>5<span class=nt>&lt;/maxHistory&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;totalSizeCap&gt;</span>1GB<span class=nt>&lt;/totalSizeCap&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/rollingPolicy&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;encoder&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;pattern&gt;</span>
</span></span><span class=line><span class=cl>      %d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg trace_id=%X{trace_id} span_id=%X{span_id} trace_flags=%X{trace_flags} service.name=%property{otel.resource.service.name}, deployment.environment=%property{otel.resource.deployment.environment} %n
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/pattern&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/encoder&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/appender&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;root</span> <span class=na>level=</span><span class=s>&#34;debug&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;appender-ref</span> <span class=na>ref=</span><span class=s>&#34;file&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/root&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/configuration&gt;</span></span></span></code></pre></div><p>その後、アプリケーションを再構築して再度実行していきます。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java -javaagent:./splunk-otel-javaagent.jar <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=k>$(</span>hostname<span class=k>)</span>.service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span>deployment.environment<span class=o>=</span><span class=k>$(</span>hostname<span class=k>)</span>,version<span class=o>=</span>0.317 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.profiler.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.profiler.memory.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.metrics.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>これまで通り、アプリケーション <code>http://&lt;VM_IP_ADDRESS>:8083</code> にアクセスしてトラフィックを生成すると、ログメッセージが報告されるようになります。</p><p>左側のLog Observerアイコンをクリックして、ホストとSpring PetClinicアプリケーションからのログメッセージのみを選択するためのフィルタを追加できます。</p><ol><li>Add Filter → Field → host.name → &lt;あなたのホスト名></li><li>Add Filter → Field → service.name → &lt;あなたのホスト名>.service</li></ol><h2 id=4-まとめ>4. まとめ</h2><p>これでワークショップは終了です。
これまでに、Splunk Observability Cloudにメトリクス、トレース、ログ、データベースクエリのパフォーマンス、コードプロファイリングが報告されるようになりました。
おめでとうございます！</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetryでクラウドネイティブ環境のオブザーバビリティを実現する>OpenTelemetryでクラウドネイティブ環境のオブザーバビリティを実現する</h1><h2 id=概要>概要</h2><p>OpenTelemetry を使い始める場合は、バックエンドに直接データを送ることから始めるかもしれません。最初のステップとしてはよいですが、OpenTelemetry Collector をオブザーバビリティのアーキテクチャとして使用するのは多くの利点があり、本番環境では Collector を使ったデプロイを推奨しています。</p><p>このワークショップでは、OpenTelemetry Collector を使用することに焦点を当て、Splunk Observability Cloud で使用するためのレシーバー、プロセッサー、エクスポーターを定義し、実際にテレメトリデータを送信するためのパイプラインを設定することで、環境に合わせて Collector を活用を学びます。また、分散プラットフォームのビジネスニーズに対応するための、カスタムコンポーネントを追加できるようになるまでの道のりを進むことになります。</p><h3 id=ninja-セクション>Ninja セクション</h3><p>ワークショップの途中には、展開できる <span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content>Ninja セクション</span></span> があります。これらはより実践的で、ワークショップ中、もしくは自分の時間を使って、さらに技術的な詳細に取り組むことができます。</p><p>OpenTelemetry プロジェクトは頻繁に開発されているため、Ninjaセクションの内容が古くなる可能性があることに注意してください。コンテンツが古い場合には更新のリクエストを出すこともできますので、必要なものを見つけた場合はお知らせください。</p><hr><div class=expand><input type=checkbox id=R-expand-de4561b3ef2022f8e6ec1b3e978489a5 aria-controls=R-expandcontent-de4561b3ef2022f8e6ec1b3e978489a5>
<label class=expand-label for=R-expand-de4561b3ef2022f8e6ec1b3e978489a5><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> をテストして！</span></span></label><div id=R-expandcontent-de4561b3ef2022f8e6ec1b3e978489a5 class=expand-content><p><strong>このワークショップを完了すると、正式に OpenTelemetry Collector ニンジャになります！</strong></p></div></div><hr><h2 id=対象者>対象者</h2><p>このワークショップは、OpenTelemetry Collector のアーキテクチャとデプロイメントについてさらに学びたいと考えている開発者やシステム管理者を対象としています。</p><h2 id=前提条件>前提条件</h2><ul><li>データ収集に関する基本的な理解</li><li>コマンドラインとvim/viの経験</li><li>Ubuntu 20.04 LTSまたは22.04 LTSが稼働するインスタンス/ホスト/VM<ul><li>最小要件はAWS/EC2 t2.micro（1 CPU、1GB RAM、8GBストレージ）</li></ul></li></ul><h2 id=学習目標>学習目標</h2><p>このセッションの終わりまでに、参加者は以下を行うことができるようになります：</p><ul><li>OpenTelemetry のコンポーネントを理解する</li><li>レシーバー、プロセッサー、エクスポーターを使用してデータを収集・分析する</li><li>OpenTelemetry を使用する利点を特定する</li><li>自分たちのビジネスニーズに対応するカスタムコンポーネントを構築する</li></ul><h2 id=opentelemetry-のアーキテクチャー>OpenTelemetry のアーキテクチャー</h2><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    subgraph Receivers
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline></footer></article><section><h1 class=a11y-only>OpenTelemetryでクラウドネイティブ環境のオブザーバビリティを実現するのサブセクション</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-contrib-をインストールする>OpenTelemetry Collector Contrib をインストールする</h1><h2 id=opentelemetry-collector-の-contrib-ディストリビューションをダウンロードする>OpenTelemetry Collector の Contrib ディストリビューションをダウンロードする</h2><p>OpenTelemetry Collector のインストールのために、まずはダウンロードするのが最初のステップです。このラボでは、 <code>wget</code> コマンドを使って OpenTelemetry の GitHub リポジトリから <code>.deb</code> パッケージをダウンロードしていきます。</p><p><a href=https://github.com/open-telemetry/opentelemetry-collector-releases/releases target=_blank>OpenTelemetry Collector Contrib releases page</a>
から、ご利用のプラットフォーム用の <code>.deb</code> パッケージを入手してください。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/v0.80.0/otelcol-contrib_0.80.0_linux_amd64.deb</span></span></code></pre></div><h2 id=opentelemetry-collector-の-contrib-ディストリビューションをインストールする>OpenTelemetry Collector の Contrib ディストリビューションをインストールする</h2><p><code>dpkg</code> を使って、 <code>.deb</code> パッケージをインストールします。下記の <strong>dpkg Output</strong> のようになれば、インストールは成功です！</p><div class=tab-panel data-tab-group=8764605216131ab051db0b2038710227><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=install class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8764605216131ab051db0b2038710227","install")'>
<span class=tab-nav-text>Install</span></button>
<button data-tab-item=dpkg-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("8764605216131ab051db0b2038710227","dpkg-output")'>
<span class=tab-nav-text>dpkg Output</span></button></div><div class=tab-content-container><div data-tab-item=install class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo dpkg -i otelcol-contrib_0.80.0_linux_amd64.deb</span></span></code></pre></div></div></div><div data-tab-item=dpkg-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Selecting previously unselected package otelcol-contrib.
</span></span><span class=line><span class=cl>(Reading database ... 64218 files and directories currently installed.)
</span></span><span class=line><span class=cl>Preparing to unpack otelcol-contrib_0.75.0_linux_amd64.deb ...
</span></span><span class=line><span class=cl>Unpacking otelcol-contrib (0.75.0) ...
</span></span><span class=line><span class=cl>Setting up otelcol-contrib (0.75.0) ...
</span></span><span class=line><span class=cl>Created symlink /etc/systemd/system/multi-user.target.wants/otelcol-contrib.service → /lib/systemd/system/otelcol-contrib.service.</span></span></code></pre></div></div></div></div></div><footer class=footline></footer></article><section><h1 class=a11y-only>OpenTelemetry Collector Contrib をインストールするのサブセクション</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-contribをインストールする>OpenTelemetry Collector Contribをインストールする</h1><h2 id=collector-が動作していることを確認する>Collector が動作していることを確認する</h2><p>これで、Collector が動いているはずです。root権限で <code>systemctl</code> コマンドを使って、それを確かめてみましょう。</p><div class=tab-panel data-tab-group=629328975c1ed2cb8e1b80a46e128150><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("629328975c1ed2cb8e1b80a46e128150","command")'>
<span class=tab-nav-text>Command</span></button>
<button data-tab-item=status-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("629328975c1ed2cb8e1b80a46e128150","status-output")'>
<span class=tab-nav-text>Status Output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl status otelcol-contrib</span></span></code></pre></div></div></div><div data-tab-item=status-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>● otelcol-contrib.service - OpenTelemetry Collector Contrib
</span></span><span class=line><span class=cl>     Loaded: loaded (/lib/systemd/system/otelcol-contrib.service; enabled; vendor preset: enabled)
</span></span><span class=line><span class=cl>     Active: active (running) since Tue 2023-05-16 08:23:23 UTC; 25s ago
</span></span><span class=line><span class=cl>   Main PID: 1415 (otelcol-contrib)
</span></span><span class=line><span class=cl>      Tasks: 5 (limit: 1141)
</span></span><span class=line><span class=cl>     Memory: 22.2M
</span></span><span class=line><span class=cl>        CPU: 125ms
</span></span><span class=line><span class=cl>     CGroup: /system.slice/otelcol-contrib.service
</span></span><span class=line><span class=cl>             └─1415 /usr/bin/otelcol-contrib --config=/etc/otelcol-contrib/config.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]: NumberDataPoints #0
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]: Data point attributes:
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]:      -&gt; exporter: Str(logging)
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]:      -&gt; service_instance_id: Str(df8a57f4-abdc-46b9-a847-acd62db1001f)
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]:      -&gt; service_name: Str(otelcol-contrib)
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]:      -&gt; service_version: Str(0.75.0)
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]: StartTimestamp: 2023-05-16 08:23:39.006 +0000 UTC
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]: Timestamp: 2023-05-16 08:23:39.006 +0000 UTC
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]: Value: 0.000000
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]:         {&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;metrics&#34;, &#34;name&#34;: &#34;logging&#34;}</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Tips: status 表示を中止するには</div><div class=box-content><p><code>systemctl status</code> コマンドの表示を中止するときは <code>q</code> キーを押してください。</p></div></div><p>サービスを停止するときは、 <code>stop</code> コマンドを使います。</p><div class=tab-panel data-tab-group=287c924ba339e61b5da8fe4818c3b2ce><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("287c924ba339e61b5da8fe4818c3b2ce","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl stop otelcol-contrib</span></span></code></pre></div></div></div></div></div><p>更新した設定ファイルを読み込ませるときは、 <code>restart</code> コマンドでサービスの再起動をしましょう。</p><div class=tab-panel data-tab-group=63e77a8fd0a616aa33b4307a446f29c1><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("63e77a8fd0a616aa33b4307a446f29c1","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart otelcol-contrib</span></span></code></pre></div></div></div></div></div><hr><div class=expand><input type=checkbox id=R-expand-56404917b269b8f903ad435b2ae8e9f3 aria-controls=R-expandcontent-56404917b269b8f903ad435b2ae8e9f3>
<label class=expand-label for=R-expand-56404917b269b8f903ad435b2ae8e9f3><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Open Telemetry Collector Builder (ocb) を使って、独自のコレクターを作る</span></span></label><div id=R-expandcontent-56404917b269b8f903ad435b2ae8e9f3 class=expand-content><p>このパートでは、お使いのシステムに以下のものがインストールされている必要があります：</p><ul><li><p>Go (latest version)</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /tmp
</span></span><span class=line><span class=cl>wget https://golang.org/dl/go1.20.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>sudo tar -C /usr/local -xzf go1.20.linux-amd64.tar.gz</span></span></code></pre></div><p><code>.profile</code> を編集して、次の環境変数をセットします:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOROOT</span><span class=o>=</span>/usr/local/go
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOPATH</span><span class=o>=</span><span class=nv>$HOME</span>/go
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$GOPATH</span>/bin:<span class=nv>$GOROOT</span>/bin:<span class=nv>$PATH</span></span></span></code></pre></div><p>そして、シェルのセッションを更新します:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>source</span> ~/.profile</span></span></code></pre></div><p>Go のバージョンを確認します:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go version</span></span></code></pre></div></li><li><p>ocb のインストール</p><ul><li><p>ocb バイナリーを <a href=https://github.com/open-telemetry/opentelemetry-collector/releases/tag/cmd%2Fbuilder%2Fv0.80.0 target=_blank>project releases</a>
からダウンロードして、次のコマンドを実行します:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mv ocb_0.80.0_darwin_arm64 /usr/bin/ocb
</span></span><span class=line><span class=cl>chmod <span class=m>755</span> /usr/bin/ocb</span></span></code></pre></div><p>別のアプローチとして、Go のツールチェーンを使ってバイナリをローカルにビルドする方法もあります:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go install go.opentelemetry.io/collector/cmd/builder@v0.80.0
</span></span><span class=line><span class=cl>mv <span class=k>$(</span>go env GOPATH<span class=k>)</span>/bin/builder /usr/bin/ocb</span></span></code></pre></div></li></ul></li><li><p>(Optional) Docker</p></li></ul><h2 id=なぜ独自のコレクターをビルドするの>なぜ独自のコレクターをビルドするの？</h2><p>コレクターのデフォルトのディストリビューション（core および contrib）は、含まれれるコンポーネントが少なすぎたり、もしくは多すぎたりします。</p><p>本番環境で contrib コレクターを実行することはできますが、インストールされているコンポーネントの量が多く、デプロイに必要ではないものも含まれるため、一般的には推奨されません。</p><h2 id=独自のコレクターをビルドする利点は>独自のコレクターをビルドする利点は？</h2><p>独自のコレクターバイナリー（通常は「ディストリビューション」と呼ばれる）を作成することで、必要なものだけをビルドすることができます。</p><p>メリットは次のとおりです:</p><ol><li>バイナリーのサイズが小さい</li><li>一般的な Go の脆弱性スキャナーを利用できる</li><li>組織独自のコンポーネントを組み込むことができる</li></ol><h2 id=カスタムコレクターをビルドするときの注意事項は>カスタムコレクターをビルドするときの注意事項は？</h2><p>さて、これは Ninja ゾーンの人たちにあえて言うことではないかもしれませんが:</p><ol><li>Go の開発経験を、必須ではないが、推奨される</li><li>Splunk の <strong>サポートがない</strong></li><li>ディストリビューションのライフサイクルを管理しなければならない</li></ol><p>プロジェクトは安定性に向けて進んでいますが、行われた変更がワークフローを壊す可能性があることに注意してください。Splunk チームは、より高い安定性とサポートを提供し、デプロイメントニーズに対応するためのキュレーションされた経験を提供しています。</p><h2 id=ninja-ゾーン>Ninja ゾーン</h2><p>必要なツールをすべてインストールしたら、以下のディレクトリ構造に従い、 <code>otelcol-builder.yaml</code> という新しいファイルを作成します:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>└── otelcol-builder.yaml</span></span></code></pre></div><p>ファイルを作成したら、インストールするコンポーネントのリストと追加のメタデータを追加する必要があります。</p><p>この例では、導入設定に必要なコンポーネントのみをインストールするためのビルダーマニフェストを作成します:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>dist</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otelcol-ninja</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>A custom build of the Open Telemetry Collector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>output_path</span><span class=p>:</span><span class=w> </span><span class=l>./dist</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/extension/ballastextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/extension/zpagesextension  v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/httpforwarder v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/healthcheckextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/loggingexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/exporter/splunkhecexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/exporter/signalfxexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/exporter/sapmexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/batchprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/memorylimiterprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/receiver/otlpreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/hostmetricsreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/jaegerreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/prometheusreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/zipkinreceiver v0.80.0</span></span></span></code></pre></div><p><em>ocb</em> のためのyamlファイルを作成して更新したら、 次のコマンドを実行します:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ocb --config<span class=o>=</span>otelcol-builder.yaml</span></span></code></pre></div><p>すると、次のようなディレクトリ構造が作成されます:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>├── dist
</span></span><span class=line><span class=cl>│   ├── components.go
</span></span><span class=line><span class=cl>│   ├── components_test.go
</span></span><span class=line><span class=cl>│   ├── go.mod
</span></span><span class=line><span class=cl>│   ├── go.sum
</span></span><span class=line><span class=cl>│   ├── main.go
</span></span><span class=line><span class=cl>│   ├── main_others.go
</span></span><span class=line><span class=cl>│   ├── main_windows.go
</span></span><span class=line><span class=cl>│   └── otelcol-ninja
</span></span><span class=line><span class=cl>└── otelcol-builder.yaml</span></span></code></pre></div><p>最後に、 <code>./dist/otelcol-ninja</code> を実行すれば、独自ビルドのCollectorが動作することがわかります。このコマンドを実行する前に、 <code>otelcol-contrib</code> サービスが停止していることを確認してください。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>./dist/otelcol-ninja --config<span class=o>=</span>file:/etc/otelcol-contrib/config.yaml</span></span></code></pre></div><p><strong>この設定ファイルで記述されているコンポーネントは、ビルドに含まれていないかもしれません。エラーの内容を含めて、何が起こるかを見てみましょう</strong> 。</p><h3 id=リファレンス>リファレンス</h3><ol><li><a href=https://opentelemetry.io/docs/collector/custom-collector/ target=_blank>https://opentelemetry.io/docs/collector/custom-collector/</a></li></ol></div></div><hr><h2 id=デフォルト設定>デフォルト設定</h2><p>OpenTelemetry Collector は YAML ファイルを使って設定をしていきます。これらのファイルには、必要に応じて変更できるデフォルト設定が含まれています。提供されているデフォルト設定を見てみましょう:</p><div class=tab-panel data-tab-group=7da83fec8e22ea65eaa630a61201839d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("7da83fec8e22ea65eaa630a61201839d","command")'>
<span class=tab-nav-text>Command</span></button>
<button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7da83fec8e22ea65eaa630a61201839d","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div><p>おめでとうございます！OpenTelemetry Collector のダウンロードとインストールに成功しました。あなたは OTel Ninja になる準備ができました。しかしまずは、設定ファイルと OpenTelemetry Collector の異なるディストリビューションについて見ていきましょう。</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> メモ</div><div class=box-content><p>Splunk は、自社で完全にサポートされた OpenTelemetry Collector のディストリビューションを提供しています。このディストリビューションは、<a href=https://github.com/signalfx/splunk-otel-collector target=_blank>Splunk GitHub Repository</a> からインストールするか、Splunk Observability Cloud のウィザードを使用して、簡単なインストールスクリプトを作成し、コピー＆ペーストすることで利用できます。このディストリビューションには、OpenTelemetry Collector Contrib ディストリビューションにはない追加機能や強化が含まれています。</p><ul><li>Splunk の OpenTelemetry Collector ディストリビューションは本番環境でテスト済みであり、多くの顧客が本番環境で使用しています。</li><li>このディストリビューションを使用する顧客は、公式の Splunk サポートから、SLA の範囲内で直接支援を受けることができます。</li><li>メトリクスとトレース収集のコア構成体験に将来的な破壊的変更がないことを心配せずに、Splunk の OpenTelemetry Collector ディストリビューションを使用または移行することができます（OpenTelemetry ログ収集の設定はベータ版です）。Collector 自身のメトリクスに破壊的変更がある可能性はあります。</li></ul></div></div><p>このセクションでは、ホストメトリクスを Splunk Observability Cloud に送信するために、設定ファイルの各セクションを詳しく見ていき、変更する方法について説明します。</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-エクステンション>OpenTelemetry Collector エクステンション</h1><p>さて、OpenTelemetry Collector はインストールできました。次は OpenTelemetry Collector のエクステンション（拡張機能）を見てみましょう。エクステンションはオプションで、主にテレメトリーデータの処理を伴わないタスクで使用できます。例としては、ヘルスモニタリング、サービスディスカバリ、データ転送などがあります。</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;: &#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style E fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Receivers
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline></footer></article><section><h1 class=a11y-only>OpenTelemetry Collector エクステンションのサブセクション</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-エクステンション>OpenTelemetry Collector エクステンション</h1><h2 id=health-check-エクステンション>Health Check エクステンション</h2><p>他のコンポーネントと同様に、エクステンションは <code>config.yaml</code> ファイルで設定できます。ここでは実際に <code>config.yaml</code> ファイルを編集して、エクステンションを設定していきましょう。デフォルトの <code>config.yaml</code> では、すでに <strong>pprof</strong> エクステンションと <strong>zpages</strong> エクステンションが設定されていることを確認してみてください。このワークショップでは、設定ファイルをアップデートして <strong>health_check</strong> エクステンションを追加し、ポートを解放し、外部ネットワークからコレクターのヘルスチェックにアクセスできるようにしていきます。</p><div class=tab-panel data-tab-group=f29cefdd556df46a6b7d12fa208a3b42><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("f29cefdd556df46a6b7d12fa208a3b42","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=d4464258ae5cf3b99be72a029a03051c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=extensions-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("d4464258ae5cf3b99be72a029a03051c","extensions-configuration")'>
<span class=tab-nav-text>Extensions Configuration</span></button></div><div class=tab-content-container><div data-tab-item=extensions-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span></span></span></code></pre></div></div></div></div></div><p>コレクターを起動します:</p><div class=tab-panel data-tab-group=611b91a85676475516d2059ab02a72fc><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("611b91a85676475516d2059ab02a72fc","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart otelcol-contrib</span></span></code></pre></div></div></div></div></div><p>このエクステンションはHTTPのURLを公開し、OpenTelemetory Collectorの稼働状況をチェックするプローブを提供します。このエクステンションはKubernetes環境でのLiveness/Readinessプローブとしても使われています。 <code>curl</code> コマンドの使い方は、<a href=https://curl.se/docs/manpage.html target=_blank>curl man page</a> を参照してください。</p><p>次のコマンドを実行します:</p><div class=tab-panel data-tab-group=eb2770384ff27435e0189432e2326df7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=curl-command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("eb2770384ff27435e0189432e2326df7","curl-command")'>
<span class=tab-nav-text>curl Command</span></button>
<button data-tab-item=curl-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("eb2770384ff27435e0189432e2326df7","curl-output")'>
<span class=tab-nav-text>curl Output</span></button></div><div class=tab-content-container><div data-tab-item=curl-command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:13133</span></span></code></pre></div></div></div><div data-tab-item=curl-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{&#34;status&#34;:&#34;Server available&#34;,&#34;upSince&#34;:&#34;2023-04-27T10:11:22.153295874+01:00&#34;,&#34;uptime&#34;:&#34;16m24.684476004s&#34;}</span></span></code></pre></div></div></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-エクステンション>OpenTelemetry Collector エクステンション</h1><h2 id=performance-profiler-エクステンション>Performance Profiler エクステンション</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/extension/pprofextension/README.md target=_blank><strong>Performance Profiler</strong></a> エクステンションは、Go の net/http/pprof エンドポイントを有効化します。これは通常、開発者がパフォーマンスプロファイルを収集し、サービスの問題を調査するために使用します。<strong>このワークショップでは詳しく紹介はしません</strong>。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-エクステンション>OpenTelemetry Collector エクステンション</h1><h2 id=zpages-エクステンション>zPages エクステンション</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/extension/zpagesextension/README.md target=_blank><strong>zPages</strong></a> は、外部エクスポータに代わるプロセス内部の機能です。有効化すると、バックグラウンドでトレースとメトリクス情報を収集し、集計し、どのようなデータを扱ったかの Web ページを公開します。zpages は、コレクターが期待どおりに動作していることを確認するための非常に便利な診断機能です。</p><div class=tab-panel data-tab-group=5562acf970078a024aa90c0dd28ef4a7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=servicez class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("5562acf970078a024aa90c0dd28ef4a7","servicez")'>
<span class=tab-nav-text>ServiceZ</span></button>
<button data-tab-item=pipelinez class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("5562acf970078a024aa90c0dd28ef4a7","pipelinez")'>
<span class=tab-nav-text>PipelineZ</span></button>
<button data-tab-item=extensionz class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("5562acf970078a024aa90c0dd28ef4a7","extensionz")'>
<span class=tab-nav-text>ExtensionZ</span></button></div><div class=tab-content-container><div data-tab-item=servicez class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>ServiceZ</strong> は、コレクターサービスの概要と、pipelinez、extensionz、featurez zPages へのクイックアクセスを提供します。このページでは、ビルドとランタイムの情報も提供します。</p><p>URL: <a href=http://localhost:55679/debug/servicez target=_blank>http://localhost:55679/debug/servicez</a> (<code>localhost</code> は、適切なホスト名に切り替えてください)</p><p><a href=#R-image-3e8ba745e1f2ef9be8cbb04b6b8482c9 class=lightbox-link><img src=../ja/other/opentelemetry-collector/2-extensions/3-zpages/../../images/servicez.png alt=ServiceZ class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3e8ba745e1f2ef9be8cbb04b6b8482c9><img src=../ja/other/opentelemetry-collector/2-extensions/3-zpages/../../images/servicez.png alt=ServiceZ class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></div></div><div data-tab-item=pipelinez class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>PipelineZ</strong> は、コレクターで実行中のパイプラインに関する情報を提供します。タイプ、データが変更されているか、各パイプラインで使用されているレシーバー、プロセッサー、エクスポーターの情報を見ることができます。</p><p>URL: <a href=http://localhost:55679/debug/pipelinez target=_blank>http://localhost:55679/debug/pipelinez</a> (<code>localhost</code> は、適切なホスト名に切り替えてください)</p><p><a href=#R-image-a33afb286f22ec877d5f57012c371df4 class=lightbox-link><img src=../ja/other/opentelemetry-collector/2-extensions/3-zpages/../../images/pipelinez.png alt=PipelineZ class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a33afb286f22ec877d5f57012c371df4><img src=../ja/other/opentelemetry-collector/2-extensions/3-zpages/../../images/pipelinez.png alt=PipelineZ class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></div></div><div data-tab-item=extensionz class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>ExtensionZ</strong> は、コレクターで有効化されたエクステンションを確認できます。</p><p>Example URL: <a href=http://localhost:55679/debug/extensionz target=_blank>http://localhost:55679/debug/extensionz</a> (<code>localhost</code> は、適切なホスト名に切り替えてください)</p><p><a href=#R-image-df8900760307b7e5e93a694b8af1a056 class=lightbox-link><img src=../ja/other/opentelemetry-collector/2-extensions/3-zpages/../../images/extensionz.png alt=ExtensionZ class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-df8900760307b7e5e93a694b8af1a056><img src=../ja/other/opentelemetry-collector/2-extensions/3-zpages/../../images/extensionz.png alt=ExtensionZ class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></div></div></div></div><hr><div class=expand><input type=checkbox id=R-expand-5a870b29dc1e6769ce8ac3a9e97e9973 aria-controls=R-expandcontent-5a870b29dc1e6769ce8ac3a9e97e9973>
<label class=expand-label for=R-expand-5a870b29dc1e6769ce8ac3a9e97e9973><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> storage エクステンションでデータの耐久性を向上させる</span></span></label><div id=R-expandcontent-5a870b29dc1e6769ce8ac3a9e97e9973 class=expand-content><p>これをこなうには、ディストリビューションに <code>file_storage</code> エクステンションモジュールがインストールされていることを確認する必要があります。確認するには、<code>otelcol-contrib components</code> コマンドを実行します:</p><div class=tab-panel data-tab-group=d66df1350fdde034d94700f48276c2f2><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("d66df1350fdde034d94700f48276c2f2","command")'>
<span class=tab-nav-text>Command</span></button>
<button data-tab-item=truncated-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("d66df1350fdde034d94700f48276c2f2","truncated-output")'>
<span class=tab-nav-text>Truncated Output</span></button>
<button data-tab-item=full-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("d66df1350fdde034d94700f48276c2f2","full-output")'>
<span class=tab-nav-text>Full Output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>otelcol-contrib components</span></span></code></pre></div></div></div><div data-tab-item=truncated-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># ... truncated for clarity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>file_storage</span></span></span></code></pre></div></div></div><div data-tab-item=full-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>buildinfo</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=l>otelcol-contrib</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>OpenTelemetry Collector Contrib</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus_simple</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>influxdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>purefa</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>purefb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>receiver_creator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mongodbatlas</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>vcenter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>snmp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>expvar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jmx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>skywalking</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>udplog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>carbon</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafkametrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memcached</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>windowseventlog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zookeeper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsecscontainermetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>iis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mysql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>nsxt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>aerospike</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>elasticsearch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>httpcheck</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8sobjects</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mongodb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>hostmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>statsd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsxray</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cloudfoundry</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>collectd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>couchdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kubeletstats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>journald</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>riak</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>splunk_hec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>active_directory_ds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscloudwatch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sqlquery</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>windowsperfcounters</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>flinkmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudpubsub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>podman_stats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>wavefront</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_events</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>postgresql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>rabbitmq</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sapm</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sqlserver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>solace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tcplog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscontainerinsightreceiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsfirehose</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>bigip</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>filelog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudspanner</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cloudflare</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>docker_stats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pulsar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zipkin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>opencensus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azureeventhub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>fluentforward</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlpjsonfile</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>syslog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cumulativetodelta</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>groupbyattrs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>groupbytrace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8sattributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>experimental_metricsgeneration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>metricstransform</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>routing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>deltatorate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>spanmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>span</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>redaction</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>servicegraph</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>transform</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>filter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>probabilistic_sampler</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tail_sampling</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>carbon</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>f5cloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mezmo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>skywalking</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsxray</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>dynatrace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>loki</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azuredataexplorer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azuremonitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>instana</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>loadbalancing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sentry</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>splunk_hec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tanzuobservability</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zipkin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>alibabacloud_logservice</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>clickhouse</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheusremotewrite</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscloudwatchlogs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudpubsub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger_thrift</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logzio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sapm</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sumologic</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlemanagedprometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>opencensus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awskinesis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>coralogix</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>influxdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logicmonitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tencentcloud_logservice</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsemf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>elasticsearch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pulsar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zpages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>bearertokenauth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>oidc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>host_observer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sigv4auth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>file_storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memory_ballast</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>health_check</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>oauth2client</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsproxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>http_forwarder</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaegerremotesampling</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_observer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pprof</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>asapclient</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>basicauth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>headers_setter</span></span></span></code></pre></div></div></div></div></div><p>このエクステンションは、エクスポーターが設定されたエンドポイントにデータを送信できない事象が発生したときに、データをディスクにキューイングする機能をエクスポーターに提供します。</p><p>このエクステンションを設定するには、以下の情報を含むように設定を更新する必要があります。まず、 /tmp/otel-data ディレクトリを作成し、読み取り/書き込み権限を与えてください：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file_storage</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=l>/tmp/otel-data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>compaction</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=l>/tmp/otel-data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>on_start</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>on_rebound</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rebound_needed_threshold_mib</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rebound_trigger_threshold_mib</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ... truncated for clarity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages, file_storage]</span></span></span></code></pre></div><h2 id=なぜキューデータをディスクに書くの>なぜキューデータをディスクに書くの？</h2><p>コレクターはネットワークの不調（および、コレクターの再起動）を乗り切って、アップストリームプロバイダーに確実にデータを送信できるようになります。</p><h2 id=キューデータをディスクに書く時の注意事項は>キューデータをディスクに書く時の注意事項は？</h2><p>ディスクの性能により、データスループットの性能に影響を与える可能性があります</p><h3 id=参照>参照</h3><ol><li><a href=https://community.splunk.com/t5/Community-Blog/Data-Persistence-in-the-OpenTelemetry-Collector/ba-p/624583 target=_blank>https://community.splunk.com/t5/Community-Blog/Data-Persistence-in-the-OpenTelemetry-Collector/ba-p/624583</a></li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/storage/filestorage target=_blank>https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/storage/filestorage</a></li></ol></div></div><hr><h2 id=設定を確認しましょう>設定を確認しましょう</h2><p>さて、エクステンションについて説明したので、設定の変更箇所を確認していきましょう。</p><hr><div class=expand><input type=checkbox id=R-expand-bebb1056e2a5be8f0ab7de1bdbf7ecdf aria-controls=R-expandcontent-bebb1056e2a5be8f0ab7de1bdbf7ecdf>
<label class=expand-label for=R-expand-bebb1056e2a5be8f0ab7de1bdbf7ecdf><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>設定ファイルを確認してください</span></span></label><div id=R-expandcontent-bebb1056e2a5be8f0ab7de1bdbf7ecdf class=expand-content><div class=tab-panel data-tab-group=1134cd7faff6b0e523407aa19a032ffd><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("1134cd7faff6b0e523407aa19a032ffd","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=hl><span class=lnt> 3
</span></span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></div><hr><p>さて、エクステンションについて復習したところで、ワークショップのデータパイプラインの部分に飛び込んでみましょう。パイプラインとは、コレクター内でデータがたどる経路を定義するもので、レシーバーから始まり、追加の処理や変更をし、最終的にエクスポーターを経由してコレクターを出ます。</p><p>OpenTelemetry Collector のデータパイプラインは、レシーバー、プロセッサー、エクスポーターで構成されています。まずは、レシーバーから見ていきましょう。</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-レシーバー>OpenTelemetry Collector レシーバー</h1><p>レシーバーワークショップへようこそ！OpenTelemetry Collectorのデータパイプラインのスタート地点です。さあ、始めましょう。</p><p>レシーバーはデータをCollectorに取り込む方法で、プッシュベースとプルベースのものがあります。レシーバーは1つ以上のデータソースをサポートします。一般的に、レシーバーは指定されたフォーマットでデータを受け入れ、内部フォーマットに変換し、該当するパイプラインで定義されたプロセッサやエクスポータにデータを渡します。</p><p>プッシュまたはプルベースのレシーバは、データをCollectorに取り込む方法です。レシーバは 1 つまたは複数のデータソースをサポートします。通常、レシーバは指定されたフォーマットでデータを受け入れ、内部フォーマットに変換し、該当するパイプラインで定義されたプロセッサーや エクスポーターにデータを渡します。</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style M fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Receivers
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline></footer></article><section><h1 class=a11y-only>OpenTelemetry Collector レシーバーのサブセクション</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-レシーバー>OpenTelemetry Collector レシーバー</h1><h2 id=host-metrics-レシーバー>Host Metrics レシーバー</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/receiver/hostmetricsreceiver/README.md target=_blank><strong>Host Metrics レシーバー</strong></a> は、さまざまなソースからスクレイピングされたホストシステムに関するメトリクスを生成します。これは、コレクターがエージェントとしてデプロイされるときに使用さます。</p><p><code>etc/otel-contrib/config.yaml</code> ファイルを更新して、<strong>hostmetrics</strong> レシーバーを設定してみましょう。以下の YAML を <strong>receivers</strong> セクションの下に挿入します。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/otelcol-contrib/config.yaml</span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Tips: vi or nano</div><div class=box-content><p>vi/vimの操作に慣れていない場合は、<a href=https://www.nano-editor.org/ target=_blank>nano</a> もお試しいただくと良いかもしれません。nanoはLinux環境でよく使われる、シンプルなエディタの一つです。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/otelcol-contrib/config.yaml</span></span></code></pre></div><ul><li><code>Alt-U</code> で、アンドゥができます。Macの場合は <code>Esc</code> キーを押したあとに <code>U</code> を押してください！</li><li><code>ctrl-_</code> のあとに数字を入力すると、指定した行数にジャンプします。</li><li><code>ctrl-O</code> のあとに <code>Enter</code> で、ファイルを保存します。</li><li><code>ctrl-X</code> で、nanoを終了します。</li></ul></div></div><div class=tab-panel data-tab-group=5935216c5f241d20a2de5c9fec394044><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=host-metrics-receiver-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("5935216c5f241d20a2de5c9fec394044","host-metrics-receiver-configuration")'>
<span class=tab-nav-text>Host Metrics Receiver Configuration</span></button></div><div class=tab-content-container><div data-tab-item=host-metrics-receiver-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># process:</span></span></span></code></pre></div></div></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-レシーバー>OpenTelemetry Collector レシーバー</h1><h2 id=prometheus-レシーバー>Prometheus レシーバー</h2><p><strong>Prometheus</strong> のレシーバーも、もちろんあります。<a href=https://prometheus.io/docs/introduction/overview/ target=_blank>Prometheus</a> は OpenTelemetry Collector で使われているオープンソースのツールキットです。このレシーバーは、OpenTelemetry Collector 自身からメトリクスをスクレイピングするためにも使われます。これらのメトリクスは、コレクタの健全性をモニタリングするために使用できる。</p><p>ここでは、<strong>prometheus</strong> レシーバーを変更して、コレクター自身からメトリクスを収集できるようにしてみます。レシーバーの名前を <strong>prometheus</strong> から <strong>prometheus/internal</strong> に変更して、レシーバーが何をしているのかをより明確しましょう。設定ファイルを以下のように更新します：</p><div class=tab-panel data-tab-group=face2016c8b27f22d9b0ea9046cdd434><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=prometheus-receiver-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("face2016c8b27f22d9b0ea9046cdd434","prometheus-receiver-configuration")'>
<span class=tab-nav-text>Prometheus Receiver Configuration</span></button></div><div class=tab-content-container><div data-tab-item=prometheus-receiver-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class="line hl"><span class=cl><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span></span></span></code></pre></div></div></div></div></div><p>上記の設定では、OpenTelemetry Collector 自身が公開している Prometheus エンドポイントをスクレイピングしています。どのような情報が得られるか、<code>curl</code> コマンドで試すことができます:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:8888/metrics</span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Tips: コンポーネントに名前をつける</div><div class=box-content><p>レシーバー、プロセッサー、エクスポーター、パイプラインなどのコンポーネントは、 <code>otlp</code> や <code>otlp/2</code> のように、 <code>type[/name]</code> 形式に従った識別子によって定義されます。識別子が一意である限り、与えられたタイプのコンポーネントを複数回定義することができるようになります。</p><p>ここでは <code>prometheus/internal</code> という識別子でこのコンポーネントを特定できるようにしたので、別の <code>prometheus</code> レシーバーを追加して、監視対象インスタンスの Prometheus エンドポイントをスクレイピングさせることもできます。</p></div></div><h2 id=ダッシュボード例---prometheus-メトリクス>ダッシュボード例 - Prometheus メトリクス</h2><p>このスクリーンショットは、 <code>prometheus/internal</code> レシーバーが OpenTelemetry Collector から収集したメトリクスの、spmeのダッシュボードの例です。ここではスパン・メトリクス・ログの、それぞれの受信および送信の様子を見ることができます。</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> メモ</div><div class=box-content><p>このダッシュボードはSplunk Observability Cloud にある組み込みダッシュボードで、Splunk OpenTelemetry Collector のインストールの状況を簡単にモニタリングできます。</p></div></div><p><a href=#R-image-257c725878a974b9cc3d16e1f21a47c8 class=lightbox-link><img src=../ja/other/opentelemetry-collector/3-receivers/2-prometheus/../../images/otel-charts.png alt=otel-charts class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-257c725878a974b9cc3d16e1f21a47c8><img src=../ja/other/opentelemetry-collector/3-receivers/2-prometheus/../../images/otel-charts.png alt=otel-charts class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-レシーバー>OpenTelemetry Collector レシーバー</h1><h2 id=その他のレシーバー>その他のレシーバー</h2><p>デフォルトの設定には、他のレシーバーがあることに気づくはずです。 <strong><a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/receiver/otlpreceiver target=_blank>otlp</a></strong>、<strong><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/opencensusreceiver target=_blank>opencensus</a></strong>、<strong><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/jaegerreceiver target=_blank>jaeger</a></strong>、<strong><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/zipkinreceiver target=_blank>zipkin</a></strong> が定義されています。これらは他のソースからテレメトリーデータを受信するために使われます。このワークショップでは、これらのレシーバーについては取り上げませんので、そのままにしておきましょう。</p><hr><div class=expand><input type=checkbox id=R-expand-3db6fa34e0ce256a784f85bb7c431ac7 aria-controls=R-expandcontent-3db6fa34e0ce256a784f85bb7c431ac7>
<label class=expand-label for=R-expand-3db6fa34e0ce256a784f85bb7c431ac7><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> レシーバーを動的に生成する</span></span></label><div id=R-expandcontent-3db6fa34e0ce256a784f85bb7c431ac7 class=expand-content><p>dockerコンテナ、kubernetesポッド、sshセッションのような短時間のタスクを観測するために、<a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/receivercreator target=_blank>receiver creator</a> レシーバーと <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/observer target=_blank>observer</a> エクステンションを使って、対象のサービスが起動するタイミングで新しいレシーバーを作成することができます。</p><h2 id=何が必要なの>何が必要なの？</h2><p>receiver creator とそれに関連する observer エクステンションの使用を開始するには、collector build manifest に追加する必要があります。</p><p>詳細は <a href=../ja/other/opentelemetry-collector/1-installation/index.html>installation</a> を参照してください。</p><h2 id=注意事項はある>注意事項はある？</h2><p>短命なタスクの中には、<em>username</em> や <em>password</em> のような追加設定を必要とするものがあります。それらの値は<a href=https://opentelemetry.io/docs/collector/configuration/#configuration-environment-variables target=_blank>環境変数</a> を参照したり、 <code>${file:./path/to/database/password}</code> のようなスキーム展開構文を使うこともできます。</p><p>組織における機密情報の取り扱い規定に従って、どのような方法を取るかを検討してください。</p><h2 id=ninja-ゾーン>Ninja ゾーン</h2><p>この Ninja ゾーンに必要なものは2つだけです:</p><ol><li>builder manifestに、 receiver creator レシーバーと observer エクステンションを追加する</li><li>検出されたエンドポイントを検出するように、設定を作成する</li></ol><p>次のようにすると、設定をテンプレート化できます:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>watch_observers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>host_observer]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;port&#34; &amp;&amp; port == 6379</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=l>${env:HOST_REDIS_PASSWORD}</span></span></span></code></pre></div><p>他の例は <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/receivercreator#examples target=_blank>receiver creator&rsquo;s examples</a> にあります。</p></div></div><hr><h2 id=設定を確認しましょう>設定を確認しましょう</h2><p>これで、レシーバーをカバーできました。ここで、設定のの変更内容をチェックしてみましょう。</p><hr><div class=expand><input type=checkbox id=R-expand-09546184e313da95ab93a02bfc46a6ee aria-controls=R-expandcontent-09546184e313da95ab93a02bfc46a6ee>
<label class=expand-label for=R-expand-09546184e313da95ab93a02bfc46a6ee><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>設定をレビューしてください</span></span></label><div id=R-expandcontent-09546184e313da95ab93a02bfc46a6ee class=expand-content><div class=tab-panel data-tab-group=3032b990170d7ef3a49e762fce289ce6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("3032b990170d7ef3a49e762fce289ce6","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=hl><span class=lnt>10
</span></span><span class=hl><span class=lnt>11
</span></span><span class=hl><span class=lnt>12
</span></span><span class=hl><span class=lnt>13
</span></span><span class=hl><span class=lnt>14
</span></span><span class=hl><span class=lnt>15
</span></span><span class=hl><span class=lnt>16
</span></span><span class=hl><span class=lnt>17
</span></span><span class=hl><span class=lnt>18
</span></span><span class=hl><span class=lnt>19
</span></span><span class=hl><span class=lnt>20
</span></span><span class=hl><span class=lnt>21
</span></span><span class=hl><span class=lnt>22
</span></span><span class=hl><span class=lnt>23
</span></span><span class=hl><span class=lnt>24
</span></span><span class=hl><span class=lnt>25
</span></span><span class=hl><span class=lnt>26
</span></span><span class=hl><span class=lnt>27
</span></span><span class=hl><span class=lnt>28
</span></span><span class=hl><span class=lnt>29
</span></span><span class=hl><span class=lnt>30
</span></span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=hl><span class=lnt>39
</span></span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></div><hr><p>これで、レシーバーを通して OpenTelemetry Collector にデータがどのように取り込まれるかを確認しました。次に、コレクターが受信したデータをどのように処理するかを見てみましょう。</p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> 警告</div><div class=box-content><p><strong>ここではコレクターを再起動しないでください</strong>！ <code>/etc/otelcol-contrib/config.yaml</code> の変更はまだ完了していません。</p></div></div><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-プロセッサー>OpenTelemetry Collector プロセッサー</h1><p><a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/processor/README.md target=_blank><strong>プロセッサー</strong></a>は、レシーバーとエクスポーターとの間で、データに対して実行される処理です。プロセッサーはオプションですが、いくつかは推奨されています。OpenTelemetry Collector Contrib には<a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor target=_blank>多数のプロセッサー</a>が含まれています。</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style Processors fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Receivers
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline></footer></article><section><h1 class=a11y-only>OpenTelemetry Collector プロセッサーのサブセクション</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-プロセッサー>OpenTelemetry Collector プロセッサー</h1><h2 id=batch-プロセッサー>Batch プロセッサー</h2><p>デフォルトでは、<strong>batch</strong> プロセッサーだけが有効になっています。このプロセッサーは、データをエクスポートする前にバッチ処理して、エクスポーターへのネットワーク・コールの回数を減らすために使われます。このワークショップではデフォルトの設定を使用します：</p><ul><li><code>send_batch_size</code> (デフォルト = 8192): タイムアウトに関係なく、バッチを送信するスパン、メトリクスデータポイント、またはログレコードの数。パイプラインの次のコンポーネントに送信されるバッチサイズを制限する場合には、 <code>send_batch_max_size</code> を使います。</li><li><code>timeout</code> (デフォルト = 200ms): サイズに関係なく、バッチが送信されるまでの時間。ゼロに設定すると、<code>send_batch_size</code> の設定を無視して <code>send_batch_max_size</code> だけが適用され、データは直ちに送信されます。</li><li><code>send_batch_max_size</code> (デフォルト = 0): バッチサイズの上限。<code>0</code> を設定すると、バッチサイズの上限がないことして扱われます。この設定は、大きなバッチが小さなユニットに分割されることを保証します。<code>send_batch_size</code> 以上でなければななりません。</li></ul><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-プロセッサー>OpenTelemetry Collector プロセッサー</h1><h2 id=resource-detection-プロセッサー>Resource Detection プロセッサー</h2><p><strong>resourcedetection</strong> プロセッサーは、ホストからリソース情報を検出して、テレメトリーデータ内のリソース値をこの情報で追加または上書きすることができます。</p><p>デフォルトでは、可能であればホスト名を FQDN に設定し、そうでなければ OS が提供するホスト名になります。このロジックは <code>hostname_sources</code> オプションを使って変更できます。FQDN を取得せず、OSが提供するホスト名を使用するには、<code>hostname_sources</code>を<code>os</code>に設定します。</p><div class=tab-panel data-tab-group=86a4685d18bf663e685b589798a462b8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=system-resource-detection-processor-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("86a4685d18bf663e685b589798a462b8","system-resource-detection-processor-configuration")'>
<span class=tab-nav-text>System Resource Detection Processor Configuration</span></button></div><div class=tab-content-container><div data-tab-item=system-resource-detection-processor-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span></span></span></code></pre></div></div></div></div></div><p>If the workshop instance is running on an AWS/EC2 instance we can gather the following tags from the EC2 metadata API (this is not available on other platforms).
ワークショップのインスタンスが AWS/EC2 インスタンスで実行されている場合、EC2 のメタデータ API から以下のタグを収集します（これは他のプラットフォームでは利用できないものもあります）。</p><ul><li><code>cloud.provider ("aws")</code></li><li><code>cloud.platform ("aws_ec2")</code></li><li><code>cloud.account.id</code></li><li><code>cloud.region</code></li><li><code>cloud.availability_zone</code></li><li><code>host.id</code></li><li><code>host.image.id</code></li><li><code>host.name</code></li><li><code>host.type</code></li></ul><p>これらのタグをメトリクスに追加するために、別のプロセッサーとして定義してみましょう。</p><div class=tab-panel data-tab-group=2fa0b9e42df3ea6ab0efe9ee971ce7f3><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=ec2-resource-detection-processor-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("2fa0b9e42df3ea6ab0efe9ee971ce7f3","ec2-resource-detection-processor-configuration")'>
<span class=tab-nav-text>EC2 Resource Detection Processor Configuration</span></button></div><div class=tab-content-container><div data-tab-item=ec2-resource-detection-processor-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span></span></span></code></pre></div></div></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-プロセッサー>OpenTelemetry Collector プロセッサー</h1><h2 id=attributes-プロセッサー>Attributes プロセッサー</h2><p>attribute プロセッサーを使うと、スパン、ログ、またはメトリクスの属性を変更できます。また、このプロセッサーは、入力データをフィルタリングし、マッチさせ、指定されたアクションに含めるべきか、除外すべきかを決定する機能もサポートしています。</p><p>アクションを設定するには、指定された順序で実行されるアクションのリストを記述します。サポートされるアクションは以下の通りです：</p><ul><li><code>insert</code>: その属性がない場合に、新しい属性値を挿入します。</li><li><code>update</code>: その属性がある場合に、その属性値を更新します。</li><li><code>upsert</code>: insert または update を実行します。属性がない場合には新しい属性値を挿入し、属性がある場合にはその値を更新します。</li><li><code>delete</code>: 入力データから属性値を削除します。</li><li><code>hash</code>: 属性値をハッシュ化 (SHA1) します。</li><li><code>extract</code>: 入力キーの値を正規表現ルールを使って抽出し、対象キーの値を更新します。対象キーがすでに存在する場合は、その値は上書きされます。</li></ul><p>次の例のように、attribute プロセッサーを使って、キーは <code>participant.name</code>、あたいはあなたの名前（例: <code>marge_simpson</code>）という新しい属性を追加してみましょう。</p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> 警告</div><div class=box-content><p><code>INSERT_YOUR_NAME_HERE</code> の箇所は、自分の名前に置き換えてください。また、自分の名前に <strong>スペースを使わない</strong> ようにしてください。</p></div></div><p>このワークショップの後半では、この属性を使用して Splunk Observability Cloud でメトリクスをフィルタリングします。</p><div class=tab-panel data-tab-group=92446aae520d934d7838eb3ede0ac88c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=attributes-processor-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("92446aae520d934d7838eb3ede0ac88c","attributes-processor-configuration")'>
<span class=tab-nav-text>Attributes Processor Configuration</span></button></div><div class=tab-content-container><div data-tab-item=attributes-processor-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span></span></span></code></pre></div></div></div></div></div><hr><div class=expand><input type=checkbox id=R-expand-5f6bdddd0859c050504221ac3eff2fad aria-controls=R-expandcontent-5f6bdddd0859c050504221ac3eff2fad>
<label class=expand-label for=R-expand-5f6bdddd0859c050504221ac3eff2fad><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> コネクターを使って内部への洞察を加速する</span></span></label><div id=R-expandcontent-5f6bdddd0859c050504221ac3eff2fad class=expand-content><p>最近追加されたものの一つとして、<a href=https://opentelemetry.io/docs/collector/configuration/#connectors target=_blank>connector</a> というコンセプトがあります。これを使うと、あるパイプラインの出力を別のパイプラインの入力に結合できるようになります。</p><p>利用シーンとして、送信するデータポイントの量、エラーステータスを含むログの数をメトリクスをとして出力するサービスがあります。他には、あるデプロイ環境から送信されるデータ量のメトリクスを生成するサービスがあります。このような場合に、count コネクターですぐに対応できます。</p><h2 id=プロセッサーではなくコネクターなのはなぜ>プロセッサーではなくコネクターなのはなぜ？</h2><p>プロセッサーは、処理したデータを次に渡すものであり、追加の情報を出力することはできません。コネクターはレシーバーで受け取ったデータを出力せずに、私たちが求める洞察を作り出す機会を提供します。</p><p>たとえば、count コネクターを使うと、環境変数 <code>deployment</code> を持たないログ、メトリクス、トレースの数をカウントすることができます。</p><p>また、非常にシンプルな例として、<code>deployment</code> 別にデータ使用量を分解して出力することもできます。</p><h2 id=コネクターの注意事項>コネクターの注意事項</h2><p>コネクターは、あるパイプラインからエクスポートされ、別のパイプラインでレシーバーで定義されたデータのみを受け入れます。コレクターをどう構築してどう利用するか、設定を検討する必要があります。</p><h2 id=参照>参照</h2><ol><li><a href=https://opentelemetry.io/docs/collector/configuration/#connectors target=_blank>https://opentelemetry.io/docs/collector/configuration/#connectors</a></li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/countconnector target=_blank>https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/countconnector</a></li></ol></div></div><hr><h2 id=設定を確認しましょう>設定を確認しましょう</h2><p>これで、プロセッサーがカバーできました。ここで、設定のの変更内容をチェックしてみましょう。</p><hr><div class=expand><input type=checkbox id=R-expand-03257506ce024d3531aa914fa5fa2533 aria-controls=R-expandcontent-03257506ce024d3531aa914fa5fa2533>
<label class=expand-label for=R-expand-03257506ce024d3531aa914fa5fa2533><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>設定をレビューしてください</span></span></label><div id=R-expandcontent-03257506ce024d3531aa914fa5fa2533 class=expand-content><div class=tab-panel data-tab-group=7f1b008b1bd43ede828ff93842d5ba99><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("7f1b008b1bd43ede828ff93842d5ba99","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=hl><span class=lnt>58
</span></span><span class=hl><span class=lnt>59
</span></span><span class=hl><span class=lnt>60
</span></span><span class=hl><span class=lnt>61
</span></span><span class=hl><span class=lnt>62
</span></span><span class=hl><span class=lnt>63
</span></span><span class=hl><span class=lnt>64
</span></span><span class=hl><span class=lnt>65
</span></span><span class=hl><span class=lnt>66
</span></span><span class=hl><span class=lnt>67
</span></span><span class=hl><span class=lnt>68
</span></span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></div><hr><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-エクスポーター>OpenTelemetry Collector エクスポーター</h1><p>エクスポーターは、プッシュまたはプルベースであり、一つ以上のバックエンド/デスティネーションにデータを送信する方法です。エクスポーターは、一つまたは複数のデータソースをサポートすることがあります。</p><p>このワークショップでは、<a href=https://opentelemetry.io/docs/specs/otel/protocol/exporter/ target=_blank><strong>otlphttp</strong></a> エクスポーターを使用します。OpenTelemetry Protocol (OTLP) は、テレメトリーデータを伝送するためのベンダーニュートラルで標準化されたプロトコルです。OTLP エクスポーターは、OTLP プロトコルを実装するサーバーにデータを送信します。OTLP エクスポーターは、<a href=https://grpc.io/ target=_blank><strong>gRPC</strong></a> および <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Overview target=_blank><strong>HTTP</strong></a>/<a href=https://www.json.org/json-en.html target=_blank><strong>JSON</strong></a> プロトコルの両方をサポートします。</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style Exporters fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Receivers
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline></footer></article><section><h1 class=a11y-only>OpenTelemetry Collector エクスポーターのサブセクション</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-エクスポーター>OpenTelemetry Collector エクスポーター</h1><h2 id=otlp-http-エクスポーター>OTLP HTTP エクスポーター</h2><p>Splunk Observability Cloud へ HTTP 経由でメトリックスを送信するためには、<strong>otlphttp</strong> エクスポーターを設定する必要があります。</p><p><code>/etc/otelcol-contrib/config.yaml</code> ファイルを編集し、<strong>otlphttp</strong> エクスポーターを設定しましょう。以下の YAML を <strong>exporters</strong> セクションの下に挿入し、例えば2スペースでインデントしてください。</p><p>また、ディスクの容量不足を防ぐために、ロギングエクスポーターの詳細度を変更します。デフォルトの <code>detailed</code> は非常に詳細です。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=l>otlphttp/splunk:</span></span></span></code></pre></div><p>次に、<code>metrics_endpoint</code> を定義して、ターゲットURLを設定していきます。</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> メモ</div><div class=box-content><p>Splunk 主催のワークショップの参加者である場合、使用しているインスタンスにはすでに Realm 環境変数が設定されています。その環境変数を設定ファイルで参照します。それ以外の場合は、新しい環境変数を作成して Realm を設定する必要があります。例えば：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span><span class=s2>&#34;us1&#34;</span></span></span></code></pre></div></div></div><p>使用するURLは <code>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</code> です。（Splunkは、データの居住地に応じて世界中の主要地域に Realm を持っています）。</p><p><strong>otlphttp</strong> エクスポーターは、<code>traces_endpoint</code> と <code>logs_endpoint</code> それぞれのターゲットURLを定義することにより、トレースとログを送信するようにも設定できますが、そのような設定はこのワークショップの範囲外とします。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span></span></span></code></pre></div><p>デフォルトでは、すべてのエンドポイントで <code>gzip</code> 圧縮が有効になっています。エクスポーターの設定で <code>compression: none</code> を設定することにより、圧縮を無効にすることができます。このワークショップでは圧縮を有効にしたままにし、データを送信する最も効率的な方法としてデフォルト設定を使っていきます。</p><p>Splunk Observability Cloud にメトリクスを送信するためには、アクセストークンを使用する必要があります。これは、Splunk Observability Cloud UI で新しいトークンを作成することにより行うことができます。トークンの作成方法についての詳細は、<a href=https://docs.splunk.com/Observability/admin/authentication-tokens/org-tokens.html target=_blank>Create a token</a> を参照してください。トークンは <strong>INGEST</strong> タイプである必要があります。</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> メモ</div><div class=box-content><p>Splunk　主催のワークショップの参加者である場合、使用しているインスタンスにはすでにアクセストークンが設定されています（環境変数として設定されています）ので、その環境変数を設定ファイルで参照します。それ以外の場合は、新しいトークンを作成し、それを環境変数として設定する必要があります。例えば：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span>&lt;replace-with-your-token&gt;</span></span></code></pre></div></div></div><p>トークンは、設定ファイル内で <code>headers:</code> セクションの下に <code>X-SF-TOKEN: ${env:ACCESS_TOKEN}</code> を挿入することにで定義します：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>X-SF-TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span></span></span></code></pre></div><h2 id=設定を確認しましょう>設定を確認しましょう</h2><p>これで、エクスポーターもカバーできました。設定を確認していきましょう：</p><hr><div class=expand><input type=checkbox id=R-expand-7b97b2df97abda657d28466f6b8c3c3f aria-controls=R-expandcontent-7b97b2df97abda657d28466f6b8c3c3f>
<label class=expand-label for=R-expand-7b97b2df97abda657d28466f6b8c3c3f><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>設定をレビューしてください</span></span></label><div id=R-expandcontent-7b97b2df97abda657d28466f6b8c3c3f class=expand-content><div class=tab-panel data-tab-group=1e0573de482865ca575e0eb4715fb4d8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("1e0573de482865ca575e0eb4715fb4d8","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=hl><span class=lnt>72
</span></span><span class=hl><span class=lnt>73
</span></span><span class=hl><span class=lnt>74
</span></span><span class=hl><span class=lnt>75
</span></span><span class=hl><span class=lnt>76
</span></span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>X-SF-TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></div><hr><p>もちろん、<strong>OTLP</strong> プロトコルをサポートする他のソリューションを指すように <code>metrics_endpoint</code> を簡単に設定することができます。</p><p>次に、<code>config.yaml</code> のサービスセクションで、今設定したレシーバー、プロセッサー、エクスポーターを有効にしていきます。</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-サービス>OpenTelemetry Collector サービス</h1><p><strong>Service</strong> セクションでは、レシーバー、プロセッサー、エクスポーター、およびエクステンションにある設定に基づいて、コレクターで有効にするコンポーネントを設定していきます。</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> 情報</div><div class=box-content><p>コンポーネントが設定されていても、<strong>Service</strong> セクション内で定義されていない場合、そのコンポーネントは<strong>有効化されません</strong>。</p></div></div><p>サービスのセクションは、以下の3つのサブセクションで構成されています：</p><ul><li>extensions（拡張機能）</li><li>pipelines（パイプライン）</li><li>telemetry（テレメトリー）</li></ul><p>デフォルトの設定では、拡張機能セクションが <code>health_check</code>、<code>pprof</code>、<code>zpages</code> を有効にするように設定されており、これらは以前のエクステンションのモジュールで設定しました。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></div><p>それでは、メトリックパイプラインを設定していきましょう！</p><footer class=footline></footer></article><section><h1 class=a11y-only>OpenTelemetry Collector サービスのサブセクション</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-サービス>OpenTelemetry Collector サービス</h1><h2 id=hostmetrics-レシーバー>Hostmetrics レシーバー</h2><p>ワークショップのレシーバー部分で振り返ると、ホストシステムに関するメトリクスを生成するために、様々なソースからスクレイピングする <a href=../ja/other/opentelemetry-collector/3-receivers/index.html#host-metrics-receiver>Host Metrics</a> レシーバーを定義しました。このレシーバーを有効にするためには、メトリクスパイプラインに <code>hostmetrics</code> レシーバーを含める必要があります。</p><p><code>metrics</code> パイプラインで、メトリクスの <code>receivers</code> セクションに <code>hostmetrics</code> を追加します。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-サービス>OpenTelemetry Collector サービス</h1><h2 id=prometheus-internal-レシーバー>Prometheus Internal レシーバー</h2><p>ワークショップの前半で、<code>prometheus</code> レシーバーの名前を変更し、コレクター内部のメトリクスを収集していることを反映して、<code>prometheus/internal</code> という名前にしました。</p><p>現在、メトリクスパイプラインの下で <code>prometheus/internal</code> レシーバーを有効にする必要があります。<code>metrics</code> パイプラインの下の <code>receivers</code> セクションを更新して、<code>prometheus/internal</code> を含めます：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-サービス>OpenTelemetry Collector サービス</h1><h2 id=resource-detection-プロセッサー>Resource Detection プロセッサー</h2><p>また、コレクターがインスタンスのホスト名やAWS/EC2のメタデータを取得できるように、<code>resourcedetection/system</code> および <code>resourcedetection/ec2</code> プロセッサーを追加しました。これらのプロセッサーをメトリクスパイプライン下で有効にする必要があります。</p><p><code>metrics</code> パイプラインの下の <code>processors</code> セクションを更新して、<code>resourcedetection/system</code> および <code>resourcedetection/ec2</code> を追加します：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-サービス>OpenTelemetry Collector サービス</h1><h2 id=attributes-プロセッサー>Attributes プロセッサー</h2><p>また、このワークショップのプロセッサーセクションでは、<code>attributes/conf</code> プロセッサーを追加し、コレクターがすべてのメトリクスに <code>participant.name</code> という新しい属性を挿入するようにしました。これをメトリクスパイプライン下で有効にする必要があります。</p><p><code>metrics</code> パイプラインの下の <code>processors</code> セクションを更新して、<code>attributes/conf</code> を追加します：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-サービス>OpenTelemetry Collector サービス</h1><h2 id=otlp-http-エクスポーター>OTLP HTTP エクスポーター</h2><p>ワークショップのエクスポーターセクションでは、<code>otlphttp</code> エクスポーターを設定して、メトリクスを Splunk Observability Cloud に送信するようにしました。これをメトリクスパイプライン下で有効にする必要があります。</p><p><code>metrics</code> パイプラインの下の <code>exporters</code> セクションを更新して、<code>otlphttp/splunk</code> を追加します：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging, otlphttp/splunk]</span></span></span></code></pre></div><hr><div class=expand><input type=checkbox id=R-expand-8d5b19af982c32897444b15845891b9e aria-controls=R-expandcontent-8d5b19af982c32897444b15845891b9e>
<label class=expand-label for=R-expand-8d5b19af982c32897444b15845891b9e><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> コレクターの内部を観測する</span></span></label><div id=R-expandcontent-8d5b19af982c32897444b15845891b9e class=expand-content><p>コレクターは、その動作に関する内部シグナルを捕捉しています。これには実行中のコンポーネントからの追加されるシグナルも含まれます。これは、データの流れに関する決定を行うコンポーネントが、その情報をメトリクスやトレースとして表面化する方法を必要とするためです。</p><h2 id=なぜコレクターを監視するの>なぜコレクターを監視するの？</h2><p>これは「監視者を監視するのは誰か？」という種類の問題ですが、このような情報を表面化できることは重要です。コレクターの歴史の興味深い部分は、GoメトリクスのSDKが安定と考えられる前に存在していたことで、コレクターは当面の間、この機能を提供するために Prometheus エンドポイントを公開しています。</p><h2 id=注意点>注意点</h2><p>組織内で稼働している各コレクターの内部使用状況を監視することは、新しいメトリクス量（MTS）を大幅な増加させる可能性があります。Splunkディストリビューションはこれらのメトリクスをキュレーションしており、増加を予測するのに役立ちます。</p><h2 id=ninja-ゾーン>Ninja ゾーン</h2><p>コレクターの内部オブザーバビリティを公開するためには、いくつかの設定を追加することがあります：</p><div class=tab-panel data-tab-group=36a88a71bb4b60be322402a101285d5c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=telemetry-schema class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("36a88a71bb4b60be322402a101285d5c","telemetry-schema")'>
<span class=tab-nav-text>telemetry schema</span></button>
<button data-tab-item=example-configyml class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("36a88a71bb4b60be322402a101285d5c","example-configyml")'>
<span class=tab-nav-text>example-config.yml</span></button></div><div class=tab-content-container><div data-tab-item=telemetry-schema class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>telemetry</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>&lt;info|warn|error&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>development</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>encoding</span><span class=p>:</span><span class=w> </span><span class=l>&lt;console|json&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_caller</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_stacktrace</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>output_paths</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>&lt;stdout|stderr&gt;, paths...]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>error_output_paths</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>&lt;stdout|stderr&gt;, paths...]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>initial_fields</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>&lt;none|basic|normal|detailed&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Address binds the promethues endpoint to scrape</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=l>&lt;hostname:port&gt;</span></span></span></code></pre></div></div></div><div data-tab-item=example-configyml class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>telemetry</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>info</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>encoding</span><span class=p>:</span><span class=w> </span><span class=l>json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_stacktrace</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>initial_fields</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>instance.name</span><span class=p>:</span><span class=w> </span><span class=l>${env:INSTANCE}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=l>localhost:8888 </span></span></span></code></pre></div></div></div></div></div><h2 id=参照>参照</h2><ol><li><a href=https://opentelemetry.io/docs/collector/configuration/#service target=_blank>https://opentelemetry.io/docs/collector/configuration/#service</a></li></ol></div></div><hr><h2 id=完成した設定>完成した設定</h2><hr><div class=expand><input type=checkbox id=R-expand-d907c4677abc894c19e9c53ef309c970 aria-controls=R-expandcontent-d907c4677abc894c19e9c53ef309c970>
<label class=expand-label for=R-expand-d907c4677abc894c19e9c53ef309c970><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>完成した設定をレビューしてください</span></span></label><div id=R-expandcontent-d907c4677abc894c19e9c53ef309c970 class=expand-content><div class=tab-panel data-tab-group=ac9c437d2eeecd62a3c2a37eea0019b0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("ac9c437d2eeecd62a3c2a37eea0019b0","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=hl><span class=lnt>88
</span></span><span class=hl><span class=lnt>89
</span></span><span class=hl><span class=lnt>90
</span></span><span class=lnt>91
</span><span class=lnt>92
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>X-SF-TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf] </span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging, otlphttp/splunk]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></div><hr><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> ヒント</div><div class=box-content><p>コレクターを再起動する前に、設定ファイルを検証することをお勧めします。これは、組み込みの <code>validate</code> コマンドを使用して行うことができます：</p><div class=tab-panel data-tab-group=2a35c593271cc070883c1464033d9e3e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("2a35c593271cc070883c1464033d9e3e","command")'>
<span class=tab-nav-text>Command</span></button>
<button data-tab-item=example-error-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("2a35c593271cc070883c1464033d9e3e","example-error-output")'>
<span class=tab-nav-text>Example error output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>otelcol-contrib validate --config<span class=o>=</span>file:/etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div><div data-tab-item=example-error-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Error: failed to get config: cannot unmarshal the configuration: 1 error(s) decoding:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* error decoding &#39;processors&#39;: error reading configuration for &#34;attributes/conf&#34;: 1 error(s) decoding:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* &#39;actions[0]&#39; has invalid keys: actions
</span></span><span class=line><span class=cl>2023/06/29 09:41:28 collector server run finished with error: failed to get config: cannot unmarshal the configuration: 1 error(s) decoding:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* error decoding &#39;processors&#39;: error reading configuration for &#34;attributes/conf&#34;: 1 error(s) decoding:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* &#39;actions[0]&#39; has invalid keys: actions</span></span></code></pre></div></div></div></div></div></div></div><p>動作する設定ができたので、コレクターを起動し、その後 <a href=../ja/other/opentelemetry-collector/2-extensions/index.html#zpages>zPages</a> が報告している内容を確認しましょう。</p><div class=tab-panel data-tab-group=a0fa0bd9242a491f0b782ce2ca32d7ef><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("a0fa0bd9242a491f0b782ce2ca32d7ef","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart otelcol-contrib</span></span></code></pre></div></div></div></div></div><p><a href=#R-image-e5b6f1acc1e12e60be40b598e361230e class=lightbox-link><img src=../ja/other/opentelemetry-collector/6-service/5-otlphttp/../../images/pipelinez-full-config.png alt=pipelinez-full-config class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e5b6f1acc1e12e60be40b598e361230e><img src=../ja/other/opentelemetry-collector/6-service/5-otlphttp/../../images/pipelinez-full-config.png alt=pipelinez-full-config class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=データの可視化>データの可視化</h1><h2 id=splunk-observability-cloud>Splunk Observability Cloud</h2><p>OpenTelemetry Collector を設定して Splunk Observability Cloud にメトリクスを送信するようにしたので、Splunk Observability Cloud でデータを見てみましょう。Splunk Observability Cloud　への招待を受け取っていない場合は、講師がログイン資格情報を提供します。</p><p>その前に、もう少し興味深くするために、インスタンスでストレステストを実行しましょう。これにより、ダッシュボードが活性化されます。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install stress
</span></span><span class=line><span class=cl><span class=k>while</span> true<span class=p>;</span> <span class=k>do</span> stress -c <span class=m>2</span> -t 40<span class=p>;</span> stress -d <span class=m>5</span> -t 40<span class=p>;</span> stress -m <span class=m>20</span> -t 40<span class=p>;</span> <span class=k>done</span></span></span></code></pre></div><p>Splunk Observability Cloudにログインしたら、左側のナビゲーションを使用して <strong>Dashboards</strong> に移動します：</p><p><a href=#R-image-0c624b6585567f2b45e588fce8510005 class=lightbox-link><img src=../ja/other/opentelemetry-collector/7-visualisation/../images/menu-dashboards.png alt=menu-dashboards class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0c624b6585567f2b45e588fce8510005><img src=../ja/other/opentelemetry-collector/7-visualisation/../images/menu-dashboards.png alt=menu-dashboards class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>検索ボックスで <strong>OTel Contrib</strong> を検索します：</p><p><a href=#R-image-08276d71625aa2bd49b6ba348202d23d class=lightbox-link><img src=../ja/other/opentelemetry-collector/7-visualisation/../images/search-dashboards.png alt=search-dashboards class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-08276d71625aa2bd49b6ba348202d23d><img src=../ja/other/opentelemetry-collector/7-visualisation/../images/search-dashboards.png alt=search-dashboards class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> 情報</div><div class=box-content><p>ダッシュボードが存在しない場合は、講師が迅速に追加します。このワークショップの Splunk 主催版に参加していない場合、インポートするダッシュボードグループはこのページの下部にあります。</p></div></div><p><strong>OTel Contrib Dashboard</strong> ダッシュボードをクリックして開きます：</p><p><a href=#R-image-5c88e2164170fdefc7c34a662a62d856 class=lightbox-link><img src=../ja/other/opentelemetry-collector/7-visualisation/../images/otel-dashboard.png alt=otel-dashboard class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5c88e2164170fdefc7c34a662a62d856><img src=../ja/other/opentelemetry-collector/7-visualisation/../images/otel-dashboard.png alt=otel-dashboard class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>ダッシュボードの上部にある <strong>Filter</strong> 欄に「participant」の途中まで入力し、候補に出る <strong>participant.name</strong> を選択します：</p><p><a href=#R-image-f27fceb1ec9cc1ccec2971e44b6012bb class=lightbox-link><img src=../ja/other/opentelemetry-collector/7-visualisation/../images/search-filter.png alt=search-filter class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f27fceb1ec9cc1ccec2971e44b6012bb><img src=../ja/other/opentelemetry-collector/7-visualisation/../images/search-filter.png alt=search-filter class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><code>participant.name</code> で、<code>config.yaml</code> 内で設定したあなたの名前を入力するか、リストから選択することができます：</p><p><a href=#R-image-6308611609f0af3826039ec523f827c1 class=lightbox-link><img src=../ja/other/opentelemetry-collector/7-visualisation/../images/select-participant-name.png alt=select-conf-attendee-name class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6308611609f0af3826039ec523f827c1><img src=../ja/other/opentelemetry-collector/7-visualisation/../images/select-participant-name.png alt=select-conf-attendee-name class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>これで、OpenTelemetry Collector を設定したホストの、ホストメトリクスを確認することができます。</p><div class="box attachments cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> ダッシュボードJSONのダウンロード方法</div><ul class="box-content attachments-files"><li><a href=../ja/other/opentelemetry-collector/7-visualisation/index.files/dashboard_OTel-Contrib-Dashboard.json>dashboard_OTel-Contrib-Dashboard.json</a> (40 KB)</li></ul></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-を開発する>OpenTelemetry Collector を開発する</h1><h2 id=カスタムコンポーネントの開発>カスタムコンポーネントの開発</h2><p>Open Telemetry Collectorのためのコンポーネントを構築するには、以下の3つの主要な部分が必要です：</p><ol><li>Configuration - <em>ユーザーが設定できる値は何か</em></li><li>Factory - <em>提供された値を使ってコンポーネントを作成する</em></li><li>Business Logic - <em>コンポーネントが実行する必要があること</em></li></ol><p>これについて、プロジェクトの重要なDevOpsメトリクスを追跡するためにJenkinsと連携するコンポーネントを構築する例を考えていきます。</p><p>測定しようとしているメトリクスは次のとおりです：</p><ol><li>変更に対するリードタイム - <em>「コミットが本番環境に入るまでにかかる時間」</em></li><li>変更失敗率 - <em>「本番環境での障害を引き起こすデプロイの割合」</em></li><li>デプロイ頻度 - <em>「[チーム]が本番環境に成功してリリースする頻度」</em></li><li>平均復旧時間 - <em>「[チーム]が本番環境の障害から復旧するのにかかる時間」</em></li></ol><p>これらの指標は Google の <a href=https://dora.dev/ target=_blank>DevOps Research and Assessment (DORA)</a> チームによって特定されたもので、ソフトウェア開発チームのパフォーマンスを示すのに役立ちます。<em>Jenkins CI</em> を選択した理由は、私たちが同じオープンソースソフトウェアエコシステムに留まり、将来的にベンダー管理のCIツールが採用する例となることができるためです。</p><h2 id=計装--コンポーネント>計装 🆚 コンポーネント</h2><p>組織内でオブザーバビリティを向上させる際には、トレードオフが発生するため、考慮する点があります。</p><table><thead><tr><th></th><th>長所</th><th>短所</th></tr></thead><tbody><tr><td><strong>（自動）計装</strong><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></td><td>システムを観測するために外部APIが不要</td><td>計装を変更するにはプロジェクトの変更が必要</td></tr><tr><td></td><td>システム所有者/開発者は可観測性の変更が可能</td><td>ランタイムへの追加の依存が必要</td></tr><tr><td></td><td>システムの文脈を理解し、<em>Exemplar</em> とキャプチャされたデータを関連付けることが可能</td><td>システムのパフォーマンスに影響を与える可能性がある</td></tr><tr><td><strong>コンポーネント</strong></td><td>データ名や意味の変更をシステムのリリースサイクルから独立した展開が可能</td><td>APIの破壊的な変更の可能性があり、システムとコレクター間でリリースの調整が必要</td></tr><tr><td></td><td>その後の利用に合わせて収集されるデータの更新/拡張が容易</td><td>キャプチャされたデータの意味がシステムリリースと一致せず、予期せず壊れる可能性がある</td></tr></tbody></table><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>計装（instrument, インストゥルメント）とは、アプリケーションなどのシステムコンポーネントに対して、トレースやメトリクス、ログなどのテレメトリーデータを出力させる実装。計装ライブラリを最低限セットアップするだけで一通りのトレースやメトリクスなどを出力できるような対応を「自動計装」と呼びます。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><section><h1 class=a11y-only>OpenTelemetry Collector を開発するのサブセクション</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-を開発する>OpenTelemetry Collector を開発する</h1><h2 id=プロジェクトのセットアップ-hahahugoshortcode155s0hbhb>プロジェクトのセットアップ <span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja</strong></span></span></h2><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> メモ</div><div class=box-content><p>このワークショップのセクションを完了する時間は経験によって異なる場合があります。</p><p>完成したものは<a href=https://github.com/splunk/collector-workshop-example target=_blank>こちら</a>にあります。詰まった場合や講師と一緒に進めたい場合に利用してください。</p></div></div><p>新しい <em>Jenkins CI</em> レシーバーの開発を始めるため、まずは Go プロジェクトのセットアップから始めていきます。
新しい Go プロジェクトを作成する手順は以下の通りです：</p><ol><li><code>${HOME}/go/src/jenkinscireceiver</code> という名前の新しいディレクトリを作成し、そのディレクトリに移動します。<ol><li>実際のディレクトリ名や場所は厳密ではありません。自分の開発ディレクトリを自由に選ぶことができます。</li></ol></li><li><code>go mod init splunk.conf/workshop/example/jenkinscireceiver</code> を実行して、Go のモジュールを初期化します。<ol><li>依存関係を追跡するために使用される <code>go.mod</code> というファイルが作成されます。</li><li>インポートされている依存関係のチェックサム値が <code>go.sum</code> として保存されます。</li></ol></li></ol><div class=expand><input type=checkbox id=R-expand-475a470be30b1c52372176bcc4d0c751 aria-controls=R-expandcontent-475a470be30b1c52372176bcc4d0c751>
<label class=expand-label for=R-expand-475a470be30b1c52372176bcc4d0c751><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>go.modをレビューする</span></span></label><div id=R-expandcontent-475a470be30b1c52372176bcc4d0c751 class=expand-content><p>`` text
module splunk.conf/workshop/example/jenkinscireceiver</p><p>go 1.20</p><div class="wrap-code highlight"><pre tabindex=0><code></code></pre></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-を開発する>OpenTelemetry Collector を開発する</h1><h2 id=configuration-の構築>Configuration の構築</h2><p>コンポーネントの Configuration 部分は、ユーザーがコンポーネントに対する入力を行う方法であり、設定に使用される値は以下のようである必要があります：</p><ol><li>そのフィールドが何を制御するのか、ユーザーが直感的に理解できる</li><li>必須項目とオプション項目が明確である</li><li>共通の名前とフィールドを再利用する</li><li>オプションをシンプルに保つ</li></ol><div class=tab-panel data-tab-group=4c730ec368cfa269775e069ec091ee86><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=良い-config class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("4c730ec368cfa269775e069ec091ee86","良い-config")'>
<span class=tab-nav-text>良い config</span></button>
<button data-tab-item=悪い-config class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("4c730ec368cfa269775e069ec091ee86","悪い-config")'>
<span class=tab-nav-text>悪い config</span></button></div><div class=tab-content-container><div data-tab-item=良い-config class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Required Values</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=l>http://my-jenkins-server:8089</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>auth</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>authenticator</span><span class=p>:</span><span class=w> </span><span class=l>basicauth/jenkins</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Optional Values</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.3</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.4</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div></div></div><div data-tab-item=悪い-config class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jenkins_server_addr</span><span class=p>:</span><span class=w> </span><span class=l>hostname</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jenkins_server_api_port</span><span class=p>:</span><span class=w> </span><span class=m>8089</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=l>10m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>filter_builds_by</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>my-awesome-build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>status</span><span class=p>:</span><span class=w> </span><span class=l>amber</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>track</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.1</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.2</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.3</span><span class=p>:</span><span class=w> </span><span class=kc>no</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.4</span><span class=p>:</span><span class=w> </span><span class=kc>no</span></span></span></code></pre></div></div></div></div></div><p>悪い例では、Configuration のベストプラクティスに反するとコンポーネントが使いにくくなってしまうことが理解できるはずです。
フィールドの値が何であるべきかを明確ではなく、既存のプロセッサーに移譲できる機能を含み、コレクター内の他のコンポーネントと比較してフィールドの命名に一貫性がありません。</p><p>良い例では、必要な値をシンプルに保ち、他のコンポーネントからのフィールド名を再利用し、コンポーネントが Jenkins とコレクター間の相互作用にのみ焦点を当てています。</p><p>設定値の中には、このコンポーネントで独自に追加するものと、コレクター内部の共有ライブラリによって提供されているものがあります。これらはビジネスロジックに取り組む際にさらに詳しく説明します。Configuration は小さく始めるべきで、ビジネスロジックに追加の機能が必要になったら、設定も追加していきましょう。</p><h2 id=コードを書く>コードを書く</h2><p>Configuration に必要なコードを実装するために、<code>config.go</code> という名前の新しいファイルを以下の内容で作成します：</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// HTTPClientSettings contains all the values
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that are commonly shared across all HTTP interactions
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// performed by the collector.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>confighttp</span><span class=p>.</span><span class=nx>HTTPClientSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ScraperControllerSettings will allow us to schedule 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// how often to check for updates to builds.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// MetricsBuilderConfig contains all the metrics
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that can be configured.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-を開発する>OpenTelemetry Collector を開発する</h1><h2 id=コンポーネントを検討する>コンポーネントを検討する</h2><p>Jenkinsからメトリクスを取得するために必要なコンポーネントの種類をおさらいしましょう：</p><div class=tab-panel data-tab-group=07a78af2cb10791d7d560b7b1635cab3><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=エクステンション class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("07a78af2cb10791d7d560b7b1635cab3","エクステンション")'>
<span class=tab-nav-text>エクステンション</span></button>
<button data-tab-item=レシーバー class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("07a78af2cb10791d7d560b7b1635cab3","レシーバー")'>
<span class=tab-nav-text>レシーバー</span></button>
<button data-tab-item=プロセッサー class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("07a78af2cb10791d7d560b7b1635cab3","プロセッサー")'>
<span class=tab-nav-text>プロセッサー</span></button>
<button data-tab-item=エクスポーター class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("07a78af2cb10791d7d560b7b1635cab3","エクスポーター")'>
<span class=tab-nav-text>エクスポーター</span></button>
<button data-tab-item=ninja-コネクター class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("07a78af2cb10791d7d560b7b1635cab3","ninja-コネクター")'>
<span class=tab-nav-text><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> コネクター</span></span></span></button></div><div class=tab-content-container><div data-tab-item=エクステンション class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p>エクステンションが解決するビジネスユースケースは以下の通りです：</p><ol><li>実行時の設定が必要な共有機能を持つ</li><li>コレクターの実行時間の観察に間接的に役立つ</li></ol><p>詳細については、<a href=../ja/other/opentelemetry-collector/2-extensions/index.html>エクステンションの概要</a>を参照してください。</p></div></div><div data-tab-item=レシーバー class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>レシーバーが解決するビジネスユースケースは以下の通りです：</p><ul><li>リモートソースからのデータの取得</li><li>リモートソースからのデータの受信</li></ul><p>これらは一般的に <em>pull</em> 対 <em>push</em> ベースのデータ収集と呼ばれ、詳細については<a href=../ja/other/opentelemetry-collector/3-receivers/index.html>レシーバーの概要</a>で読むことができます。</p></div></div><div data-tab-item=プロセッサー class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>プロセッサーが解決するビジネスユースケースは以下の通りです：</p><ul><li>データ、フィールド、または値の追加または削除</li><li>データの観察と意思決定</li><li>バッファリング、キューイング、および並べ替え</li></ul><p>プロセッサーを通過するデータタイプは、下流のコンポーネントに同じデータタイプを転送する必要があることを覚えておいてください。
詳細については、<a href=../ja/other/opentelemetry-collector/4-processors/index.html>プロセッサーの概要</a>をご覧ください。</p></div></div><div data-tab-item=エクスポーター class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>エクスポーターが解決するビジネスユースケースは以下の通りです：</p><ul><li>データをツール、サービス、またはストレージに送信する</li></ul><p>OpenTelemetryコレクターは「バックエンド」、すべてを一元化した観測可能性スイートを目指すのではなく、OpenTelemetryの創設原則に忠実であり続けることを目指しています。つまり、ベンダーに依存しない全ての人のための観測可能性です。詳細については、<a href=../ja/other/opentelemetry-collector/5-exporters/index.html>エクスポーターの概要</a>をお読みください。</p></div></div><div data-tab-item=ninja-コネクター class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>コネクターは比較的新しいコンポーネントで、このワークショップではあまり触れていません。
コネクターは、異なるテレメトリタイプやパイプラインをまたいで使用できるプロセッサーのようなものだといえます。たとえば、コネクターはログとしてデータを受け取り、メトリクスとして出力したり、あるパイプラインからメトリクスを受け取り、テレメトリーデータに関するメトリクスを提供したりすることができます。</p><p>コネクターが解決するビジネスケースは以下の通りです：</p><ul><li>異なるテレメトリタイプ間の変換<ul><li>ログからメトリクスへ</li><li>トレースからメトリクスへ</li><li>メトリクスからログへ</li></ul></li><li>受信したデータを観察し、自身のデータを生成する<ul><li>メトリクスを受け取り、データの分析メトリクスを生成する。</li></ul></li></ul><p><strong>Ninja</strong>セクションの一部として<a href=../ja/other/opentelemetry-collector/4-processors/index.html>プロセッサーの概要</a>内で簡単に概要が説明されています。</p></div></div></div></div><p>これらのコンポーネントについて考えると、Jenkins に対応する場合はプルベースのレシーバーを開発する必要があることがわかります。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-を開発する>OpenTelemetry Collector を開発する</h1><h3 id=メトリクスを設計する>メトリクスを設計する</h3><p>レシーバーによってキャプチャされるメトリクスを定義し、エクスポートするために、コレクターのために開発された <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/cmd/mdatagen target=_blank>mdatagen</a> を使って、yaml で定義したメトリクスをコードに変換していきます。</p><div class=tab-panel data-tab-group=c1f0655667c5469f6c2d5fbb5951a437><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=metadatayaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("c1f0655667c5469f6c2d5fbb5951a437","metadatayaml")'>
<span class=tab-nav-text>metadata.yaml</span></button>
<button data-tab-item=gengo class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("c1f0655667c5469f6c2d5fbb5951a437","gengo")'>
<span class=tab-nav-text>gen.go</span></button></div><div class=tab-content-container><div data-tab-item=metadatayaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Type defines the name to reference the component</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># in the configuration file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>jenkins</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Status defines the component type and the stability level</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>class</span><span class=p>:</span><span class=w> </span><span class=l>receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stability</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>development</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>metrics]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Attributes are the expected fields reported</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># with the exported values.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>job.name</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>The name of the associated Jenkins job</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>job.status</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Shows if the job had passed, or failed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enum</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>failed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>success</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>unknown</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Metrics defines all the pontentially exported values from this receiver. </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.jobs.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Provides a count of the total number of configured jobs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{Count}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.job.duration</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Show the duration of the job</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;s&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.status</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.job.commit_delta</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>The calculation difference of the time job was finished minus commit timestamp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;s&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.status</span></span></span></code></pre></div></div></div><div data-tab-item=gengo class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// To generate the additional code needed to capture metrics, 
</span></span></span><span class=line><span class=cl><span class=c1>// the following command to be run from the shell:
</span></span></span><span class=line><span class=cl><span class=c1>//  go generate -x ./...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>//go:generate go run github.com/open-telemetry/opentelemetry-collector-contrib/cmd/mdatagen@v0.80.0 metadata.yaml
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// There is no code defined within this file.
</span></span></span></code></pre></div></div></div></div></div><p>次のセクションに進む前に、これらのファイルをプロジェクトフォルダ内に作成してください。</p><h2 id=factory-の構築>Factory の構築</h2><p>Factory はソフトウェアデザインパターンの一種で、提供された Configuration を使って、動的にオブジェクト（この場合は <code>jenkinscireceiver</code>）を作成するものです。現実的な例では、携帯電話店に行って、あなたの正確な説明に合った携帯電話を求め、それを提供されるようなものです。</p><p>コマンド <code>go generate -x ./...</code> を実行すると、定義されたメトリクスをエクスポートするために必要なすべてのコードを含む新しいフォルダ <code>jenkinscireceiver/internal/metadata</code> が作成されます。生成されるコードは以下の通りです：</p><div class=tab-panel data-tab-group=75e0cfa448547270bae3f88553270c1f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=factorygo class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("75e0cfa448547270bae3f88553270c1f","factorygo")'>
<span class=tab-nav-text>factory.go</span></button>
<button data-tab-item=configgo class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("75e0cfa448547270bae3f88553270c1f","configgo")'>
<span class=tab-nav-text>config.go</span></button>
<button data-tab-item=scrapergo class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("75e0cfa448547270bae3f88553270c1f","scrapergo")'>
<span class=tab-nav-text>scraper.go</span></button>
<button data-tab-item=build-configyaml class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("75e0cfa448547270bae3f88553270c1f","build-configyaml")'>
<span class=tab-nav-text>build-config.yaml</span></button>
<button data-tab-item=project-layout class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("75e0cfa448547270bae3f88553270c1f","project-layout")'>
<span class=tab-nav-text>project layout</span></button></div><div class=tab-content-container><div data-tab-item=factorygo class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;errors&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/component&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewFactory</span><span class=p>()</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>Factory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>receiver</span><span class=p>.</span><span class=nf>NewFactory</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>newDefaultConfig</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>receiver</span><span class=p>.</span><span class=nf>WithMetrics</span><span class=p>(</span><span class=nx>newMetricsReceiver</span><span class=p>,</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsStability</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newMetricsReceiver</span><span class=p>(</span><span class=nx>_</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>,</span> <span class=nx>cfg</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>consumer</span> <span class=nx>consumer</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>)</span> <span class=p>(</span><span class=nx>receiver</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Convert the configuration into the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>conf</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>cfg</span><span class=p>.(</span><span class=o>*</span><span class=nx>Config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>!</span><span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;can not convert config&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>sc</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>conf</span><span class=p>,</span> <span class=nx>set</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraperControllerReceiver</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=o>&amp;</span><span class=nx>conf</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>set</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>consumer</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>AddScraper</span><span class=p>(</span><span class=nx>sc</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=configgo class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// HTTPClientSettings contains all the values
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that are commonly shared across all HTTP interactions
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// performed by the collector.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>confighttp</span><span class=p>.</span><span class=nx>HTTPClientSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ScraperControllerSettings will allow us to schedule 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// how often to check for updates to builds.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// MetricsBuilderConfig contains all the metrics
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that can be configured.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newDefaultConfig</span><span class=p>()</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Config</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>&amp;</span><span class=nx>Config</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ScraperControllerSettings</span><span class=p>:</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewDefaultScraperControllerSettings</span><span class=p>(</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>HTTPClientSettings</span><span class=p>:</span>        <span class=nx>confighttp</span><span class=p>.</span><span class=nf>NewDefaultHTTPClientSettings</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>MetricsBuilderConfig</span><span class=p>:</span>      <span class=nx>metadata</span><span class=p>.</span><span class=nf>DefaultMetricsBuilderConfig</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=scrapergo class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>scraper</span> <span class=kd>struct</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>cfg</span> <span class=o>*</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>)</span> <span class=p>(</span><span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>Scraper</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Create a our scraper with our values 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span> <span class=o>:=</span> <span class=nx>scraper</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// To be filled in later
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraper</span><span class=p>(</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span> <span class=nx>s</span><span class=p>.</span><span class=nx>scrape</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nx>pmetrics</span><span class=p>.</span><span class=nf>NewMetrics</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=build-configyaml class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>dist</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otelcol</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Conf workshop collector&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>output_path</span><span class=p>:</span><span class=w> </span><span class=l>./dist</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=l>v0.0.0-experimental</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/basicauthextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/healthcheckextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/receiver/otlpreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/jaegerreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/prometheusreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>splunk.conf/workshop/example/jenkinscireceiver v0.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./jenkinscireceiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/batchprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/loggingexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlphttpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># This replace is a go directive that allows for redefine</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># where to fetch the code to use since the default would be from a remote project.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>replaces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=l>splunk.conf/workshop/example/jenkinscireceiver =&gt; ./jenkinscireceiver</span></span></span></code></pre></div></div></div><div data-tab-item=project-layout class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>├── build-config.yaml
</span></span><span class=line><span class=cl>└── jenkinscireceiver
</span></span><span class=line><span class=cl>    ├── go.mod
</span></span><span class=line><span class=cl>    ├── config.go
</span></span><span class=line><span class=cl>    ├── factory.go
</span></span><span class=line><span class=cl>    ├── scraper.go
</span></span><span class=line><span class=cl>    └── internal
</span></span><span class=line><span class=cl>      └── metadata</span></span></code></pre></div></div></div></div></div><p>これらのファイルがプロジェクトに作成されたら、<code>go mod tidy</code> を実行します。すると、すべての依存ライブラリが取得され、<code>go.mod</code> が更新されます。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-を開発する>OpenTelemetry Collector を開発する</h1><h2 id=ビジネスロジックを作る>ビジネスロジックを作る</h2><p>この時点では、何も行っていないカスタムコンポーネントが作成されています。ここから、Jenkins からデータを取得するための必要なロジックを追加していきましょう。</p><p>ここからのステップは以下の通りです：</p><ol><li>Jenkinsに接続するクライアントを作成する</li><li>設定されたすべてのジョブをキャプチャする</li><li>設定されたジョブの最後のビルドのステータスを報告する</li><li>コミットタイムスタンプとジョブ完了の時間差を計算する</li></ol><p>変更を <code>scraper.go</code> に加えていきます。</p><div class=tab-panel data-tab-group=d30001663675f7b79d18c1888102468d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=jenkins-クライアントを追加する class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("d30001663675f7b79d18c1888102468d","jenkins-クライアントを追加する")'>
<span class=tab-nav-text><ol><li>Jenkins クライアントを追加する</li></ol></span></button>
<button data-tab-item=ジョブをキャプチャする class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("d30001663675f7b79d18c1888102468d","ジョブをキャプチャする")'>
<span class=tab-nav-text><ol start=2><li>ジョブをキャプチャする</li></ol></span></button>
<button data-tab-item=ジョブの状態を報告する class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("d30001663675f7b79d18c1888102468d","ジョブの状態を報告する")'>
<span class=tab-nav-text><ol start=3><li>ジョブの状態を報告する</li></ol></span></button>
<button data-tab-item=差分を報告する class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("d30001663675f7b79d18c1888102468d","差分を報告する")'>
<span class=tab-nav-text><ol start=4><li>差分を報告する</li></ol></span></button></div><div class=tab-content-container><div data-tab-item=jenkins-クライアントを追加する class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p>Jenkinsサーバーに接続するために、パッケージ <a href=https://pkg.go.dev/github.com/yosida95/golang-jenkins target=_blank>&ldquo;github.com/yosida95/golang-jenkins&rdquo;</a> を使用します。これには、Jenkinsサーバーからデータを読み取るために必要な機能が提供されています。</p><p>次に、<a href=https://pkg.go.dev/go.opentelemetry.io/collector/receiver/scraperhelper target=_blank>&ldquo;go.opentelemetry.io/collector/receiver/scraperhelper&rdquo;</a> ライブラリのいくつかのヘルパー関数を利用して、コンポーネントの起動が完了したらJenkinsサーバーに接続できるようにするスタート関数を作成します。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>jenkins</span> <span class=s>&#34;github.com/yosida95/golang-jenkins&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/component&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/pdata/pmetric&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>scraper</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>mb</span>     <span class=o>*</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilder</span>
</span></span><span class=line><span class=cl>    <span class=nx>client</span> <span class=o>*</span><span class=nx>jenkins</span><span class=p>.</span><span class=nx>Jenkins</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>cfg</span> <span class=o>*</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>)</span> <span class=p>(</span><span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>Scraper</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>scraper</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>mb</span> <span class=p>:</span> <span class=nx>metadata</span><span class=p>.</span><span class=nf>NewMetricsBuilder</span><span class=p>(</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span><span class=p>,</span> <span class=nx>set</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraper</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>scrape</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>WithStart</span><span class=p>(</span><span class=kd>func</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>h</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Host</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>client</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>cfg</span><span class=p>.</span><span class=nf>ToClient</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>set</span><span class=p>.</span><span class=nx>TelemetrySettings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=c1>// The collector provides a means of injecting authentication
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// on our behalf, so this will ignore the libraries approach
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// and use the configured http client with authentication.
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>s</span><span class=p>.</span><span class=nx>client</span> <span class=p>=</span> <span class=nx>jenkins</span><span class=p>.</span><span class=nf>NewJenkins</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>Endpoint</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>SetHTTPClient</span><span class=p>(</span><span class=nx>client</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nf>NewMetrics</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>これで、Jenkinsレシーバーを初期化するために必要なすべてのコードが完成しました。</p></div></div><div data-tab-item=ジョブをキャプチャする class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>ここから先は、実装が必要な <code>scrape</code> メソッドに焦点を当てます。このメソッドは、設定された間隔（デフォルトでは1分）ごとに実行されます。</p><p>Jenkins サーバーの負荷状況や、どの程度のプロジェクトが実行されているかを測定するために、Jenkins で設定されているジョブの数をキャプチャしたいと考えています。これを行うために、Jenkins クライアントを呼び出してすべてのジョブをリスト化し、エラーが報告された場合はメトリクスなしでそれを返し、そうでなければメトリクスビルダーからのデータを発行します。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// all captured data points within this scrape have the same value. 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=ジョブの状態を報告する class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>前のステップにより、すべてのジョブをキャプチャしてジョブの数をレポートできるようになりました。
このステップでは、それぞれのジョブを調査し、レポートされた値を使用してメトリクスをキャプチャしていきます。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// all captured data points within this scrape have the same value. 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>job</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>jobs</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure we have valid results to start off with
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>build</span>  <span class=p>=</span> <span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// This will check the result of the job, however,
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// since the only defined attributes are 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// `success`, `failure`, and `unknown`. 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// it is assume that anything did not finish 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// with a success or failure to be an unknown status.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=nx>build</span><span class=p>.</span><span class=nx>Result</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;aborted&#34;</span><span class=p>,</span> <span class=s>&#34;not_built&#34;</span><span class=p>,</span> <span class=s>&#34;unstable&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;success&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusSuccess</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;failure&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusFailed</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobDurationDataPoint</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>now</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>int64</span><span class=p>(</span><span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span><span class=p>.</span><span class=nx>Duration</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>job</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=差分を報告する class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>最後のステップでは、コミットからジョブ完了までにかかった時間を計算して、<a href=https://cloud.google.com/blog/products/devops-sre/using-the-four-keys-to-measure-your-devops-performance target=_blank>DORA メトリクス</a> を推測するのに役立てていきます。</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// all captured data points within this scrape have the same value. 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>job</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>jobs</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure we have valid results to start off with
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>build</span>  <span class=p>=</span> <span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Previous step here
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure that the `ChangeSet` has values
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// set so there is a valid value for us to reference
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>build</span><span class=p>.</span><span class=nx>ChangeSet</span><span class=p>.</span><span class=nx>Items</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Making the assumption that the first changeset
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// item is the most recent change.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>change</span> <span class=o>:=</span> <span class=nx>build</span><span class=p>.</span><span class=nx>ChangeSet</span><span class=p>.</span><span class=nx>Items</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Record the difference from the build time
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// compared against the change timestamp.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobCommitDeltaDataPoint</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>now</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>int64</span><span class=p>(</span><span class=nx>build</span><span class=p>.</span><span class=nx>Timestamp</span><span class=o>-</span><span class=nx>change</span><span class=p>.</span><span class=nx>Timestamp</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>job</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>これらのステップがすべて完了すると、Jenkins CI レシーバーが完成します！</p><h2 id=次は何をするの>次は何をするの？</h2><p>コンポーネントに必要な機能は、おそらく他にもたくさん思いつくでしょう。例えば：</p><ul><li>ジョブで使用されたブランチ名を含めることはできますか？</li><li>ジョブのプロジェクト名を含めることはできますか？</li><li>プロジェクトのジョブの総持続時間をどのように計算しますか？</li><li>変更が機能するかどうかをどのように検証しますか？</li></ul><p>この時間を使って遊んでみたり、壊してみたり、変更してみたり、ビルドからのログをキャプチャしてみるなどしてください。</p><footer class=footline></footer></article></section></section></section><article class=default><header class=headline></header><h1 id=その他のリソース>その他のリソース</h1><div class="children children-h3 children-sort-"><h3><a href=../ja/resources/faq/index.html>よくある質問とその回答</a></h3><p>オブザーバビリティ、DevOps、インシデント対応、Splunk On-Callに関連する一般的な質問とその回答を集めました。</p><h3><a href=../ja/resources/dimensions_properties_tags/index.html>ディメンション、プロパティ、タグ</a></h3><p>ディメンションとプロパティの比較で、どちらかを使うべきかというのはよく議論されます。</p><h3><a href=../ja/resources/otel_tagging/index.html>OpenTelemetryとSplunkにおける、タグ付けのための命名規則</a></h3><p>大規模な組織で OpenTelemetry を展開する際には、タグ付けのための標準化された命名規則を定義し、規則が遵守されるようにガバナンスプロセスを確立することが重要です。</p></div><footer class=footline></footer></article><section><h1 class=a11y-only>その他のリソースのサブセクション</h1><article class=default><header class=headline></header><h1 id=よくある質問とその回答>よくある質問とその回答</h1><p>オブザーバビリティ、DevOps、インシデント対応、Splunk On-Callに関連する一般的な質問とその回答を集めました。</p><h2 id=q-アラートとインシデント対応インシデント管理の違いは>Q: アラートとインシデント対応、インシデント管理の違いは？</h2><p>A: アラート、インシデント対応、インシデント管理は関連する機能です。これらは一緒にインシデント対応および解決プロセスを構成します。</p><p>モニタリングやオブザーバビリティのツールはインシデント対応プラットフォームにアラートを送信します。これらのプラットフォームはアラートのコレクションを収集し、それらをインシデントとして相関させます。</p><p>これらのインシデントは記録のためにインシデント管理（ITSM）プラットフォームに記録されます。アラートは何かが起こったことを示すトリガーであり、インシデントへのコンテキストを提供します。</p><p>インシデントには、アラートの内容、インシデントが作成されてから関連するすべての活動、およびフォローされるオンコールポリシーが含まれます。ITSMは、インシデントがアクティブであるときおよび解決された後のインシデントを記録するシステムです。</p><p>インシデント対応および管理をより良く実践するために、これらのコンポーネントが必要になります。</p><span class="btn cstyle transparent"><span><span class=title>On-Call</span></span></span><h2 id=q-オブザーバビリティはモニタリングとは違うものですか>Q: オブザーバビリティはモニタリングとは違うものですか？</h2><p>A: モニタリングとオブザーバビリティの主な違いは、「既知の未知」と「未知の未知」の違いです。</p><p>モニタリングでは、オペレーターは通常、システムのアーキテクチャと要素に関する事前の知識を持っています。彼らは要素間の関係とそれに関連するメタデータを確実に予測することができます。モニタリングは、頻繁に変更されない状態のインフラストラクチャに適しています。</p><p>オブザーバビリティは、オペレーターがシステム内のすべての要素とそれらの関係を予測し、追跡する能力が限定されているシステム向けです。</p><p>オブザーバビリティは、従来のメトリクスのモニタリングを含む一連のプラクティスと技術です。</p><p>これらのプラクティスと技術を組み合わせることで、オペレーターはシステムのすべての要素に関する事前の知識がなくても、頻繁に変更がある複雑な環境を理解することができます。オブザーバビリティ技術は、環境の変動やメタデータの変化（カーディナリティ）を従来のモニタリングよりもよく考慮できるため、より静的なモニタリングと比較して優れています。</p><span class="btn cstyle transparent"><span><span class=title>Observability</span></span></span><h2 id=q-トレースとスパンとは何ですか>Q: トレースとスパンとは何ですか？</h2><p>A: トレースとスパンは、メトリクスとログと共に、現代のオブザーバビリティツールにフィードされるコアタイプのデータを構成します。それらは特定の要素と機能を持っていますが、一緒にうまく機能します。</p><p>マイクロサービスベースのアーキテクチャは分散しているため、システム内のトランザクションは完了する前に複数のサービスにアクセスします。これにより、問題の場所を正確に特定することが困難になります。トレースは、分散システム内のすべてのサービスを通るリクエストの完全なパスを追跡するための方法です。スパンは、各サービスでの時間のかかる操作です。トレースはスパンの結合したものであり、一緒になると個々のサービスプロセスについてより詳細な情報を提供します。メトリクスはシステムの健康状態の良いスナップショットを提供し、ログは問題を調査する際に深さを提供しますが、トレースとスパンはオペレーターに問題の源泉をより多くのコンテキストでナビゲートするのに役立ちます。これにより、インシデントの調査にかかる時間が節約され、現代のアーキテクチャの複雑さがサポートされます。</p><span class="btn cstyle transparent"><span><span class=title>APM</span></span></span><h2 id=q-サイドカーパターンとは何ですか>Q: サイドカーパターンとは何ですか？</h2><p>A: サイドカーパターンは、関連するサービスをインフラストラクチャによって直接接続するためのデザインパターンです。関連するサービスは、接続されているアプリケーションロジックに機能を追加したりサポートしたりすることができます。これは、管理計画に関連するエージェントをアプリケーションサービスと共に展開する方法として広く使用されます。</p><p>オブザーバビリティでは、サイドカーサービスはアプリケーションロジックであり、そのサービスからデータを収集するエージェントです。このセットアップには、アプリケーションサービスを含むコンテナと、エージェントを実行するコンテナの2つが必要です。コンテナはポッドを共有し、ディスク、ネットワーク、名前空間などのリソースを共有します。また、一緒にデプロイされ、同じライフサイクルを共有します。</p><span class="btn cstyle transparent"><span><span class=title>Observability</span></span></span><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=ディメンションプロパティタグ>ディメンション、プロパティ、タグ</h1><h2 id=メトリクスにコンテキストを与える>メトリクスにコンテキストを与える</h2><p>ディメンションとプロパティの違いや、どちらを使うべきかというのは、よく話題にされます。それぞれの説明から始めるのではなく、私たちがどのように使い、どのように似ているのかを理解してから、それぞれの違いや、なぜどちらかを使うのかの例を見ていくことにしましょう。</p><h2 id=ディメンションとプロパティの類似点>ディメンションとプロパティの類似点</h2><p>最も単純な答えは、ディメンションとプロパティはともに、メトリクスにコンテキスト（状況）を追加するメタデータの <code>key:value</code> ペアであるということです。メトリクス自体は、<code>cpu.utilization</code> のような標準的なインフラストラクチャメトリクスであろうと、API呼び出しの回数のようなカスタムメトリクスであろうと、実際に測定しているものなら全てに当てはまります。</p><p><code>cpu.utilization</code> メトリクスの値が50%であっても、それがどこから来たのかなどのコンテキストを知らなければ、それは単なる数字であり、私たちにとって有用ではありません。少なくとも、どのホストから来たのかを知る必要があります。</p><p>現在では、個々のホストのパフォーマンスや利用率よりも、クラスターやデータセンター全体のパフォーマンスや利用率をより気にすることが多く、ホストのクラスター全体の平均 <code>cpu.utilization</code>、あるホストの <code>cpu.utilization</code> が同じサービスを実行する他のホストと比べて外れ値である場合、あるいは環境間での平均 <code>cpu.utilization</code> を比較することに興味を持っています。</p><p>このように <code>cpu.utilization</code> メトリクスをスライス、集約、またはグループ化するためには、受け取る <code>cpu.utilization</code> メトリクスのメタデータに、ホストが属するクラスター、ホスト上で実行されているサービス、およびそれが属する環境などの情報が必要です。このメタデータは、ディメンションまたはプロパティの <code>key:value</code> ペアの形で存在することができます。</p><p>例えば、ダッシュボードでフィルターを適用したり、分析関数を実行する際にグループ化機能を使用したりするとき、プロパティまたはディメンションを使用することができます。</p><h2 id=ではディメンションとプロパティはどう違うの>では、ディメンションとプロパティはどう違うの？</h2><p>ディメンションはメトリクスと共に取り込み時に送信されるのに対し、プロパティは取り込み後にメトリクスやディメンションに適用されます。これは、`cpu.utilization`` の値がどのホストから来ているかのような、データポイント（メトリクスの単一の報告値）をユニークにするために必要なメタデータはディメンションでなければならないことを意味します。メトリクス名 + ディメンションは MTS（メトリクスの時間系列）をユニークに定義します。</p><p>例：特定のホスト（server1）によって送信される <code>cpu.utilization</code> メトリクスで、ディメンション <code>host:server1</code> があれば、それはユニークな時間系列と見なされます。もし 10 台のサーバーがそのメトリクスを送信していれば、メトリクス名 <code>cpu.utilization</code> を共有し、ディメンションのキー値ペア（host:server1, host:server2&mldr;host:server10）でユニークに識別される 10 の時間系列があります。</p><p>しかし、サーバー名がデータセンター内でのみユニークである場合、データセンターの場所を示す 2 番目のディメンション dc を追加する必要があります。これにより、可能な MTS の数は倍になります。受信された <code>cpu.utilization</code> メトリクスは、2 組のディメンションのキー値ペアによってユニークに識別されます。</p><p><code>cpu.utilization</code> に <code>dc:east</code> と <code>host:server1</code> を加えたものは、<code>cpu.utilization</code> に <code>dc:west</code> と <code>host:server1</code> を加えたものとは異なる時間系列を作り出します。</p><h2 id=ディメンションは不変だがプロパティは可変である>ディメンションは不変だが、プロパティは可変である</h2><p>上記で述べたように、メトリクス名 + ディメンションの組み合わせで、ユニークな MTS を作ります。したがって、ディメンションの値が変わると、メトリクス名 + ディメンション値の新しいユニークな組み合わせが生まれ、新しい MTS が作成されます。</p><p>一方、プロパティはメトリクス（またはディメンション）が取り込まれた後に適用されます。メトリクスにプロパティを適用すると、そのメトリクスが属するすべての MTS に伝播して適用されます。または、ディメンションにプロパティを適用する場合、例えば <code>host:server1</code> とすると、そのホストからのすべてのメトリクスにそのプロパティが添付されます。プロパティの値を変更すると、そのプロパティが添付されているすべての MTS のプロパティ値が更新されます。これが重要な理由は何でしょうか？ プロパティの歴史的な値にこだわる場合、それをディメンションにする必要があることを意味しています。</p><p>例：私たちはアプリケーションに関するカスタムメトリクスを収集しています。1つのメトリクスは <code>latency</code> で、アプリケーションへのリクエストのレイテンシーをカウントします。顧客ごとにレイテンシーを分類して比較できるように <code>customer</code> ディメンションを持っています。私たちは、顧客が使用しているバージョン別にアプリケーションの <code>latency</code> を分類して比較したいと考え、プロパティ <code>version</code> を <code>customer</code> ディメンションに添付しました。最初はすべての顧客がアプリケーションバージョン1を使用しているので、<code>version:1</code> です。</p><p>現在、いくつかの顧客がアプリケーションのバージョン2を使用しているため、それらの顧客に対してプロパティを <code>version:2</code> に更新します。これらの顧客の <code>version</code> プロパティの値を更新すると、その顧客に関連するすべての MTS に伝播します。これにより、これらの顧客が以前に <code>version:1</code> を使用していたという歴史が失われるため、歴史的な期間にわたって <code>version:1</code> と <code>version:2</code> の <code>latency</code> を比較する場合、正確なデータを得ることはできません。この場合、メトリクスの時間系列をユニークにするためにアプリケーションの <code>version</code> が必要ではないかもしれませんが、歴史的な値にこだわるために <code>version</code> をディメンションにする必要があります。</p><h2 id=結局いつディメンションじゃなくてプロパティを使うの>結局、いつ、ディメンションじゃなくてプロパティを使うの？</h2><p>メトリクスに添付したいメタデータがあるが、取り込み時にはそれを知らない場合が第一の理由です。第二の理由は、ベストプラクティスとして、ディメンションである必要がなければ、それをプロパティにすることです。なぜでしょうか？</p><p>一つの理由は、現在、分析ジョブやチャートレンダリングあたりの MTS の上限が 5K であり、ディメンションが多いほど多くの MTS を生成することです。プロパティは完全に自由形式であり、MTS の数を増やすことなく、メトリクスやディメンションに必要な情報を追加することができます。</p><p>ディメンションは各データポイントと共に送信されるため、ディメンションが多いほど、より多くのデータを送信することになります。これは、クラウドプロバイダーがデータ転送に料金を請求する場合、コストが高くなる可能性があります。</p><p>プロパティを使う良い例としては、ホスト情報の追加などがあります。 <code>machine_type</code>, <code>processor</code>, <code>os</code> などの情報を確認することが重要ですが、これらをディメンションとして設定し、各ホストからのすべてのメトリクスと共に送信するのではなく、プロパティとして設定し、ホストディメンションに添付することができます。</p><p>例えば <code>host:server1</code> では、プロパティ <code>machine_type:ucs</code>, <code>processor:xeon-5560</code>, <code>os:rhel71</code> を設定します。<code>host:server1</code> というディメンションを持つメトリクスが入ってくるたびに、上記のすべてのプロパティが自動的に適用されます。</p><p>プロパティの使用例としては、各サービスのエスカレーション連絡先や、各顧客の SLA レベルを知りたい場合があります。これらの項目は、メトリクスをユニークに識別するために必要ではなく、歴史的な値にも関心がないため、プロパティにすることができます。プロパティはサービスディメンションや顧客ディメンションに追加され、これらのディメンションを持つすべてのメトリクスや MTS に適用されます。</p><h2 id=タグについてはどうですか>タグについてはどうですか？</h2><p>タグは、メトリクスにコンテキストを与えたり整理するのに使われる、メタデータの 3 番目のタイプです。ディメンションやプロパティとは異なり、タグは <code>key:value</code> ペアではありません。タグはラベルやキーワードとして考えることができます。プロパティと同様に、タグは取り込み後に UI の Catalog や API を通じてプログラム的にデータに適用されます。タグはメトリクス、ディメンション、ディテクターなどの他のオブジェクトに適用することができます。</p><h2 id=タグを使う場面はどこですか>タグを使う場面はどこですか？</h2><p>タグが必要とされるのは、タグとオブジェクトの間に多対一の関係がある場合や、タグとそれに適用されるオブジェクト間に一対多の関係がある場合です。本質的に関連していないメトリクスをまとめるのに役立ちます。</p><p>例として、複数のアプリケーションを実行しているホストがある場合です。各アプリケーションに対してタグ（ラベル）を作成し、それぞれのホストに複数のタグを適用して、その上で実行されているアプリケーションをラベル付けします。</p><p>例：Server1 は 3 つのアプリケーションを実行しています。タグ <code>app1</code>, <code>app2</code>, <code>app3</code> を作成し、ディメンション <code>host:server1</code> にこれら 3 つのタグをすべて適用します。</p><p>上記の例を拡張すると、アプリケーションからのメトリクスも収集しているとします。作成したタグを、アプリケーション自体から来るメトリクスに適用することができます。タグに基づいてフィルタリングすることで、アプリケーションに基づいてフィルタリングしながら、アプリケーションと関連するホストメトリクスの全体像を得ることができます。</p><p>例：App1 は <code>service:application1</code> というディメンションでメトリクスを送信します。<code>service:application1</code> のディメンションにタグ <code>app1</code> を適用します。その後、チャートやダッシュボードでタグ <code>app1</code> でフィルタリングすることができます。</p><p>タグの他の使用例には、単一の可能な値を持つ二進状態があります。例として、カナリアテストを行い、カナリアデプロイを行った際に新しいコードを受け取ったホストをマークして、新しいコードを受け取らなかったホストとのパフォーマンスを比較しやすくすることがあります。単一の値 <code>canary</code> しかないため、<code>key:value</code> ペアは必要ありません。</p><p>ただし、タグでフィルタリングはできますが、groupBy 関数では使用できないことに注意してください。groupBy 関数は <code>key:value</code> ペアのキー部分を指定して実行され、そのキーの値に基づいて結果がグループ化されます。</p><h2 id=さらなる情報>さらなる情報</h2><p>カスタムメトリクスのディメンションを送信する方法に関する情報については、お使いのライブラリに関するクライアントライブラリのドキュメントをご覧ください。</p><p>API を通じてメトリクスやディメンションにプロパティやタグを適用する方法については、 <code>/metric/:name</code>、<code>/dimension/:key/:value</code> に関する API ドキュメントを参照してください。</p><p>UI のメタデータカタログでプロパティやタグを追加または編集する方法については、<a href=https://docs.splunk.com/Observability/metrics-and-metadata/metrics-finder-metadata-catalog.html#use-the-metadata-catalog target=_blank>Search the Metric Finder and Metadata catalog</a>で、<strong>​Add or edit metadata</strong> セクションをご覧ください。</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetryとsplunkにおけるタグ付けのための命名規則>OpenTelemetryとSplunkにおける、タグ付けのための命名規則</h1><h2 id=はじめに>はじめに</h2><p>大規模な組織で OpenTelemetry を展開する際には、タグ付けのための標準化された命名規則を定義し、その規則が遵守されるようにガバナンスプロセスを設定することが非常に重要です。</p><p>これにより、OpenTelemetry を通じて収集される MELT データ（メトリクス、イベント、ログ、トレース）を、アラート、ダッシュボード作成、トラブルシューティングの目的で効率的に活用することが可能になります。また、Splunk Observability Cloud のユーザーが探しているデータを迅速に見つけることができます。</p><p>命名規則はまた、データを効果的に集約するためにも重要です。例えば、環境ごとのユニークなホストの数を数えたい場合、ホスト名と環境名を捉えるための標準化された規則を使用する必要があります。</p><h2 id=属性-vs-タグ>属性 vs タグ</h2><p>先に進む前に、用語についての注意をしておきましょう。OpenTelemetry の「タグ」は「属性（attribute）」と呼ばれます。属性は、手動または自動の計装を通じて、メトリクス、ログ、トレースに添付することができます。</p><p>属性はまた、<a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/resourcedetectionprocessor target=_blank>Resource Detection processor</a>などのさまざまなプロセッサを使用して、OpenTelemetry コレクターレベルでメトリクス、ログ、トレースに添付することもできます。</p><p>Splunk Observability Cloud に属性付きのトレースが取り込まれると、それらは「タグ」として利用可能になります。オプションとして、トレースの一部として収集された属性は、<a href=https://docs.splunk.com/Observability/apm/span-tags/metricsets.html#troubleshooting-metricsets target=_blank>Troubleshooting Metric Sets</a>の作成に使用され、<a href=https://docs.splunk.com/Observability/apm/span-tags/tag-spotlight.html target=_blank>Tag Spotlight</a>などのさまざまな機能と共に使用することができます。</p><p>また、属性は<a href=https://docs.splunk.com/Observability/apm/span-tags/metricsets.html#monitoring-metricsets target=_blank>Monitoring Metric Sets</a>の作成に使用され、アラートのトリガーとして使用することもできます。</p><h2 id=リソースに関するセマンティック規約>リソースに関するセマンティック規約</h2><p><a href=https://github.com/open-telemetry/opentelemetry-specification/tree/main/specification/resource/semantic_conventions#resource-semantic-conventions target=_blank>OpenTelemetry リソースセマンティック規約</a>は、組織が標準化すべき属性を決定する際の出発点として使用できます。以下のセクションでは、よく使用される属性のいくつか見ていきましょう。</p><h3 id=サービス属性>サービス属性</h3><p>監視されるサービスを記述するために多くの属性が使用されます。</p><p><code>service.name</code> はサービスの論理名を定義する必須の属性です。OpenTelemetry SDK によって自動的に追加されますが、カスタマイズすることができます。これはシンプルに保つことが最善です（例えば、<code>inventoryservice</code> は <code>inventoryservice-prod-hostxyz</code> よりも良いでしょう。他の属性を使用してサービスの他の側面を捉えることができます）。</p><p>以下のサービス属性が推奨されます：</p><ul><li><code>service.namespace</code> はサービスを所有するチームを識別するために使用されます</li><li><code>service.instance.id</code> はサービスのユニークなインスタンスを識別するために使用されます</li><li><code>service.version</code> はサービスのバージョンを識別するために使用されます</li></ul><h3 id=テレメトリsdk>テレメトリSDK</h3><p>これらの属性はSDKによって自動的に設定され、使用されている計測ライブラリに関する情報を記録します：</p><ul><li><code>telemetry.sdk.name</code> は通常 <code>opentelemetry</code> に設定されます。</li><li><code>telemetry.sdk.language</code> は SDK の言語で、例えば <code>java</code> です。</li><li><code>telemetry.sdk.version</code> は使用されている SDK のバージョンを識別します。</li></ul><h3 id=コンテナ>コンテナ</h3><p>コンテナで実行されるサービスには、<code>container.id</code>、<code>container.name</code>、<code>container.image.name</code> など、コンテナのランタイムを記述するための多くの属性が使用されます。完全なリストは<a href=https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/resource/semantic_conventions/container.md target=_blank>こちら</a>で確認できます。</p><h3 id=ホスト>ホスト</h3><p>これらの属性は、サービスが実行されているホストを記述し、<code>host.id</code>、<code>host.name</code>、<code>host.arch</code> などの属性を含みます。完全なリストは<a href=https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/resource/semantic_conventions/host.md target=_blank>こちら</a>で確認できます。</p><h3 id=デプロイ環境>デプロイ環境</h3><p><code>deployment.environment</code> 属性は、サービスがデプロイされている環境（ <strong>staging</strong> や <strong>production</strong> など）を識別するために使用されます。</p><p>Splunk Observability Cloud は、この属性を使用して関連コンテンツを有効する（詳細は<a href=https://docs.splunk.com/observability/metrics-and-metadata/enablerelatedcontent.html target=_blank>こちら</a>）ため、この属性を含めることが重要です。</p><h3 id=クラウド>クラウド</h3><p>AWS などのパブリッククラウド環境で実行されるサービスに関する情報を捉えるための属性もあります。これには、<code>cloud.provider</code>、<code>cloud.account.id</code>、<code>cloud.region</code> が含まれます。</p><p>属性の完全なリストは<a href=https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/resource/semantic_conventions/cloud.md target=_blank>こちら</a>で確認できます。</p><p>一部のクラウドプロバイダー、例えば <a href=https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/resource/semantic_conventions/cloud_provider/gcp/README.md target=_blank>GCP</a> は、独自のセマンティック規則を定義しています。</p><h3 id=kubernetes>Kubernetes</h3><p>Kubernetesで実行されるアプリケーションにも、いくつかの標準化された属性があります。これらの多くは、Splunk の OpenTelemetry コレクター配布によって自動的に追加されます（詳細は<a href=https://docs.splunk.com/observability/metrics-and-metadata/enablerelatedcontent.html#splunk-infrastructure-monitoring target=_blank>こちら</a>）。</p><p>属性は、例えば <code>k8s.cluster.name</code>、<code>k8s.node.name</code>、<code>k8s.pod.name</code>、<code>k8s.namespace.name</code>、<code>kubernetes.workload.name</code> などがあります。</p><h2 id=カスタム属性のベストプラクティス>カスタム属性のベストプラクティス</h2><p>多くの組織では、OpenTelemetryのリソースセマンティック規約で定義されているもの以上の属性が欲しくなります。</p><p>この場合、セマンティック規約にすでに含まれている属性名との命名競合を避けることが重要です。つまり、特定の属性名を命名規則に決定する前に、セマンティック規約をチェックすると良いでしょう。</p><p>属性名の命名規則に加えて、属性値も考慮する必要があります。例えば、アプリケーションが属する特定のビジネスユニットをキャプチャしたい場合、簡単にかつ効果的にフィルタリングするために、標準化されたビジネスユニット値のリストも持ちたいでしょう。</p><p>OpenTelemetryコミュニティでは、属性の命名に従うべきガイドラインも提供しています。<a href=https://opentelemetry.io/docs/specs/otel/common/attribute-naming/ target=_blank>こちら</a>で見つけることができます。</p><p><a href=https://opentelemetry.io/docs/specs/otel/common/attribute-naming/#recommendations-for-application-developers target=_blank>Recommendations for Application Developers</a>は、私たちの議論に最も関連しています。</p><p>そこでは、以下を推奨しています：</p><ul><li><code>com.acme.shopname</code> のように、会社のドメイン名で属性名を接頭辞として付けること（属性が社内だけでなく外部で使用される可能性がある場合）</li><li>属性が特定のアプリケーションに固有であり、組織内でのみ使用される場合は、アプリケーション名で属性名に接頭辞を付けること</li><li>既存の OpenTelemetry セマンティック規約の名前を属性名の接頭辞として使用しないこと</li><li>異なる組織や業界全体で一般的なニーズがある場合は、あなたの属性名を OpenTelemetry 仕様に追加する提案を検討すること</li><li><code>otel.*</code> で始まる属性名は避けること。これは OpenTelemetry 仕様の使用に予約されています</li></ul><h2 id=カーディナリティに関する考慮事項>カーディナリティに関する考慮事項</h2><p>属性名と値の命名基準を決定する際に考慮すべき最後の点は、メトリクスのカーディナリティに関連しています。</p><p>のカーディナリティは、メトリクス名とそれに関連する次元の組み合わせによって生成されるユニークなメトリクス時系列（MTS: Metric Time Series）の数として定義されます。</p><p>メトリクスは、ディメンションの数とそれらのディメンションが持つユニークな値の数が多い場合に、高いカーディナリティを持つことになります。</p><p>例えば、あなたのアプリケーションが <code>custom.metric</code> という名前のメトリクスのデータを送信するとします。属性がない場合、<code>custom.metric</code> は単一のメトリクス時系列（MTS）を生成します。</p><p>一方で、<code>custom.metric</code>が <code>customer.id</code> という属性を含み、数千の顧客ID値がある場合、これは数千のメトリクス時系列を生成し、コストやクエリ性能に影響を与える可能性があります。</p><p>Splunk Observability Cloud は、メトリクスの使用量を管理するための<a href=https://docs.splunk.com/Observability/infrastructure/metrics-pipeline/metrics-usage-report.html target=_blank>レポート</a>を提供しています。そして、望ましくないディメンションを削除する<a href=https://docs.splunk.com/Observability/infrastructure/metrics-pipeline/use-metrics-pipeline.html target=_blank>ルール</a>を作成することができます。しかし、最初の防衛線は、属性名と値の組み合わせがどのようにメトリクスのカーディナリティを増加させるかを理解することです。</p><h2 id=まとめ>まとめ</h2><p>このドキュメントでは、大規模な OpenTelemetry インストゥルメンテーションの展開を開始する前に、OpenTelemetry タグの命名規則を定義することの重要性を強調しました。</p><p>OpenTelemetry のリソースセマンティック規約がいくつかの属性の命名規則を定義し、多くの属性が OpenTelemetry SDKや OpenTelemetry コレクター内で動作するプロセッサーを通じて自動的に収集される方法について説明しました。</p><p>最後に、リソースセマンティック規約が組織のニーズに十分でない場合に、属性名を作成するためのベストプラクティスを共有しました。</p><footer class=footline></footer></article></section></section></div></main></div><script src=../js/clipboard.min.js?1709149817 defer></script>
<script src=../js/perfect-scrollbar.min.js?1709149817 defer></script>
<script src=../js/d3/d3-color.min.js?1709149817 defer></script>
<script src=../js/d3/d3-dispatch.min.js?1709149817 defer></script>
<script src=../js/d3/d3-drag.min.js?1709149817 defer></script>
<script src=../js/d3/d3-ease.min.js?1709149817 defer></script>
<script src=../js/d3/d3-interpolate.min.js?1709149817 defer></script>
<script src=../js/d3/d3-selection.min.js?1709149817 defer></script>
<script src=../js/d3/d3-timer.min.js?1709149817 defer></script>
<script src=../js/d3/d3-transition.min.js?1709149817 defer></script>
<script src=../js/d3/d3-zoom.min.js?1709149817 defer></script>
<script src=../js/js-yaml.min.js?1709149817 defer></script>
<script src=../js/mermaid.min.js?1709149817 defer></script>
<script>window.themeUseMermaid=JSON.parse("{}")</script><script src=../js/theme.js?1709149817 defer></script></body></html>